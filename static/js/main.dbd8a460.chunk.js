/*! For license information please see main.dbd8a460.chunk.js.LICENSE.txt */
(this.webpackJsonpterminal=this.webpackJsonpterminal||[]).push([[0],{103:function(e,t,n){var r=n(4),i=n(20).standardize,a=n(152).covenantIdModel,s=n(104).timestampModel,o=n(70).keypairModel,c=n(127).aclModel,u=n(150).binaryModel,l=(n(41).integrityModel,n(105).networkModel),p=n(158).stateModel,d=n(159).configModel,h=n(160).validatorsModel,f=n(161).pendingModel,v=(n(107).rxRequestModel,i({schema:{type:"object",title:"Dmz",description:"DMZ coordinates all the models in one place.\nDmz is equivalent to CombineReducers in Redux.",required:["validators","encryption","config","network","covenantId","binaryIntegrity","acl","state","pending"],additionalProperties:!1,properties:{validators:h.schema,encryption:o.schema,config:d.schema,covenantId:a.schema,binaryIntegrity:u.schema,timestamp:s.schema,acl:c.schema,network:l.schema,state:p.schema,pending:f.schema}},create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r("object"===typeof e);var t={validators:h.clone(e.validators),encryption:o.clone(e.encryption),config:d.create(e.config),covenantId:a.clone(e.covenantId),binaryIntegrity:u.clone(e.binaryIntegrity),acl:c.clone(e.acl),network:l.clone(e.network),state:p.clone(e.state),pending:f.create()};return v.clone(t)},logicize:function(e){var t=e.network,n=e.pending,i=e.config;r(n.isBufferValid(t)),r(!t[".@@io"]||i.isPierced);return{rx:function(){var e=t.rxReply();if(e)return e;if(!n.getIsPending()){var r=n.rxBufferedRequest(t);if(r)return r}return t.rxRequest()}}}}));e.exports={dmzModel:v}},104:function(e,t,n){var r=(0,n(20).standardize)({schema:{title:"Timestamp",type:"object",description:"Time of issuance in standard format, with Zulu offset",additionalProperties:!1,required:["date","ms"],properties:{date:{type:"string",format:"date-time",examples:["2011-10-05T14:48:00.000Z"]},ms:{type:"integer"}}},create:function(){var e=new Date,t=e.toISOString(),n=e.valueOf();return r.clone({date:t,ms:n})},logicize:function(e){return{isExpired:function(t){return Date.now()-e.ms>=t}}}});e.exports={timestampModel:r}},105:function(e,t,n){var r=n(7),i=n(4),a=(n(9)("interblock:models:network"),n(24)),s=n(20).standardize,o=n(106).channelModel,c=n(52).addressModel,u=n(69).provenanceModel,l=n(155).rxRequestModel,p=s({schema:{title:"Network",description:"All communication in and out of this blockchain.",type:"object",required:["..","."],additionalProperties:!1,minProperties:2,patternProperties:{"(.*?)":o.schema}},create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e[".."]?e[".."]:o.create(c.create(),".."),n=e["."]?e["."]:o.create(c.create("LOOPBACK"),".");return i(n.address.isLoopback()),p.clone(r({},e,{"..":t,".":n}))},logicize:function(e){i(!e[void 0]);var t=Object.keys(e);i(t.includes("..")),i(t.includes(".")),i(o.isModel(e["."]),"channel invalid"),i("."===e["."].systemRole,"self not loopback channel");var n=function(n){var r;return t.find((function(t){var i,a=e[t],s=a.rxReply(),o=a.rxRequest();switch(n){case"reply":i=s;break;case"request":i=o}if(i)return r={alias:t,event:i,channel:a},!0})),r},r=function(){return Object.keys(e)},s=function(){return r().filter((function(t){return e[t].address.isResolved()&&".@@io"!==t}))},d=function(t){return i(c.isModel(t)),i(!t.isUnknown()),r().find((function(n){return e[n].address.equals(t)}))};return{rxReply:function(){return n("reply")},rxRequest:function(){return n("request")},rxSelf:function(){var t=e["."];return t.rxReply()||t.rxRequest()},getAliases:r,getResolvedAliases:s,getAlias:d,getParent:function(){return e[".."]},includesInterblock:function(t){var n=t.provenance;i(u.isModel(n));var r=d(n.getAddress());if(!r)return!1;var s=!1,o=e[r];if(n.height<=o.lineageHeight&&(s=!0),n.height===o.lineageHeight){var c=n.equals(a.last(o.lineageTip).provenance);i(c)}return t.getRemote()&&s?(n.height===o.heavy.provenance.height&&i(t.equals(o.heavy)),n.height<=o.heavy.provenance.height):s},getResponse:function(t){i(l.isModel(t));var n=t.getAddress(),r=t.getIndex(),a=d(n);return i(e[a]),e[a].replies[r]},txInterblockAliases:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p.create();i(p.isModel(t));var n=s(),r=n.filter((function(n){var r=e[n],i=t.getAlias(r.address);if(!i)return!0;var a=t[i];return r.isTxGreaterThan(a)}));return r},isNewChannels:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p.create();i(p.isModel(t));var n=s(),r=n.some((function(n){var r=e[n].address;if(!t.getAlias(r))return!0}));return r}}}});e.exports={networkModel:p}},106:function(e,t,n){var r=n(28),i=n(7),a=n(4),s=n(9)("interblock:models:channel"),o=n(24),c=n(107),u=c.rxRequestModel,l=c.rxReplyModel,p=n(20).standardize,d=n(52).addressModel,h=n(68).actionModel,f=n(88).continuationModel,v=n(109).remoteModel,g=p({schema:n(38).channelSchema,create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"DOWN_LINK";e=d.clone(e);var n=v.create({address:e}),r=i({},n,{systemRole:t,requestsLength:0,lineage:[],lineageTip:[]});return g.clone(r)},logicize:function(e){var t=e.address,n=e.systemRole,i=e.requests,c=e.replies,p=e.heavy,d=e.lineageHeight,f=e.heavyHeight,x=e.lineage,w=e.lineageTip,I=(e.requestsLength,"."===n);I&&a(t.isLoopback()),t.isUnknown()&&a.strictEqual(Object.keys(c).length,0);var M=I?v.create(e):p&&p.getRemote()?p.getRemote():v.create();if(a(M),p&&(a(p.getRemote()||0===f),a.strictEqual(p.provenance.height,f),a(d>=f)),w.length){var C=o.last(w).provenance;a.strictEqual(C.height,d),a(o.last(x).equals(C.reflectIntegrity()))}a(w.every((function(e){return!e.getRemote()}))),b(i),b(c);var P=function(){if(!t.isUnknown())return k(M.replies).find((function(e){return!M.replies[e].isPromise()&&i[e]}))},E=function(){var e,t=k(M.requests),n=r(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(!c[i])return i}}catch(a){n.e(a)}finally{n.f()}};return{rxRequest:function(e){if(!t.isUnknown()||I){Number.isInteger(e)||(e=E());var n=M.requests[e];if(n){a(h.isModel(n));var r=n.type,i=n.payload,o=u.create(r,i,t,e);return s("rxRequest ".concat(o.type)),o}}},rxReply:function(e){if(Number.isInteger(e)||(e=P()),Number.isInteger(e)&&!(e<0)){a(i[e],"No request for: ".concat(e)),a(M.replies[e],"No reply for: ".concat(e));var t=M.replies[e],n=t.type,r=t.payload,s=i[e];return l.create(n,r,s)}},rxReplyIndex:P,getNextReplyIndex:E,getRemoteRequestIndices:function(){return k(M.requests)},getRemoteReplyIndices:function(){return k(M.replies)},isTxGreaterThan:function(e){a(g.isModel(e));var n=!e.address.equals(t),r=m(c,e.replies),s=m(i,e.requests),o=y(c,e.replies);return n||r||s||o},getRemote:function(){return M},getOutboundPairs:function(){return k(i).map((function(e){return[i[e],M.replies[e]]}))},getRequestIndices:function(){return k(i)}}}}),y=function(e,t){return k(e).some((function(n){var r=e[n],i=t[n];return!(!i||!r)&&(a(f.isModel(r)),a(f.isModel(i)),i.isPromise()&&!r.isPromise())}))},m=function(e,t){var n=k(e),r=k(t),i=x(n,r);return i},k=function(e){var t=[];return Object.keys(e).forEach((function(e){var n=parseInt(e);t.push(n)})),t.sort((function(e,t){return e-t})),t},b=function(e){var t=-1,n=Object.keys(e).every((function(e){var n=parseInt(e),r=n>t;return t=n,r}));a(n)},x=function(e,t){return!(!t.length&&!e.length)&&(!(t.length||!e.length)||!(t.length&&!e.length)&&o.last(t)<o.last(e))};e.exports={channelModel:g}},107:function(e,t,n){var r=n(245).rxReplyModel,i=n(155).rxRequestModel,a=n(156).txReplyModel,s=n(157).txRequestModel,o=n(1733).reductionModel;e.exports={rxReplyModel:r,rxRequestModel:i,txReplyModel:a,txRequestModel:s,reductionModel:o}},108:function(e,t){e.exports={txRequestSchema:{title:"txRequest",description:"Covenant created",type:"object",required:["type","payload","to"],additionalProperties:!1,properties:{type:{type:"string"},payload:{type:"object"},to:{type:"string"}}},rxRequestSchema:{title:"rxRequest",description:"System created inside ChannelModel",type:"object",required:["type","payload","sequence"],additionalProperties:!1,properties:{type:{type:"string"},payload:{type:"object"},sequence:{type:"string",pattern:""}}},txReplySchema:{title:"txReply",description:"Covenant created",type:"object",required:["type","payload","request"],additionalProperties:!1,properties:{type:{type:"string",enum:["@@REJECT","@@PROMISE","@@RESOLVE"]},payload:{type:"object"},request:{description:"Sequence created in rxRequest",type:"object",required:["sequence"],additionalProperties:!1,properties:{sequence:{type:"string",pattern:""}}}}},rxReplySchema:{title:"rxReply",description:'System created.\nCreate requires the sequence to be included.\n@@PROMISE cannot ever be dispatched to a reducer, hence its exclusion from "type"',type:"object",required:["type","payload","request"],additionalProperties:!1,properties:{type:{type:"string",enum:["@@REJECT","@@RESOLVE"]},payload:{type:"object"},request:{description:"Covenants original request, without the 'to' field",type:"object",required:["type","payload"],additionalProperties:!1,properties:{type:{type:"string"},payload:{type:"object"}}}}}}},109:function(e,t,n){var r=n(7),i=n(4),a=(n(24),n(20).standardize),s=n(38).remoteSchema,o=n(52).addressModel,c=a({schema:s,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i("object"===typeof e);var t={},n=["address","requests","replies","heavyHeight","lineageHeight"];n.forEach((function(n){e[n]&&(t[n]=e[n])}));var a={address:o.create(),requests:{},replies:{},heavyHeight:-1,lineageHeight:-1},s=r({},a,{},t);return c.clone(s)},logicize:function(e){return{}}});e.exports={remoteModel:c}},110:function(e,t,n){var r=n(7),i=n(47),a=n(4),s=(n(24),n(9)("interblock:models:interblock"),n(20).standardize),o=(n(69).provenanceModel,n(41).integrityModel,n(88).continuationModel),c=n(84).blockModel,u=n(106).channelModel,l=n(109).remoteModel,p=n(38).interblockSchema,d=n(163).proofModel,h=s({schema:p,create:function(e,t){a(c.isModel(e)),f(e,t);var n=e.provenance,r=e.validators,s={provenance:n,proof:d.create(e,t),validators:r};if(t){var o=e.network[t];a(u.isModel(o));var p=l.create(o);s.network=i({},t,p)}return h.clone(s)},logicize:function(e){var t,n=e.provenance,i=(e.proof,e.validators,e.network),s=i&&Object.keys(i)[0],u=s&&i[s];if(a(!u||l.isModel(u)),s){a.strictEqual(Object.keys(i).length,1);var p=i[s];a(!p.address.isUnknown(),"interblock transmission address must be known")}var d,f=function(){if(!t){var e=c.clone(u.requests[0].payload.genesis);a(e.provenance.address.isGenesis()),t=e}return t},v=function(){if(!u)return!1;var e=u.requests[0],t=1===u.requests.length;return!(!e||"@@INTRO"!==e.type||!t)||void 0};return{extractGenesis:f,getTargetAddress:function(){return u&&u.address},getOriginAlias:function(){return s},getRemote:function(){return u},isConnectionAttempt:v,isGenesisAttempt:function(){try{return f()}catch(e){}return!1},getWithoutRemote:function(){if(!d){var t={block:e.proof.block},n=r({},e,{proof:t});delete n.network,d=h.clone(n)}return d},getLineageHeight:function(){return u.lineageHeight},getHeavyHeight:function(){return u.heavyHeight},isConnectionResponse:function(){if(!u)return!1;a(u&&s);var e=-1===u.lineageHeight&&-1===u.heavyHeight,t=s.startsWith("@@PUBLIC_"),n=s.substring("@@PUBLIC_".length),r=t&&n===u.address.getChainId(),i=u.requests[0],o=i&&"@@ACCEPT"===i.type,c=!Object.keys(u.replies).length;return e&&r&&o&&c},isConnectionResolve:function(){if(!v())return!1;var e=u.replies[0];return e?(a(o.isModel(e)),e.isResolve()):void 0},isDownlinkInit:function(){if(!u)return!1;var e=u.requests[0]&&!Object.keys(u.replies).length,t=u.heavyHeight<0;return e&&t},isUplinkInit:function(){return!!u&&(u.replies[0]&&!Object.keys(u.requests).length)},getChainId:function(){return n.getAddress().getChainId()}}}}),f=function(e,t){if(t&&"string"!==typeof t)throw new Error("Invalid format for target alias: ".concat(t));if(!e.isValidated())throw new Error("Only validated blocks can be reduced to Interblocks");if("."===t)throw new Error("Cannot make interblock from loopback channel")};e.exports={interblockModel:h}},111:function(e,t,n){var r=n(7),i=n(2),a=n(3),s=n(4),o=n(40).interpret,c=n(1738).machineLogger,u=function(){var e=a(i.mark((function e(t,n){var s,u,l;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=c(t.type||t,n.id),u=o(n,{execute:!1}),l=new Promise((function(e,t){var n=!1;u.onTransition(function(){var e=a(i.mark((function e(t){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("error"===t.value&&(n=t.event),"error"===t.value||"done"===t.value){e.next=4;break}return e.next=4,s.writeTransition(t.value,t.event,t.context);case 4:u.execute(t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),u.onDone(function(){var o=a(i.mark((function a(o){var c,u,l;return i.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!n){i.next=11;break}return(c=n).type,u=c.data,(l=r({},new Error,{},u)).message=u.message,l.stack=u.stack,l.name=u.name,i.next=8,s.writeTermination(l);case 8:t(l),i.next=14;break;case 11:return i.next=13,s.writeTermination();case 13:e(o.data);case 14:case"end":return i.stop()}}),a)})));return function(e){return o.apply(this,arguments)}}())})),u.start(),u.send(t),e.abrupt("return",l);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();e.exports={thread:u,setLogger:function(e){s.strictEqual(typeof e,"function"),c=e}}},112:function(e,t,n){var r=n(2),i=n(3),a=n(7),s=n(4),o=n(34)["@@GLOBAL_HOOK"],c=n(21),u=c.blockModel,l=c.rxReplyModel,p=c.rxRequestModel,d=n(86),h=n(9)("interblock:isolate");e.exports={isolateFactory:function(e){var t=function(e){var t={},n=a({},d,{},e);return{loadCovenant:function(){var e=i(r.mark((function e(i){var a,o,c,l;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(u.isModel(i)),a=i.covenantId,o=i.provenance.reflectIntegrity().hash,c=a.name,s(n[c],"No covenant loaded: ".concat(c)),h("loadCovenant %o from %o",c,Object.keys(n)),h("containerId: %o",o.substring(0,9)),l=n[c],t[o]={covenant:l,block:i,effects:{}},e.abrupt("return",o);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),tick:function(){var e=i(r.mark((function e(n){var i,a,c,u,d,f,v,g,y,m,k,b,x,w,I;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.containerId,a=n.state,c=n.action,u=n.accumulator,d=void 0===u?[]:u,f=n.timeout,h("tick: %o action: %o",i.substring(0,9),c.type),v=t[i],s(v,"No tick container for: ".concat(i)),s(!a||"object"===typeof a),s(Array.isArray(d)),f=f||3e4,s(Number.isInteger(f)&&f>=0),l.isModel(c)?s(!d.length):s(p.isModel(c)),g=function(){return v.covenant.reducer(a,c)},y=c.getHash(),e.next=13,o(g,d,y);case 13:return m=e.sent,h("syncResult",m),k=m.reduction,b=m.isPending,x=m.requests,w=m.replies,s(k&&!b||!k&&b),s.strictEqual(typeof b,"boolean"),s(Array.isArray(x)),s(Array.isArray(w)),b&&s(d.length||x.length),I=x.map((function(e){if(".@@io"===e.to){s.strictEqual(typeof e.exec,"function");var t=e.payload[".@@ioRequestId"];return s.strictEqual(typeof t,"string"),s(t.length>y.length+1),s(!v.effects[t]),v.effects[t]=e,{type:e.type,payload:e.payload,to:e.to}}return e})),e.abrupt("return",{reduction:k,isPending:b,requests:I,replies:w});case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),unloadCovenant:function(){var e=i(r.mark((function e(n){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h("attempting to unload: %o",n),e.next=3,Promise.resolve();case 3:s(t[n],"No container for: ".concat(n)),delete t[n];case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setEffectPermissions:function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.containerId,t.permissions;case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),executeEffect:function(){var e=i(r.mark((function e(n){var i,a,o,c,u;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.containerId,a=n.effectId,n.timeout,h("executeEffect effectId: %o",a),o=t[i],s(o,"No effects container for: ".concat(i)),s(o.effects[a],"No effect for: ".concat(a)),c=o.effects[a],h("action: ",c),s.strictEqual(typeof c.exec,"function"),e.next=10,c.exec();case 10:return u=e.sent,e.abrupt("return",u);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}(e);return function(e){switch(e.type){case"LOAD_COVENANT":return t.loadCovenant(e.payload);case"TICK":return t.tick(e.payload);case"UNLOAD_COVENANT":return t.unloadCovenant(e.payload);case"EXECUTE":return t.executeEffect(e.payload);default:throw new Error("Unknown isolator action type")}}},toFunctions:function(e){return{loadCovenant:function(t){return e.push({type:"LOAD_COVENANT",payload:t})},tick:function(t){return e.push({type:"TICK",payload:t})},unloadCovenant:function(t){return e.push({type:"UNLOAD_COVENANT",payload:t})},executeEffect:function(t){return e.push({type:"EXECUTE",payload:t})}}}}},113:function(e,t,n){var r=n(2),i=n(3),a=n(9)("interblock:services:crypto"),s=n(4),o=n(21),c=o.cryptoCacher,u=o.keypairModel,l=o.integrityModel,p=n(53),d=p.ramDynamoDbFactory,h=p.dbFactory,f=n(48),v=c.cacheVerifyKeypair,g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"CI";e=e||d();var n=h(e);s("string"===typeof t);var o,c=function(){var e=i(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(l.isModel(t)),e.next=3,g();case 3:return n=e.sent,e.abrupt("return",n.sign(t));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:return t=e.sent,e.abrupt("return",t.getValidatorEntry());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=i(r.mark((function e(){var i,s,c,l,p,d,h,g;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=2;break}return e.abrupt("return",o);case 2:return e.next=4,n.scanKeypair();case 4:if(!(i=e.sent)){e.next=12;break}return s=JSON.parse(i.keypairJson),e.next=9,v(s);case 9:o=u.clone(s),e.next=30;break;case 12:return e.next=14,f.generateKeyPair();case 14:return c=e.sent,l=u.create(t,c),p=l.serialize(),e.next=19,n.putKeypair({keyname:t,keypairJson:p});case 19:return e.next=21,n.scanKeypair();case 21:if(d=e.sent,h=d.keypairJson){e.next=25;break}throw new Error("cannot store keypair");case 25:return g=JSON.parse(h),e.next=28,v(g);case 28:(o=u.clone(g)).equals(l)||a("collision avoided for: ",t);case 30:return e.abrupt("return",o);case 31:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{sign:c,getValidatorEntry:p}};e.exports={cryptoFactory:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"CI",n=g(e,t),s=function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a("crypto: ".concat(t.type)),e.t0=t.type,e.next="SIGN"===e.t0?4:"VALIDATOR"===e.t0?5:6;break;case 4:return e.abrupt("return",n.sign(t.payload));case 5:return e.abrupt("return",n.getValidatorEntry());case 6:throw new Error("Unknown crypto action type: ".concat(t.type));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return s},toFunctions:function(e){return{sign:function(t){return e.push({type:"SIGN",payload:t})},getValidatorEntry:function(){return e.push({type:"VALIDATOR"})}}},crypto:f}},114:function(e,t,n){(function(t){var r=n(60),i=n(2),a=n(3),s=n(9)("interblock:aws:ramDynamoDb"),o=n(4),c=(n(24),{dbChains:"height",dbPools:"originChainId_height_type",dbLocks:"chainId",dbSockets:"socketId",dbSubscribers:"targetChainId",dbPiercings:"hash"}),u=function(e,t){return t[c[e]]};e.exports={ramDynamoDbFactory:function(){var e={dbCrypto:{},dbChains:{},dbPools:{},dbLocks:{},dbSubscribers:{},dbSockets:{},dbPiercings:{}};return{get:function(n,r){var c=n.TableName,l=n.Key;s("get %O callback: %O",c,r),o(e[c]),r&&t(a(i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=r,e.next=3,p.promise();case 3:e.t1=e.sent,(0,e.t0)(null,e.t1);case 5:case"end":return e.stop()}}),e)}))));var p={promise:function(){var t=a(i.mark((function t(){var n,r,a;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:return o(l.chainId),n=e[c][l.chainId]||{},r=u(c,l),a=n[r],t.abrupt("return",{Item:a});case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()};return p},query:function(t){s("query %O",t.TableName);var n=t.TableName,r=t.KeyConditionExpression,c=t.ExpressionAttributeValues;o.strictEqual(r,"chainId = :hkey");var u=c[":hkey"];return o(u),{promise:function(){var t=a(i.mark((function t(){var r,a;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:return r=e[n][u]||{},a=Object.values(r).reverse(),t.abrupt("return",{Items:a});case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}},delete:function(t){var n=t.TableName,r=t.Key;return s("del %O %O",n,r),{promise:function(){var t=a(i.mark((function t(){var a,s,c;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:a=e[n][r.chainId],s=u(n,r),c=a[s],o(c,"cannot delete non existent item"),delete a[s];case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}},put:function(n,o){var c=n.TableName,l=n.Item;r(n,["TableName","Item"]);s("put %O %O",c,l.chainId),o&&t(a(i.mark((function e(){var t;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.promise();case 3:t=e.sent,o(null,t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),o(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))));var p={promise:function(){var t=a(i.mark((function t(){var n,r,a;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:return n=l.chainId,r=e[c][n]||{},a=u(c,l),r[a]&&s("already exists: %O",l.chainId),r[a]=l,e[c][n]=r,t.abrupt("return",!0);case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()};return p},scan:function(t){var n=t.TableName,r=t.Limit;return s("scan: %O %O",n,r),o(["dbChains","dbCrypto"].includes(n)),o.strictEqual(r,1),{promise:function(){var t=a(i.mark((function t(){var r,a,s;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:return r=e[n],a=Object.values(r)[0],s=[],a&&s.push(Object.values(a)[0]),t.abrupt("return",{Items:s});case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}},_getTables:function(){return e}}}}}).call(this,n(58).setImmediate)},115:function(e,t,n){"use strict";var r=n(28),i=n(7),a=n(2),s=n(3),o=n(10),c=n(12),u=n(259),l=n(26),p=n(29),d=n(18),h=n(19),f=n(46),v=n(89),g=n(1826),y=n(32),m=y.reorder,k=y.scrollUp,b=y.scrollDown,x=y.isObject,w=y.swap,I=function(e){h(n,e);var t=d(n);function n(e){var r;return o(this,n),(r=t.call(this,e)).cursorHide(),r.maxSelected=e.maxSelected||1/0,r.multiple=e.multiple||!1,r.initial=e.initial||0,r.delay=e.delay||0,r.longest=0,r.num="",r}return c(n,[{key:"initialize",value:function(){var e=s(a.mark((function e(){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!==typeof this.options.initial){e.next=4;break}return e.next=3,this.options.initial.call(this);case 3:this.initial=e.sent;case 4:return e.next=6,this.reset(!0);case 6:return e.next=8,p(l(n.prototype),"initialize",this).call(this);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reset",value:function(){var e=s(a.mark((function e(){var t,n,r,i,s,o=this;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.options,n=t.choices,r=t.initial,i=t.autofocus,s=t.suggest,this.state._choices=[],this.state.choices=[],e.t0=Promise,e.next=6,this.toChoices(n);case 6:return e.t1=e.sent,e.next=9,e.t0.all.call(e.t0,e.t1);case 9:if(this.choices=e.sent,this.choices.forEach((function(e){return e.enabled=!1})),"function"===typeof s||0!==this.selectable.length){e.next=13;break}throw new Error("At least one choice must be selectable");case 13:if(x(r)&&(r=Object.keys(r)),!Array.isArray(r)){e.next=21;break}return null!=i&&(this.index=this.findIndex(i)),r.forEach((function(e){return o.enable(o.find(e))})),e.next=19,this.render();case 19:e.next=24;break;case 21:null!=i&&(r=i),"string"===typeof r&&(r=this.findIndex(r)),"number"===typeof r&&r>-1&&(this.index=Math.max(0,Math.min(r,this.choices.length)),this.enable(this.find(this.index)));case 24:if(!this.isDisabled(this.focused)){e.next=27;break}return e.next=27,this.down();case 27:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toChoices",value:function(){var e=s(a.mark((function e(t,n){var r,i,o,c=this;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.loadingChoices=!0,r=[],i=0,o=function(){var e=s(a.mark((function e(t,n){var s,u;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!==typeof t){e.next=4;break}return e.next=3,t.call(c);case 3:t=e.sent;case 4:if(!(t instanceof Promise)){e.next=8;break}return e.next=7,t;case 7:t=e.sent;case 8:s=0;case 9:if(!(s<t.length)){e.next=20;break}return e.next=12,c.toChoice(t[s],i++,n);case 12:if(u=t[s]=e.sent,r.push(u),!u.choices){e.next=17;break}return e.next=17,o(u.choices,u);case 17:s++,e.next=9;break;case 20:return e.abrupt("return",r);case 21:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.abrupt("return",o(t,n).then((function(e){return c.state.loadingChoices=!1,e})));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"toChoice",value:function(){var e=s(a.mark((function e(t,n,r){var s,o,c;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!==typeof t){e.next=4;break}return e.next=3,t.call(this,this);case 3:t=e.sent;case 4:if(!(t instanceof Promise)){e.next=8;break}return e.next=7,t;case 7:t=e.sent;case 8:if("string"===typeof t&&(t={name:t}),!t.normalized){e.next=11;break}return e.abrupt("return",t);case 11:if(t.normalized=!0,s=t.value,o=g(t.role,this.options),"string"!==typeof(t=o(this,t)).disabled||t.hint||(t.hint=t.disabled,t.disabled=!0),!0===t.disabled&&null==t.hint&&(t.hint="(disabled)"),null==t.index){e.next=19;break}return e.abrupt("return",t);case 19:if(t.name=t.name||t.key||t.title||t.value||t.message,t.message=t.message||t.name||"",t.value=[t.value,t.name].find(this.isValue.bind(this)),t.input="",t.index=n,t.cursor=0,y.define(t,"parent",r),t.level=r?r.level+1:1,null==t.indent&&(t.indent=r?r.indent+"  ":t.indent||""),t.path=r?r.path+"."+t.name:t.name,t.enabled=!(!this.multiple||this.isDisabled(t)||!t.enabled&&!this.isSelected(t)),this.isDisabled(t)||(this.longest=Math.max(this.longest,f.unstyle(t.message).length)),c=i({},t),t.reset=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.input,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.value,r=0,i=Object.keys(c);r<i.length;r++){var a=i[r];t[a]=c[a]}t.input=e,t.value=n},null!=s||"function"!==typeof t.initial){e.next=37;break}return e.next=36,t.initial.call(this,this.state,t,n);case 36:t.input=e.sent;case 37:return e.abrupt("return",t);case 38:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"onChoice",value:function(){var e=s(a.mark((function e(t,n){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.emit("choice",t,n,this),"function"!==typeof t.onChoice){e.next=4;break}return e.next=4,t.onChoice.call(this,this.state,t,n);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"addChoice",value:function(){var e=s(a.mark((function e(t,n,r){var i;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.toChoice(t,n,r);case 2:return i=e.sent,this.choices.push(i),this.index=this.choices.length-1,this.limit=this.choices.length,e.abrupt("return",i);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"newItem",value:function(){var e=s(a.mark((function e(t,n,r){var s,o;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=i({name:"New choice name?",editable:!0,newChoice:!0},t),e.next=3,this.addChoice(s,n,r);case 3:return(o=e.sent).updateChoice=function(){delete o.newChoice,o.name=o.message=o.input,o.input="",o.cursor=0},e.abrupt("return",this.render());case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"indent",value:function(e){return null==e.indent?e.level>1?"  ".repeat(e.level-1):"":e.indent}},{key:"dispatch",value:function(e,t){if(this.multiple&&this[t.name])return this[t.name]();this.alert()}},{key:"focus",value:function(e,t){return"boolean"!==typeof t&&(t=e.enabled),t&&!e.enabled&&this.selected.length>=this.maxSelected?this.alert():(this.index=e.index,e.enabled=t&&!this.isDisabled(e),e)}},{key:"space",value:function(){return this.multiple?(this.toggle(this.focused),this.render()):this.alert()}},{key:"a",value:function(){if(this.maxSelected<this.choices.length)return this.alert();var e=this.selectable.every((function(e){return e.enabled}));return this.choices.forEach((function(t){return t.enabled=!e})),this.render()}},{key:"i",value:function(){return this.choices.length-this.selected.length>this.maxSelected?this.alert():(this.choices.forEach((function(e){return e.enabled=!e.enabled})),this.render())}},{key:"g",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.focused;return this.choices.some((function(e){return!!e.parent}))?(this.toggle(e.parent&&!e.choices?e.parent:e),this.render()):this.a()}},{key:"toggle",value:function(e,t){var n=this;if(!e.enabled&&this.selected.length>=this.maxSelected)return this.alert();"boolean"!==typeof t&&(t=!e.enabled),e.enabled=t,e.choices&&e.choices.forEach((function(e){return n.toggle(e,t)}));for(var r=e.parent;r;){var i=r.choices.filter((function(e){return n.isDisabled(e)}));r.enabled=i.every((function(e){return!0===e.enabled})),r=r.parent}return M(this,this.choices),this.emit("toggle",e,this),e}},{key:"enable",value:function(e){return this.selected.length>=this.maxSelected?this.alert():(e.enabled=!this.isDisabled(e),e.choices&&e.choices.forEach(this.enable.bind(this)),e)}},{key:"disable",value:function(e){return e.enabled=!1,e.choices&&e.choices.forEach(this.disable.bind(this)),e}},{key:"number",value:function(e){var t=this;this.num+=e;var n=function(e){var n=Number(e);if(n>t.choices.length-1)return t.alert();var r=t.focused,i=t.choices.find((function(e){return n===e.index}));if(!i.enabled&&t.selected.length>=t.maxSelected)return t.alert();if(-1===t.visible.indexOf(i)){var a=m(t.choices),s=a.indexOf(i);if(r.index>s){var o=a.slice(s,s+t.limit),c=a.filter((function(e){return!o.includes(e)}));t.choices=o.concat(c)}else{var u=s-t.limit+1;t.choices=a.slice(u).concat(a.slice(0,u))}}return t.index=t.choices.indexOf(i),t.toggle(t.focused),t.render()};return clearTimeout(this.numberTimeout),new Promise((function(e){var r=t.choices.length,i=t.num,a=function(){var r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=arguments.length>1?arguments[1]:void 0;clearTimeout(t.numberTimeout),r&&(a=n(i)),t.num="",e(a)};return"0"===i||1===i.length&&Number(i+"0")>r?a(!0):Number(i)>r?a(!1,t.alert()):void(t.numberTimeout=setTimeout((function(){return a(!0)}),t.delay))}))}},{key:"home",value:function(){return this.choices=m(this.choices),this.index=0,this.render()}},{key:"end",value:function(){var e=this.choices.length-this.limit,t=m(this.choices);return this.choices=t.slice(e).concat(t.slice(0,e)),this.index=this.limit-1,this.render()}},{key:"first",value:function(){return this.index=0,this.render()}},{key:"last",value:function(){return this.index=this.visible.length-1,this.render()}},{key:"prev",value:function(){return this.visible.length<=1?this.alert():this.up()}},{key:"next",value:function(){return this.visible.length<=1?this.alert():this.down()}},{key:"right",value:function(){return this.cursor>=this.input.length?this.alert():(this.cursor++,this.render())}},{key:"left",value:function(){return this.cursor<=0?this.alert():(this.cursor--,this.render())}},{key:"up",value:function(){var e=this.choices.length,t=this.visible.length,n=this.index;return!1===this.options.scroll&&0===n?this.alert():e>t&&0===n?this.scrollUp():(this.index=(n-1%e+e)%e,this.isDisabled()?this.up():this.render())}},{key:"down",value:function(){var e=this.choices.length,t=this.visible.length,n=this.index;return!1===this.options.scroll&&n===t-1?this.alert():e>t&&n===t-1?this.scrollDown():(this.index=(n+1)%e,this.isDisabled()?this.down():this.render())}},{key:"scrollUp",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.choices=k(this.choices),this.index=e,this.isDisabled()?this.up():this.render()}},{key:"scrollDown",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.visible.length-1;return this.choices=b(this.choices),this.index=e,this.isDisabled()?this.down():this.render()}},{key:"shiftUp",value:function(){var e=s(a.mark((function e(){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==this.options.sort){e.next=7;break}return this.sorting=!0,this.swap(this.index-1),e.next=5,this.up();case 5:return this.sorting=!1,e.abrupt("return");case 7:return e.abrupt("return",this.scrollUp(this.index));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"shiftDown",value:function(){var e=s(a.mark((function e(){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==this.options.sort){e.next=7;break}return this.sorting=!0,this.swap(this.index+1),e.next=5,this.down();case 5:return this.sorting=!1,e.abrupt("return");case 7:return e.abrupt("return",this.scrollDown(this.index));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pageUp",value:function(){return this.visible.length<=1?this.alert():(this.limit=Math.max(this.limit-1,0),this.index=Math.min(this.limit-1,this.index),this._limit=this.limit,this.isDisabled()?this.up():this.render())}},{key:"pageDown",value:function(){return this.visible.length>=this.choices.length?this.alert():(this.index=Math.max(0,this.index),this.limit=Math.min(this.limit+1,this.choices.length),this._limit=this.limit,this.isDisabled()?this.down():this.render())}},{key:"swap",value:function(e){w(this.choices,this.index,e)}},{key:"isDisabled",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.focused,t=["disabled","collapsed","hidden","completing","readonly"];return!(!e||!t.some((function(t){return!0===e[t]})))||e&&"heading"===e.role}},{key:"isEnabled",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.focused;if(Array.isArray(t))return t.every((function(t){return e.isEnabled(t)}));if(t.choices){var n=t.choices.filter((function(t){return!e.isDisabled(t)}));return t.enabled&&n.every((function(t){return e.isEnabled(t)}))}return t.enabled&&!this.isDisabled(t)}},{key:"isChoice",value:function(e,t){return e.name===t||e.index===Number(t)}},{key:"isSelected",value:function(e){var t=this;return Array.isArray(this.initial)?this.initial.some((function(n){return t.isChoice(e,n)})):this.isChoice(e,this.initial)}},{key:"map",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";return[].concat(t||[]).reduce((function(t,r){return t[r]=e.find(r,n),t}),{})}},{key:"filter",value:function(e,t){var n="function"===typeof e?e:function(t,n){return[t.name,n].includes(e)},r=(this.options.multiple?this.state._choices:this.choices).filter(n);return t?r.map((function(e){return e[t]})):r}},{key:"find",value:function(e,t){if(x(e))return t?e[t]:e;var n="function"===typeof e?e:function(t,n){return[t.name,n].includes(e)},r=this.choices.find(n);return r?t?r[t]:r:void 0}},{key:"findIndex",value:function(e){return this.choices.indexOf(this.find(e))}},{key:"submit",value:function(){var e=s(a.mark((function e(){var t,r,i,s,o,c;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.focused){e.next=3;break}return e.abrupt("return",this.alert());case 3:if(!t.newChoice){e.next=8;break}if(t.input){e.next=6;break}return e.abrupt("return",this.alert());case 6:return t.updateChoice(),e.abrupt("return",this.render());case 8:if(!this.choices.some((function(e){return e.newChoice}))){e.next=10;break}return e.abrupt("return",this.alert());case 10:if(r=this.options,i=r.reorder,s=r.sort,o=!0===this.multiple,void 0!==(c=this.selected)){e.next=15;break}return e.abrupt("return",this.alert());case 15:return Array.isArray(c)&&!1!==i&&!0!==s&&(c=y.reorder(c)),this.value=o?c.map((function(e){return e.name})):c.name,e.abrupt("return",p(l(n.prototype),"submit",this).call(this));case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"choices",set:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.state._choices=this.state._choices||[],this.state.choices=t;var n,i=r(t);try{var a=function(){var t=n.value;e.state._choices.some((function(e){return e.name===t.name}))||e.state._choices.push(t)};for(i.s();!(n=i.n()).done;)a()}catch(c){i.e(c)}finally{i.f()}if(!this._initial&&this.options.initial){this._initial=!0;var s=this.initial;if("string"===typeof s||"number"===typeof s){var o=this.find(s);o&&(this.initial=o.index,this.focus(o,!0))}}},get:function(){return M(this,this.state.choices||[])}},{key:"visible",set:function(e){this.state.visible=e},get:function(){return(this.state.visible||this.choices).slice(0,this.limit)}},{key:"limit",set:function(e){this.state.limit=e},get:function(){var e=this.state,t=this.options,n=this.choices,r=e.limit||this._limit||t.limit||n.length;return Math.min(r,this.height)}},{key:"value",set:function(e){u(l(n.prototype),"value",e,this,!0)},get:function(){return"string"!==typeof p(l(n.prototype),"value",this)&&p(l(n.prototype),"value",this)===this.initial?this.input:p(l(n.prototype),"value",this)}},{key:"index",set:function(e){this.state.index=e},get:function(){return Math.max(0,this.state?this.state.index:0)}},{key:"enabled",get:function(){return this.filter(this.isEnabled.bind(this))}},{key:"focused",get:function(){var e=this.choices[this.index];return e&&this.state.submitted&&!0!==this.multiple&&(e.enabled=!0),e}},{key:"selectable",get:function(){var e=this;return this.choices.filter((function(t){return!e.isDisabled(t)}))}},{key:"selected",get:function(){return this.multiple?this.enabled:this.focused}}]),n}(v);function M(e,t){if(t instanceof Promise)return t;if("function"===typeof t){if(y.isAsyncFn(t))return t;t=t.call(e,e)}var n,i=r(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(Array.isArray(a.choices)){var s=a.choices.filter((function(t){return!e.isDisabled(t)}));a.enabled=s.every((function(e){return!0===e.enabled}))}!0===e.isDisabled(a)&&delete a.enabled}}catch(o){i.e(o)}finally{i.f()}return t}e.exports=I},116:function(e,t,n){t.cd=n(264),t.config=n(1846),t.exit=n(1847),t.help=n(1848),t.ls=n(1860),t.pwd=n(1862),t.version=n(1863),t.pkg=n(1865),t.clear=n(1866),t.error=n(1868),t.open=n(1869),t.login=n(1872),t.logout=n(1873),t.su=n(1874),t.add=n(1876),t.ln=n(1877),t.rm=n(1878),t.whoami=n(1879),t.search=n(1880),t.time=n(1881),t.ping=n(1884),t.reset=n(1885),t.dns=n(1886),t.cat=n(1887),t.net=n(1888),t.debug=n(1889),t.edit=n(1890),t.about=n(1891),t.blocks=n(1892),t.scrub=n(1893),t.namegen=n(1894),t.validators=n(1896)},121:function(e,t,n){var r=n(293),i=r.browserFactory,a=r.effectorFactory,s=r.awsFactory,o=n(126),c=n(21);e.exports={browserFactory:i,effectorFactory:a,awsFactory:s,engine:o,models:c}},126:function(e,t,n){var r=n(294).metrologyFactory,i=n(178).standardEngineFactory,a=n(53),s=a.consistencyFactory,o=a.toFunctions,c=n(113),u=c.cryptoFactory,l=c.crypto,p=n(254).blockPrint,d=n(111).setLogger;e.exports={metrologyFactory:r,standardEngineFactory:i,consistencyFactory:s,cryptoFactory:u,crypto:l,blockPrint:p,setLogger:d,consistencyQueueToFunctions:o}},127:function(e,t,n){var r=(0,n(20).standardize)({schema:{type:"object",title:"Acl",description:"Access control list, power rating, alias table, and chargeout rates\nGroups are similar to roles.\nGroups contain only Actors\nActors are similar to users, but represent chains\nThis is the alias table\nActors contain only a single ChainId\nThis might be extended to cover token balance from other chains.\nCould use proofs to show your current balance when an action was requested.\n\nAlias table is contained within the join slices directly.",required:["groups","everybody","balance","shares","costs"],additionalProperties:!1,properties:{groups:{},everybody:{},balance:{},shares:{},costs:{}}},create:function(){return r.clone({groups:{children:{alice:50,chain123:60},founders:{chain123:1}},everybody:{},balance:{},shares:{children:0,founders:100},costs:{"*":{children:50}}})},logicize:function(e){return{isAllowed:function(e,t,n){}}}});e.exports={aclModel:r}},150:function(e,t,n){var r=n(20).standardize,i=n(41).integrityModel,a=r({schema:{title:"Binary",type:"object",description:"Manages the binary attached to each chain.",additionalProperties:!1,required:["integrity","size"],properties:{integrity:i.schema,size:{type:"number",min:0}}},create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e=i.clone(e),a.clone({integrity:e,size:t})},logicize:function(e){return{}}});e.exports={binaryModel:a}},151:function(e,t,n){var r=n(48),i=n(20).standardize,a=(n(85).publicKeyModel,n(41).integrityModel,i({schema:n(38).signatureSchema,create:function(){throw new Error("Only the keypairModel can create signatureModel types")},logicize:function(e){var t=e.integrity,n=e.seal,i=e.publicKey,a=t.hash,s=i.key;if(!r.verifyHashSync(a,n,s)){var o=new Error("Could not verify hash synchronously: ".concat(a));throw o.toVerify={hash:a,seal:n,key:s},o}return{}}}));e.exports={signatureModel:a}},152:function(e,t,n){var r=n(20).standardize,i=n(41).integrityModel,a=r({schema:{title:"CovenantId",description:"Covenants are how behaviour is introduced to the system.\nA Covenant represents the loaded piece of language specific code.\nA covenant is a binary package on disk, but in ram it is executable code.\n\nIn all languages, a reducer must be supplied.\nThis pure function takes a json state, and a json action, and returns a json state\n\nOptionally, a list of async functions that are invoked by the side effect system \nmay be supplied",type:"object",additionalProperties:!1,required:["name","version","integrity","language"],properties:{name:{type:"string"},version:{type:"string"},integrity:i.schema,language:{enum:["javascript","javascript/xstate","python","go","rust","haskell","c","c++"]}}},create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"unity",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0.0.0",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"javascript",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.create();if(!i.isModel(r))throw new Error("Invalid integrity for name: ".concat(e));return a.clone({name:e,version:t,integrity:r,language:n})},logicize:function(e){return{isSystemCovenant:function(){return s(e.name)}}}}),s=function(e){return"string"===typeof e&&!!n(86)[e]};e.exports={covenantIdModel:a}},154:function(e,t,n){var r=n(1729);e.exports=r},155:function(e,t,n){var r=n(4),i=n(20).standardize,a=n(246),s=n(68).actionModel,o=n(52).addressModel,c=i({schema:n(108).rxRequestSchema,create:function(e,t,n,i){r(Number.isInteger(i)),r(o.isModel(n));var a={type:e,payload:t,sequence:"".concat(n.getChainId(),"_").concat(i)};return c.clone(a)},logicize:function(e){var t=e.type,n=e.payload,i=e.sequence,o=a(i),c=o.address,u=o.index;r(!c.isUnknown()),r(Number.isInteger(u)),r(u>=0);var l=s.create({type:t,payload:n});return{getAddress:function(){return c},getIndex:function(){return u},getRequest:function(){return l},isReply:function(){return!1}}}});e.exports={rxRequestModel:c}},156:function(e,t,n){var r=n(4),i=n(20).standardize,a=n(88).continuationModel,s=n(108).txReplySchema,o=n(246),c=i({schema:s,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"@@RESOLVE",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;r.strictEqual(typeof t,"object");var i={type:e,payload:t,request:{sequence:n}};return c.clone(i)},logicize:function(e){var t=e.type,n=e.payload,r=e.request.sequence,i=o(r),s=i.address,c=i.index,u=a.create(t,n);return{getAddress:function(){return s},getIndex:function(){return c},getReply:function(){return u}}}});e.exports={txReplyModel:c}},157:function(e,t,n){var r=n(4),i=n(20).standardize,a=n(68).actionModel,s=i({schema:n(108).txRequestSchema,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"DEFAULT_TX_REQUEST",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";r.strictEqual(typeof t,"object");var i={type:e,payload:t,to:n};return s.clone(i)},logicize:function(e){var t=e.type,n=e.payload,r=(e.to,a.create({type:t,payload:n}));return{getRequest:function(){return r}}}});e.exports={txRequestModel:s}},158:function(e,t,n){var r=(0,n(20).standardize)({schema:{title:"State",description:"The result of running a covenant is stored here.\nIt checks the state minus the actions is serializable\nIncludes the array of requests and replies returned from \nreducing the covenant.  These actions are intended to be transmitted\nvia the network.  This model enforces the format and logic of the\nreturns from the reducer\n\nThis is how covenant info is ingested back into the trusted system.\nIt is crucial that the format of this data is correct\n\nEntry point from covenant to system.\n\nMaximally inflates actions with defaults.  Logical checking is done inside\nthe networkProducer as needs context of the initiating action to fill in\nremaining defaults\n\nThe actions in from the covenant are refined over three states:\n1. create( state ) inflates actions to pass schema validation\n2. logicize( state ) checks static logic\n3. networkProducer.tx( state ) checks context logic\n\nThe returned model is forbidden to have an actions key on it.\nThe validation is run during clone, then logicize strips the actions out.\n\nCreate is only called immediately after a reducer call returns some state.\nTherefore, we always know what the default action is, so we require it of create.\n",type:"object",required:[]},create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r.clone(e)},logicize:function(e){return{}}});e.exports={stateModel:r}},159:function(e,t,n){var r=n(7),i=(0,n(20).standardize)({schema:{title:"Config",description:"Configuration options for the chain",type:"object",required:["isPierced","sideEffects","isPublicChannelOpen"],additionalProperties:!1,properties:{isPierced:{type:"boolean",description:"If the chain should be reduced, even with no known actions"},sideEffects:{type:"object",description:"When reducing, will this chain be allowed network access",required:["networkPatterns","asyncTimeoutMs"],properties:{networkPatterns:{type:"array",description:"Empty string means no network access",items:{type:"string",format:"regex"}},asyncTimeoutMs:{type:"number",description:"0 means no timeout allowed",minimum:0}}},isPublicChannelOpen:{type:"boolean",description:"Will the validators open up new channels on request from unknown chains"}}},create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={networkPatterns:[""],asyncTimeoutMs:0};e=r({},e,{sideEffects:r({},t,{},e.sideEffects)});var n={isPierced:!1,sideEffects:t,isPublicChannelOpen:!1};return i.clone(r({},n,{},e))},logicize:function(e){return{}}});e.exports={configModel:i}},160:function(e,t,n){var r=n(20).standardize,i=n(38).validatorsSchema,a=(n(85).publicKeyModel,n(70)),s=a.keypairModel,o=a.ciKeypair,c=r({schema:i,create:function(){var e=s.create("CI",o).getValidatorEntry();return c.clone(e)},logicize:function(e){return{}}});e.exports={validatorsModel:c}},161:function(e,t,n){var r=n(4),i=n(20).standardize,a=n(107),s=a.rxRequestModel,o=a.rxReplyModel,c=n(162).simpleArrayModel,u=n(105).networkModel,l=n(52).addressModel,p=i({schema:{title:"Pending",description:"Indicates chain is waiting for a promise to resolve\n    Stores the address and index of the request.\n    Note that only requests can be origin actions for promises\n    First request is the origin request\n    The pendingRequest is saved in its entirety so structural changes\n    can occur to networking and channels, and the request will still\n    be able to proceed.",type:"object",required:["replies","requests"],additionalProperties:!1,properties:{pendingRequest:s.schema,replies:{type:"array",description:"Full replies, allowing the originating request to be lowered,\n        and the remote side to lower the reply, without losing it from the accumulator",uniqueItems:!0,items:o.schema},requests:{type:"object",additionalProperties:!1,patternProperties:{"(.*?)":c.schema}}}},create:function(){return p.clone({replies:[],requests:{}})},logicize:function(e){var t=e.pendingRequest,n=e.replies,i=e.requests;t||r(!n.length);return{getIsPending:function(){return!!t},isBufferValid:function(e){return!0},getAccumulator:function(){return n},rxBufferedRequest:function(e){r(u.isModel(e));var t=Object.keys(i);if(t.length){var n=t[0],a=l.create(n),o=e.getAlias(a);r(o);var c=e[o];r(c);var p=i[n][0];r(p>=0);var d=c.rxRequest(p);return r(s.isModel(d)),{alias:o,event:d,channel:c}}},getIsBuffered:function(e){r(s.isModel(e));var t=e.getAddress().getChainId(),n=e.getIndex();return!!i[t]&&i[t].includes(n)}}}});e.exports={pendingModel:p}},162:function(e,t,n){var r=n(4),i=(0,n(20).standardize)({schema:{title:"SimpleArray",description:"ascending indexes of requests to process",type:"array",uniqueItems:!0,items:{type:"number",minimum:0,multipleOf:1}},create:function(){return i.clone([])},logicize:function(e){var t=e.every((function(t,n){return!n||t>e[n-1]}));return r(t,"Values not monotonic: ".concat(e)),{}}});e.exports={simpleArrayModel:i}},163:function(e,t,n){var r=n(4),i=n(20).standardize,a=n(38).proofSchema,s=n(84).blockModel,o=i({schema:a,create:function(e,t){r(s.isModel(e));var n={block:e.getProof()};return t&&(r(e.network[t],"missing ".concat(t)),n.network=e.network.getProof(),n.channel=e.network[t].getProof()),o.clone(n)},logicize:function(e){return{}}});e.exports={proofModel:o}},165:function(e,t,n){var r=n(2),i=n(3),a=n(9)("interblock:aws:ramS3"),s=n(4);n(24);e.exports={ramS3Factory:function(){var e={wbblockbucket:{},wbinterbucket:{}};return{putObject:function(t){var n=t.Bucket,o=t.Key,c=t.Body;return a("putObject %O %O",n,o),s("string"===typeof n),s("string"===typeof o),s("object"===typeof c),{promise:function(){var t=i(r.mark((function t(){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:return s(e[n]),e[n][o]&&a("item already exists: %O %O",n,o),e[n][o]=c,t.abrupt("return",!0);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}},getObject:function(t){var n=t.Bucket,o=t.Key;return a("getObject %O %O",n,o),s("string"===typeof n),s("string"===typeof o),{promise:function(){var t=i(r.mark((function t(){var i;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:return s(e[n]),e[n][o]||(a(n),a(o)),s(e[n][o]),i=e[n][o],t.abrupt("return",{Body:i});case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}},deleteObject:function(t){var n=t.Bucket,o=t.Key;return a("deleteObject %O %O",n,o),{promise:function(){var t=i(r.mark((function t(){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:return s(e[n]),s(e[n][o]),delete e[n][o],t.abrupt("return",!0);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}},_getBuckets:function(){return e},_isRam:!0}}}},166:function(e,t,n){"use strict";var r=n(2),i=n(3),a=n(7),s=n(10),o=n(12),c=n(26),u=n(29),l=n(18),p=n(19),d=n(46),h=n(61),f=n(261),v=function(e){p(n,e);var t=l(n);function n(e){var r;return s(this,n),(r=t.call(this,a({},e,{multiple:!0}))).type="form",r.initial=r.options.initial,r.align=[r.options.align,"right"].find((function(e){return null!=e})),r.emptyError="",r.values={},r}return o(n,[{key:"reset",value:function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(c(n.prototype),"reset",this).call(this);case 2:return!0===t&&(this._index=this.index),this.index=this._index,this.values={},this.choices.forEach((function(e){return e.reset&&e.reset()})),e.abrupt("return",this.render());case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"dispatch",value:function(e){return!!e&&this.append(e)}},{key:"append",value:function(e){var t=this.focused;if(!t)return this.alert();var n=t.cursor,r=t.input;return t.value=t.input=r.slice(0,n)+e+r.slice(n),t.cursor++,this.render()}},{key:"delete",value:function(){var e=this.focused;if(!e||e.cursor<=0)return this.alert();var t=e.cursor,n=e.input;return e.value=e.input=n.slice(0,t-1)+n.slice(t),e.cursor--,this.render()}},{key:"deleteForward",value:function(){var e=this.focused;if(!e)return this.alert();var t=e.cursor,n=e.input;if(void 0===n[t])return this.alert();var r="".concat(n).slice(0,t)+"".concat(n).slice(t+1);return e.value=e.input=r,this.render()}},{key:"right",value:function(){var e=this.focused;return e?e.cursor>=e.input.length?this.alert():(e.cursor++,this.render()):this.alert()}},{key:"left",value:function(){var e=this.focused;return e?e.cursor<=0?this.alert():(e.cursor--,this.render()):this.alert()}},{key:"space",value:function(e,t){return this.dispatch(e,t)}},{key:"number",value:function(e,t){return this.dispatch(e,t)}},{key:"next",value:function(){var e=this.focused;if(!e)return this.alert();var t=e.initial,r=e.input;return t&&t.startsWith(r)&&r!==t?(e.value=e.input=t,e.cursor=e.value.length,this.render()):u(c(n.prototype),"next",this).call(this)}},{key:"prev",value:function(){var e=this.focused;return e?0===e.cursor?u(c(n.prototype),"prev",this).call(this):(e.value=e.input="",e.cursor=0,this.render()):this.alert()}},{key:"separator",value:function(){return""}},{key:"format",value:function(e){return this.state.submitted?"":u(c(n.prototype),"format",this).call(this,e)}},{key:"pointer",value:function(){return""}},{key:"indicator",value:function(e){return e.input?"\u29bf":"\u2299"}},{key:"choiceSeparator",value:function(){var e=i(r.mark((function e(t,n){var i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resolve(t.separator,this.state,t,n);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=":";case 5:return i=e.t0,e.abrupt("return",i?" "+this.styles.disabled(i):"");case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"renderChoice",value:function(){var e=i(r.mark((function e(t,n){var i,a,s,o,c,u,l,p,h,v,g,y,m,k,b,x,w,I,M,C,P,E,R,A,q;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onChoice(t,n);case 2:return i=this.state,a=this.styles,s=t.cursor,o=t.initial,c=void 0===o?"":o,u=t.name,l=t.hint,p=t.input,h=void 0===p?"":p,v=a.muted,g=a.submitted,y=a.primary,m=a.danger,k=l,b=this.index===n,x=t.validate||function(){return!0},e.next=10,this.choiceSeparator(t,n);case 10:return w=e.sent,I=t.message,"right"===this.align&&(I=I.padStart(this.longest+1," ")),"left"===this.align&&(I=I.padEnd(this.longest+1," ")),M=this.values[u]=h||c,C=h?"success":"dark",e.next=18,x.call(t,M,this.state);case 18:if(e.t0=e.sent,!0===e.t0){e.next=21;break}C="danger";case 21:return P=a[C],e.t1=P,e.next=25,this.indicator(t,n);case 25:if(e.t2=e.sent,e.t3=(0,e.t1)(e.t2),e.t4=t.pad||"",E=e.t3+e.t4,R=this.indent(t),A=function(){return[R,E,I+w,h,k].filter(Boolean).join(" ")},!i.submitted){e.next=36;break}return I=d.unstyle(I),h=g(h),k="",e.abrupt("return",A());case 36:if(!t.format){e.next=42;break}return e.next=39,t.format.call(this,h,t,n);case 39:h=e.sent,e.next=45;break;case 42:q=this.styles.muted,h=f(this,{input:h,initial:c,pos:s,showCursor:b,color:q});case 45:if(this.isValue(h)||(h=this.styles.muted(this.symbols.ellipsis)),!t.result){e.next=50;break}return e.next=49,t.result.call(this,M,t,n);case 49:this.values[u]=e.sent;case 50:return b&&(I=y(I)),t.error?h+=(h?" ":"")+m(t.error.trim()):t.hint&&(h+=(h?" ":"")+v(t.hint.trim())),e.abrupt("return",A());case 53:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"submit",value:function(){var e=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.value=this.values,e.abrupt("return",u(c(n.prototype),"base",this).submit.call(this));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(h);e.exports=v},167:function(e,t,n){"use strict";var r=n(2),i=n(3),a=n(10),s=n(12),o=n(259),c=n(26),u=n(29),l=n(18),p=n(19),d=n(89),h=n(32),f=h.isPrimitive,v=h.hasColor,g=function(e){p(n,e);var t=l(n);function n(e){var r;return a(this,n),(r=t.call(this,e)).cursorHide(),r}return s(n,[{key:"initialize",value:function(){var e=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resolve(this.initial,this.state);case 2:return t=e.sent,e.next=5,this.cast(t);case 5:return this.input=e.sent,e.next=8,u(c(n.prototype),"initialize",this).call(this);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispatch",value:function(e){return this.isValue(e)?(this.input=e,this.submit()):this.alert()}},{key:"format",value:function(e){var t=this.styles;return this.state.submitted?t.success(e):t.primary(e)}},{key:"cast",value:function(e){return this.isTrue(e)}},{key:"isTrue",value:function(e){return/^[ty1]/i.test(e)}},{key:"isFalse",value:function(e){return/^[fn0]/i.test(e)}},{key:"isValue",value:function(e){return f(e)&&(this.isTrue(e)||this.isFalse(e))}},{key:"hint",value:function(){var e=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("pending"!==this.state.status){e.next=7;break}return e.next=3,this.element("hint");case 3:if(t=e.sent,v(t)){e.next=6;break}return e.abrupt("return",this.styles.muted(t));case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=i(r.mark((function e(){var t,n,i,a,s,o,c,u,l,p,d,h,f;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.input,i=t.size,e.next=3,this.prefix();case 3:return a=e.sent,e.next=6,this.separator();case 6:return s=e.sent,e.next=9,this.message();case 9:return o=e.sent,c=this.styles.muted(this.default),u=[a,o,c,s].filter(Boolean).join(" "),this.state.prompt=u,e.next=15,this.header();case 15:return l=e.sent,p=this.value=this.cast(n),e.next=19,this.format(p);case 19:return d=e.sent,e.next=22,this.error();case 22:if(e.t0=e.sent,e.t0){e.next=27;break}return e.next=26,this.hint();case 26:e.t0=e.sent;case 27:return h=e.t0,e.next=30,this.footer();case 30:f=e.sent,h&&!u.includes(h)&&(d+=" "+h),u+=" "+d,this.clear(i),this.write([l,u,f].filter(Boolean).join("\n")),this.restore();case 36:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"value",set:function(e){o(c(n.prototype),"value",e,this,!0)},get:function(){return this.cast(u(c(n.prototype),"value",this))}}]),n}(d);e.exports=g},168:function(e,t,n){var r=n(17),i=n(22)("dos:eval"),a=n(116);e.exports.evaluate=function(e,t,n){if(i(t,n),t=t||""){if(!a[t])throw new Error("".concat(t,": command not found"));return a[t].apply(a,[e].concat(r(n)))}}},169:function(e,t,n){var r=n(2),i=n(3),a=n(256),s=n(22)("dos:spinner");t.withSpin=function(e){return function(){var t=i(r.mark((function t(n){var i=arguments;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s("spinner"),n.spinner=a({spinner:"moon"}).start(),t.prev=2,t.next=5,e.apply(this,i);case 5:return t.abrupt("return",t.sent);case 8:throw t.prev=8,t.t0=t.catch(2),s(t.t0),t.t0;case 12:return t.prev=12,n.spinner.stop(),n.spinner=null,t.finish(12);case 16:case"end":return t.stop()}}),t,this,[[2,8,12,16]])})));return function(e){return t.apply(this,arguments)}}()}},1720:function(e,t,n){var r=n(33),i=n(28),a=n(60),s=n(2),o=n(7),c=n(3),u=n(4),l=n(9)("interblock:dmzReducer"),p=(n(24),n(83)),d=n(21),h=d.actionModel,f=d.addressModel,v=d.covenantIdModel,g=d.dmzModel,y=d.blockModel,m=d.interblockModel,k=d.channelModel,b=d.networkModel,x=d.txRequestModel,w=d.rxRequestModel,I=d.rxReplyModel,M=n(71),C=M.networkProducer,P=M.channelProducer,E=n(34),R=E.replyPromise,A=E.replyResolve,q=E.replyReject,O=E.isReplyFor,S=E.effectInBand,T=E.interchain,j=function(){var e=c(s.mark((function e(t,n){var r,i,a,c,p,d,h,f,v,m,k,b,x,M,C,P,E,q,S;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l("reducer( ".concat(n.type," )")),u(g.isModel(t)),u(I.isModel(n)||w.isModel(n)),r=t.network,e.t0=n.type,e.next="@@SPAWN"===e.t0?7:"@@CONNECT"===e.t0?13:"@@UPLINK"===e.t0?15:"@@GENESIS"===e.t0?19:"@@OPEN_CHILD"===e.t0?20:"@@LIST_CHILDREN"===e.t0?22:"@@GET_GIVEN_NAME"===e.t0?25:"@@INTRO"===e.t0?28:"@@ACCEPT"===e.t0?29:"@@DEPLOY"===e.t0?30:34;break;case 7:return e.next=9,L(t,n);case 9:return i=e.sent,r=i,R(),e.abrupt("break",35);case 13:return r=z(t.network,n),e.abrupt("break",35);case 15:return a=B(t.network,n),c=a.nextNetwork,p=a.payload,A(p),r=c,e.abrupt("break",35);case 19:return e.abrupt("break",35);case 20:return _(t.network,n),e.abrupt("break",35);case 22:return d=K(t.network),A(d),e.abrupt("break",35);case 25:return h=F(t.network),A(h),e.abrupt("break",35);case 28:case 29:return e.abrupt("break",35);case 30:return e.next=32,H(t,n);case 32:return r=e.sent,e.abrupt("break",35);case 34:return e.abrupt("break",35);case 35:if(!O(n)){e.next=60;break}f=n.getRequest(),e.t1=f.type,e.next="@@GENESIS"===e.t1?40:"@@UPLINK"===e.t1?46:"@@OPEN_CHILD"===e.t1?52:"@@DEPLOY"===e.t1?57:60;break;case 40:return v=f.payload,m=v.genesis,k=v.alias,b=v.originAction,x=y.clone(m),M={alias:k,chainId:x.getChainId()},b.sequence&&A(M,b),l("reply received for @@GENESIS"),e.abrupt("break",60);case 46:return C=f.payload.originAction.payload.alias,l("reply received for @@UPLINK: %o",C),P=r[C].address.getChainId(),A({chainId:P},f.payload.originAction),e.abrupt("break",60);case 52:return E=n.payload.chainId,l("reply received for @@OPEN_CHILD: %o",E.substring(0,9)),q=f.payload.fullPath,T(D.connect(q,E)),e.abrupt("break",60);case 57:return l("reply received for deploy",n),G(t,n),e.abrupt("break",60);case 60:return S=o({},t,{network:r}),e.abrupt("return",S);case 62:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),D={},N={spawn:"@@SPAWN",connect:"@@CONNECT",uplink:"@@UPLINK",intro:"@@INTRO",accept:"@@ACCEPT",genesis:"@@GENESIS",openChild:"@@OPEN_CHILD",listChildren:"@@LIST_CHILDREN",getGivenName:"@@GET_GIVEN_NAME",deploy:"@@DEPLOY"};D.spawn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r={type:N.spawn,payload:{alias:e,spawnOpts:t,initialActions:n}};return e||delete r.payload.alias,r};var L=function(){var e=c(s.mark((function e(t,n){var r,i,a,c,p,d,f,v,w,I,M,E,R,A,q;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.payload,i=r.alias,a=r.spawnOpts,c=r.initialActions,Array.isArray(c)||(c=[c]),c=c.map((function(e){var t=e.type,n=e.payload,r=e.to;return x.create(t,n,r)})),p=t.network,d=t.validators,f=t.covenantId,v=C.tx(b.create(),c,[]),w=g.create(o({network:v,covenantId:f},a,{validators:d})),l("spawn alias: ".concat(i)),i=i||V(p),u(!i.includes("/"),'No / character allowed in "'.concat(i,'"')),I=!p[i]||p[i].address.isUnknown(),u(I,"childAlias exists: ".concat(i)),e.next=13,S("SIGN_BLOCK",y.create,w);case 13:return M=e.sent,u(y.isModel(M),"Genesis block creation failed"),E={genesis:M,alias:i,originAction:n},R=h.create("@@GENESIS",E),A=M.provenance.getAddress(),q=b.clone(p,(function(e){var t=k.create(A,"./"),n=m.create(M);t=P.ingestInterblock(t,n),t=P.txRequest(t,R),p[i]&&p[i].getRequestIndices().forEach((function(e){var n=p[i].requests[e];t=P.txRequest(t,n)})),e[i]=t})),e.abrupt("return",q);case 20:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();D.connect=function(e,t){return{type:N.connect,payload:{alias:e,chainId:t}}};var z=function(e,t){return b.clone(e,(function(n){u(b.isModel(e));var r=f.create(t.payload.chainId);u(r.isResolved()),u.strictEqual(r.getChainId(),t.payload.chainId);var i=t.payload.alias;u(i&&"string"===typeof i);var a=e[i]||k.create(r);n[i]=P.setAddress(a,r)}))};D.connectUplink=function(e,t){return{type:N.uplink,payload:{chainId:e,originAction:t}}};var B=function(e,t){var n,r=b.clone(e,(function(r){u(b.isModel(e));var i=f.create(t.payload.chainId);u.strictEqual(i.getChainId(),t.payload.chainId),u(i.isResolved());var a=e.getAlias(i);u(!a||"UP_LINK"!==e[a].systemRole),n=V(e,".uplink_"),u(!e[n]),r[n]=k.create(i);var s=t.payload.chainId.substring(0,9);l("connectUplinkReducer ".concat(n," set to ").concat(s))}));return u(n),{nextNetwork:r,payload:{alias:n}}};D.openChild=function(e,t){return{type:N.openChild,payload:{alias:e,fullPath:t}}};var _=function(e,t){u(w.isModel(t));var n=t.payload.alias,r=e[n];if(r)if("./"!==r.systemRole)q("Alias found, but is not child: ".concat(n));else{var i=t.getAddress().getChainId(),a=D.connectUplink(i,t),s=a.type,o=a.payload;T(s,o,n),R()}else q("Alias not found: ".concat(n))};D.listChildren=function(){return{type:N.listChildren}};var K=function(e){return l("listChildrenReducer"),{children:e.getAliases()}};D.getGivenName=function(){return{type:N.getGivenName}};var F=function(e){l("getGivenNameReducer");var t,n=e[".."];return n.address.isRoot()?(u(!n.heavy),t="/"):(u(n.heavy),t=n.heavy.getOriginAlias()),u(t),{givenName:t}};D.deploy=function(e){return{type:"@@DEPLOY",payload:{installer:e}}};var H=function(){var e=c(s.mark((function e(t,n){var r,i,c,u,l,p,d,h,f,y,m;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.payload.installer,i=r.children,c=void 0===i?{}:i,e.t0=s.keys(c);case 3:if((e.t1=e.t0()).done){e.next=18;break}return u=e.t1.value,l=c[u],l.children,p=l.covenant,d=a(l,["children","covenant"]),p=p||"unity",h=v.create(p),d=o({},d,{covenantId:h}),f=D.spawn(u,d),e.next=12,L(t,f);case 12:y=e.sent,t=g.clone(o({},t,{network:y})),m=D.deploy(c[u]),T(m,u),e.next=3;break;case 18:return Object.keys(c).length&&R(),e.abrupt("return",t.network);case 20:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),G=function(e,t){var n,r=e.network.getResolvedAliases(),a=i(r);try{for(a.s();!(n=a.n()).done;){var s=n.value,o=e.network[s];o.requests[1];if("./"===o.systemRole&&"@@DEPLOY"===o.requests[1].type&&!o.rxReplyIndex(1))return}}catch(h){a.e(h)}finally{a.f()}var c,u=e.network[".."],l=i(u.getRemoteRequestIndices());try{for(l.s();!(c=l.n()).done;){var p=c.value,d=u.rxRequest(p);"@@DEPLOY"===d.type&&A({},d)}}catch(h){l.e(h)}finally{l.f()}},U=[N.genesis,N.uplink,N.openChild,"@@DEPLOY"],V=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"file_",n=0;return e.getAliases().forEach((function(e){if(e.startsWith(t))try{var r=parseInt(e.substring(t.length));n=r>n?r:n}catch(i){l("autoAlias error: ",i)}})),t+p(5,n+1,"0")},W=function(e){return e.getOutboundPairs().some((function(e){var t=r(e,2),n=t[0],i=t[1],a=!i||i.isPromise();return"@@OPEN_CHILD"===n.type&&a}))},J=function(e){var t="";return e.split("/").map((function(e){return t&&(t+="/"),t+=e}))};e.exports={actions:D,reducer:j,isSystemRequest:function(e){if(!w.isModel(e))return!1;var t=Object.values(N).includes(e.type);return l("isSystemAction: ".concat(t," type: ").concat(e.type)),t},isSystemReply:function(e){if(!I.isModel(e))return!1;var t=e.getRequest(),n=U.includes(t.type);return l("isSystemReply: ".concat(n," type: ").concat(t.type)),n},openPaths:function(e){return b.clone(e,(function(t){u(b.isModel(e)),e.getAliases().filter((function(t){return e[t].address.isUnknown()})).forEach((function(n){if(".@@io"!==n){var r=J(n);r.forEach((function(n,i){var a=e[n];if(!a||a.address.isUnknown()){l("unresolved path: ",n),0===i&&l("immediate child unresolved");var s=r[i-1];l("parent: ",s);var o=n.substring(s.length+1);if(l("child: ",o),W(e[s]))l("parent: %o was already asked to open child: %o",s,o);else{var c=h.create(D.openChild(o,n));l("open: ",c),t[s]=P.txRequest(e[s],c)}}}))}}))}))}}},1721:function(e,t,n){var r=n(17),i=n(7),a=n(4),s=n(9)("interblock:producers:network"),o=n(24),c=n(21),u=c.channelModel,l=c.continuationModel,p=c.actionModel,d=c.networkModel,h=c.interblockModel,f=c.addressModel,v=c.rxRequestModel,g=c.txRequestModel,y=c.txReplyModel,m=c.configModel,k=n(238),b=function(e,t,n){return d.clone(e,(function(r){a(v.isModel(t)),a(l.isModel(n));var i=t.getAddress(),s=e.getAlias(i),o=e[s];a(u.isModel(o)),a(o.address.equals(i)),a(o.rxRequest().equals(t));var c=t.getIndex();a(!o.replies[c]);var p=k.txReply(o,n);a(p.replies[c]),r[s]=p}))},x=function(e,t){return Array.isArray(e)||(e=[e]),e.map(t)};e.exports={ingestInterblocks:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;return d.clone(e,(function(c){t=x(t,h.clone),a(m.isModel(n)),s("ingestInterblocks count: ".concat(t.length)),t.sort((function(e,t){return e.provenance.height-t.provenance.height}));var l={};t.forEach((function(t){var r=t.provenance.getAddress(),o=e.getAlias(r),d=n.isPublicChannelOpen;if(!o&&d&&t.isConnectionAttempt()){s("connection attempt accepted");var h="@@PUBLIC_".concat(r.getChainId()),f=u.create(r),v=p.create({type:"@@ACCEPT"}),g=u.clone(i({},f,{requests:{0:v}}));c[h]=g}if(o){var y=l[o]||e[o];if(a(u.isModel(y)),y=k.ingestInterblock(y,t),t.isConnectionResponse(),!y.heavy||y.equals(e[o]))return;l[o]=y}})),e.getAliases().forEach((function(t){var n=e[t];if(n&&n.address.isResolved()&&n.heavy){var s=l[t]||n,c=n.lineageTip.slice(0,-1),p=o.without.apply(o,[s.lineageTip].concat(r(c))),d=s.lineage.findIndex((function(e){return e.equals(s.heavy.provenance.reflectIntegrity())})),h=s.lineage.findIndex((function(e){return e.equals(p[0].provenance.reflectIntegrity())})),f=d<h?d:h;a(f>=0,"minIndex out of bounds");var v=s.lineage.slice(f);(s=u.clone(i({},s,{lineage:v,lineageTip:p}))).equals(n)||(l[t]=s)}})),Object.keys(l).forEach((function(e){return c[e]=l[e]}))}))},respondRejection:function(e,t,n){s("respondRejection %O",n);var r=l.create("@@REJECT",n);return b(e,t,r)},respondRequest:function(e,t){s("respondRequest request: %o",t.type);var n=l.create("@@RESOLVE");return b(e,t,n)},respondReply:function(e,t,n){return d.clone(e,(function(r){a(f.isModel(t)),a(u.isModel(n));var i=e.getAlias(t);s("respondReply alias: ".concat(i));var o=e[i],c=k.shiftTxRequest(o,n);r[i]=c}))},tx:function(e,t,n){return d.clone(e,(function(r){a(d.isModel(e)),a(Array.isArray(t)),a(Array.isArray(n)),s("tx requests: ".concat(t.length," replies: ").concat(n.length));var i={};t.forEach((function(t){a(g.isModel(t));var n=t.to,r=i[n]||e[n];if(!r){var o=".@@io"===n?"PIERCE":"DOWN_LINK",c=f.create();r=u.create(c,o),s("channel created with systemRole: ".concat(o))}i[n]=k.txRequest(r,t.getRequest())})),n.forEach((function(t){a(y.isModel(t));var n=t.getAddress(),r=t.getIndex(),o=e.getAlias(n);if(o){var c=i[o]||e[o],u=t.getReply();i[o]=k.txReply(c,u,r)}else s("No alias found for: %O",t)})),Object.keys(i).forEach((function(e){return r[e]=i[e]}))}))}}},1722:function(e,t,n){var r=n(7),i=n(2),a=n(3),s=n(4),o=n(21),c=o.dmzModel,u=o.keypairModel,l=o.provenanceModel,p=o.blockModel,d=o.integrityModel,h=function(){var e=a(i.mark((function e(t){var n;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.create("CI"),s(d.isModel(t)),e.abrupt("return",n.sign(t));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=a(i.mark((function e(t,n){var a,o,u,f,v,g,y,m,k,b=arguments;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=b.length>2&&void 0!==b[2]?b[2]:h,s(c.isModel(t)),s(p.isModel(n)),s(!t.equals(n.getDmz()),"block dmz has not changed"),s("function"===typeof a),o=t.network.isNewChannels(n.network),u={},f=0===n.provenance.height,o&&!f&&(v=d.create(),g=n.provenance.getAddress().getChainId(),y=d.clone(r({},v,{hash:g})),u[0]=y),e.next=11,l.create(t,n.provenance,u,a);case 11:return m=e.sent,k=p.clone(r({},t,{provenance:m})),s(n.isNext(k)),e.abrupt("return",k);case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();e.exports={generateNext:f}},1723:function(e,t,n){var r=n(4),i=n(21),a=i.lockModel,s=i.blockModel;e.exports={reconcile:function(e,t){return a.clone(e,(function(n){r(s.isModel(t)),r(a.isModel(e)),n.block=t,n.piercings={requests:[],replies:[]},n.interblocks=[]}))}}},1724:function(e,t,n){var r=n(239),i=n(17),a=n(7),s=n(4),o=n(21),c=o.rxRequestModel,u=o.rxReplyModel,l=o.pendingModel;e.exports={raisePending:function(e,t){return s(c.isModel(t)),s(l.isModel(e)),s(!e.getIsPending()),l.clone(a({},e,{pendingRequest:t}))},bufferRequest:function(e,t){return l.clone(e,(function(n){s(c.isModel(t)),s(e.getIsPending());var r=t.getAddress().getChainId(),a=t.getIndex(),o=e.requests[r]||[];n.requests[r]=[].concat(i(o),[a])}))},pushReply:function(e,t){return l.clone(e,(function(n){s(u.isModel(t)),s(e.getIsPending()),n.replies=[].concat(i(e.replies),[t])}))},settle:function(e){return l.clone(e,(function(t){s(e.getIsPending()),delete t.pendingRequest,t.replies=[]}))},shiftRequests:function(e,t){return l.clone(e,(function(n){s(!e.getIsPending()),s(!e.replies.length);var i=e.rxBufferedRequest(t).event;s(c.isModel(i));var a=i.getAddress().getChainId(),o=i.getIndex(),u=r(e.requests[a]),l=u[0],p=u.slice(1);s.strictEqual(l,o),p.length?n.requests[a]=p:delete n.requests[a]}))}}},1726:function(e,t,n){(function(t){var r=n(17),i=n(47),a=n(2),s=n(3),o=n(4),c=n(9)("interblock:api:hooks"),u=n(240),l=u.request,p=u.promise,d=u.resolve,h=(u.reject,u.isReplyFor),f=new Promise((function(){}));f.isEternal=!0,Object.freeze(f);var v=function(){},g=function(){var e=s(a.mark((function e(t,n,r){var i;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=l(t,n,r),o(".@@io"!==i.to),e.abrupt("return",k(i));case 3:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),y=function(){var e=s(a.mark((function e(t,n){var r,s,c,u,l,p,d=arguments;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=d.length,s=new Array(r>2?r-2:0),c=2;c<r;c++)s[c-2]=d[c];return o.strictEqual(typeof t,"string"),o.strictEqual(typeof n,"function"),u=E(),l=i({args:s},".@@ioRequestId",u),p=function(){return n.apply(void 0,s)},e.abrupt("return",k({type:t,payload:l,to:".@@io",exec:p,inBand:!1}));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),m=function(){var e=s(a.mark((function e(t,n){var r,i,s,o,c,u=arguments;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=u.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=u[s];return o={args:i},c=function(){return n.apply(void 0,i)},e.abrupt("return",k({type:t,payload:o,exec:c,inBand:!0}));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),k=function(e){c("_promise request.type: %o",e.type);var t=M();o(Array.isArray(t));var n=e.type,r=e.payload,i=e.to,a=e.exec,s=e.inBand;o(!a||"function"===typeof a);var u={type:n,payload:r,to:i},l=t.find((function(e){return h(e,u)}));if(!l)return a&&(u.exec=a,u.inBand=s),C(u),f;if("@@RESOLVE"===l.type)return l.payload;throw l.payload},b=function(){var e=s(a.mark((function e(){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=s(a.mark((function e(n){var r,i,s,u,l,p,d,h,f,v,g,y,m=arguments;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=m.length>1&&void 0!==m[1]?m[1]:[],i=m.length>2&&void 0!==m[2]?m[2]:"unsalted",o.strictEqual(typeof n,"function"),o(Array.isArray(r)),o.strictEqual(typeof i,"string"),c("hook salt:",i),e.prev=6,e.next=9,w(r,i);case 9:if("object"===typeof(u=n())){e.next=12;break}throw new Error("Must return object from tick: ".concat(u));case 12:if(l=!1,"function"!==typeof u.then){e.next=36;break}return p=Symbol("RACECAR"),d=new Promise((function(e){return t((function(){return e(p)}))})),e.next=18,Promise.race([u,d]);case 18:if(h=e.sent,f=h===p,s=I(),!f||s.requests.length){e.next=23;break}throw new Error('Non standard promise returned - use "effectInBand(...)"');case 23:if(f){e.next=32;break}return e.next=26,u;case 26:if(u=e.sent,l=!1,"object"===typeof u){e.next=30;break}throw new Error("Must resolve object from tick: ".concat(u));case 30:e.next=34;break;case 32:u=void 0,l=!0;case 34:e.next=37;break;case 36:s=I();case 37:return g=(v=s).requests,y=v.replies,e.abrupt("return",{reduction:u,isPending:l,requests:g,replies:y});case 41:throw e.prev=41,e.t0=e.catch(6),c("error: ",e.t0),!s&&I(),e.t0;case 46:case"end":return e.stop()}}),e,null,[[6,41]])})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=s(a.mark((function e(n,i){var s,u,l;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(globalThis["@@interblock"]=globalThis["@@interblock"]||{},!globalThis["@@interblock"].promises){e.next=6;break}return s=Date.now(),e.next=5,new Promise(t);case 5:c("waited for global for ".concat(Date.now()-s,"ms"));case 6:o(!globalThis["@@interblock"].promises),u=r(n),0,l={accumulator:u,requests:[],replies:[],requestId:0,salt:i},globalThis["@@interblock"].promises=l;case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),I=function(){R();var e=globalThis["@@interblock"].promises,t=e.requests,n=e.replies;return delete globalThis["@@interblock"].promises,{requests:t,replies:n}},M=function(){R();var e=globalThis["@@interblock"].promises.accumulator;return c("_getGlobalAccumulator"),e},C=function(e){R();var t=globalThis["@@interblock"].promises.requests;c("_pushGlobalRequest",e.type),t.push(e)},P=function(e){R();var t=globalThis["@@interblock"].promises.replies;c("_pushGlobalReply",e.type),t.push(e)},E=function(){var e=globalThis["@@interblock"].promises.salt,t=globalThis["@@interblock"].promises.requestId++;return"".concat(t,"_").concat(e)},R=function(){o(globalThis["@@interblock"]),o(globalThis["@@interblock"].promises);var e=globalThis["@@interblock"].promises,t=e.accumulator,n=e.requests,r=e.replies,i=e.requestId;o(Array.isArray(t)),o(Array.isArray(n)),o(Array.isArray(r)),o(Number.isInteger(i)&&i>=0)};e.exports={replyPromise:function(){return P(p())},replyResolve:function(e,t){return P(d(e,t))},replyReject:function(e,t){return v()},interchain:g,effect:y,effectInBand:m,all:b,"@@GLOBAL_HOOK":x}}).call(this,n(58).setImmediate)},1727:function(e,t,n){var r=n(7),i=n(2),a=n(60),s=n(3),o=n(9)("interblock:covenants:shell"),c=n(1728),u=n(4),l=n(21).covenantIdModel,p=n(44),d=n(40),h=d.Machine,f=d.assign,v=p.actions,g=v.spawn,y=v.connect,m=v.listChildren,k=v.getGivenName,b=v.deploy,x=n(34).interchain,w=n(241),I=n(154),M=I.respond,C=(I.send,I.sendParent,{ping:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{type:"PING",payload:r({},t,{to:e})}},login:function(e,t){return{type:"LOGIN",payload:{terminalChainId:e,credentials:t}}},add:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{type:"ADD",payload:{alias:e,spawnOptions:t}}},ls:function(e){return{type:"LS",payload:{path:e}}},rm:function(e){return{type:"RM",payload:{path:e}}},cd:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".";return{type:"CD",payload:{path:e}}},up:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".",t=arguments.length>1?arguments[1]:void 0;return{type:"UP",payload:{path:e,remoteParent:t}}},dispatch:function(e,t){return u.strictEqual(typeof e,"object"),u.strictEqual(typeof t,"string"),{type:"DISPATCH",payload:{action:e,to:t}}},install:function(e,t){return{type:"INSTALL",payload:{dpkgPath:e,installPath:t}}},publish:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";return{type:"PUBLISH",payload:{name:e,installer:t,registry:n}}}}),P=(0,I.translator)(h({id:"shell",initial:"idle",context:{root:"/",wd:"/"},strict:!0,states:{idle:{on:{PING:"ping",LOGIN:"login",ADD:"addActor",LS:"listActors",CD:"changeDirectory",RM:"removeActor",MV:"moveActor",LN:"linkActor",UP:"uplinkActor",CAT:"getState",DISPATCH:"dispatch",PUBLISH:"publish",INSTALL:"install",LOGOUT:"logout",BAL:"balance"}},ping:{invoke:{src:"ping",onDone:"idle"},exit:"respondOrigin"},login:{invoke:{src:"login",onDone:"idle"}},addActor:{invoke:{src:"addActor",onError:"idle",onDone:"idle"},exit:"respondOrigin"},listActors:{invoke:{src:"listActors",onDone:"idle",onError:"idle"}},changeDirectory:{invoke:{src:"changeDirectory",onDone:{target:"idle",actions:["assignWd","respondOrigin"]},onError:"idle"}},removeActor:{invoke:{src:"removeActor",onDone:"idle",onError:"idle"}},moveActor:{},linkActor:{},uplinkActor:{},getState:{},logout:{},balance:{},dispatch:{invoke:{src:"dispatch",onDone:{target:"idle",actions:"respondOrigin"}}},publish:{invoke:{src:"publish",onDone:{target:"idle",actions:"respondOrigin"}}},install:{invoke:{src:"install",onDone:{target:"idle",actions:"respondOrigin"}}},done:{id:"done",data:"info about the files ?",type:"final"},error:{id:"error",type:"final"}}},{actions:{respondOrigin:function(e,t){return o("respondOrigin",t.type),M(t.data)},assignWd:f({wd:function(e,t){var n=t.data.absolutePath;return u.strictEqual(typeof n,"string"),o("assignWd",n),n}})},guards:{},services:{ping:function(){var e=s(i.mark((function e(t,n){var r,s,c,l,p,d;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o("ping: %O",n),r=n.type,s=n.payload,c=s.to,l=void 0===c?".":c,p=a(s,["to"]),u("PING"===r),"."!==l){e.next=7;break}return o("ping to self"),e.abrupt("return",{type:"PONG",payload:p});case 7:return e.next=9,x(r,p,l);case 9:return d=e.sent,o("ping result: %O",d),e.abrupt("return",d);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),login:function(){var e=s(i.mark((function e(t,n){var r,a,s,c,u;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o("login: %O",n.payload),r=n.payload,a=r.terminalChainId,s=r.credentials,c=y("terminal",a),e.next=5,invoke(c);case 5:return e.next=7,invoke("@@INTRO",s,"terminal");case 7:return u=e.sent,o("loginResult: %O",u),e.abrupt("return",{loginResult:u});case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),addActor:function(){var e=s(i.mark((function e(t,n){var r,a,s,c,p,d,h,f;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u.strictEqual(typeof n.payload,"object"),r=n.payload,a=r.alias,s=r.spawnOptions,c=R(a),p=E(a),o("addActor",p,c),"string"===typeof s&&(d=l.create(s),s={covenantId:d}),h=g(p,s),e.next=9,x(h,c);case 9:return f=e.sent,e.abrupt("return",f);case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),listActors:function(){var e=s(i.mark((function e(t,n){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),changeDirectory:function(){var e=s(i.mark((function e(t,n){var a,s,l,p,d,h,f,v,g;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.payload.path,u.strictEqual(typeof a,"string"),s=c(a),o("changeDirectory",s),e.next=6,x(k());case 6:return l=e.sent,p=l.givenName,o("givenName: ",p),(d=p+s).endsWith("/.")&&(d=d.substring(0,d.length-1)),o("absolutePath",d),h=m(),f=h.type,v=h.payload,e.next=15,x(f,v,a);case 15:return g=e.sent,u(Array.isArray(g.children)),o("changeDirectory result: ",g),e.abrupt("return",r({},g,{absolutePath:d}));case 19:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),removeActor:function(){var e=s(i.mark((function e(t,n){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o("removeActor",n);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),dispatch:function(){var e=s(i.mark((function e(t,n){var r,a,s,c,u,l;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.payload,a=r.action,s=r.to,c=a.type,u=a.payload,o("dispatch type: %o to: %o",c,s),e.next=5,x(c,u,s);case 5:return l=e.sent,e.abrupt("return",l);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),publish:function(){var e=s(i.mark((function e(t,n){var r,a,s,c,u;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.payload,a=r.name,s=r.installer,r.registry,o("publish: ",a),c=l.create("dpkg"),u={installer:s},e.next=6,x(g(a,{covenantId:c,state:u}));case 6:return e.abrupt("return",{dpkgPath:a});case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),install:function(){var e=s(i.mark((function e(t,n){var s,c,u,p,d,h,f,v,y,m;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.payload,c=s.dpkgPath,u=s.installPath,e.next=3,x(w.actions.getInstaller(),c);case 3:return p=e.sent,p.children,d=p.covenant,h=a(p,["children","covenant"]),d=d||"unity",f=l.create(d),h=r({},h,{covenantId:f}),v=g(u,h),x(v),y=b(p),e.next=13,x(y,u);case 13:m=e.sent,o(m);case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}}));e.exports={actions:C,reducer:P};var E=function(e){return/^(?:\/?|)(?:[\s\S]*?)((?:\.{1,2}|[^\/]+?|)(?:\.[^.\/]*|))(?:[\/]*)$/.exec(e)[1]},R=function(e){return/^((?:\.(?![^\/]))|(?:(?:\/?|)(?:[\s\S]*?)))(?:\/+?|)(?:(?:\.{1,2}|[^\/]+?|)(?:\.[^.\/]*|))(?:[\/]*)$/.exec(e)[1]||"."}},1729:function(e,t,n){var r=n(2),i=n(60),a=n(7),s=n(3),o=n(4),c=n(9)("interblock:xstate:translator"),u=(n(24),n(63)),l=n(40).State,p=n(34),d=(p.request,p.promise,p.resolve,p.reject,p.isReplyFor),h=(p.replyPromise,p.replyReject,p.replyResolve),f=p.interchain,v=function(e,t){if(e&&e.message&&e.stack){c("error detected %O",e);var n=e,r=n.message,i=n.stack;e=a({},e,{stack:i,message:r})}return{type:"done.invoke."+t,data:e}},g=function(e){o(Array.isArray(e))},y=function(e,t){switch(e.type){case"@@SEND":throw c("send: %O",e),new Error("not implemented");case"@@SEND_PARENT":throw c("sendParent: %O",e),new Error("not implemented");case"@@RESPOND":c("@@RESPOND to: ",t.type),h(e.data,t);break;default:if(e.type.startsWith("done.invoke.")){var n=a({},e,{payload:e.data});return delete n.data,n}return e}},m=function(e,t){if(!e.nextEvents.includes(t.type)){var n=t&&t.type,r=e&&e.value;throw new Error("State: ".concat(r," does not accept event type: ").concat(n))}};e.exports={respond:function(e){return"string"===typeof e&&(e={type:e}),{type:"@@RESPOND",data:e}},send:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".";return{type:"@@SEND",payload:e,path:t}},sendParent:function(e){return{type:"@@SEND_PARENT",payload:e,path:".."}},translator:function(e){var t=e.initialState;return function(){var n=s(r.mark((function n(p,h){var k,b,x,w,I,M,C,P,E,R,A;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o.strictEqual(typeof h,"object"),p&&!u(p,{})||(p=t),o(!p.actions||!p.actions.length,"uncleared xstate"),"@@INIT"!==h.type){n.next=5;break}return n.abrupt("return",p);case 5:if(h.type.startsWith("done.invoke.")&&delete(h=a({},h,{data:h.payload})).payload,c("translator reducer action: %O",h),!d(h)){n.next=10;break}return c("ignoring reply received: ",h),n.abrupt("return",p);case 10:return c("previous machine state: ",p.value),k=l.create(p),b=e.resolveState(k),m(b,h),x=e.transition(b,h),c("next machine state: ",x.value),w=x.toJSON(),I=w.actions,M=i(w,["actions"]),C=JSON.parse(JSON.stringify(M)),P=C.context,E=C.event,g(I),R=C.history.event,c("originAction: ",R.type),A=I.map(function(){var t=s(r.mark((function t(n){var i,a,s,u,l,p,d,h,g;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=n.type,t.next="xstate.start"===t.t0?3:"xstate.stop"===t.t0?18:20;break;case 3:return c("xstate.start"),i=n.activity,o(i&&"xstate.invoke"===i.type),a=i.src,s=e.options.services[a],o("function"===typeof s),c("running service: ",a),t.next=12,s(P,E);case 12:return u=t.sent,c("invoke result: ",u&&u.type),l=v(u,a),p=l.type,d=l.data,c("doneInvoke",d),f(p,d),t.abrupt("break",23);case 18:return c("end of invoke"),t.abrupt("break",23);case 20:return c("default: %O",n),n.exec?(h=n.exec(P,E),c("execResult %O",h),h&&y(h,R)):(c("standard action ? %O",n),g=y(n,R),protocolActions.push(g)),t.abrupt("break",23);case 23:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),n.next=26,Promise.all(A);case 26:return n.abrupt("return",C);case 27:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()}}},1731:function(e,t,n){var r=n(2),i=n(7),a=n(3),s=n(9)("interblock:covenants:hyper"),o=n(34),c=o.replyResolve,u=(o.request,n(44).actions,{}),l={reducer:function(){var e=a(r.mark((function e(){var t,n,a=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=a.length>0&&void 0!==a[0]?a[0]:u,n=a.length>1?a[1]:void 0,s("hyper action: ",n.type),e.t0=n.type,e.next="PING"===e.t0?6:8;break;case 6:return c({type:"PONG"}),e.abrupt("break",8);case 8:return e.abrupt("return",i({},t));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),actions:{}};e.exports=i({},l)},1732:function(e,t,n){var r=n(2),i=n(7),a=n(3),s=n(9)("interblock:covenants:probe"),o=n(34),c=o.replyResolve,u=(o.request,n(44).actions,{}),l={reducer:function(){var e=a(r.mark((function e(){var t,n,a,o,l=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=l.length>0&&void 0!==l[0]?l[0]:u,n=l.length>1?l[1]:void 0,a=n.type,o=n.payload,s("test action: ",a),e.t0=a,e.next="PING"===e.t0?7:9;break;case 7:return c({type:"PONG",payload:o}),e.abrupt("break",9);case 9:return e.abrupt("return",i({},t));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),actions:{}};e.exports=i({},l)},1733:function(e,t,n){var r=n(4),i=n(20).standardize,a=n(157).txRequestModel,s=n(156).txReplyModel,o=n(245).rxReplyModel,c=n(155).rxRequestModel,u=n(93).registry,l=function(e,t){if(!e)throw new Error("Action cannot be interpreted: ".concat(e));if("string"===typeof e&&(e={type:e}),r(e.type,"Action must supply a type"),p(e.type)){var n,i=e,o=i.type,u=i.payload,l=void 0===u?{}:u,d=e.request;return d?n=d.sequence:(r(c.isModel(t)),n=t.sequence),s.create(o,l,n)}var h=e,f=h.type,v=h.payload,g=void 0===v?{}:v,y=h.to,m=void 0===y?".":y;return a.create(f,g,m)},p=function(e){return s.schema.properties.type.enum.includes(e)},d=i({schema:{title:"Reduction",type:"object",required:["isPending","requests","replies"],additionalProperties:!1,properties:{reduction:{type:"object"},isPending:{type:"boolean"},requests:{type:"array",uniqueItems:!0,items:a.schema},replies:{type:"array",uniqueItems:!0,items:s.schema}}},create:function(e,t,n){var i=e.reduction,a=e.isPending,s=e.requests,p=e.replies;r(Array.isArray(s)),r(Array.isArray(p)),r(c.isModel(t)||o.isModel(t)),r(u.get("Dmz").isModel(n)),s=s.map((function(e){return l(e,t)})),p=p.map((function(e){return l(e,t)})),s.forEach((function(e){".@@io"===e.to&&r(n.config.isPierced)}));var h={reduction:i,isPending:a,requests:s,replies:p};return i||delete h.reduction,d.clone(h)},logicize:function(e){var t=e.reduction,n=e.isPending,i=e.requests,o=e.replies;r(t&&!n||!t&&n),r(i.every(a.isModel)),r(o.every(s.isModel));var c=0,u=new Set;o.forEach((function(e){e.getReply().isPromise()&&c++,u.add(e.request.sequence)})),n?r.strictEqual(c,0,"No promises allowed if pending"):r(c<=1,"Max one promise allowed: ".concat(c)),r(u.size===o.length,"Duplicate sequence detected");return{getIsPending:function(){return n}}}});e.exports={reductionModel:d}},1734:function(e,t,n){var r=n(1735).txModel,i=n(248).socketModel;e.exports={socketModel:i,txModel:r}},1735:function(e,t,n){var r=n(4),i=n(20).standardize,a=n(110).interblockModel,s=n(248).socketModel,o=i({schema:{title:"Tx",description:"An interblock plus socket info, used for transmission functions",type:"object",required:["socket","interblock"],additionalProperties:!1,properties:{socket:s.schema,interblock:a.schema}},create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.create(),t=arguments.length>1?arguments[1]:void 0;return r(s.isModel(e)),r(a.isModel(t)),o.clone({socket:e,interblock:t})},logicize:function(e){return{}}});e.exports={txModel:o}},1736:function(e,t,n){var r=n(2),i=n(3),a=n(48),s=function(){var e=i(r.mark((function e(t){var n,s,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("object"===typeof t){e.next=2;break}return e.abrupt("return");case 2:if(n=t,t.interblock&&(n=t.interblock),n.provenance&&n.provenance.signatures){e.next=6;break}return e.abrupt("return");case 6:if(s=n.provenance.signatures,Array.isArray(s)){e.next=9;break}return e.abrupt("return");case 9:return c=s.map(function(){var e=i(r.mark((function e(t){var n,i,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.publicKey,i=t.integrity,s=t.seal,a.verifyKeyPairSync(i.hash,s,n.key)){e.next=3;break}return e.abrupt("return",a.verifyHash(i.hash,s,n.key));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=12,Promise.all(c);case 12:if(!n.network||!n.network["."]){e.next=15;break}return e.next=15,o(n.network);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o=function(){var e=i(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object.values(t).map(function(){var e=i(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(t.heavy);case 2:return n=t.lineageTip.map(s),e.next=5,Promise.all(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=3,Promise.all(n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=i(r.mark((function e(t){var n,i,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.publicKey.key,i=t.secretKey,s={publicKey:n,secretKey:i},a.verifyKeyPairSync(s)){e.next=6;break}return e.next=6,a.verifyKeyPair(s);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();e.exports={cacheVerifyHash:s,cacheVerifyKeypair:c}},1737:function(e,t,n){(function(t){var r=n(2),i=n(3),a=n(40),s=a.Machine,o=a.assign;t.Machine=s,t.assign=o;var c=n(4),u=n(180).ioQueueFactory,l=n(21),p=l.interblockModel,d=l.addressModel,h=l.txModel,f=n(111).thread,v=n(112).isolateFactory,g=n(113).cryptoFactory,y=n(53).consistencyFactory,m=n(1746).increasorConfig,k=n(1752).poolConfig,b=n(1754).receiveConfig,x=n(1756).transmitConfig;e.exports={fsmFactory:function(){var e=u("ioIsolate"),t=u("ioCrypto"),n=u("ioConsistency"),a=u("ioPool",p),s=u("ioIncrease",d),o=u("ioReceive",h),l=u("ioTransmit",p);e.setProcessor(v()),t.setProcessor(g()),n.setProcessor(y());var w=k(t,n);a.setProcessor(function(){var e=i(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(p.isModel(t)),n={type:"POOL_INTERBLOCK",payload:t},e.next=4,f(n,w);case 4:return i=e.sent,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var I=m(t,n,e);s.setProcessor(function(){var e=i(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(d.isModel(t)),n={type:"INCREASE_CHAIN",payload:t},e.next=4,f(n,I);case 4:return i=e.sent,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var M=b(n);o.setProcessor(function(){var e=i(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(h.isModel(t)),n={type:"RECEIVE_INTERBLOCK",payload:t},e.next=4,f(n,M);case 4:return i=e.sent,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var C=x(n);return l.setProcessor(function(){var e=i(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(p.isModel(t)),n={type:"TRANSMIT_INTERBLOCK",payload:t},e.next=4,f(n,C);case 4:return i=e.sent,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),{ioIsolate:e,ioCrypto:t,ioConsistency:n,ioPool:a,ioIncrease:s,ioReceive:o,ioTransmit:l}}}}).call(this,n(31))},1738:function(e,t,n){var r=n(120).v4,i=n(83),a=n(9),s=0;e.exports={machineLogger:function(e,t){var n=r(),o=a("interblock:machines:".concat(i(t,11)));o("INVOCATION: ".concat(t," -> ").concat(e));var c=[],u=!1,l=function(e){s++,o("TRANSITION: ".concat(i(3,s)," %O"),e)},p=function(e){o("TERMINATOR: ".concat(e.machine," -> ").concat(e.type," execution ended after ").concat(e.elapsedTime,"ms"))};return{writeTransition:function(e,t,n){var r=e;if(c.push(r),u)return l(r);u=!0},writeTermination:function(r){return p({invocation:n,type:e,machine:t,state:"TERMINATION",event:c})}}}}},1739:function(e,t,n){var r=n(17),i=n(2),a=n(3),s=n(7),o=n(4),c=n(24),u=n(21),l=(u.actionModel,u.addressModel),p=u.integrityModel,d=u.provenanceModel,h=u.lockModel,f=u.blockModel,v=u.socketModel,g=u.interblockModel,y=u.txRequestModel,m=u.txReplyModel,k=n(9)("interblock:services:consistency"),b=function(e){var t=p.create(),n=p.clone(s({},t,{hash:e})),r=l.create(n);return o.strictEqual(r.getChainId(),e),r},x=function(e){return{chainId:e.provenance.getAddress().getChainId(),height:e.provenance.height,blockHash:e.getHash(),shortestLineage:e.provenance.lineage[0]}},w=function(e){return function(t){return I(t,e)}},I=function(e,t){var n=t.getChainId(),r=e.getRemote()?"heavy":"light",i=e.provenance.getAddress().getChainId(),a=e.provenance.height;return{chainId:n,originChainId_height_type:"".concat(i,"_").concat(a,"_").concat(r),interblockHash:e.getHash(),isDeleted:!1}},M=function(e){return function(t){var n=t.getChainId(),r=e.provenance.getAddress().getChainId(),i=e.network.getAlias(t),a=e.network[i];return o(a),{chainId:n,targetChainId:r,heavyHeight:a.heavyHeight,lineageHeight:a.lineageHeight,height:e.provenance.height}}},C=n(1740).lockFactory,P=n(249).dbFactory,E=n(250),R=E.s3Factory,A=E.s3Keys,q=n(114).ramDynamoDbFactory,O=n(165).ramS3Factory;e.exports={consistencySourceFactory:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"CI";e=e||q(),t=t||O();var u=C(e),p=P(e),E=R(t),S=new Map,T=function(){var e=a(i.mark((function e(t){var n,r,a,s,c,u,d,h,f;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.affectedAddresses,r=t.interblock,o(n.every(l.isModel)),o(g.isModel(r)),k("poolInterblocks for ".concat(n.length," addresses")),c=r.getWithoutRemote(),u=n.map((function(e){var t=c;return e.equals(r.getTargetAddress())?(s=!0,t=r):a=!0,I(t,e)})),k("poolItems count: %O",u.length),d=[],a&&(h=A.fromInterblock(c),d.push(E.putInterblock(h,c))),s&&(f=A.fromInterblock(r),d.push(E.putInterblock(f,r))),e.next=12,p.putPool(u);case 12:return e.next=14,Promise.all(d);case 14:k("poolInterblock complete for: ".concat(n.length," addresses"));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=a(i.mark((function e(t,r){var s,d,f,v,y,m,b,x,w,I,M,C;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(l.isModel(t)),s=t.getChainId(),e.next=4,u.tryAcquire(s,n,r);case 4:if(d=e.sent){e.next=8;break}return k("lockChain could not lock ".concat(s)),e.abrupt("return");case 8:return k("locked chain: ".concat(s," with: ").concat(d)),f=W({address:t}),e.next=12,p.queryPool(s);case 12:return v=e.sent,y=v.filter((function(e){return!e.isDeleted})),k("pool total: ".concat(v.length," valid: ").concat(y.length)),m=y.map(function(){var e=a(i.mark((function e(t){var n,r;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=A.fromPoolItem(t),e.next=3,E.getInterblock(n);case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return");case 6:return o(g.isModel(r)),o.strictEqual(t.interblockHash,r.getHash()),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=18,Promise.all(m);case 18:return b=e.sent,x=c.compact(b),k("interblocks fetched: ".concat(x.length)),e.next=23,f;case 23:return w=e.sent,k("block height: %O",w&&w.provenance.height),k("interblock count: %O",x.length),e.next=28,p.queryPiercings(s);case 28:return I=e.sent,M={requests:[],replies:[]},I.forEach((function(e){var t=e.txRequest,n=e.txReply;o(!t||!n),t&&M.requests.push(t),n&&M.replies.push(n)})),C=h.create(w,x,d,M),o(!S.has(s)),S.set(s,C),k("lock complete: %O",C.uuid),e.abrupt("return",C);case 36:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),D=function(){var e=a(i.mark((function e(t){var n,r,a,s,c,l,d,f,v,g;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k("putUnlockChain"),o(h.isModel(t)),n=t.block,o(n,"cannot unlock without a block"),r=n.provenance.getAddress(),a=r.getChainId(),e.next=8,u.isValid(a,t.uuid);case 8:if(e.sent){e.next=12;break}return k("unlock rejected for ".concat(a)),e.abrupt("return");case 12:if(s=S.get(a),!(c=s.block)||c.isNext(n)){e.next=19;break}k("block is not next %O",n.provenance.height),k("no change: ",c.equals(n)),e.next=30;break;case 19:if(c||n.provenance.address.isGenesis()){e.next=23;break}k("next was not genesis: %O",n.height),e.next=30;break;case 23:return l=A.fromBlock(n),e.next=26,E.putBlock(l,n);case 26:return d=x(n),e.next=29,p.putBlock(d);case 29:k("block added");case 30:return f=N(n,c),v=L(n,s.interblocks),g=B(n,s.piercings),e.next=35,Promise.all([f,v,g]);case 35:return S.delete(a),e.next=38,u.release(a,t.uuid);case 38:k("putUnlockChain complete");case 39:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=a(i.mark((function e(t,n){var r,a,s,c,u,l,d,h;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(f.isModel(t)),o(!n||f.isModel(n)),r=n?n.network.getAliases():[],a=r.filter((function(e){return n.network[e].address.isResolved()})),s=t.network.getAliases().filter((function(e){return t.network[e].address.isResolved()})),c=s.filter((function(e){return!a.includes(e)})).map((function(e){return t.network[e].address})),u=a.filter((function(e){return!s.includes(e)})).map((function(e){return t.network[e].address})),l=c.map((function(e){return e.getChainId()})),k("_updateRouteTable newAddresses",l),d=c.map(M(t)),h=u.map(M(t)),e.next=13,Promise.all([p.putSubscriptions(d),p.delSubscriptions(h)]);case 13:k("updateRouteTable complete");case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),L=function(){var e=a(i.mark((function e(t,n){var r,a,o,c,u,l;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Y(t,n),a=t.provenance.getAddress(),o=r.map(w(a)).map((function(e){return s({},e,{isDeleted:!0})})),e.next=5,p.putPool(o);case 5:return k("_purgePool isDeleted marked"),e.next=8,z(r);case 8:return c=e.sent,k("_purgePool _findOrphans found: ".concat(c.length)),u=c.map(A.fromInterblock),e.next=13,E.deleteInterblocks(u);case 13:return l=o.map((function(e){return{chainId:e.chainId,originChainId_height_type:e.originChainId_height_type}})),e.next=16,p.delPool(l);case 16:k("_purgePool complete");case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),z=function(){var e=a(i.mark((function e(t){var n,s,o,u;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.filter((function(e){return e.getRemote()})),s=t.filter((function(e){return!e.getRemote()})),o=s.map(function(){var e=a(i.mark((function e(t){var n;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(t);case 2:return n=e.sent,e.abrupt("return",!n&&t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.t0=c,e.next=6,Promise.all(o);case 6:return e.t1=e.sent,u=e.t0.compact.call(e.t0,e.t1),e.abrupt("return",[].concat(r(u),r(n)));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=a(i.mark((function e(t,n){var a,s,o,c,u,l,d,h,f,v,g;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.network[".@@io"]){e.next=3;break}return e.abrupt("return");case 3:return s=a.getRemote(),o=s.requests,c=s.replies,u=Object.values(o),l=Object.values(c),d=n.requests.filter((function(e){return u.some((function(t){return e.getRequest().equals(t)}))})),h=n.replies.filter((function(e){return l.some((function(t){return e.getReply().equals(t)}))})),f=t.getChainId(),v=[].concat(r(d),r(h)),g=v.map((function(e){var t=e.getHash();return{chainId:f,hash:t}})),e.abrupt("return",p.delPierce(g));case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),_=function(){var e=a(i.mark((function e(t){var n,r,a,s,c,u,l,p,h;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.provenance,r=t.height,k("getLineage from height: ",a=void 0===r?0:r),o(d.isModel(n)),o(Number.isInteger(a)&&a>=0),o(a<n.height),s=n.getAddress(),c=[],l=n;case 8:return u=l.getShortestHeight(),e.next=11,W({address:s,height:u});case 11:p=e.sent,o(f.isModel(p)),c.push(p),l=p.provenance;case 15:if(u>a){e.next=8;break}case 16:return h=c.map((function(e){return g.create(e)})),e.abrupt("return",h);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=a(i.mark((function e(t){var n,r;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(g.isModel(t)),n=t.provenance.getAddress().getChainId(),!0,e.next=5,p.queryAffected(n,!0);case 5:return r=e.sent,e.abrupt("return",!!r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=a(i.mark((function e(t){var n,a,s,c,u,l;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(g.isModel(t)),n=t.provenance.getAddress().getChainId(),a=t.provenance.height,e.next=5,p.queryAffected(n);case 5:return s=e.sent,c=s.filter((function(e){var t=e.targetChainId,n=e.heavyHeight,r=e.lineageHeight;return t.startsWith(t)?n<a:r<a})),u=c.map((function(e){var t=e.targetChainId;return b(t)})),l=new Set(u),k("dbQueryAffected items length: %O",l.size),e.abrupt("return",r(l));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=a(i.mark((function e(t){var n,r,a;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(l.isModel(t)),n=t.getChainId(),k("getSockets for: %O",n),e.next=5,p.querySockets(n);case 5:return r=e.sent,o(Array.isArray(r)),o(r.every((function(e){return"object"===typeof e}))),a=r.map((function(e){var t=e.socketJson;return o(t),v.clone(t)})),k("getSockets length: ".concat(a.length)),e.abrupt("return",a);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=a(i.mark((function e(t){var n,r,a,s,c,u,d;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.address,r=t.socket,k("putSocket"),o(l.isModel(n)),o(v.isModel(r)),a=n.getChainId(),s=r.id,c=parseInt(Date.now()/1e3),u=r.serialize(),d={chainId:a,socketId:s,updatedTime:c,socketJson:u},e.next=11,p.putSocket(d);case 11:k("putSocket complete");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=a(i.mark((function e(t){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o(v.isModel(t)),k("delSocket %o",t.id);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(e){return p.queryLatest(e.getChainId())},W=function(){var e=a(i.mark((function e(t){var n,r,a,s,c,u;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.address,r=t.height,k("getBlock",n&&n.getChainId(),r),n){e.next=5;break}return o(!r),e.abrupt("return",J());case 5:if(o(l.isModel(n)),a=n.getChainId(),Number.isInteger(r)){e.next=13;break}return e.next=10,p.queryLatest(a);case 10:s=e.sent,e.next=16;break;case 13:return e.next=15,p.getBlock({chainId:a,height:r});case 15:s=e.sent;case 16:if(s){e.next=18;break}return e.abrupt("return");case 18:return Number.isInteger(r)||(r=s.height),c=A.fromBlockItem(s),k("s3.getBlock(s3Key)",c),e.next=23,E.getBlock(c);case 23:return u=e.sent,o(f.isModel(u)),o(n.equals(u.provenance.getAddress())),o.strictEqual(u.getHash(),s.blockHash),o.strictEqual(u.provenance.height,r),k("getBlock complete"),e.abrupt("return",u);case 30:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=a(i.mark((function e(){var t,n;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k("getBaseAddress"),e.next=3,p.scanBaseChainId();case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return");case 6:return o(t.chainId),n=l.create(t.chainId),o.strictEqual(t.chainId,n.getChainId()),k("getBaseAddress: ".concat(n.getChainId())),e.abrupt("return",n);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$=function(){var e=a(i.mark((function e(t){var n,r,a,s,c;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.txRequest,o(y.isModel(n)),r=l.create(n.to),o(r.isResolved()),a=r.getChainId(),s=n.getHash(),k("putPierceRequest %o %o",a,n),c={chainId:a,hash:s,txRequest:n},e.next=10,p.putPierce(c);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=a(i.mark((function e(t){var n,r,a,s,c;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.txReply,o(m.isModel(n)),r=n.getAddress(),o(r.isResolved()),a=r.getChainId(),s=n.getHash(),k("putPierceReply %o %o",a,n),c={chainId:a,hash:s,txReply:n},e.next=10,p.putPierce(c);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(e,t){return t.filter((function(t){var n=e.network.includesInterblock(t),r=e.network.getAlias(t.provenance.getAddress());return n||!r}))};return{putSocket:G,getSockets:H,delSocket:U,putLockChain:j,putUnlockChain:D,getLineage:_,getIsAnyAffected:K,getAffected:F,getIsPresent:V,getBlock:W,putPoolInterblock:T,putPierceRequest:$,putPierceReply:Q}}}},1740:function(e,t,n){var r=n(2),i=n(3),a=n(1741),s=n(57).promisify,o=n(114).ramDynamoDbFactory,c=0,u=1;e.exports={lockFactory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o(),t=n(9)("interblock:aws:lock:id-".concat(c++)),l=new Map,p=function(){var n=i(r.mark((function n(o,c,p){var d,h,v,g,y,m,k,b,x,w,I,M;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t("attempting to lock %o %o %o",o.substring(0,16),c,p),!l.has(o)){n.next=4;break}return t("already locked to this thread: ".concat(o)),n.abrupt("return");case 4:if(!e._getTables){n.next=9;break}return d="ramLockId-"+u++,h={uuid:d,tryRelease:function(){t("ram tryRelease for uuid: %o and chainId: %o",d,o)}},l.set(o,h),n.abrupt("return",d);case 9:return l.set(o,"acquisition in progress"),v=new a.FailOpen({dynamodb:e,lockTable:"dbLocks",partitionKey:"chainId",leaseDurationMs:p||12e3,retryCount:0,owner:c,trustLocalTime:!0}),n.prev=11,n.next=14,f("dbLocks",{chainId:o});case 14:if(!(g=n.sent)||1===g.leaseDurationMs){n.next=23;break}if(y=g.lockAcquiredTimeUnixMs,m=g.leaseDurationMs,2e3,Date.now()-y>m+2e3){n.next=23;break}return t("lock not available ".concat(o)),n.abrupt("return");case 23:return k=s(v.acquireLock).bind(v),n.next=26,k(o);case 26:return b=n.sent,x=b.fencingToken,t("locked ".concat(o," with fencing token: ").concat(x)),w=function(){var e=i(r.mark((function e(){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=s(b.release).bind(b),e.next=4,n();case 4:t("released lock for ".concat(o)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t("failed to release lock for ".concat(o," ").concat(e.t0.message));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),I=b._guid.toString("base64"),M={uuid:I,tryRelease:w},l.set(o,M),t("lock complete"),n.abrupt("return",I);case 37:return n.prev=37,n.t0=n.catch(11),t("failed to lock: ".concat(o," %O"),n.t0),"string"===typeof l.get(o)&&l.delete(o),n.abrupt("return");case 43:case"end":return n.stop()}}),n,null,[[11,37]])})));return function(e,t,r){return n.apply(this,arguments)}}(),d=function(){var e=i(r.mark((function e(n,i){var a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve();case 2:if(l.has(n)){e.next=5;break}return t("unknown lock for ".concat(n)),e.abrupt("return",!1);case 5:return a=l.get(n),e.abrupt("return",a.uuid===i);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),h=function(){var e=i(r.mark((function e(t,n){var i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=l.get(t)).uuid!==n){e.next=6;break}return e.next=4,i.tryRelease();case 4:return l.delete(t),e.abrupt("return");case 6:throw new Error("invalid lock: ".concat(t," ").concat(n));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),f=function(){var t=i(r.mark((function t(n,i){var a,s,o;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={TableName:n,Key:i,ConsistentRead:!0,ReturnConsumedCapacity:"TOTAL"},t.next=3,e.get(a).promise();case 3:return s=t.sent,s.ConsumedCapacity,o=s.Item,t.abrupt("return",o);case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();return{tryAcquire:p,isValid:d,release:h}}}},1745:function(e,t,n){var r=n(2),i=n(3);e.exports={toFunctions:function(e){return{putSocket:function(t){return e.push({type:"PUT_SOCKET",payload:t})},getSockets:function(t){return e.push({type:"GET_SOCKETS",payload:t})},delSocket:function(t){return e.push({type:"DEL_SOCKET",payload:t})},putPoolInterblock:function(t){return e.push({type:"POOL",payload:t})},putLockChain:function(t){return e.push({type:"LOCK",payload:t})},putUnlockChain:function(t){return e.push({type:"UNLOCK",payload:t})},getLineage:function(t){return e.push({type:"LINEAGE",payload:t})},getIsAnyAffected:function(t){return e.push({type:"ANY_AFFECTED",payload:t})},getAffected:function(t){return e.push({type:"AFFECTED",payload:t})},getIsPresent:function(t){return e.push({type:"IS_PRESENT",payload:t})},getBlock:function(t){return e.push({type:"GET_BLOCK",payload:t})},putPierceRequest:function(t){return e.push({type:"PIERCE_REQ",payload:t})},putPierceReply:function(t){return e.push({type:"PIERCE_REP",payload:t})}}},fromFunctions:function(e){return function(){var t=i(r.mark((function t(n){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=n.type,t.next="PUT_SOCKET"===t.t0?3:"GET_SOCKETS"===t.t0?4:"DEL_SOCKET"===t.t0?5:"POOL"===t.t0?6:"LOCK"===t.t0?7:"UNLOCK"===t.t0?8:"LINEAGE"===t.t0?9:"ANY_AFFECTED"===t.t0?10:"AFFECTED"===t.t0?11:"IS_PRESENT"===t.t0?12:"GET_BLOCK"===t.t0?13:"PIERCE_REQ"===t.t0?14:"PIERCE_REP"===t.t0?15:16;break;case 3:return t.abrupt("return",e.putSocket(n.payload));case 4:return t.abrupt("return",e.getSockets(n.payload));case 5:return t.abrupt("return",e.delSocket(n.payload));case 6:return t.abrupt("return",e.putPoolInterblock(n.payload));case 7:return t.abrupt("return",e.putLockChain(n.payload));case 8:return t.abrupt("return",e.putUnlockChain(n.payload));case 9:return t.abrupt("return",e.getLineage(n.payload));case 10:return t.abrupt("return",e.getIsAnyAffected(n.payload));case 11:return t.abrupt("return",e.getAffected(n.payload));case 12:return t.abrupt("return",e.getIsPresent(n.payload));case 13:return t.abrupt("return",e.getBlock(n.payload));case 14:return t.abrupt("return",e.putPierceRequest(n.payload));case 15:return t.abrupt("return",e.putPierceReply(n.payload));case 16:throw new Error("Unknown action type: ".concat(n&&n.type));case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}},1746:function(e,t,n){var r=n(2),i=n(3),a=n(4),s=n(9)("interblock:config:increasor"),o=(n(24),n(40).assign),c=n(21),u=c.channelModel,l=c.lockModel,p=c.addressModel,d=c.dmzModel,h=c.blockModel,f=c.interblockModel,v=c.networkModel,g=c.rxRequestModel,y=c.txReplyModel,m=n(71),k=m.blockProducer,b=m.lockProducer,x=(m.networkProducer,k.generateNext),w=n(111).thread,I=n(1747).machine,M=n(53),C=n(113),P=n(112),E=n(1748).isolatorConfig,R=function(e,t){if(!e[".@@io"])return!1;var n=e[".@@io"],r=t[".@@io"]||u.create();return n.isTxGreaterThan(r)};e.exports={increasorConfig:function(e,t,n){var c=M.toFunctions(t),m=C.toFunctions(e),k=P.toFunctions(n);return I.withConfig({actions:{assignLock:o({lock:function(e,t){s("assignLock");var n=t.data.lock;return a(l.isModel(n)),n}}),assignNextDmz:o({nextDmz:function(e,t){var n=t.data.dmz;return a(d.isModel(n)),n}}),assignContainerId:o({containerId:function(e,t){var n=t.data.containerId;return a(!n||"string"===typeof n),s("assignContainerId: ",n),n}}),assignBlock:o({block:function(e,t){var n=t.data.nextBlock;return a(h.isModel(n)),n}}),reconcileLock:o({nextLock:function(e){var t=e.lock,n=e.block;a(l.isModel(t)),a(h.isModel(n)),s("reconcileLock");var r=b.reconcile(t,n);return r}}),repeatLock:o({nextLock:function(e){return e.lock}}),assignIsRedriveRequired:o({isRedriveRequired:function(e,t){var n=e.isRedriveRequired;a(!n);var r=t.data.effectsReplyCount;a(Number.isInteger(r)),a(r>=0);var i=!!r;return s("isRedriveRequired",i),i}}),assignTxInterblocks:o({txInterblocks:function(e){var t=e.block,n=e.lock;s("txInterblocks");var r=n.block;a(h.isModel(t)),a(h.isModel(r)),a(!t.provenance.address.isGenesis());var i=r.network;2===t.provenance.height&&!t.network[".."].address.isRoot()&&(i=v.create());var o=t.network.txInterblockAliases(i).map((function(e){return f.create(t,e)}));return s("txInterblocks raw length: ".concat(o.length)),o.push(f.create(t)),o}})},guards:{isLockAcquired:function(e,t){var n=!1,r=t.data.lock;return r&&(a(l.isModel(r)),n=r.block,!r.block&&s("WARNING missing chain locked")),s("isLockAcquired: ",!!n),n},isProposer:function(){return!0},isValidator:function(){return!1},isIsolationComplete:function(e){var t=!!e.nextDmz;return s("isIsolationComplete: ".concat(t)),t},isDmzChanged:function(e){var t=e.lock,n=e.nextDmz;a(l.isModel(t)),a(d.isModel(n));var r=n.network;a(t.block,"increasor never makes a new chain");var i=t.block.network,o=r.txInterblockAliases(i),c=R(r,i),u=o.length||c;return s("isDmzChanged: ".concat(u)),u},isNewBlock:function(e){var t=e.block,n=t&&h.isModel(t);return s("isNewBlock: ".concat(n)),n},isEffectable:function(e){var t=e.block,n=e.containerId;a(h.isModel(t)),a.strictEqual(typeof n,"string");var r=t.config.isPierced&&n;return s("isEffectable %o",r),r}},services:{lockChain:function(){var e=i(r.mark((function e(t,n){var i,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.payload,s("lockChain ".concat(i.getChainId())),a(p.isModel(i)),e.next=5,c.putLockChain(i);case 5:return o=e.sent,e.abrupt("return",{lock:o});case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),isolatedExecution:function(){var e=i(r.mark((function e(t){var i,s,o,c,u,l;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.lock,s={type:"EXECUTE_COVENANT",payload:{lock:i}},o=E(n),e.next=5,w(s,o);case 5:return c=e.sent,u=c.dmz,l=c.containerId,a(d.isModel(u)),e.abrupt("return",{dmz:u,containerId:l});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),signBlock:function(){var e=i(r.mark((function e(t){var n,i,s,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.lock,i=t.nextDmz,a(d.isModel(i)),a(l.isModel(n)),s=n.block,a(s),e.next=7,x(i,s,m.sign);case 7:return o=e.sent,e.abrupt("return",{nextBlock:o});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),effects:function(){var e=i(r.mark((function e(t){var n,o,l,p,d,h,f,v;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.containerId,o=t.nextLock,l=t.lock,a.strictEqual(typeof n,"string"),a(o.block),a(!o.block.equals(l.block)),s("effects"),p=u.create(),l.block&&l.block.network[".@@io"]&&(p=l.block.network[".@@io"]),d=o.block.network[".@@io"]||p,h=d.getRequestIndices().filter((function(e){return!p.requests[e]})),s("nextIoIndices: ",h),3e4,f=h.map(function(){var e=i(r.mark((function e(t){var i,u,l,p,h,f,v,m,b;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=d.requests[t],a(i&&i.payload),u=i.payload[".@@ioRequestId"],a.strictEqual(typeof u,"string"),l=i.type,p=i.payload,h=o.block.provenance.getAddress(),f=g.create(l,p,h,t),v=f.sequence,e.prev=8,e.next=11,k.executeEffect({containerId:n,effectId:u,timeout:3e4});case 11:b=e.sent,s("effects payload: ",b),m=y.create("@@RESOLVE",b,v),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(8),m=y.create("@@REJECT",e.t0,v);case 19:return e.next=21,c.putPierceReply({txReply:m});case 21:return s("reply address:",m.getAddress().getChainId()),e.abrupt("return",m);case 23:case"end":return e.stop()}}),e,null,[[8,16]])})));return function(t){return e.apply(this,arguments)}}()),e.next=14,Promise.all(f);case 14:return v=e.sent,s("settlements: ",v),e.next=18,k.unloadCovenant(n);case 18:return e.abrupt("return",{effectsReplyCount:v.length});case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),unlockChain:function(){var e=i(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.nextLock,a(l.isModel(n)),s("unlockChain"),e.next=5,c.putUnlockChain(n);case 5:return e.abrupt("return");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}})}}},1747:function(e,t,n){var r={id:"increasor",initial:"idle",context:{lock:void 0,nextLock:void 0,block:void 0,nextDmz:void 0,txInterblocks:[],containerId:"",isRedriveRequired:!1},strict:!0,states:{idle:{on:{INCREASE_CHAIN:"lockChain"}},lockChain:{invoke:{src:"lockChain",onDone:[{target:"execute",cond:"isLockAcquired",actions:"assignLock"},{target:"done"}],onError:"error"}},execute:{initial:"branch",states:{branch:{always:[{target:"proposeNext",cond:"isProposer"},{target:"validateNext",cond:"isValidator"},{target:"#done"}]},proposeNext:{initial:"branch",states:{branch:{always:[{target:"isDmzChanged",cond:"isIsolationComplete"},{target:"#increasor.isolate"}]},isDmzChanged:{always:[{target:"signBlock",cond:"isDmzChanged"},{target:"#increasor.unlockChain"}]},signBlock:{invoke:{src:"signBlock",onDone:{target:"#increasor.unlockChain",actions:"assignBlock"},onError:"#error"}}}},validateNext:{always:[{target:".signBlock",cond:"isIsolationComplete"},{target:"#increasor.isolate",cond:"isIsolationRequired"}],initial:"signBlock",states:{signBlock:{}}},history:{type:"history"}}},isolate:{invoke:{src:"isolatedExecution",onDone:{target:"#increasor.execute.history",actions:["assignNextDmz","assignContainerId"]},onError:"#error"}},unlockChain:{initial:"isNewBlock",states:{isNewBlock:{always:[{target:"effects",cond:"isNewBlock",actions:"reconcileLock"},{target:"unlockChain",actions:"repeatLock"}]},effects:{initial:"isEffectable",states:{isEffectable:{always:[{target:"executeEffects",cond:"isEffectable"},{target:"done"}]},executeEffects:{invoke:{src:"effects",onDone:{target:"done",actions:"assignIsRedriveRequired"}}},done:{type:"final"}},onDone:"unlockChain"},unlockChain:{invoke:{src:"unlockChain",onDone:"done"}},done:{type:"final"}},onDone:[{target:"done",cond:"isNewBlock",actions:"assignTxInterblocks"},{target:"done"}]},done:{id:"done",data:function(e){return{txInterblocks:e.txInterblocks,isRedriveRequired:e.isRedriveRequired}},type:"final"},error:{id:"error",type:"final"}}},i=Machine(r);e.exports={definition:r,machine:i}},1748:function(e,t,n){var r=n(2),i=n(3),a=n(7),s=n(4),o=n(9)("interblock:config:isolator"),c=n(40).assign,u=n(21),l=u.channelModel,p=u.interblockModel,d=u.blockModel,h=u.provenanceModel,f=u.dmzModel,v=u.lockModel,g=u.keypairModel,y=u.pierceSigner,m=n(71),k=m.networkProducer,b=m.channelProducer,x=(n(44).openPaths,n(111).thread),w=n(1749).interpreterConfig,I=n(1751).machine,M=n(112),C=n(48),P=g.create("PIERCE",C.pierceKeypair),E=function(e){var t=e.dmz;s(f.isModel(t));var n=t.rx();return o("isReduceable",n&&n.event.type),!!n},R=function(e){var t=e.dmz,n=e.hasPierced;s(f.isModel(t));var r=t.config.isPierced&&!n;return o("isPiercable: %O",r),r},A=I.withConfig({actions:{assignLock:c({lock:function(e,t){var n=t.payload.lock;return s(v.isModel(n)),s(n.block,"can only isolate for existing chains"),n}}),primeDmz:c({dmz:function(e){var t=e.lock;s(v.isModel(t));var n=t.block,r=t.interblocks,i=n.getDmz(),o=k.ingestInterblocks(i.network,r,i.config);return f.clone(a({},i,{network:o}))}}),assignContainerId:c({containerId:function(e,t){var n=t.data.containerId;return s(n),n}}),updateDmz:c({dmz:function(e,t){o("updateDmz");var n=t.data.nextDmz;return s(f.isModel(n)),n}}),generatePierceDmz:c({pierceDmz:function(e){var t=e.lock;s(v.isModel(t)),s(t.block);var n=t.block,r=t.piercings,i=q(t.block),c=i.network["@@PIERCE_TARGET"];return s(c.address.equals(n.provenance.getAddress())),s.strictEqual(c.systemRole,"PIERCE"),o("generatePierceDmz piercings.length: ",r.length),r.requests.forEach((function(e){var t=e.getRequest();c=b.txRequest(c,t)})),r.replies.forEach((function(e){s(e.getAddress().equals(c.address));var t=e.getReply(),n=e.getIndex();c=b.txReply(c,t,n)})),network=a({},i.network,{"@@PIERCE_TARGET":c}),i=f.clone(a({},i,{network:network})),i}}),assignHasPierced:c({hasPierced:function(){return!0}}),openPierceChannel:c({dmz:function(e,t){var n=e.dmz;o("openPierceChannel");var r=t.data.pierceBlock;s(d.isModel(r)),s(f.isModel(n));var i=r.provenance.getAddress(),c=n.network[".@@io"]||l.create(i,"PIERCE");c.address.isUnknown()&&(c=b.setAddress(c,i));var u=c.address;s(u.equals(i)),s.strictEqual(c.systemRole,"PIERCE");var p=a({},n.network,{".@@io":c});return f.clone(a({},n,{network:p}))}}),ingestPierceBlock:c({dmz:function(e,t){var n=e.dmz;o("ingestPierceBlock");var r=t.data.pierceBlock;s(d.isModel(r)),s(f.isModel(n));var i=p.create(r,"@@PIERCE_TARGET"),c=k.ingestInterblocks(n.network,[i],n.config);return s(i.equals(c[".@@io"].heavy)),f.clone(a({},n,{network:c}))}}),unassignContainerId:c({containerId:function(){return""}})},guards:{isDmzChangeable:function(e){var t=e.lock;s(v.isModel(t)),s(t.block);var n=R(e)&&t.isPiercingsPresent(),r=E(e)||n;return o("isDmzChangeable: ".concat(r)),r},isReduceable:E,isPiercable:R,isPierceDmzChanged:function(e){var t=e.lock,n=e.pierceDmz;if(!n)return o("isPierceDmzChanged: ",n),!1;s(v.isModel(t)),s(t.block),s(f.isModel(n));var r=q(t.block).network["@@PIERCE_TARGET"],i=n.network["@@PIERCE_TARGET"].isTxGreaterThan(r);return o("isPierceDmzChanged: %o",i),i},isPierceChannelUnopened:function(e){var t=e.dmz;s(f.isModel(t));var n=t.network[".@@io"],r=n&&!n.address.isResolved();return o("isPierceChannelUnopened",r),r},isCovenantEffectable:function(e){var t=e.lock,n=e.dmz;s(v.isModel(t)),s(f.isModel(n));var r=l.create();t.block&&t.block.network[".@@io"]&&(r=t.block.network[".@@io"]);var i=(n.network[".@@io"]||r).getRequestIndices().filter((function(e){return!r.requests[e]})).length;return o("isCovenantEffectable",i),i}},services:{loadCovenant:function(){var e=i(r.mark((function e(t){var n,i,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.lock,i=t.isolation,s(v.isModel(n)),e.next=4,i.loadCovenant(n.block);case 4:return a=e.sent,o("loadCovenant containerId: ".concat(a.substring(0,9))),e.abrupt("return",{containerId:a});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),reduce:function(){var e=i(r.mark((function e(t){var n,i,a,c,u,l,p,d,h,v,g;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dmz,i=t.containerId,a=t.isolation,s(f.isModel(n)),s(n.rx()),c=n.rx(),u=c.event,l=c.channel,o("reduce: ",u.type),p=l.address,s(!p.isUnknown()),d=S(i,a.tick),h=w(d),v={type:"TICK",payload:{dmz:n,externalAction:u,address:p}},e.next=13,x(v,h);case 13:return g=e.sent,s(f.isModel(g)),e.abrupt("return",{nextDmz:g});case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),signPierceDmz:function(){var e=i(r.mark((function e(t){var n,i,c,u,l,p,g;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.pierceDmz,i=t.lock,s(f.isModel(n)),s(v.isModel(i)),c=i.block,s(c),u=O(c),o("signPierceDmz with previous: %O",!!u),l={},e.next=10,h.create(n,u,l,y);case 10:return p=e.sent,g=d.clone(a({},n,{provenance:p})),e.abrupt("return",{pierceBlock:g});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),unloadCovenant:function(){var e=i(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.containerId,i=t.isolation,o("unloadCovenant containerId: %o",n.substring(0,9)),e.next=4,i.unloadCovenant(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),q=function(e){var t=P.getValidatorEntry(),n=f.create({validators:t}),r=e.provenance.getAddress(),i=l.create(r,"PIERCE");if(e.network[".@@io"]&&e.network[".@@io"].address.isResolved()){var o=e.network[".@@io"],c=o.getRemote();s(c&&c.address.equals(r));var u=c.requests,d=c.replies,h=o.getRemoteRequestIndices(),v=h.length?h.pop()+1:0,g=a({},i,{requests:u,replies:d,requestsLength:v});i=l.clone(g);var y=p.create(e,".@@io");for(i=b.ingestPierceInterblock(i,y);i.rxReply();)i=b.shiftTxRequest(i)}var m=a({},n.network,{"@@PIERCE_TARGET":i});return f.clone(a({},n,{network:m}))},O=function(e){var t=e.network[".@@io"];if(t){var n=t.heavy.provenance;return s(h.isModel(n)),n}},S=function(e,t){return function(n,r,i){return t({containerId:e,state:n,action:r,accumulator:i,timeout:3e4})}};e.exports={isolatorConfig:function(e){o("isolatorConfig");var t=M.toFunctions(e);return A.withContext({isolation:t})}}},1749:function(e,t,n){var r=n(17),i=n(2),a=n(3),s=n(7),o=n(4),c=n(9)("interblock:config:interpreter"),u=n(21),l=u.txReplyModel,p=u.txRequestModel,d=u.rxReplyModel,h=u.rxRequestModel,f=u.addressModel,v=u.dmzModel,g=u.channelModel,y=u.reductionModel,m=u.pendingModel,k=n(71),b=k.networkProducer,x=k.pendingProducer,w=n(44),I=n(1750).machine,M=n(34),C=M["@@GLOBAL_HOOK"],P=M.resolve,E=(M.reject,M.isReplyFor,n(40).assign),R=I.withConfig({actions:{assignExternalAction:E({externalAction:function(e,t){var n=t.payload.externalAction;return n}}),assignDmz:E({dmz:function(e,t){var n=t.payload,r=n.dmz,i=n.address;return o(v.isModel(r)),o(r.network.getAlias(i)),r},initialPending:function(e,t){var n=t.payload.dmz;return o(v.isModel(n)),n.pending}}),assignAnvil:E({anvil:function(e,t){var n=t.payload,r=n.externalAction,i=n.address,a=r;o(h.isModel(a)||d.isModel(a)),o(f.isModel(i)),h.isModel(a)&&o(a.getAddress().equals(i));var s=i.getChainId();return c("interpreterConfig type: %o chainId: %o",a.type,s),a},address:function(e,t){var n=t.payload.address;return o(f.isModel(n)),o(n.isResolved()||n.isLoopback()),n}}),loadSelfAnvil:E({anvil:function(e){var t=e.dmz.network.rxSelf();return c("loadSelfAnvil anvil: %o",t.type),t},address:function(e){var t=e.dmz.network["."].address;return o(t.isLoopback()),c("loadSelfAnvil selfAddress: %o",t.getChainId()),t}}),assignResolve:E({reduceResolve:function(e,t){var n=e.dmz,r=e.anvil;o(v.isModel(n));var i=t.data.reduceResolve;o(i);i.reduction;var a=i.isPending;i.requests,i.replies;return c("assignResolve pending: %o",a),y.create(i,r,n)}}),assignRejection:E({reduceRejection:function(e,t){return t.data}}),respondRejection:E({dmz:function(e){var t=e.dmz,n=e.anvil,r=e.reduceRejection;o(v.isModel(t));var i=b.respondRejection(t.network,n,r);return v.clone(s({},t,{network:i}))}}),assignDirectCovenantAction:E({covenantAction:function(e){var t=e.dmz,n=e.anvil;return o(v.isModel(t)),o(h.isModel(n)||d.isModel(n)),o(!t.pending.getIsPending()),o(!t.pending.getAccumulator().length),n}}),bufferRequest:E({dmz:function(e){var t=e.dmz,n=e.anvil;o(v.isModel(t)),o(h.isModel(n)),c("bufferRequest: ",n.type);var r=x.bufferRequest(t.pending,n);return v.clone(s({},t,{pending:r}))}}),accumulateReply:E({dmz:function(e){var t=e.dmz,n=e.anvil;o(v.isModel(t)),o(d.isModel(n)),c("accumulateReply: ",n.type);var r=x.pushReply(t.pending,n);return v.clone(s({},t,{pending:r}))}}),shiftCovenantAction:E({covenantAction:function(e){var t=e.dmz,n=e.anvil;o(v.isModel(t)),o(d.isModel(n));var r=t.pending;o(r.getIsPending());var i=r.pendingRequest;return o(h.isModel(i)),c("shiftCovenantAction: ",i.type),i}}),mergeSystemState:E({dmz:function(e){var t=e.dmz,n=e.reduceResolve;return o(v.isModel(t)),o(y.isModel(n)),c("mergeSystemState"),v.clone(n.reduction)}}),deduplicatePendingReplyTx:E({reduceResolve:function(e){var t=e.dmz,n=e.reduceResolve;o(v.isModel(t)),o(y.isModel(n));var r=n.requests,i=n.replies;return r=r.filter((function(e){o(p.isModel(e));var n=t.network[e.to];if(!n)return!0;var r=e.getRequest();return!Object.values(n.requests).some((function(e){return r.equals(e)}))})),i=i.filter((function(e){o(l.isModel(e));var n=e.getAddress(),r=e.getIndex(),i=t.network.getAlias(n);if(!i)return!0;var a=t.network[i].replies[r];return!e.getReply().equals(a)})),c("deduplicatePendingReplyTx dedupes: ",n.requests.length-r.length),y.clone(s({},n,{requests:r,replies:i}))}}),transmit:E({dmz:function(e){var t=e.dmz,n=e.reduceResolve;o(v.isModel(t)),o(y.isModel(n));var r=n.requests,i=n.replies;c("transmit req: %o rep %o",r,i);var a=b.tx(t.network,r,i);return v.clone(s({},t,{network:a}))},isExternalPromise:function(e){var t=e.isExternalPromise,n=e.externalAction,r=e.reduceResolve;if(t)return t;o(y.isModel(r));var i=r.replies;return d.isModel(n)?(c("transmit isExternalPromise",!1),!1):(o(h.isModel(n)),t=i.some((function(e){return e.getReply().isPromise()&&e.request.sequence===n.sequence})),c("transmit isExternalPromise",t),t)},isOriginPromise:function(e){var t=e.isOriginPromise,n=e.initialPending,r=e.reduceResolve;if(t||!n.getIsPending())return c("transmit isOriginPromise",t),t;o(m.isModel(n)),o(y.isModel(r));var i=r.replies,a=n.pendingRequest;return t=i.some((function(e){return e.getReply().isPromise()&&e.request.sequence===a.sequence})),c("transmit isOriginPromise",t),t}}),settleOrigin:E({dmz:function(e){var t=e.initialPending,n=e.dmz;o(m.isModel(t)),o(t.getIsPending()),o(v.isModel(n)),o(!n.pending.getIsPending());var r=t.pendingRequest;o(h.isModel(r)),c("settleOrigin",r);var i=r.sequence,a=l.create("@@RESOLVE",{},i),u=b.tx(n.network,[],[a]);return v.clone(s({},n,{network:u}))}}),rejectOriginRequest:E({dmz:function(e){var t=e.dmz,n=e.anvil,r=e.reduceRejection,i=e.covenantAction;o(v.isModel(t)),o(d.isModel(n)),o(h.isModel(i)),o.strictEqual(typeof r,"object"),c("rejectOriginRequest",n.type,r);var a=i.sequence,u=l.create("@@REJECT",r,a),p=b.tx(t.network,[],[u]);return v.clone(s({},t,{network:p}))}}),warnReplyRejection:function(e){var t=e.reduceRejection;c("warnReplyRejection"),console.warn("Warning: rejection occured during reply"),console.warn(t)},raisePending:E({dmz:function(e){var t=e.dmz,n=e.anvil;o(v.isModel(t)),o(h.isModel(n)),o(!t.pending.getIsPending()),c("raisePending",n.type);var r=x.raisePending(t.pending,n);return v.clone(s({},t,{pending:r}))}}),assignInitialPending:E({initialPending:function(e){var t=e.dmz;return o(v.isModel(t)),o(t.pending.getIsPending()),c("assignInitialPending"),t.pending}}),promiseAnvil:E({dmz:function(e){var t=e.dmz,n=e.anvil;o(v.isModel(t)),o(h.isModel(n)),c("promiseanvil",n.type);var r=n.sequence,i=l.create("@@PROMISE",{},r),a=b.tx(t.network,[],[i]);return v.clone(s({},t,{network:a}))}}),promiseOriginRequest:E({dmz:function(e){var t=e.dmz,n=e.anvil,r=e.covenantAction;o(v.isModel(t)),o(h.isModel(n)),o(!r||n.equals(r));var i=n.sequence,a=l.create("@@PROMISE",{},i),u=b.tx(t.network,[],[a]);return c("promiseOriginRequest",n.type),v.clone(s({},t,{network:u}))},isExternalPromise:function(){return!0}}),settlePending:E({dmz:function(e){var t=e.dmz;o(v.isModel(t)),o(t.pending.getIsPending()),c("settlePending");var n=x.settle(t.pending);return v.clone(s({},t,{pending:n}))}}),mergeState:E({dmz:function(e){var t=e.dmz,n=e.reduceResolve;return o(v.isModel(t)),o(y.isModel(n)),c("mergeState"),v.clone(s({},t,{state:n.reduction}))}}),respondReply:E({dmz:function(e){var t=e.dmz,n=e.address;o(v.isModel(t));var r=t.network["."];o(g.isModel(r)),o(f.isModel(n)),c("respondReply");var i=b.respondReply(t.network,n,r);return v.clone(s({},t,{network:i}))}}),respondRequest:E({dmz:function(e){var t=e.externalAction,n=e.dmz,r=e.address,i=e.anvil;c("respondRequest"),o(v.isModel(n)),o(h.isModel(i)),o(i.getAddress().equals(r)),o(!i.equals(t));var a=b.respondRequest(n.network,i);return v.clone(s({},n,{network:a}))}}),shiftBufferedRequests:E({dmz:function(e){var t=e.dmz;o(v.isModel(t)),c("shiftBufferedRequests");var n=x.shiftRequests(t.pending,t.network);return v.clone(s({},t,{pending:n}))}}),defaultResolve:E({dmz:function(e){var t=e.dmz,n=e.externalAction;c("defaultResolve"),o(v.isModel(t)),o(h.isModel(n));var r=n.sequence,i=l.create("@@RESOLVE",{},r),a=b.tx(t.network,[],[i]);return v.clone(s({},t,{network:a}))}}),openPaths:E({dmz:function(e){var t=e.dmz;o(v.isModel(t)),c("openPaths");var n=w.openPaths(t.network);return v.clone(s({},t,{network:n}))}})},guards:{isSelfExhausted:function(e){var t=!e.dmz.network.rxSelf();return c("isSelfExhausted: ".concat(t)),t},isSystem:function(e){var t=e.anvil;o(h.isModel(t)||d.isModel(t));var n=w.isSystemReply(t)||w.isSystemRequest(t);return c("isSystem: ".concat(n)),n},isExternalAction:function(e){var t=e.externalAction,n=e.anvil,r=e.address;o(h.isModel(n)||d.isModel(n)),o(f.isModel(r));var i=!r.isLoopback();return o(!i||t.equals(n)),c("isExternalAction",i),i},isPending:function(e){var t=e.dmz.pending.getIsPending();return c("isPending",t),t},isReductionPending:function(e){var t=e.reduceResolve;o(y.isModel(t));var n=t.getIsPending();return c("isReductionPending",n),n},isChannelUnavailable:function(e){var t=e.dmz,n=e.address;o(f.isModel(n),"If Anvil, then address required"),o(!n.isUnknown(),"Address unknown");var r=t.network.getAlias(n);return c("isChannelUnavailable: ",!r),!r},isReply:function(e){var t=e.anvil,n=d.isModel(t);return n||o(h.isModel(t)),c("isReply: %o",n),n},isAnvilPromised:function(e){var t=e.dmz,n=e.anvil;o(v.isModel(t)),o(h.isModel(n));var r=t.network.getResponse(n),i=r&&r.isPromise();return c("isAnvilPromised",i),i},isUnbuffered:function(e){var t=e.dmz,n=e.covenantAction;o(v.isModel(t)),o(h.isModel(n));var r=!t.pending.getIsBuffered(n);return c("isUnbuffered",r),r},isLoopbackResponseDone:function(e){var t=e.dmz,n=e.anvil,r=e.address;o(v.isModel(t)),o(h.isModel(n)),o(n.getAddress().equals(r)),o(r.isLoopback());var i=!!t.network.getResponse(n);return c("isLoopbackResponseDone: %o anvil: %o",i,n.type),i},isOriginSettled:function(e){var t=e.initialPending,n=e.dmz;if(o(m.isModel(t)),o(v.isModel(n)),!t.getIsPending())return c("isOriginSettled",!0),!0;var r=t.pendingRequest;o(h.isModel(r));var i=n.network.getResponse(r),a=i&&!i.isPromise();return c("isOriginSettled",a),a},isPendingUnlowered:function(e){var t=e.initialPending,n=e.dmz;o(m.isModel(t)),o(v.isModel(n));var r=!(t.getIsPending()&&!n.pending.getIsPending());return c("isPendingUnlowered",r),r},isTxOriginPromise:function(e){var t=e.isOriginPromise;return c("isTxOriginPromise",t),t},isExternalActionReply:function(e){var t=e.externalAction,n=d.isModel(t);return c("isExternalActionReply",n),n},isExternalActionSettled:function(e){var t=e.dmz,n=e.externalAction;o(v.isModel(t)),o(h.isModel(n));var r=t.network.getResponse(n),i=r&&!r.isPromise();return c("isExternalActionSettled",i),i},isTxExternalActionPromise:function(e){var t=!!e.isExternalPromise;return c("isTxExternalActionPromise",t),t}},services:{reduceSystem:function(){var e=a(i.mark((function e(t){var n,s,u,l,p,f,g,y;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.dmz,s=t.anvil,o(v.isModel(n)),o(h.isModel(s)||d.isModel(s)),c("reduceSystem anvil: %o",s.type),u=function(){return w.reducer(n,s)},l=[];case 6:return e.next=8,C(u,l);case 8:return p=e.sent,f=p.requests.filter((function(e){return e.inBand})),g=f.map(function(){var e=a(i.mark((function e(t){var n,r;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c("inband execution of: ",t.type),e.next=3,t.exec();case 3:return n=e.sent,r=P(n,t),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=13,Promise.all(g);case 13:y=e.sent,c("inband awaits results: ",y.length),l.push.apply(l,r(y));case 16:if(f.length){e.next=6;break}case 17:return c("result isPending: ",p.isPending),o(p,"System returned: ".concat(p)),o(!p.isPending,"System can never raise pending"),e.abrupt("return",{reduceResolve:p});case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),reduceCovenant:function(){var e=a(i.mark((function e(t){var n,r,a,s,u,l,p,f;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dmz,r=t.covenantAction,a=t.isolatedTick,c("reduceCovenant: %o",r.type),s=d.isModel(r),u=h.isModel(r),o(s||u),l=n.state,p=n.pending.getAccumulator(),e.next=9,a(l,r,p);case 9:return f=e.sent,o(f,"Covenant returned: ".concat(f)),c("reduceCovenant result pending: ",f.isPending),e.abrupt("return",{reduceResolve:f});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}});e.exports={interpreterConfig:function(e){return o("function"===typeof e),R.withContext({isolatedTick:e})}}},1750:function(e,t,n){var r={id:"interpreter",initial:"idle",context:{isolatedTick:void 0,externalAction:void 0,anvil:void 0,address:void 0,dmz:void 0,initialPending:void 0,covenantAction:void 0,reduceRejection:void 0,reduceResolve:void 0,isExternalPromise:void 0,isOriginPromise:void 0},strict:!0,states:{idle:{on:{TICK:{target:"interpret",actions:["assignExternalAction","assignDmz","assignAnvil"]}}},loopback:{always:[{target:"autoResolves",cond:"isSelfExhausted"},{target:"interpret",actions:"loadSelfAnvil"}]},interpret:{always:[{target:"interpretSystem",cond:"isSystem"},{target:"interpretCovenant"}]},interpretSystem:{initial:"reduceSystem",states:{reduceSystem:{invoke:{src:"reduceSystem",onDone:{target:"merge",actions:"assignResolve"},onError:{target:"respondRejection",actions:"assignRejection"}}},respondRejection:{entry:"respondRejection",always:"done"},merge:{entry:["mergeSystemState","transmit"],always:[{target:"done",cond:"isChannelUnavailable"},{target:"respondReply",cond:"isReply"},{target:"respondRequest"}]},respondReply:{entry:"respondReply",always:"done"},respondRequest:{always:[{target:"done",cond:"isExternalAction"},{target:"done",cond:"isLoopbackResponseDone"},{target:"done",actions:"respondRequest"}]},done:{type:"final"}},onDone:"loopback"},interpretCovenant:{initial:"isPending",states:{isPending:{always:[{target:"pending",cond:"isPending"},{target:"direct"}]},pending:{initial:"isReply",states:{isReply:{always:[{target:"reducePendingReply",cond:"isReply"},{target:"bufferRequest"}]},bufferRequest:{entry:"bufferRequest",always:[{target:"done",cond:"isAnvilPromised"},{target:"done",actions:"promiseAnvil"}]},reducePendingReply:{entry:["accumulateReply","shiftCovenantAction"],invoke:{src:"reduceCovenant",onDone:{target:"deduplicatePendingReplyTx",actions:"assignResolve"},onError:{target:"rejectPending",actions:"assignRejection"}},exit:"respondReply"},deduplicatePendingReplyTx:{entry:"deduplicatePendingReplyTx",always:"transmit"},transmit:{entry:"transmit",always:[{target:"done",cond:"isReductionPending"},{target:"resolvePending"}]},rejectPending:{entry:["rejectOriginRequest","settlePending"],always:"done"},resolvePending:{entry:["settlePending","mergeState"],always:"done"},done:{type:"final"}},onDone:"done"},direct:{initial:"isReply",states:{isReply:{entry:"assignDirectCovenantAction",always:[{target:"reply",cond:"isReply"},{target:"request"}]},reply:{initial:"reduce",states:{reduce:{invoke:{src:"reduceCovenant",onDone:{target:"isPending",actions:"assignResolve"},onError:{target:"reject",actions:"assignRejection"}}},isPending:{always:[{target:"reject",cond:"isReductionPending",actions:"assignRejectionFromReply"},{target:"transmit"}]},transmit:{entry:"transmit",always:"done"},reject:{entry:"warnReplyRejection",always:"done"},done:{entry:"respondReply",type:"final"}},onDone:"done"},request:{initial:"reduce",states:{reduce:{invoke:{src:"reduceCovenant",onDone:{target:"transmit",actions:"assignResolve"},onError:{target:"reject",actions:"assignRejection"}}},transmit:{entry:"transmit",always:[{target:"raisePending",cond:"isReductionPending"},{target:"respondRequest"}]},respondRequest:{entry:"mergeState",always:[{target:"isUnbuffered",cond:"isExternalAction"},{target:"isUnbuffered",cond:"isLoopbackResponseDone"},{target:"isUnbuffered",actions:"respondRequest"}]},raisePending:{entry:["raisePending","promiseOriginRequest","assignInitialPending"],always:"isUnbuffered"},reject:{entry:"respondRejection",always:"isUnbuffered"},isUnbuffered:{always:[{target:"done",cond:"isUnbuffered"},{target:"done",actions:"shiftBufferedRequests"}]},done:{type:"final"}},onDone:"done"},done:{type:"final"}},onDone:"done"},done:{type:"final"}},onDone:"loopback"},autoResolves:{initial:"settleOrigin",states:{settleOrigin:{always:[{target:"settleExternalAction",cond:"isOriginSettled"},{target:"settleExternalAction",cond:"isPendingUnlowered"},{target:"settleExternalAction",cond:"isTxOriginPromise"},{target:"settleExternalAction",actions:"settleOrigin"}]},settleExternalAction:{always:[{target:"done",cond:"isExternalActionReply"},{target:"done",cond:"isExternalActionSettled"},{target:"done",cond:"isTxExternalActionPromise"},{target:"done",actions:"defaultResolve"}]},done:{type:"final"}},onDone:"done"},done:{entry:"openPaths",id:"done",data:function(e){return e.dmz},type:"final"}}},i=Machine(r);e.exports={definition:r,machine:i}},1751:function(e,t,n){var r={id:"isolator",initial:"idle",context:{lock:void 0,dmz:void 0,containerId:void 0,isolation:function(){return"isolation function"},pierceDmz:void 0,hasPierced:!1},strict:!0,states:{idle:{on:{EXECUTE_COVENANT:{target:"isDmzChangeable",actions:["assignLock","primeDmz"]}}},isDmzChangeable:{always:[{target:"loadCovenant",cond:"isDmzChangeable"},{target:"done"}]},loadCovenant:{invoke:{src:"loadCovenant",onDone:{target:"isReduceable",actions:"assignContainerId"},onError:"error"}},isReduceable:{always:[{target:"reduce",cond:"isReduceable"},{target:"pierce",cond:"isPiercable"},{target:"isCovenantUnloadable"}]},reduce:{invoke:{src:"reduce",onDone:{target:"isReduceable",actions:"updateDmz"},onError:"error"}},pierce:{initial:"generatePierceDmz",states:{generatePierceDmz:{entry:["assignHasPierced","generatePierceDmz"],always:[{target:"signPierceDmz",cond:"isPierceDmzChanged"},{target:"signPierceDmz",cond:"isPierceChannelUnopened"},{target:"done"}]},signPierceDmz:{invoke:{src:"signPierceDmz",onDone:{target:"done",actions:["openPierceChannel","ingestPierceBlock"]}}},done:{type:"final"}},onDone:"isReduceable"},isCovenantUnloadable:{always:[{target:"done",cond:"isCovenantEffectable"},{target:"unloadCovenant"}]},unloadCovenant:{invoke:{src:"unloadCovenant",onDone:{target:"done",actions:"unassignContainerId"},onError:"error"}},done:{data:function(e){return{dmz:e.dmz,containerId:e.containerId}},type:"final"},error:{type:"final"}}},i=Machine(r);e.exports={definition:r,machine:i}},1752:function(e,t,n){var r=n(2),i=n(3),a=n(17),s=n(7),o=n(4),c=n(9)("interblock:config:pool"),u=(n(24),n(40).assign),l=n(1753).machine,p=n(21),d=p.channelModel,h=p.networkModel,f=p.blockModel,v=p.lockModel,g=p.interblockModel,y=p.addressModel,m=p.dmzModel,k=p.covenantIdModel,b=p.publicKeyModel,x=(p.provenanceModel,n(71)),w=x.blockProducer,I=x.lockProducer,M=x.channelProducer,C=x.networkProducer,P=w.generateNext,E=n(53),R=n(113);e.exports={poolConfig:function(e,t){var n=E.toFunctions(t),p=R.toFunctions(e);return l.withConfig({actions:{assignInterblock:u({interblock:function(e,t){var n=t.payload;return o(g.isModel(n)),n}}),assignLock:u({lock:function(e,t){return o(v.isModel(t.data)),t.data}}),assignDmz:u({dmz:function(e){var t=e.lock;o(v.isModel(t));var n=t.block&&t.block.getDmz();return n}}),assignNextBlock:u({nextBlock:function(e){var t=e.lock;return o(v.isModel(t)),t.block}}),mergeGenesis:u({nextBlock:function(e){var t=e.lock,n=e.interblock;c("mergeGenesis"),o(v.isModel(t)),o(g.isModel(n));var r=n.extractGenesis();return r}}),connectToParent:u({dmz:function(e){var t=e.interblock,n=e.dmz;c("connectToParent");var r=t.provenance.getAddress(),i=n.network[".."];i=M.setAddress(i,r);var a=s({},n.network,{"..":i});return m.clone(s({},n,{network:a}))}}),ingestParentLineage:u({dmz:function(e,t){var n=e.dmz,r=t.data;o(Array.isArray(r)),o(r.every(g.isModel)),c("ingestParentLineage length: ".concat(r.length));var i=C.ingestInterblocks(n.network,r,n.config);return n=m.clone(s({},n,{network:i}))}}),mergeBlockToLock:u({lock:function(e){var t=e.lock,n=e.nextBlock;return o(v.isModel(t)),o(f.isModel(n)),c("mergeBlockToLock increased: ".concat(!n.equals(t.block))),I.reconcile(t,n)}}),assignInitializedAddress:u({affectedAddresses:function(e){return[e.lock.block.provenance.getAddress()]}}),assignGeneratedBlock:u({nextBlock:function(e,t){return o(f.isModel(t.data)),c("assignGeneratedBlock"),t.data}}),unassignLock:u({lock:function(){}}),createBaseDmz:u({baseDmz:function(e){var t=e.validators,n=k.create("hyper"),r=y.create("ROOT"),i=d.create(r),a=s({},h.create(),{"..":i});return m.create({covenantId:n,validators:t,network:a,config:{isPierced:!0,isPublicChannelOpen:!0}})}}),assignValidatorKey:u({validators:function(e,t){c("assignValidatorKey: %o",t.data);var n=Object.values(t.data)[0];return o(b.isModel(n)),t.data}}),assignAffectedAddresses:u({affectedAddresses:function(e,t){var n=e.affectedAddresses;c("assignAffectedAddresses");var r=t.data;return o(Array.isArray(r)),[].concat(a(r),a(n))}}),assignConnectionAttempt:u({affectedAddresses:function(e){var t=e.interblock,n=e.affectedAddresses;o(Array.isArray(n)),o(g.isModel(t));var r=t.getTargetAddress();return[].concat(a(n),[r])}})},guards:{isStorageEmpty:function(e,t){var n=t.data.isStorageEmpty;return c("isStorageEmpty: ".concat(n)),n},isInitialConditions:function(e){return!!e.baseDmz},isGenesis:function(e){var t=e.interblock;o(g.isModel(t));var n=!1;try{t.extractGenesis(),n=!0}catch(r){}return c("isGenesis: ".concat(n)),n},isOriginPresent:function(e,t){var n=t.data;return o("boolean"===typeof n),c("isOriginPresent: ".concat(n)),n},isLockFailed:function(e,t){var n=!t.data&&!v.isModel(t.data);return c("isLockFailed: ".concat(n)),n},isBirthingCompleted:function(e){var t=e.lock;o(v.isModel(t));var n=t.block&&t.block.provenance.height>=1;return c("isBirthingCompleted: ".concat(n)),n},verifyLineage:function(e,t){var n=e.interblock,r=t.data;return o(r.length),o.strictEqual(n.getChainId(),r[0].getChainId()),o(!r[0].provenance.height),c("verifyLineage"),!0},isLockForGenesis:function(e){var t=e.lock;o(v.isModel(t));var n=t.block,r=n&&n.provenance.address.isGenesis();return c("isLockForGenesis: ".concat(r)),r},isLockForBirthBlock:function(e){var t=e.lock;o(v.isModel(t));var n=t.block,r=n&&1===n.provenance.height;return c("isLockForBirthBlock: ".concat(r)),r},isConnectionAttempt:function(e){return e.interblock.isConnectionAttempt()},isConnectable:function(e,t){return t.data}},services:{isStorageEmpty:function(){var e=i(r.mark((function e(){var t,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0,e.next=3,n.getBlock({address:void 0});case 3:return t=e.sent,c("isStorageEmpty: ".concat(i=!t)),e.abrupt("return",{isStorageEmpty:i});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),checkIsOriginPresent:function(){var e=i(r.mark((function e(t){var i,a,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.interblock,a=i.provenance.getAddress(),e.next=4,n.getIsPresent(a);case 4:return s=e.sent,c("checkIsOriginPresent: %O",!!s),e.abrupt("return",!!s);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),lockChildChain:function(){var e=i(r.mark((function e(t){var i,a,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.interblock,o(g.isModel(i)),a=i.extractGenesis().provenance.getAddress(),e.next=5,n.putLockChain(a);case 5:return s=e.sent,c("lockChildChain: ".concat(!!s)),e.abrupt("return",s);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchParentLineage:function(){var e=i(r.mark((function e(t){var i,a,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.interblock,o(g.isModel(i)),a=i.provenance,e.next=5,n.getLineage({provenance:a});case 5:return s=e.sent,o(Array.isArray(s)),o(s.every(g.isModel)),o.strictEqual(s[0].provenance.height,0),c("fetchParentLineage length: ".concat(s.length)),e.abrupt("return",s);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),generateBirthBlock:function(){var e=i(r.mark((function e(t){var n,i,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dmz,i=t.lock,o(m.isModel(n)),o(v.isModel(i)),c("generateBirthBlock"),e.next=6,P(n,i.block,p.sign);case 6:return a=e.sent,e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),unlockChain:function(){var e=i(r.mark((function e(t){var i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.lock,o(v.isModel(i)),c("unlockChain"),e.next=5,n.putUnlockChain(i);case 5:return e.abrupt("return");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),poolBirthBlock:function(){var e=i(r.mark((function e(t){var i,a,s,c,u;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.lock,o(v.isModel(i)),a=i.block,o(a),o(1===a.provenance.height),s=a.network[".."].address,o(s.isResolved()),c=g.create(a),u=[s],e.next=11,n.putPoolInterblock({affectedAddresses:u,interblock:c});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchValidatorKey:function(){var e=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c("fetchValidatorKey"),e.next=3,p.getValidatorEntry();case 3:return t=e.sent,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),signBlock:function(){var e=i(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.baseDmz,c("signBlock"),e.next=4,f.create(n,p.sign);case 4:return i=e.sent,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),lockBaseChain:function(){var e=i(r.mark((function e(t){var i,a,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.nextBlock,c("lockBaseChain"),a=i.provenance.getAddress(),e.next=5,n.putLockChain(a);case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchAffectedAddresses:function(){var e=i(r.mark((function e(t){var i,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.interblock,e.next=3,n.getAffected(i);case 3:return a=e.sent,c("fetchAffectedAddresses: ".concat(a.length)),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),isConnectable:function(){var e=i(r.mark((function e(t){var i,a,s,u;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.interblock,o(g.isModel(i)),a=i.getTargetAddress(),o(a),e.next=6,n.getBlock({address:a});case 6:return(s=e.sent)&&o(f.isModel(s)),u=s&&s.config.isPublicChannelOpen,c("isConnectable: ",u),e.abrupt("return",u);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),storeInPools:function(){var e=i(r.mark((function e(t){var i,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.interblock,a=t.affectedAddresses,o(Array.isArray(a)),o(g.isModel(i)),c("storeInPools"),e.next=6,n.putPoolInterblock({affectedAddresses:a,interblock:i});case 6:c("storeInPools completed on ".concat(a.length," items"));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}})}}},1753:function(e,t,n){var r={id:"pool",initial:"idle",context:{interblock:void 0,lock:void 0,dmz:void 0,nextBlock:void 0,affectedAddresses:[],baseDmz:void 0,validators:void 0},strict:!0,states:{idle:{on:{POOL_INTERBLOCK:{target:"initializeStorage",actions:"assignInterblock"}}},done:{id:"done",data:function(e){return e.affectedAddresses},type:"final"},initializeStorage:{initial:"isStorageEmpty",states:{isStorageEmpty:{invoke:{src:"isStorageEmpty",onDone:[{target:"fetchValidatorKey",cond:"isStorageEmpty"},{target:"done"}]}},fetchValidatorKey:{invoke:{src:"fetchValidatorKey",onDone:{target:"createBaseBlock",actions:"assignValidatorKey"}}},createBaseBlock:{entry:"createBaseDmz",invoke:{src:"signBlock",onDone:{target:"lockBaseChain",actions:"assignGeneratedBlock"}}},lockBaseChain:{invoke:{src:"lockBaseChain",onDone:{target:"unlockChain",actions:"assignLock"}}},unlockChain:{entry:"mergeBlockToLock",invoke:{src:"unlockChain",onDone:{target:"done",actions:"assignInitializedAddress"}}},done:{type:"final"}},onDone:[{target:"done",cond:"isInitialConditions"},{target:"poolInterblock"}]},poolInterblock:{initial:"isGenesis",states:{isGenesis:{always:[{target:"birthChild",cond:"isGenesis"},{target:"poolAffectedChains"}]},poolAffectedChains:{initial:"fetchAffectedAddresses",states:{fetchAffectedAddresses:{invoke:{src:"fetchAffectedAddresses",onDone:{target:"isConnectionAttempt",actions:"assignAffectedAddresses"}}},isConnectionAttempt:{always:[{target:"isConnectable",cond:"isConnectionAttempt"},{target:"storeInPools"}]},isConnectable:{invoke:{src:"isConnectable",onDone:[{target:"storeInPools",cond:"isConnectable",actions:"assignConnectionAttempt"},{target:"storeInPools"}]}},storeInPools:{invoke:{src:"storeInPools",onDone:{target:"done"}}},done:{type:"final"}},onDone:"done"},done:{type:"final"},birthChild:{initial:"checkIsOriginPresent",states:{checkIsOriginPresent:{invoke:{src:"checkIsOriginPresent",onDone:[{target:"lockChildChain",cond:"isOriginPresent"},{target:"done"}]}},done:{type:"final"},lockChildChain:{entry:"unassignLock",invoke:{src:"lockChildChain",onDone:[{target:"done",cond:"isLockFailed"},{target:"increaseChain"}]}},increaseChain:{entry:["assignLock","assignDmz","assignNextBlock"],always:[{target:"unlockChain",cond:"isBirthingCompleted"},{target:"fetchParentLineage",cond:"isLockForGenesis"},{target:"mergeGenesis"}]},mergeGenesis:{entry:"mergeGenesis",always:"unlockChain"},fetchParentLineage:{entry:"connectToParent",invoke:{src:"fetchParentLineage",onDone:{target:"generateBirthBlock",cond:"verifyLineage"}},exit:"ingestParentLineage"},generateBirthBlock:{invoke:{src:"generateBirthBlock",onDone:{target:"unlockChain",actions:"assignGeneratedBlock"}}},unlockChain:{entry:"mergeBlockToLock",invoke:{src:"unlockChain",onDone:[{target:"lockChildChain",cond:"isLockForGenesis"},{target:"poolBirthBlock",cond:"isLockForBirthBlock"},{target:"done"}]}},poolBirthBlock:{invoke:{src:"poolBirthBlock",onDone:"done"}}},onDone:"poolAffectedChains"}},onDone:"done"},error:{id:"error",type:"final"}}},i=Machine(r);e.exports={definition:r,machine:i}},1754:function(e,t,n){var r=n(2),i=n(3),a=n(4),s=n(9)("interblock:config:receive"),o=(n(24),n(40).assign),c=n(21),u=(c.lockModel,c.addressModel,c.txModel),l=c.blockModel,p=c.interblockModel,d=n(71),h=(d.blockProducer,d.lockProducer,d.networkProducer,n(1755).machine),f=n(53);e.exports={receiveConfig:function(e){var t=f.toFunctions(e);return h.withConfig({actions:{assignInterblock:o({interblock:function(e,t){var n=t.payload;return a(u.isModel(n)),n.interblock}}),assignSocket:o({socket:function(e,t){var n=t.payload;return a(u.isModel(n)),n.socket}}),assignIsPoolable:o({isPoolable:function(e,t){return!0}})},guards:{isInitialConditions:function(e,t){var n=t.data;return s("isInitialConditions: ".concat(n)),n},isPoolable:function(e,t){var n=t.data;return a("boolean"===typeof n),s("isPoolable: ".concat(n)),n},isConnectionAttempt:function(e){return e.interblock.isConnectionAttempt()},isConnectable:function(e,t){return t.data}},services:{isInitialConditions:function(){var e=i(r.mark((function e(){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0,e.next=3,t.getBlock({address:void 0});case 3:return n=e.sent,s("isInitialConditions: ".concat(!n)),e.abrupt("return",!n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),isAnyAffected:function(){var e=i(r.mark((function e(n){var i,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,e.next=3,t.getIsAnyAffected(i);case 3:return a=e.sent,s("isAnyAffected: ".concat(a)),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),isConnectable:function(){var e=i(r.mark((function e(n){var i,o,c,u;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,a(p.isModel(i)),o=i.getTargetAddress(),a(o),e.next=6,t.getBlock({address:o});case 6:return(c=e.sent)&&a(l.isModel(c)),u=c&&c.config.isPublicChannelOpen,s("isConnectable: ",u),e.abrupt("return",u);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),storeConnection:function(){var e=i(r.mark((function e(n){var i,a,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,a=n.socket,s("storeConnection"),o=i.provenance.getAddress(),e.next=5,t.putSocket({address:o,socket:a});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}})}}},1755:function(e,t,n){var r={id:"receive",initial:"idle",context:{socket:void 0,interblock:void 0,isPoolable:!1,isCatchupable:!1},strict:!0,states:{idle:{on:{RECEIVE_INTERBLOCK:{target:"isInitialConditions",actions:["assignInterblock","assignSocket"]}}},isInitialConditions:{invoke:{src:"isInitialConditions",onDone:[{target:"done",actions:"assignIsPoolable",cond:"isInitialConditions"},{target:"isAnyAffected"}]}},isAnyAffected:{invoke:{src:"isAnyAffected",onDone:[{target:"storeConnection",actions:"assignIsPoolable",cond:"isPoolable"},{target:"isConnectable",cond:"isConnectionAttempt"},{target:"done"}]}},storeConnection:{invoke:{src:"storeConnection",onDone:"done"}},isConnectable:{invoke:{src:"isConnectable",onDone:[{target:"storeConnection",actions:"assignIsPoolable",cond:"isConnectable"},{target:"done"}]}},done:{data:function(e){return{isPoolable:e.isPoolable,isCatchupable:e.isCatchupable}},type:"final"},error:{id:"error",type:"final"}}},i=Machine(r);e.exports={definition:r,machine:i}},1756:function(e,t,n){var r=n(2),i=n(3),a=n(17),s=n(4),o=n(9)("interblock:config:transmit"),c=n(24),u=n(40).assign,l=n(21),p=l.interblockModel,d=l.blockModel,h=l.socketModel,f=l.txModel,v=l.addressModel,g=n(1757).machine,y=n(53);e.exports={transmitConfig:function(e){var t=y.toFunctions(e);return g.withConfig({actions:{assignInterblock:u({interblock:function(e,t){var n=t.payload;return o("assignInterblock"),s(p.isModel(n)),n}}),assignBlock:u({block:function(e,t){var n=t.data.block;return s(d.isModel(n)),n}}),extendListeningTxs:u({listeningTxs:function(e,t){var n=e.interblock,r=e.listeningTxs;o("extendListeningTxs");var i=t.data.sockets;s(i.every(h.isModel));var c=n.getWithoutRemote(),u=i.map((function(e){return f.create(e,c)}));return[].concat(a(r),a(u))}}),extendTargetTxs:u({targetTxs:function(e,t){var n=e.interblock,r=e.targetTxs;o("assignTargetTxs");var i=t.data;s(i.every(h.isModel));var c=i.map((function(e){return f.create(e,n)}));return[].concat(a(r),a(c))}}),assignLineage:u({lineage:function(e,t){return t.data}}),assignSelfTarget:u({targetTxs:function(e){var t=e.targetTxs,n=e.interblock,r=h.create(),i=f.create(r,n),s=[].concat(a(t),[i]);return o("assignSelfTarget targetTxs length: ".concat(s.length)),s}}),extendLineageTxs:u({lineageTxs:function(e){var t=e.targetTxs,n=e.lineage;o("extendLineageTxs"),s(n.every(p.isModel)),s(n.every((function(e){return!e.getTargetAddress()})));var r=[];return t.forEach((function(e){n.forEach((function(t){s(f.isModel(e));var n=e.socket;s(h.isModel(n)),r.push(f.create(n,t))}))})),o("extendLineageTxs generated ".concat(r.length," extensions")),r}}),extendGenesisAttempt:u({targetTxs:function(e){var t=e.interblock,n=e.targetTxs;s(p.isModel(t)),s(t.isGenesisAttempt());var r=f.create(h.create(),t);return n=[].concat(a(n),[r])}}),removeListeningTxs:u({listeningTxs:function(e){var t=e.listeningTxs,n=e.targetTxs;o("removeListeningTxs");var r=n.map((function(e){return e.socket})),i=t.filter((function(e){var t=e.socket;return!r.some((function(e){return e.equals(t)}))}));return o("filter removed: ".concat(r.length-i.length)),i}}),mergeTransmissions:u({transmissions:function(e){var t=e.listeningTxs,n=e.targetTxs,r=e.lineageTxs;return[].concat(a(t),a(r),a(n))}})},guards:{isBlockFetched:function(e,t){return d.isModel(t.data.block)},isLineageInterblock:function(e){return!e.interblock.getRemote()},isInitiatingAction:function(e){var t=e.interblock;s(p.isModel(t));var n=t.isConnectionResponse(),r=t.isConnectionResolve(),i=t.isDownlinkInit(),a=t.isUplinkInit();return n||r||i||a},isGenesisAttempt:function(e){return e.interblock.isGenesisAttempt()},isOriginPresent:function(e,t){return t.data.isOriginPresent}},services:{fetchBlock:function(){var e=i(r.mark((function e(n){var i,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,s(p.isModel(i)),e.next=4,t.getBlock(i.provenance);case 4:return a=e.sent,s(d.isModel(a)),s(a.provenance.equals(i.provenance)),o("fetchBlock height: ".concat(a.provenance.height)),e.abrupt("return",{block:a});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchRemoteListeners:function(){var e=i(r.mark((function e(n){var i,u,l,f,v,g,y,m;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,u=n.block,s(p.isModel(i)),s(!i.getRemote()),s(d.isModel(u)),l=u.network,f=l.getResolvedAliases().map((function(e){var n=l[e].address;return t.getSockets(n)})),e.next=8,Promise.all(f);case 8:return v=e.sent,g=c.flatten(v),y=new Set(g),o("fetchListeningSockets length: ".concat(y.size)),m=a(y),s(m.every(h.isModel)),e.abrupt("return",{sockets:m});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchSelfListener:function(){var e=i(r.mark((function e(n){var i,a,c,u,l,f,v;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,a=n.block,s(p.isModel(i)),s(d.isModel(a)),c=a.network,u=c.getResolvedAliases().map((function(e){var n=c[e].address;return t.getIsPresent(n)})),e.next=7,Promise.all(u);case 7:return l=e.sent,f=l.some((function(e){return e})),o("fetchSelfListener: ".concat(f)),v=f?[h.create()]:[],e.abrupt("return",{sockets:v});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchRemoteTargets:function(){var e=i(r.mark((function e(n){var i,a,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,s(p.isModel(i)),a=i.getTargetAddress(),s(v.isModel(a)),e.next=6,t.getSockets(a);case 6:return c=e.sent,o("fetchTargetSockets length: ".concat(c.length)),e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchSelfTarget:function(){var e=i(r.mark((function e(n){var i,a,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,s(p.isModel(i)),a=i.getTargetAddress(),s(a),e.next=6,t.getIsPresent(a);case 6:return c=e.sent,o("fetchSelfTarget: ".concat(c)),e.abrupt("return",c?[h.create()]:[]);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchLineageToGenesis:function(){var e=i(r.mark((function e(n){var i,a,c,u;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,s(p.isModel(i)),0,o("fetchLineage from height: ".concat(0)),a=i.provenance,c={provenance:a,height:0},e.next=8,t.getLineage(c);case 8:return u=e.sent,o("fetchLineage length: ".concat(u.length)),e.abrupt("return",u);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),isOriginPresent:function(){var e=i(r.mark((function e(n){var i,a,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,s(p.isModel(i)),a=i.provenance.getAddress(),e.next=5,t.getIsPresent(a);case 5:return c=e.sent,o("isOriginPresent: ",c),e.abrupt("return",{isOriginPresent:c});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}})}}},1757:function(e,t,n){var r={id:"transmit",initial:"idle",context:{interblock:void 0,listeningTxs:[],targetTxs:[],lineage:[],lineageTxs:[],transmissions:[]},strict:!0,states:{idle:{on:{TRANSMIT_INTERBLOCK:{target:"isLineageInterblock",actions:"assignInterblock"}}},done:{entry:["removeListeningTxs","mergeTransmissions"],data:function(e){return e.transmissions},type:"final"},isLineageInterblock:{always:[{target:"fetchLineageSockets",cond:"isLineageInterblock"},{target:"fetchTargetSockets"}]},fetchLineageSockets:{initial:"fetchBlock",states:{fetchBlock:{invoke:{src:"fetchBlock",onDone:[{target:"fetchListeners",actions:"assignBlock",cond:"isBlockFetched"},{target:"done"}]}},done:{type:"final"},fetchListeners:{type:"parallel",states:{fetchRemoteListeners:{initial:"promise",states:{promise:{invoke:{src:"fetchRemoteListeners",onDone:{target:"done",actions:"extendListeningTxs"}}},done:{type:"final"}}},fetchSelfListener:{initial:"promise",states:{promise:{invoke:{src:"fetchSelfListener",onDone:{target:"done",actions:"extendListeningTxs"}}},done:{type:"final"}}}},onDone:"done"}},onDone:"done"},fetchTargetSockets:{type:"parallel",states:{isGenesisAttempt:{initial:"isGenesisAttempt",states:{isGenesisAttempt:{always:[{target:"isOriginPresent",cond:"isGenesisAttempt"},{target:"done"}]},isOriginPresent:{invoke:{src:"isOriginPresent",onDone:[{target:"done",cond:"isOriginPresent",actions:"extendGenesisAttempt"},{target:"done"}]}},done:{type:"final"}}},fetchRemoteTargets:{initial:"promise",states:{promise:{invoke:{src:"fetchRemoteTargets",onDone:{target:"done",actions:"extendTargetTxs"}}},done:{type:"final"}}},fetchSelfTarget:{initial:"promise",states:{promise:{invoke:{src:"fetchSelfTarget",onDone:{target:"done",actions:"extendTargetTxs"}}},done:{type:"final"}}},addLineage:{initial:"isLineageRequired",states:{isLineageRequired:{always:[{target:"fetchLineageToGenesis",cond:"isInitiatingAction"},{target:"done"}]},fetchLineageToGenesis:{invoke:{src:"fetchLineageToGenesis",onDone:{target:"done",actions:"assignLineage"}}},done:{type:"final"}}}},onDone:{target:"done",actions:"extendLineageTxs"}}}},i=Machine(r);e.exports={definition:r,machine:i}},1758:function(e,t,n){var r=n(2),i=n(3),a=n(21),s=a.blockModel,o=a.interblockModel,c=function(){var e=i(r.mark((function e(t,n){var i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(n),e.next=3,l(t);case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),u=function(){var e=i(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.create();case 2:n=e.sent,i=o.create(n),t.push(i);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(e){var t,n=new Promise((function(e){return t=e})),a=e.subscribe(function(){var e=i(r.mark((function e(n,i){var s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("UNLOCK"!==n.type){e.next=6;break}return s=n.payload.block,e.next=4,i;case 4:t(s.provenance.getAddress()),a();case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());return n};e.exports={createBase:c}},1759:function(e,t,n){var r=n(4),i=n(24),a=(n(251),n(83),n(253)),s=n(254),o=s.blockPrint,c=s.interPrint,u=n(21),l=u.blockModel,p=u.interblockModel;e.exports={createTap:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"interblock:blocktap",t=!1,s=function(){return t=!0},u=function(){return t=!1},d=n(9)(e),h={},f=(a.gray("undefined"),d.extend("tran")),v=function(e){if(t){var n=m(e);f(n)}},g=d.extend("pool"),y=function(e){if(t){var n=m(e);g(n)}},m=function(e){r(p.isModel(e));var t=a.yellow("INTER_LIGHT"),n=a.gray(M(e,h));return e.getRemote()&&(t=a.yellow("INTER_HEAVY")),c(e,t,n,"bgYellow","yellow")},k=new Map,b=function(e,t){var n=e.getChainId(),r=Date.now();k.set(n,{lockStart:t,workStart:r})},x=d,w=function(e){r(l.isModel(e));var n=e.provenance.getAddress().getChainId(),i=!h[n],a=h[n]&&h[n].some((function(t){return t.equals(e)}));if(I(e,h),t&&!a){var s=M(e,h),c=o(e,s,i,a),u=k.get(e.getChainId()),p=u.lockStart,d=u.workStart;Date.now(),Date.now();x(c)}},I=function(e,t){var n=e.provenance.getAddress().getChainId();t[n]||(t[n]=[]),t[n].some((function(t){return t.equals(e)}))||t[n].push(e)},M=function(e,t){if(!(e=i.last(t[e.provenance.getAddress().getChainId()])))return"(unknown)";for(var n=[],a=e,s=0;a&&s<10;){s++;var o=a.network[".."].address;if(o.isRoot())a=void 0,n.unshift("");else if(o.isUnknown())n.unshift("(unknown)"),a=void 0;else{var c=o.getChainId(),u=i.last(t[c]);r(l.isModel(u),"Hole in pedigree");var p=u.network.getAlias(a.provenance.getAddress());n.unshift(p),a=u}}s>=10&&d("Path over loopCount");var h=n.join("/");return h||"/"};return{on:s,off:u,lock:b,block:w,interblockTransmit:v,interblockPool:y}}}},177:function(e,t,n){var r=n(2),i=n(7),a=n(3),s=n(4),o=n(126).metrologyFactory,c=n(24),u=n(9)("interblock:effector"),l=n(21).covenantIdModel,p=(n(244).tcpTransportFactory,n(86)),d=n(242).netFactory,h=n(243).socketFactory,f=function(){var e=a(r.mark((function e(t){var n,c,l,f,g,y,m=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=m.length>1&&void 0!==m[1]?m[1]:{},s(!n||"object"===typeof n),u("effectorFactory"),n=b(n),l=d(c={}),f=h(c),n=i({},n,{net:l,socket:f,hyper:p.shell}),e.next=10,o(t,n);case 10:return g=e.sent,(y=v(g,g.pierce)).startNetworking=a(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.add("net",{covenantId:l.covenantId});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),e.abrupt("return",y);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function e(t,r){var a,s=t.getAbsolutePath(),o=function(e){var t=e.type,n=e.payload,i=void 0===n?{}:n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s;if(u("dispatch to: %o type: %O",a,t),"/"===s)return r({type:t,payload:i});var o=p.shell.actions.dispatch({type:t,payload:i},a);return r(o)},c=i({},t,{dispatch:o,_debug:n(9)}),l={},d=function(){var n=t.getState();if(n){var i=t.getCovenants(),s=k(n,i);if(s&&!s.covenantId.equals(a)){a=s.covenantId,u("set covenant to: %O",a.name);var p=x(o,s);m(c,t),Object.assign(c,p)}var d=t.getChildren();if(u("currentChildren",Object.keys(d)),!g(d,l)){for(var h in y(c,l),d)u("creating child: %O",h),l[h]=e(d[h],r);Object.assign(c,l)}}};return d(),t.subscribe(d),c},g=function(e,t){var n=Object.keys(e).sort(),r=Object.keys(t).sort();return c.isEqual(n,r)},y=function(e,t){for(var n in t)delete e[n],delete t[n]},m=function(e,t){for(var n in e)"_debug"===n||t[n]||"function"===typeof e[n]&&delete e[n]},k=function(e,t){var n=e.covenantId,r=i({},p,{},t),a=p.unity;if("hyper"===n.name)return t.hyper;for(var o in r)r[o].covenantId.equals(n)&&(s(a===p.unity),a=r[o]);return a},b=function(e){var t={};for(var n in e){covenant=e[n];var r=covenant.covenantId,i=r.name,a=r.version,s=r.language,o=r.integrity;covenant.covenantId=l.create(i,a,s,o),t[n]=covenant}return t},x=function(e,t){var n={};if("object"!==typeof t.actions)return n;var r=function(r){n[r]=function(){var n,i=(n=t.actions)[r].apply(n,arguments);return e(i)}};for(var i in t.actions)r(i);return n};e.exports={effectorFactory:f}},178:function(e,t,n){var r=n(7),i=n(2),a=n(3),s=n(4),o=(n(24),n(298)),c=n(180).sqsQueueFactory,u=n(21),l=u.interblockModel,p=u.addressModel,d=u.txModel,h=(u.socketModel,n(1737).fsmFactory),f=n(9)("interblock:engine");e.exports={standardEngineFactory:function(){f("standardEngineFactory");var e=0,t=h(),n=(t.ioIsolate,t.ioCrypto,t.ioConsistency,t.ioPool),u=t.ioIncrease,v=t.ioReceive,g=t.ioTransmit,y=c("sqsTx",d),m=c("sqsRx",d),k=c("sqsTransmit",l),b=c("sqsPool",l),x=c("sqsIncrease",p),w={sqsTx:y,sqsRx:m,sqsTransmit:k,sqsPool:b,sqsIncrease:x};m.setProcessor(function(e,t,n){return function(){var r=a(i.mark((function r(a){var o,c,u,l,p;return i.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return f.extend("receiver")("receiver"),s(d.isModel(a)),o=a.interblock,r.next=6,e.push(a);case 6:return c=r.sent,u=c.isPoolable,l=c.isCatchupable,s("boolean"===typeof u),s("boolean"===typeof l),p=[],u&&p.push(t.push(o)),l&&p.push(n.push(o)),r.next=16,Promise.all(p);case 16:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()}(v,b,k)),k.setProcessor(function(e,t,n){return function(){var r=a(i.mark((function r(a){var o,c;return i.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return f.extend("transmitter")("transmitter"),s(l.isModel(a)),r.next=5,e.push(a);case 5:return o=r.sent,s(o.every(d.isModel),"failed transmitter"),c=o.map((function(e){var r=e.interblock;return e.socket.getIsInternal()?n.push(r):t.push(e)})),r.next=10,Promise.all(c);case 10:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()}(g,y,b)),b.setProcessor(function(e,t){return function(){var n=a(i.mark((function n(r){var a,o,c;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(a=f.extend("pooler"))("pooler"),s(l.isModel(r)),n.next=5,e.push(r);case 5:return o=n.sent,s(Array.isArray(o),"failed pool"),a("affectedAddresses length: %o",o.length),c=o.map((function(e){return t.push(e)})),n.next=11,Promise.all(c);case 11:return n.abrupt("return",o);case 12:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(n,x)),x.setProcessor(function(t,n){var r=new Map,c=new Map;return function(){var u=a(i.mark((function a(u){var d,h,v,g,y,m;return i.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if((d=f.extend("increasor").extend(o(3,e++)))("throttler"),s(p.isModel(u)),h=u.getChainId(),c.get(h)){i.next=23;break}case 5:return r.delete(h),c.set(h,!0),i.next=9,t.push(u);case 9:return v=i.sent,g=v.txInterblocks,y=v.isRedriveRequired,s(Array.isArray(g)),s(g.every(l.isModel)),s.strictEqual(typeof y,"boolean"),d("transmission count: ".concat(g.length)),m=g.map((function(e){return n.push(e)})),i.next=18,Promise.all(m);case 18:c.delete(h),y&&r.set(h,!0);case 20:if(r.get(h)){i.next=5;break}case 21:i.next=25;break;case 23:r.set(h,!0),d("redrive raised");case 25:case"end":return i.stop()}}),a)})));return function(e){return u.apply(this,arguments)}}()}(u,k));var I=r({},t,{},w);return Object.freeze(I),I}}},1782:function(e,t,n){(function(t){var r=n(7),i=n(2),a=n(3),s=n(4),o=n(120).v4,c=n(9)("interblock:engine:piercerFactory"),u=n(34).request,l=n(21).txRequestModel,p=n(53).toFunctions,d=function(){var e={},t=new Promise((function(t,n){e.settled={resolve:t,reject:n}}));return t.pending=new Promise((function(t,n){e.pending={resolve:t,reject:n}})),{promise:t,callbacks:e}};e.exports={piercerFactory:function(e,n,h){var f=new Map,v=o(),g=0,y=p(n);return n.subscribe(function(){var n=a(i.mark((function n(r,a){var o,c;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("UNLOCK"!==r.type){n.next=10;break}return n.next=3,a;case 3:if((o=r.payload.block).getChainId()!==e.getChainId()){n.next=10;break}if(c=o.network[".@@io"]){n.next=8;break}return n.abrupt("return");case 8:c.getRemoteRequestIndices().forEach((function(e){var n=c.getRemote().requests[e];s(n);var r=n.payload._dispatchId;if(s(r.endsWith(v)),f.has(r)){var i=f.get(r);i.pending.resolve();var a=c.replies[e];if(a&&!a.isPromise()){var o=i.settled,u=o.resolve,l=o.reject,p=a.isResolve()?u:l;t((function(){return p(a.payload)})),f.delete(r)}}}));case 10:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()),function(){var t=a(i.mark((function t(n,a){var s,o,p,m,k,b,x,w,I,M;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=u(n,a),o=s.type,p=s.payload,m=void 0===p?{}:p,k="".concat(g++," ").concat(v),c("pierce: %s id: %o",o,k),m=r({},m,{_dispatchId:k}),b=e.getChainId(),x=l.create(o,m,b),w=d(),I=w.promise,M=w.callbacks,f.set(k,M),t.next=10,y.putPierceRequest({txRequest:x});case 10:return t.next=12,h.push(e);case 12:return t.abrupt("return",I);case 13:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}}}).call(this,n(58).setImmediate)},1783:function(e,t,n){var r=n(2),i=n(7),a=n(3),s=n(126).metrologyFactory,o=n(86).hyper,c=function(){var e=a(r.mark((function e(){var t,n,a,c,u,l,p,d=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.length>0&&void 0!==d[0]?d[0]:"aws",n=d.length>1?d[1]:void 0,n=i({},n,{hyper:o}),e.next=5,s(t,n);case 5:return a=e.sent,c=a.getEngine(),u=c.sqsTx,l=c.sqsRx,p=a.getState().provenance.getAddress(),e.next=10,a.settle();case 10:return e.abrupt("return",{sqsTx:u,sqsRx:l,hyperAddress:p,engine:a});case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e.exports={awsFactory:c}},1784:function(e,t,n){var r=n(2),i=n(3),a=n(177).effectorFactory,s=n(9)("interblock:browser"),o=n(1785),c=function(){var e=i(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.config({name:"@dreamcatcher/interblock_".concat(t)}),s("loading browser module"),e.next=4,a("web");case 4:return n=e.sent,s("browser client ready"),e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();e.exports={browserFactory:c}},1786:function(e,t,n){(function(t){var r=n(2),i=n(3),a=n(22)("dos"),s=n(1789),o=n(168).evaluate,c=n(169).withSpin,u=n(268);function l(e,t,n,r){return a("evalPrint"),r.evaluate=r.evaluate||c(o),u((function(){return r.evaluate(e,t,n)}))}e.exports=function(){var e=i(r.mark((function e(n){var i,o=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=o.length>1&&void 0!==o[1]?o[1]:{},a("argv",n),n=(n||t.argv).slice(2),a("argv",n),e.abrupt("return",n.length?l(ctx,n[0],n.slice(1),i):s(i));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}).call(this,n(11))},1789:function(e,t,n){var r=n(2),i=n(17),a=n(239),s=n(3),o=n(22)("dos:repl"),c=n(256),u=n(121).effectorFactory,l=n(1813).read,p=n(168).evaluate,d=n(1897).withAutoComplete,h=n(169).withSpin,f=n(268),v=n(1898),g=n(116);n(1899)(0,80);function y(e){return m.apply(this,arguments)}function m(){return(m=s(r.mark((function e(t){var n,i,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.blockchain,t.evaluate,(i=c({spinner:"aesthetic"}).start()).info("System font check: \ud83d\udea6\ud83d\udea6\ud83d\udea6\ud83c\udf08\ud83c\udf08\ud83c\udf08\u274c\ufe0f\u274c\ufe0f\u274c\ufe0f"),i.info("begining boot sequence Ctrl+C to cancel and drop to local shell"),i.text='checking for new app version on server "this webpage"',i.info("current build version: 0.0.0").start(),i.text='looking for previous chains under the domain "this webpage"',i.info("no previous chains found").start(),n||(i.text="Initializing blockchain...",n=u("console")),!n.then){e.next=13;break}return e.next=12,n;case 12:n=e.sent;case 13:return a=n.getState().getChainId(),i.info("Blockchain initialized with chainId: ".concat(a)).start(),i.text="connecting to mainnet...",e.next=18,new Promise((function(e){return setTimeout(e,100)}));case 18:return i.info("connection to mainnet established").start(),i.info("mainnet latency: 543 ms"),i.info("peer connection count: 1").start(),i.text="benchmarking local system",e.next=24,new Promise((function(e){return setTimeout(e,100)}));case 24:return i.info("local blockrate 23 blocks per second / 53 ms per block"),i.stop(),e.next=28,f('Welcome to the HyperNet\n  Blockchain core: v0.0.5\n  Terminal:        v0.0.12\n  type "help" to get started');case 28:return"root","local",i.stop(),e.abrupt("return",{user:"root",machineId:"local",blockchain:n});case 32:case"end":return e.stop()}}),e)})))).apply(this,arguments)}e.exports=function(){var e=s(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o("repl"),(t=t||{}).read=t.read||d(l),t.evaluate=t.evaluate||h(p),o("opts: ",Object.keys(t)),e.next=7,y(t);case 7:return n=e.sent,o("changing to home directory"),e.next=11,t.evaluate(n,"cd",[]);case 11:return e.abrupt("return",v(function(){var e=s(r.mark((function e(){var c,u,l,p,d;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c="exit",e.prev=1,e.next=4,t.read(n);case 4:c=e.sent,e.next=12;break;case 7:if(e.prev=7,e.t0=e.catch(1),!e.t0.message){e.next=11;break}throw e.t0;case 11:o("treating error as request to exit: ",e.t0);case 12:return u=c.split(" ").filter(Boolean),l=a(u),p=l[0],d=l.slice(1),o("command: ",p,d),e.next=16,f(s(r.mark((function e(){var a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!k.includes(p)&&g[p]&&(d=[p].concat(i(d)),p="time"),e.next=3,t.evaluate(n,p,d);case 3:return(a=e.sent)&&a.ctx&&Object.assign(n,a.ctx),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)}))));case 16:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}()));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var k=["time","clear","help"]},180:function(e,t,n){var r=n(301),i=r.ioQueueFactory,a=r.sqsQueueFactory;e.exports={ioQueueFactory:i,sqsQueueFactory:a}},1813:function(e,t,n){var r=n(2),i=n(3),a=n(45).prompt,s=n(22)("dos:read"),o=n(39);t.read=function(){var e=i(r.mark((function e(t){var n,i,c,u,l,p,d,h,f,v;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.autoComplete,n=t.user,i=t.machineId,c=t.blockchain,u=c.getContext(),l=u.wd,p="".concat(o.green("".concat(n,"@").concat(i))),d="".concat(p,":").concat(o.blue(l)).concat(o.reset("$")),h={type:"input",name:"result",message:d,symbols:{prefix:"",separator:""},styles:{success:o.noop}},e.next=8,a(h);case 8:return f=e.sent,v=f.result,s("prompt result: ",v),e.abrupt("return",v);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},1815:function(e,t,n){"use strict";(function(t,r){var i=n(17),a=n(7),s=n(1816),o=n(1817),c=/^(?:\x1b)([a-zA-Z0-9])$/,u=/^(?:\x1b+)(O|N|\[|\[\[)(?:(\d+)(?:;(\d+))?([~^$])|(?:1;)?(\d+)?([a-zA-Z]))/,l={OP:"f1",OQ:"f2",OR:"f3",OS:"f4","[11~":"f1","[12~":"f2","[13~":"f3","[14~":"f4","[[A":"f1","[[B":"f2","[[C":"f3","[[D":"f4","[[E":"f5","[15~":"f5","[17~":"f6","[18~":"f7","[19~":"f8","[20~":"f9","[21~":"f10","[23~":"f11","[24~":"f12","[A":"up","[B":"down","[C":"right","[D":"left","[E":"clear","[F":"end","[H":"home",OA:"up",OB:"down",OC:"right",OD:"left",OE:"clear",OF:"end",OH:"home","[1~":"home","[2~":"insert","[3~":"delete","[4~":"end","[5~":"pageup","[6~":"pagedown","[[5~":"pageup","[[6~":"pagedown","[7~":"home","[8~":"end","[a":"up","[b":"down","[c":"right","[d":"left","[e":"clear","[2$":"insert","[3$":"delete","[5$":"pageup","[6$":"pagedown","[7$":"home","[8$":"end",Oa:"up",Ob:"down",Oc:"right",Od:"left",Oe:"clear","[2^":"insert","[3^":"delete","[5^":"pageup","[6^":"pagedown","[7^":"home","[8^":"end","[Z":"tab"};function p(e){return["[a","[b","[c","[d","[e","[2$","[3$","[5$","[6$","[7$","[8$","[Z"].includes(e)}function d(e){return["Oa","Ob","Oc","Od","Oe","[2^","[3^","[5^","[6^","[7^","[8^"].includes(e)}var h=function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=a({name:r.name,ctrl:!1,meta:!1,shift:!1,option:!1,sequence:n,raw:n},r);if(t.isBuffer(n)?n[0]>127&&void 0===n[1]?(n[0]-=128,n="\x1b"+String(n)):n=String(n):void 0!==n&&"string"!==typeof n?n=String(n):n||(n=s.sequence||""),s.sequence=s.sequence||n||s.name,"\r"===n)s.raw=void 0,s.name="return";else if("\n"===n)s.name="enter";else if("\t"===n)s.name="tab";else if("\b"===n||"\x7f"===n||"\x1b\x7f"===n||"\x1b\b"===n)s.name="backspace",s.meta="\x1b"===n.charAt(0);else if("\x1b"===n||"\x1b\x1b"===n)s.name="escape",s.meta=2===n.length;else if(" "===n||"\x1b "===n)s.name="space",s.meta=2===n.length;else if(n<="\x1a")s.name=String.fromCharCode(n.charCodeAt(0)+"a".charCodeAt(0)-1),s.ctrl=!0;else if(1===n.length&&n>="0"&&n<="9")s.name="number";else if(1===n.length&&n>="a"&&n<="z")s.name=n;else if(1===n.length&&n>="A"&&n<="Z")s.name=n.toLowerCase(),s.shift=!0;else if(e=c.exec(n))s.meta=!0,s.shift=/^[A-Z]$/.test(e[1]);else if(e=u.exec(n)){var o=i(n);"\x1b"===o[0]&&"\x1b"===o[1]&&(s.option=!0);var h=[e[1],e[2],e[4],e[6]].filter(Boolean).join(""),f=(e[3]||e[5]||1)-1;s.ctrl=!!(4&f),s.meta=!!(10&f),s.shift=!!(1&f),s.code=h,s.name=l[h],s.shift=p(h)||s.shift,s.ctrl=d(h)||s.ctrl}return s};h.listen=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=e.stdin;if(!n||n!==r.stdin&&!n.isTTY)throw new Error("Invalid stream passed");s(n);var i=function(e,n){return t(e,h(e,n))},a=n.isRaw;n.isTTY&&n.setRawMode(!0),n.on("keypress",i),n.resume();var o=function(){n.isTTY&&n.setRawMode(a),n.removeListener("keypress",i),n.emit("close")};return o},h.action=function(e,t,n){var r=a({},o,{},n);return t.ctrl?(t.action=r.ctrl[t.name],t):t.option&&r.option?(t.action=r.option[t.name],t):t.shift?(t.action=r.shift[t.name],t):(t.action=r.keys[t.name],t)},e.exports=h}).call(this,n(8).Buffer,n(11))},1817:function(e,t,n){"use strict";t.ctrl={a:"first",b:"backward",c:"cancel",d:"deleteForward",e:"last",f:"forward",g:"reset",i:"tab",k:"cutForward",l:"reset",n:"newItem",m:"cancel",j:"submit",p:"search",r:"remove",s:"save",u:"undo",w:"cutLeft",x:"toggleCursor",v:"paste"},t.shift={up:"shiftUp",down:"shiftDown",left:"shiftLeft",right:"shiftRight",tab:"prev"},t.fn={up:"pageUp",down:"pageDown",left:"pageLeft",right:"pageRight",delete:"deleteForward"},t.option={b:"backward",f:"forward",d:"cutRight",left:"cutLeft",up:"altUp",down:"altDown"},t.keys={pageup:"pageUp",pagedown:"pageDown",home:"home",end:"end",cancel:"cancel",delete:"deleteForward",backspace:"delete",down:"down",enter:"submit",escape:"cancel",left:"left",space:"space",number:"number",return:"submit",right:"right",tab:"next",up:"up"}},1818:function(e,t,n){"use strict";function r(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.timers[t]={name:t,start:Date.now(),ms:0,tick:0},i=n.interval||120;r.frames=n.frames||[],r.loading=!0;var a=setInterval((function(){r.ms=Date.now()-r.start,r.tick++,e.render()}),i);return r.stop=function(){r.loading=!1,clearInterval(a)},Reflect.defineProperty(r,"interval",{value:a}),e.once("close",(function(){return r.stop()})),r.stop}e.exports=function(e){e.timers=e.timers||{};var t=e.options.timers;if(t)for(var n=0,i=Object.keys(t);n<i.length;n++){var a=i[n],s=t[a];"number"===typeof s&&(s={interval:s}),r(e,a,s)}}},1819:function(e,t,n){"use strict";(function(t,r){var i=n(7),a=n(10),s=n(12),o=n(32),c=o.define,u=o.width,l=function(){function e(n){a(this,e);var r=n.options;c(this,"_prompt",n),this.type=n.type,this.name=n.name,this.message="",this.header="",this.footer="",this.error="",this.hint="",this.input="",this.cursor=0,this.index=0,this.lines=0,this.tick=0,this.prompt="",this.buffer="",this.width=u(r.stdout||t.stdout),Object.assign(this,r),this.name=this.name||this.message,this.message=this.message||this.name,this.symbols=n.symbols,this.styles=n.styles,this.required=new Set,this.cancelled=!1,this.submitted=!1}return s(e,[{key:"clone",value:function(){var e=i({},this);return e.status=this.status,e.buffer=r.from(e.buffer),delete e.clone,e}},{key:"color",set:function(e){this._color=e},get:function(){var e=this.prompt.styles;if(this.cancelled)return e.cancelled;if(this.submitted)return e.submitted;var t=this._color||e[this.status];return"function"===typeof t?t:e.pending}},{key:"loading",set:function(e){this._loading=e},get:function(){return"boolean"===typeof this._loading?this._loading:!!this.loadingChoices&&"choices"}},{key:"status",get:function(){return this.cancelled?"cancelled":this.submitted?"submitted":"pending"}}]),e}();e.exports=l}).call(this,n(11),n(8).Buffer)},1820:function(e,t,n){"use strict";var r=n(1821),i=n(1822),a=n(32);e.exports=function(e){e.options=a.merge({},e.options.theme,e.options),e.symbols=i.merge(e.options),e.styles=r.merge(e.options)}},1821:function(e,t,n){"use strict";var r=n(32),i=n(46),a={default:i.noop,noop:i.noop,set inverse(e){this._inverse=e},get inverse(){return this._inverse||r.inverse(this.primary)},set complement(e){this._complement=e},get complement(){return this._complement||r.complement(this.primary)},primary:i.cyan,success:i.green,danger:i.magenta,strong:i.bold,warning:i.yellow,muted:i.dim,disabled:i.gray,dark:i.dim.gray,underline:i.underline,set info(e){this._info=e},get info(){return this._info||this.primary},set em(e){this._em=e},get em(){return this._em||this.primary.underline},set heading(e){this._heading=e},get heading(){return this._heading||this.muted.underline},set pending(e){this._pending=e},get pending(){return this._pending||this.primary},set submitted(e){this._submitted=e},get submitted(){return this._submitted||this.success},set cancelled(e){this._cancelled=e},get cancelled(){return this._cancelled||this.danger},set typing(e){this._typing=e},get typing(){return this._typing||this.dim},set placeholder(e){this._placeholder=e},get placeholder(){return this._placeholder||this.primary.dim},set highlight(e){this._highlight=e},get highlight(){return this._highlight||this.inverse},merge:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.styles&&"boolean"===typeof e.styles.enabled&&(i.enabled=e.styles.enabled),e.styles&&"boolean"===typeof e.styles.visible&&(i.visible=e.styles.visible);var t=r.merge({},a,e.styles);delete t.merge;for(var n=function(){var e=o[s];t.hasOwnProperty(e)||Reflect.defineProperty(t,e,{get:function(){return i[e]}})},s=0,o=Object.keys(i);s<o.length;s++)n();for(var c=function(){var e=l[u];t.hasOwnProperty(e)||Reflect.defineProperty(t,e,{get:function(){return i[e]}})},u=0,l=Object.keys(i.styles);u<l.length;u++)c();return t}};e.exports=a},1822:function(e,t,n){"use strict";(function(t){var r=n(7),i="win32"===t.platform,a=n(46),s=n(32),o=r({},a.symbols,{upDownDoubleArrow:"\u21d5",upDownDoubleArrow2:"\u2b0d",upDownArrow:"\u2195",asterisk:"*",asterism:"\u2042",bulletWhite:"\u25e6",electricArrow:"\u2301",ellipsisLarge:"\u22ef",ellipsisSmall:"\u2026",fullBlock:"\u2588",identicalTo:"\u2261",indicator:a.symbols.check,leftAngle:"\u2039",mark:"\u203b",minus:"\u2212",multiplication:"\xd7",obelus:"\xf7",percent:"%",pilcrow:"\xb6",pilcrow2:"\u2761",pencilUpRight:"\u2710",pencilDownRight:"\u270e",pencilRight:"\u270f",plus:"+",plusMinus:"\xb1",pointRight:"\u261e",rightAngle:"\u203a",section:"\xa7",hexagon:{off:"\u2b21",on:"\u2b22",disabled:"\u2b22"},ballot:{on:"\u2611",off:"\u2610",disabled:"\u2612"},stars:{on:"\u2605",off:"\u2606",disabled:"\u2606"},folder:{on:"\u25bc",off:"\u25b6",disabled:"\u25b6"},prefix:{pending:a.symbols.question,submitted:a.symbols.check,cancelled:a.symbols.cross},separator:{pending:a.symbols.pointerSmall,submitted:a.symbols.middot,cancelled:a.symbols.middot},radio:{off:i?"( )":"\u25ef",on:i?"(*)":"\u25c9",disabled:i?"(|)":"\u24be"},numbers:["\u24ea","\u2460","\u2461","\u2462","\u2463","\u2464","\u2465","\u2466","\u2467","\u2468","\u2469","\u246a","\u246b","\u246c","\u246d","\u246e","\u246f","\u2470","\u2471","\u2472","\u2473","\u3251","\u3252","\u3253","\u3254","\u3255","\u3256","\u3257","\u3258","\u3259","\u325a","\u325b","\u325c","\u325d","\u325e","\u325f","\u32b1","\u32b2","\u32b3","\u32b4","\u32b5","\u32b6","\u32b7","\u32b8","\u32b9","\u32ba","\u32bb","\u32bc","\u32bd","\u32be","\u32bf"]});o.merge=function(e){var t=s.merge({},a.symbols,o,e.symbols);return delete t.merge,t},e.exports=o}).call(this,n(11))},1823:function(e,t,n){"use strict";(function(r){var i=n(28),a=n(17),s="Apple_Terminal"===Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).TERM_PROGRAM,o=n(46),c=n(32),u=e.exports=t,l="\x1b[",p=!1,d=u.code={bell:"\x07",beep:"\x07",beginning:"".concat(l,"G"),down:"".concat(l,"J"),esc:l,getPosition:"".concat(l,"6n"),hide:"".concat(l,"?25l"),line:"".concat(l,"2K"),lineEnd:"".concat(l,"K"),lineStart:"".concat(l,"1K"),restorePosition:l+(s?"8":"u"),savePosition:l+(s?"7":"s"),screen:"".concat(l,"2J"),show:"".concat(l,"?25h"),up:"".concat(l,"1J")},h=u.cursor={get hidden(){return p},hide:function(){return p=!0,d.hide},show:function(){return p=!1,d.show},forward:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"".concat(l).concat(e,"C")},backward:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"".concat(l).concat(e,"D")},nextLine:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"".concat(l,"E").repeat(e)},prevLine:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"".concat(l,"F").repeat(e)},up:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return e?"".concat(l).concat(e,"A"):""},down:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return e?"".concat(l).concat(e,"B"):""},right:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return e?"".concat(l).concat(e,"C"):""},left:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return e?"".concat(l).concat(e,"D"):""},to:function(e,t){return t?"".concat(l).concat(t+1,";").concat(e+1,"H"):"".concat(l).concat(e+1,"G")},move:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n="";return n+=e<0?h.left(-e):e>0?h.right(e):"",n+=t<0?h.up(-t):t>0?h.down(t):""},restore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.after,n=e.cursor,r=e.initial,i=e.input,a=e.prompt,s=e.size,o=e.value;if(r=c.isPrimitive(r)?String(r):"",i=c.isPrimitive(i)?String(i):"",o=c.isPrimitive(o)?String(o):"",s){var l=u.cursor.up(s)+u.cursor.to(a.length),p=i.length-n;return p>0&&(l+=u.cursor.left(p)),l}if(o||t){var d=!i&&r?-r.length:-i.length+n;return t&&(d-=t.length),""===i&&r&&!a.includes(r)&&(d+=r.length),u.cursor.move(d)}}},f=u.erase={screen:d.screen,up:d.up,down:d.down,line:d.line,lineEnd:d.lineEnd,lineStart:d.lineStart,lines:function(e){for(var t="",n=0;n<e;n++)t+=u.erase.line+(n<e-1?u.cursor.up(1):"");return e&&(t+=u.code.beginning),t}};u.clear=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.stdout.columns;if(!t)return f.line+h.to(0);var n,s=function(e){return a(o.unstyle(e)).length},c=e.split(/\r?\n/),u=0,l=i(c);try{for(l.s();!(n=l.n()).done;){var p=n.value;u+=1+Math.floor(Math.max(s(p)-1,0)/t)}}catch(d){l.e(d)}finally{l.f()}return(f.line+h.prevLine()).repeat(u-1)+f.line+h.to(0)}}).call(this,n(11))},1824:function(e,t,n){"use strict";var r=n(32),i=function(e,n){r.defineExport(t,e,n),r.defineExport(t,e.toLowerCase(),n)};i("AutoComplete",(function(){return n(1825)})),i("BasicAuth",(function(){return n(1827)})),i("Confirm",(function(){return n(1828)})),i("Editable",(function(){return n(1829)})),i("Form",(function(){return n(166)})),i("Input",(function(){return n(262)})),i("Invisible",(function(){return n(1831)})),i("List",(function(){return n(1832)})),i("MultiSelect",(function(){return n(1833)})),i("Numeral",(function(){return n(1834)})),i("Password",(function(){return n(1835)})),i("Scale",(function(){return n(1836)})),i("Select",(function(){return n(61)})),i("Snippet",(function(){return n(1837)})),i("Sort",(function(){return n(1839)})),i("Survey",(function(){return n(1840)})),i("Text",(function(){return n(1841)})),i("Toggle",(function(){return n(1842)})),i("Quiz",(function(){return n(1843)}))},1825:function(e,t,n){"use strict";var r=n(7),i=n(2),a=n(3),s=n(10),o=n(12),c=n(26),u=n(29),l=n(18),p=n(19),d=n(61),h=function(e,t){var n=e.toLowerCase();return function(e){var r=e.toLowerCase().indexOf(n),i=t(e.slice(r,r+n.length));return r>=0?e.slice(0,r)+i+e.slice(r+n.length):e}},f=function(e){p(n,e);var t=l(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).cursorShow(),r}return o(n,[{key:"moveCursor",value:function(e){this.state.cursor+=e}},{key:"dispatch",value:function(e){return this.append(e)}},{key:"space",value:function(e){return this.options.multiple?u(c(n.prototype),"space",this).call(this,e):this.append(e)}},{key:"append",value:function(e){var t=this.state,n=t.cursor,r=t.input;return this.input=r.slice(0,n)+e+r.slice(n),this.moveCursor(1),this.complete()}},{key:"delete",value:function(){var e=this.state,t=e.cursor,n=e.input;return n?(this.input=n.slice(0,t-1)+n.slice(t),this.moveCursor(-1),this.complete()):this.alert()}},{key:"deleteForward",value:function(){var e=this.state,t=e.cursor,n=e.input;return void 0===n[t]?this.alert():(this.input="".concat(n).slice(0,t)+"".concat(n).slice(t+1),this.complete())}},{key:"number",value:function(e){return this.append(e)}},{key:"complete",value:function(){var e=a(i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.completing=!0,e.next=3,this.suggest(this.input,this.state._choices);case 3:return this.choices=e.sent,this.state.limit=void 0,this.index=Math.min(Math.max(this.visible.length-1,0),this.index),e.next=8,this.render();case 8:this.completing=!1;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"suggest",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.input,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state._choices;if("function"===typeof this.options.suggest)return this.options.suggest.call(this,e,t);var n=e.toLowerCase();return t.filter((function(e){return e.message.toLowerCase().includes(n)}))}},{key:"pointer",value:function(){return""}},{key:"format",value:function(){var e=this;if(!this.focused)return this.input;if(this.options.multiple&&this.state.submitted)return this.selected.map((function(t){return e.styles.primary(t.message)})).join(", ");if(this.state.submitted){var t=this.value=this.input=this.focused.value;return this.styles.primary(t)}return this.input}},{key:"render",value:function(){var e=a(i.mark((function e(){var t,a,s;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("pending"===this.state.status){e.next=2;break}return e.abrupt("return",u(c(n.prototype),"render",this).call(this));case 2:return t=this.options.highlight?this.options.highlight.bind(this):this.styles.placeholder,a=h(this.input,t),s=this.choices,this.choices=s.map((function(e){return r({},e,{message:a(e.message)})})),e.next=8,u(c(n.prototype),"render",this).call(this);case 8:this.choices=s;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"submit",value:function(){return this.options.multiple&&(this.value=this.selected.map((function(e){return e.name}))),u(c(n.prototype),"submit",this).call(this)}}]),n}(d);e.exports=f},1826:function(e,t,n){"use strict";var r=n(32),i={default:function(e,t){return t},checkbox:function(e,t){throw new Error("checkbox role is not implemented yet")},editable:function(e,t){throw new Error("editable role is not implemented yet")},expandable:function(e,t){throw new Error("expandable role is not implemented yet")},heading:function(e,t){return t.disabled="",t.indicator=[t.indicator," "].find((function(e){return null!=e})),t.message=t.message||"",t},input:function(e,t){throw new Error("input role is not implemented yet")},option:function(e,t){return i.default(e,t)},radio:function(e,t){throw new Error("radio role is not implemented yet")},separator:function(e,t){return t.disabled="",t.indicator=[t.indicator," "].find((function(e){return null!=e})),t.message=t.message||e.symbols.line.repeat(5),t},spacer:function(e,t){return t}};e.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.merge({},i,t.roles);return n[e]||n.default}},1827:function(e,t,n){"use strict";var r=n(7),i=n(10),a=n(12),s=n(18),o=n(19),c=n(260);function u(e,t){return e.username===this.options.username&&e.password===this.options.password}e.exports=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,n=[{name:"username",message:"username"},{name:"password",message:"password",format:function(e){return this.options.showPassword?e:(this.state.submitted?this.styles.primary:this.styles.muted)(this.symbols.asterisk.repeat(e.length))}}],l=function(t){o(u,t);var c=s(u);function u(e){return i(this,u),c.call(this,r({},e,{choices:n}))}return a(u,null,[{key:"create",value:function(t){return e(t)}}]),u}(c.create(t));return l}()},1828:function(e,t,n){"use strict";var r=n(10),i=n(18),a=n(19),s=function(e){a(n,e);var t=i(n);function n(e){var i;return r(this,n),(i=t.call(this,e)).default=i.options.default||(i.initial?"(Y/n)":"(y/N)"),i}return n}(n(167));e.exports=s},1829:function(e,t,n){"use strict";var r=n(28),i=n(2),a=n(3),s=n(7),o=n(10),c=n(12),u=n(26),l=n(29),p=n(18),d=n(19),h=n(61),f=n(166).prototype,v=function(e){d(n,e);var t=p(n);function n(e){var r;return o(this,n),(r=t.call(this,s({},e,{multiple:!0}))).align=[r.options.align,"left"].find((function(e){return null!=e})),r.emptyError="",r.values={},r}return c(n,[{key:"dispatch",value:function(e,t){var r=this.focused,i=r.parent||{};return r.editable||i.editable||"a"!==e&&"i"!==e?f.dispatch.call(this,e,t):l(u(n.prototype),e,this).call(this)}},{key:"append",value:function(e,t){return f.append.call(this,e,t)}},{key:"delete",value:function(e,t){return f.delete.call(this,e,t)}},{key:"space",value:function(e){return this.focused.editable?this.append(e):l(u(n.prototype),"space",this).call(this)}},{key:"number",value:function(e){return this.focused.editable?this.append(e):l(u(n.prototype),"number",this).call(this,e)}},{key:"next",value:function(){return this.focused.editable?f.next.call(this):l(u(n.prototype),"next",this).call(this)}},{key:"prev",value:function(){return this.focused.editable?f.prev.call(this):l(u(n.prototype),"prev",this).call(this)}},{key:"indicator",value:function(){var e=a(i.mark((function e(t,r){var a,s;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.indicator||"",s=t.editable?a:l(u(n.prototype),"indicator",this).call(this,t,r),e.next=4,this.resolve(s,this.state,t,r);case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0="";case 7:return e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"indent",value:function(e){return"heading"===e.role?"":e.editable?" ":"  "}},{key:"renderChoice",value:function(){var e=a(i.mark((function e(t,r){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.indent="",!t.editable){e.next=3;break}return e.abrupt("return",f.renderChoice.call(this,t,r));case 3:return e.abrupt("return",l(u(n.prototype),"renderChoice",this).call(this,t,r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"error",value:function(){return""}},{key:"footer",value:function(){return this.state.error}},{key:"validate",value:function(){var e=a(i.mark((function e(){var t,n,a,s,o;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,n=r(this.choices),e.prev=2,n.s();case 4:if((a=n.n()).done){e.next=19;break}if("function"===typeof(s=a.value).validate){e.next=8;break}return e.abrupt("continue",17);case 8:if("heading"!==s.role){e.next=10;break}return e.abrupt("continue",17);case 10:return o=s.parent?this.value[s.parent.name]:this.value,s.editable?o=s.value===s.name?s.initial||"":s.value:this.isDisabled(s)||(o=!0===s.enabled),e.next=14,s.validate(o,this.state);case 14:if(!0===(t=e.sent)){e.next=17;break}return e.abrupt("break",19);case 17:e.next=4;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(2),n.e(e.t0);case 24:return e.prev=24,n.f(),e.finish(24);case 27:return!0!==t&&(this.state.error="string"===typeof t?t:"Invalid Input"),e.abrupt("return",t);case 29:case"end":return e.stop()}}),e,this,[[2,21,24,27]])})));return function(){return e.apply(this,arguments)}}()},{key:"submit",value:function(){if(!0===this.focused.newChoice)return l(u(n.prototype),"submit",this).call(this);if(this.choices.some((function(e){return e.newChoice})))return this.alert();this.value={};var e,t=r(this.choices);try{for(t.s();!(e=t.n()).done;){var i=e.value,a=i.parent?this.value[i.parent.name]:this.value;"heading"!==i.role?i.editable?a[i.name]=i.value===i.name?i.initial||"":i.value:this.isDisabled(i)||(a[i.name]=!0===i.enabled):this.value[i.name]={}}}catch(s){t.e(s)}finally{t.f()}return this.base.submit.call(this)}}]),n}(h);e.exports=v},1830:function(e,t,n){"use strict";var r=n(17),i=function(e){return function(e){return e.filter((function(t,n){return e.lastIndexOf(t)===n}))}(e).filter(Boolean)};e.exports=function(e){var t,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=a.past,c=void 0===o?[]:o,u=a.present,l=void 0===u?"":u;switch(e){case"prev":case"undo":return t=c.slice(0,c.length-1),n=c[c.length-1]||"",{past:i([s].concat(r(t))),present:n};case"next":case"redo":return t=c.slice(1),n=c[0]||"",{past:i([].concat(r(t),[s])),present:n};case"save":return{past:i([].concat(r(c),[s])),present:""};case"remove":return l="",(n=i(c.filter((function(e){return e!==s})))).length&&(l=n.pop()),{past:n,present:l};default:throw new Error('Invalid action: "'.concat(e,'"'))}}},1831:function(e,t,n){"use strict";var r=n(10),i=n(12),a=n(18),s=n(19),o=function(e){s(n,e);var t=a(n);function n(){return r(this,n),t.apply(this,arguments)}return i(n,[{key:"format",value:function(){return""}}]),n}(n(72));e.exports=o},1832:function(e,t,n){"use strict";var r=n(2),i=n(3),a=n(10),s=n(12),o=n(26),c=n(29),u=n(18),l=n(19),p=function(e){l(n,e);var t=u(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a(this,n),(e=t.call(this,r)).sep=e.options.separator||/, */,e.initial=r.initial||"",e}return s(n,[{key:"split",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.value;return e?String(e).split(this.sep):[]}},{key:"format",value:function(){var e=this.state.submitted?this.styles.primary:function(e){return e};return this.list.map(e).join(", ")}},{key:"submit",value:function(){var e=i(r.mark((function e(t){var i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.state.error,e.t0){e.next=5;break}return e.next=4,this.validate(this.list,this.state);case 4:e.t0=e.sent;case 5:if(!0===(i=e.t0)){e.next=9;break}return this.state.error=i,e.abrupt("return",c(o(n.prototype),"submit",this).call(this));case 9:return this.value=this.list,e.abrupt("return",c(o(n.prototype),"submit",this).call(this));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"list",get:function(){return this.split()}}]),n}(n(72));e.exports=p},1833:function(e,t,n){"use strict";var r=n(7),i=n(10),a=n(18),s=n(19),o=function(e){s(n,e);var t=a(n);function n(e){return i(this,n),t.call(this,r({},e,{multiple:!0}))}return n}(n(61));e.exports=o},1834:function(e,t,n){e.exports=n(263)},1835:function(e,t,n){"use strict";var r=n(10),i=n(12),a=n(18),s=n(19),o=function(e){s(n,e);var t=a(n);function n(e){var i;return r(this,n),(i=t.call(this,e)).cursorShow(),i}return i(n,[{key:"format",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.input;if(!this.keypressed)return"";var t=this.state.submitted?this.styles.primary:this.styles.muted;return t(this.symbols.asterisk.repeat(e.length))}}]),n}(n(72));e.exports=o},1836:function(e,t,n){"use strict";var r=n(17),i=n(28),a=n(2),s=n(3),o=n(10),c=n(12),u=n(26),l=n(29),p=n(18),d=n(19),h=n(46),f=n(115),v=n(32),g=function(e){d(n,e);var t=p(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,n),(e=t.call(this,r)).widths=[].concat(r.messageWidth||50),e.align=[].concat(r.align||"left"),e.linebreak=r.linebreak||!1,e.edgeLength=r.edgeLength||3,e.newline=r.newline||"\n   ";var i=r.startNumber||1;return"number"===typeof e.scale&&(e.scaleKey=!1,e.scale=Array(e.scale).fill(0).map((function(e,t){return{name:t+i}}))),e}return c(n,[{key:"reset",value:function(){var e=s(a.mark((function e(){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.tableized=!1,e.next=3,l(u(n.prototype),"reset",this).call(this);case 3:return e.abrupt("return",this.render());case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"tableize",value:function(){if(!0!==this.tableized){this.tableized=!0;var e,t=0,n=i(this.choices);try{for(n.s();!(e=n.n()).done;){var r=e.value;t=Math.max(t,r.message.length),r.scaleIndex=r.initial||2,r.scale=[];for(var a=0;a<this.scale.length;a++)r.scale.push({index:a})}}catch(s){n.e(s)}finally{n.f()}this.widths[0]=Math.min(this.widths[0],t+3)}}},{key:"dispatch",value:function(){var e=s(a.mark((function e(t,r){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.multiple){e.next=11;break}if(!this[r.name]){e.next=7;break}return e.next=4,this[r.name](t,r);case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,l(u(n.prototype),"dispatch",this).call(this,t,r);case 9:e.t0=e.sent;case 10:return e.abrupt("return",e.t0);case 11:this.alert();case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"heading",value:function(e,t,n){return this.styles.strong(e)}},{key:"separator",value:function(){return this.styles.muted(this.symbols.ellipsis)}},{key:"right",value:function(){var e=this.focused;return e.scaleIndex>=this.scale.length-1?this.alert():(e.scaleIndex++,this.render())}},{key:"left",value:function(){var e=this.focused;return e.scaleIndex<=0?this.alert():(e.scaleIndex--,this.render())}},{key:"indent",value:function(){return""}},{key:"format",value:function(){var e=this;return this.state.submitted?this.choices.map((function(t){return e.styles.info(t.index)})).join(", "):""}},{key:"pointer",value:function(){return""}},{key:"renderScaleKey",value:function(){var e=this;if(!1===this.scaleKey)return"";if(this.state.submitted)return"";var t=this.scale.map((function(e){return"   ".concat(e.name," - ").concat(e.message)}));return[""].concat(r(t)).map((function(t){return e.styles.muted(t)})).join("\n")}},{key:"renderScaleHeading",value:function(e){var t=this,n=this.scale.map((function(e){return e.name}));"function"===typeof this.options.renderScaleHeading&&(n=this.options.renderScaleHeading.call(this,e));var r=this.scaleLength-n.join("").length,i=Math.round(r/(n.length-1)),a=n.map((function(e){return t.styles.strong(e)})).join(" ".repeat(i)),s=" ".repeat(this.widths[0]);return this.margin[3]+s+this.margin[1]+a}},{key:"scaleIndicator",value:function(e,t,n){if("function"===typeof this.options.scaleIndicator)return this.options.scaleIndicator.call(this,e,t,n);var r=e.scaleIndex===t.index;return t.disabled?this.styles.hint(this.symbols.radio.disabled):r?this.styles.success(this.symbols.radio.on):this.symbols.radio.off}},{key:"renderScale",value:function(e,t){var n=this,r=e.scale.map((function(r){return n.scaleIndicator(e,r,t)})),i="Hyper"===this.term?"":" ";return r.join(i+this.symbols.line.repeat(this.edgeLength))}},{key:"renderChoice",value:function(){var e=s(a.mark((function e(t,n){var r,i,s,o,c,u,l,p,d,f,g,y=this;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onChoice(t,n);case 2:return r=this.index===n,e.next=5,this.pointer(t,n);case 5:return i=e.sent,e.next=8,t.hint;case 8:return(s=e.sent)&&!v.hasColor(s)&&(s=this.styles.muted(s)),o=function(e){return y.margin[3]+e.replace(/\s+$/,"").padEnd(y.widths[0]," ")},c=this.newline,u=this.indent(t),e.next=15,this.resolve(t.message,this.state,t,n);case 15:return l=e.sent,e.next=18,this.renderScale(t,n);case 18:return p=e.sent,d=this.margin[1]+this.margin[3],this.scaleLength=h.unstyle(p).length,this.widths[0]=Math.min(this.widths[0],this.width-this.scaleLength-d.length),f=v.wordWrap(l,{width:this.widths[0],newline:c}),g=f.split("\n").map((function(e){return o(e)+y.margin[1]})),r&&(p=this.styles.info(p),g=g.map((function(e){return y.styles.info(e)}))),g[0]+=p,this.linebreak&&g.push(""),e.abrupt("return",[u+i,g.join("\n")].filter(Boolean));case 28:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"renderChoices",value:function(){var e=s(a.mark((function e(){var t,n,i,o=this;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.submitted){e.next=2;break}return e.abrupt("return","");case 2:return this.tableize(),t=this.visible.map(function(){var e=s(a.mark((function e(t,n){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.renderChoice(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),e.next=6,Promise.all(t);case 6:return n=e.sent,e.next=9,this.renderScaleHeading();case 9:return i=e.sent,e.abrupt("return",this.margin[0]+[i].concat(r(n.map((function(e){return e.join(" ")})))).join("\n"));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=s(a.mark((function e(){var t,n,r,i,s,o,c,u,l,p,d,h,f,v;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.submitted,r=t.size,e.next=3,this.prefix();case 3:return i=e.sent,e.next=6,this.separator();case 6:return s=e.sent,e.next=9,this.message();case 9:return o=e.sent,c="",!1!==this.options.promptLine&&(c=[i,o,s,""].join(" "),this.state.prompt=c),e.next=14,this.header();case 14:return u=e.sent,e.next=17,this.format();case 17:return l=e.sent,e.next=20,this.renderScaleKey();case 20:return p=e.sent,e.next=23,this.error();case 23:if(e.t0=e.sent,e.t0){e.next=28;break}return e.next=27,this.hint();case 27:e.t0=e.sent;case 28:return d=e.t0,e.next=31,this.renderChoices();case 31:return h=e.sent,e.next=34,this.footer();case 34:f=e.sent,v=this.emptyError,l&&(c+=l),d&&!c.includes(d)&&(c+=" "+d),n&&!l&&!h.trim()&&this.multiple&&null!=v&&(c+=this.styles.danger(v)),this.clear(r),this.write([u,c,p,h,f].filter(Boolean).join("\n")),this.state.submitted||this.write(this.margin[2]),this.restore();case 43:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"submit",value:function(){this.value={};var e,t=i(this.choices);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.value[n.name]=n.scaleIndex}}catch(r){t.e(r)}finally{t.f()}return this.base.submit.call(this)}}]),n}(f);e.exports=g},1837:function(e,t,n){"use strict";var r=n(17),i=n(33),a=n(28),s=n(2),o=n(3),c=n(10),u=n(12),l=n(26),p=n(29),d=n(18),h=n(19),f=n(46),v=n(1838),g=function(e){h(n,e);var t=d(n);function n(e){var r;return c(this,n),(r=t.call(this,e)).cursorHide(),r.reset(!0),r}return u(n,[{key:"initialize",value:function(){var e=o(s.mark((function e(){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(this);case 2:return this.interpolate=e.sent,e.next=5,p(l(n.prototype),"initialize",this).call(this);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reset",value:function(){var e=o(s.mark((function e(t){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.keys=[],this.state.invalid=new Map,this.state.missing=new Set,this.state.completed=0,this.state.values={},!0===t){e.next=10;break}return e.next=8,this.initialize();case 8:return e.next=10,this.render();case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"moveCursor",value:function(e){var t=this.getItem();this.cursor+=e,t.cursor+=e}},{key:"dispatch",value:function(e,t){t.code||t.ctrl||null==e||!this.getItem()?this.alert():this.append(e,t)}},{key:"append",value:function(e,t){var n=this.getItem(),r=n.input.slice(0,this.cursor),i=n.input.slice(this.cursor);this.input=n.input="".concat(r).concat(e).concat(i),this.moveCursor(1),this.render()}},{key:"delete",value:function(){var e=this.getItem();if(this.cursor<=0||!e.input)return this.alert();var t=e.input.slice(this.cursor),n=e.input.slice(0,this.cursor-1);this.input=e.input="".concat(n).concat(t),this.moveCursor(-1),this.render()}},{key:"increment",value:function(e){return e>=this.state.keys.length-1?0:e+1}},{key:"decrement",value:function(e){return e<=0?this.state.keys.length-1:e-1}},{key:"first",value:function(){this.state.index=0,this.render()}},{key:"last",value:function(){this.state.index=this.state.keys.length-1,this.render()}},{key:"right",value:function(){if(this.cursor>=this.input.length)return this.alert();this.moveCursor(1),this.render()}},{key:"left",value:function(){if(this.cursor<=0)return this.alert();this.moveCursor(-1),this.render()}},{key:"prev",value:function(){this.state.index=this.decrement(this.state.index),this.getItem(),this.render()}},{key:"next",value:function(){this.state.index=this.increment(this.state.index),this.getItem(),this.render()}},{key:"up",value:function(){this.prev()}},{key:"down",value:function(){this.next()}},{key:"format",value:function(e){var t=this.state.completed<100?this.styles.warning:this.styles.success;return!0===this.state.submitted&&100!==this.state.completed&&(t=this.styles.danger),t("".concat(this.state.completed,"% completed"))}},{key:"render",value:function(){var e=o(s.mark((function e(){var t,n,r,i,a,o,c,u,l,p,d,h,f,v,g,y,m,k,b;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.index,r=t.keys,i=void 0===r?[]:r,a=t.submitted,o=t.size,c=[this.options.newline,"\n"].find((function(e){return null!=e})),e.next=4,this.prefix();case 4:return u=e.sent,e.next=7,this.separator();case 7:return l=e.sent,e.next=10,this.message();case 10:return p=e.sent,d=[u,p,l].filter(Boolean).join(" "),this.state.prompt=d,e.next=15,this.header();case 15:return h=e.sent,e.next=18,this.error();case 18:if(e.t0=e.sent,e.t0){e.next=21;break}e.t0="";case 21:return f=e.t0,e.next=24,this.hint();case 24:if(e.t1=e.sent,e.t1){e.next=27;break}e.t1="";case 27:if(v=e.t1,!a){e.next=32;break}e.t2="",e.next=35;break;case 32:return e.next=34,this.interpolate(this.state);case 34:e.t2=e.sent;case 35:return g=e.t2,y=this.state.key=i[n]||"",e.next=39,this.format(y);case 39:return m=e.sent,e.next=42,this.footer();case 42:k=e.sent,m&&(d+=" "+m),v&&!m&&0===this.state.completed&&(d+=" "+v),this.clear(o),b=[h,d,g,k,f.trim()],this.write(b.filter(Boolean).join(c)),this.restore();case 49:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getItem",value:function(e){var t=this.state,n=t.items,r=t.keys,i=t.index,a=n.find((function(e){return e.name===r[i]}));return a&&null!=a.input&&(this.input=a.input,this.cursor=a.cursor),a}},{key:"submit",value:function(){var e=o(s.mark((function e(){var t,o,c,u,d,h,v,g,y,m,k,b,x;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"===typeof this.interpolate){e.next=3;break}return e.next=3,this.initialize();case 3:return e.next=5,this.interpolate(this.state,!0);case 5:if(t=this.state,o=t.invalid,c=t.missing,u=t.output,d=t.values,!o.size){e.next=12;break}h="",v=a(o);try{for(v.s();!(g=v.n()).done;)y=i(g.value,2),m=y[0],k=y[1],h+="Invalid ".concat(m,": ").concat(k,"\n")}catch(h){v.e(h)}finally{v.f()}return this.state.error=h,e.abrupt("return",p(l(n.prototype),"submit",this).call(this));case 12:if(!c.size){e.next=15;break}return this.state.error="Required: "+r(c.keys()).join(", "),e.abrupt("return",p(l(n.prototype),"submit",this).call(this));case 15:return b=f.unstyle(u).split("\n"),x=b.map((function(e){return e.slice(1)})).join("\n"),this.value={values:d,result:x},e.abrupt("return",p(l(n.prototype),"submit",this).call(this));case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(n(89));e.exports=g},1838:function(e,t,n){"use strict";var r=n(28),i=n(7),a=n(2),s=n(3),o=n(10),c=n(46),u=function e(t){o(this,e),this.name=t.key,this.field=t.field||{},this.value=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"string"===typeof e?e.replace(/^['"]|['"]$/g,""):""}(t.initial||this.field.initial||""),this.message=t.message||this.name,this.cursor=0,this.input="",this.lines=[]},l=function(){var e=s(a.mark((function e(){var t,n,r,i,s,o,c,l,p,d,h,f,v,g,y,m,k=arguments;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=k.length>0&&void 0!==k[0]?k[0]:{},n=k.length>1&&void 0!==k[1]?k[1]:{},r=k.length>2&&void 0!==k[2]?k[2]:function(e){return e},i=new Set,s=t.fields||[],o=t.template,c=[],l=[],p=[],d=1,"function"!==typeof o){e.next=14;break}return e.next=13,o();case 13:o=e.sent;case 14:h=-1,f=function(){return o[++h]},v=function(){return o[h+1]},(g=function(e){e.line=d,c.push(e)})({type:"bos",value:""});case 19:if(!(h<o.length-1)){e.next=40;break}if(y=f(),!/^[^\S\n ]$/.test(y)){e.next=24;break}return g({type:"text",value:y}),e.abrupt("continue",19);case 24:if("\n"!==y){e.next=28;break}return g({type:"newline",value:y}),d++,e.abrupt("continue",19);case 28:if("\\"!==y){e.next=32;break}return y+=f(),g({type:"text",value:y}),e.abrupt("continue",19);case 32:if("$"!==y&&"#"!==y&&"{"!==y||"{"!==v()){e.next=36;break}if("continue"!==function(){for(var e=f(),t={type:"template",open:y+=e,inner:"",close:"",value:y},a=void 0;a=f();){if("}"===a){"}"===v()&&(a+=f()),t.value+=a,t.close=a;break}":"===a?(t.initial="",t.key=t.inner):void 0!==t.initial&&(t.initial+=a),t.value+=a,t.inner+=a}t.template=t.open+(t.initial||t.inner)+t.close,t.key=t.key||t.inner,n.hasOwnProperty(t.key)&&(t.initial=n[t.key]),t=r(t),g(t),p.push(t.key),i.add(t.key);var o=l.find((function(e){return e.name===t.key}));return t.field=s.find((function(e){return e.name===t.key})),o||(o=new u(t),l.push(o)),o.lines.push(t.line-1),"continue"}()){e.next=36;break}return e.abrupt("continue",19);case 36:"text"===(m=c[c.length-1]).type&&m.line===d?m.value+=y:g({type:"text",value:y}),e.next=19;break;case 40:return g({type:"eos",value:""}),e.abrupt("return",{input:o,tabstops:c,unique:i,keys:p,items:l});case 42:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function p(e,t,n,r){return function(n,i,a,s){return"function"===typeof a.field[e]?a.field[e].call(t,n,i,a,s):[r,n].find((function(e){return t.isValue(e)}))}}e.exports=function(){var e=s(a.mark((function e(t){var n,o,u,d,h,f,v,g,y,m,k;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.options,o=new Set(!0===n.required?[]:n.required||[]),u=i({},n.values,{},n.initial),e.next=5,l(n,u);case 5:return d=e.sent,h=d.tabstops,f=d.items,v=d.keys,g=p("result",t,n),y=p("format",t,n),m=p("validate",t,n,!0),k=t.isValue.bind(t),e.abrupt("return",s(a.mark((function e(){var i,u,l,p,d,b,x,w,I,M,C,P,E,R=arguments;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=R.length>0&&void 0!==R[0]?R[0]:{},u=R.length>1&&void 0!==R[1]&&R[1],l=0,i.required=o,i.items=f,i.keys=v,i.output="",p=function(){var e=s(a.mark((function e(t,n,r,i){var s;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(t,n,r,i);case 2:if(!1!==(s=e.sent)){e.next=5;break}return e.abrupt("return","Invalid field "+r.name);case 5:return e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}(),d=r(h),e.prev=9,x=a.mark((function e(){var r,s,o,d,h,v,m,x,w,I;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=b.value,s=r.value,o=r.key,"template"===r.type){e.next=6;break}return s&&(i.output+=s),e.abrupt("return","continue");case 6:if("template"!==r.type){e.next=35;break}if(d=f.find((function(e){return e.name===o})),!0===n.required&&i.required.add(d.name),h=[d.input,i.values[d.value],d.value,s].find(k),v=d.field||{},m=v.message||r.inner,!u){e.next=25;break}return e.next=15,p(i.values[o],i,d,l);case 15:if(!((x=e.sent)&&"string"===typeof x||!1===x)){e.next=19;break}return i.invalid.set(o,x),e.abrupt("return","continue");case 19:return i.invalid.delete(o),e.next=22,g(i.values[o],i,d,l);case 22:return w=e.sent,i.output+=c.unstyle(w),e.abrupt("return","continue");case 25:return d.placeholder=!1,I=s,e.next=29,y(s,i,d,l);case 29:s=e.sent,h!==s?(i.values[o]=h,s=t.styles.typing(h),i.missing.delete(m)):(i.values[o]=void 0,h="<".concat(m,">"),s=t.styles.primary(h),d.placeholder=!0,i.required.has(o)&&i.missing.add(m)),i.missing.has(m)&&i.validating&&(s=t.styles.warning(h)),i.invalid.has(o)&&i.validating&&(s=t.styles.danger(h)),l===i.index&&(s=I!==s?t.styles.underline(s):t.styles.heading(c.unstyle(s))),l++;case 35:s&&(i.output+=s);case 36:case"end":return e.stop()}}),e)})),d.s();case 12:if((b=d.n()).done){e.next=19;break}return e.delegateYield(x(),"t0",14);case 14:if("continue"!==e.t0){e.next=17;break}return e.abrupt("continue",17);case 17:e.next=12;break;case 19:e.next=24;break;case 21:e.prev=21,e.t1=e.catch(9),d.e(e.t1);case 24:return e.prev=24,d.f(),e.finish(24);case 27:w=i.output.split("\n").map((function(e){return" "+e})),I=f.length,M=0,C=r(f);try{for(C.s();!(P=C.n()).done;)E=P.value,i.invalid.has(E.name)&&E.lines.forEach((function(e){" "===w[e][0]&&(w[e]=i.styles.danger(i.symbols.bullet)+w[e].slice(1))})),t.isValue(i.values[E.name])&&M++}catch(A){C.e(A)}finally{C.f()}return i.completed=(M/I*100).toFixed(0),i.output=w.join("\n"),e.abrupt("return",i.output);case 35:case"end":return e.stop()}}),e,null,[[9,21,24,27]])}))));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},1839:function(e,t,n){"use strict";var r=n(2),i=n(3),a=n(7),s=n(10),o=n(12),c=n(74),u=n(26),l=n(29),p=n(18),d=n(19),h="(Use <shift>+<up/down> to sort)",f=function(e){d(n,e);var t=p(n);function n(e){var r;return s(this,n),(r=t.call(this,a({},e,{reorder:!1,sort:!0,multiple:!0}))).state.hint=[r.options.hint,h].find(r.isValue.bind(c(r))),r}return o(n,[{key:"indicator",value:function(){return""}},{key:"renderChoice",value:function(){var e=i(r.mark((function e(t,i){var a,s,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(u(n.prototype),"renderChoice",this).call(this,t,i);case 2:if(a=e.sent,s=this.symbols.identicalTo+" ",o=this.index===i&&this.sorting?this.styles.muted(s):"  ",!1===this.options.drag&&(o=""),!0!==this.options.numbered){e.next=8;break}return e.abrupt("return",o+"".concat(i+1," - ")+a);case 8:return e.abrupt("return",o+a);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"submit",value:function(){return this.value=this.choices.map((function(e){return e.value})),l(u(n.prototype),"submit",this).call(this)}},{key:"selected",get:function(){return this.choices}}]),n}(n(61));e.exports=f},1840:function(e,t,n){"use strict";var r=n(7),i=n(2),a=n(28),s=n(3),o=n(10),c=n(12),u=n(26),l=n(29),p=n(18),d=n(19),h=function(e){d(n,e);var t=p(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(o(this,n),(e=t.call(this,r)).emptyError=r.emptyError||"No items were selected",e.term=Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).TERM_PROGRAM,!e.options.header){var i=["","4 - Strongly Agree","3 - Agree","2 - Neutral","1 - Disagree","0 - Strongly Disagree",""];i=i.map((function(t){return e.styles.muted(t)})),e.state.header=i.join("\n   ")}return e}return c(n,[{key:"toChoices",value:function(){var e=s(i.mark((function e(){var t,r,s,o,c,p,d,h,v=arguments;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.createdScales){e.next=2;break}return e.abrupt("return",!1);case 2:for(this.createdScales=!0,r=v.length,s=new Array(r),o=0;o<r;o++)s[o]=v[o];return e.next=6,(t=l(u(n.prototype),"toChoices",this)).call.apply(t,[this].concat(s));case 6:c=e.sent,p=a(c);try{for(p.s();!(d=p.n()).done;)(h=d.value).scale=f(5,this.options),h.scaleIdx=2}catch(i){p.e(i)}finally{p.f()}return e.abrupt("return",c);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispatch",value:function(){this.alert()}},{key:"space",value:function(){var e=this.focused,t=e.scale[e.scaleIdx],n=t.selected;return e.scale.forEach((function(e){return e.selected=!1})),t.selected=!n,this.render()}},{key:"indicator",value:function(){return""}},{key:"pointer",value:function(){return""}},{key:"separator",value:function(){return this.styles.muted(this.symbols.ellipsis)}},{key:"right",value:function(){var e=this.focused;return e.scaleIdx>=e.scale.length-1?this.alert():(e.scaleIdx++,this.render())}},{key:"left",value:function(){var e=this.focused;return e.scaleIdx<=0?this.alert():(e.scaleIdx--,this.render())}},{key:"indent",value:function(){return"   "}},{key:"renderChoice",value:function(){var e=s(i.mark((function e(t,n){var r,a,s,o,c,u,l,p,d,h,f,v,g,y,m,k,b=this;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onChoice(t,n);case 2:return r=this.index===n,a="Hyper"===this.term,s=a?9:8,o=a?"":" ",c=this.symbols.line.repeat(s),u=" ".repeat(s+(a?0:1)),l=function(e){return(e?b.styles.success("\u25c9"):"\u25ef")+o},p=n+1+".",d=r?this.styles.heading:this.styles.noop,e.next=13,this.resolve(t.message,this.state,t,n);case 13:return h=e.sent,f=this.indent(t),v=f+t.scale.map((function(e,n){return l(n===t.scaleIdx)})).join(c),g=function(e){return e===t.scaleIdx?d(e):e},y=f+t.scale.map((function(e,t){return g(t)})).join(u),m=function(){return[p,h].filter(Boolean).join(" ")},k=function(){return[m(),v,y," "].filter(Boolean).join("\n")},r&&(v=this.styles.cyan(v),y=this.styles.cyan(y)),e.abrupt("return",k());case 22:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"renderChoices",value:function(){var e=s(i.mark((function e(){var t,n,r=this;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.submitted){e.next=2;break}return e.abrupt("return","");case 2:return t=this.visible.map(function(){var e=s(i.mark((function e(t,n){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.renderChoice(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),e.next=5,Promise.all(t);case 5:return(n=e.sent).length||n.push(this.styles.danger("No matching choices")),e.abrupt("return",n.join("\n"));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"format",value:function(){var e=this;return this.state.submitted?this.choices.map((function(t){return e.styles.info(t.scaleIdx)})).join(", "):""}},{key:"render",value:function(){var e=s(i.mark((function e(){var t,n,r,a,s,o,c,u,l,p,d,h;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.submitted,r=t.size,e.next=3,this.prefix();case 3:return a=e.sent,e.next=6,this.separator();case 6:return s=e.sent,e.next=9,this.message();case 9:return o=e.sent,c=[a,o,s].filter(Boolean).join(" "),this.state.prompt=c,e.next=14,this.header();case 14:return u=e.sent,e.next=17,this.format();case 17:return l=e.sent,e.next=20,this.error();case 20:if(e.t0=e.sent,e.t0){e.next=25;break}return e.next=24,this.hint();case 24:e.t0=e.sent;case 25:return p=e.t0,e.next=28,this.renderChoices();case 28:return d=e.sent,e.next=31,this.footer();case 31:h=e.sent,!l&&p||(c+=" "+l),p&&!c.includes(p)&&(c+=" "+p),n&&!l&&!d&&this.multiple&&"form"!==this.type&&(c+=this.styles.danger(this.emptyError)),this.clear(r),this.write([c,u,d,h].filter(Boolean).join("\n")),this.restore();case 38:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"submit",value:function(){this.value={};var e,t=a(this.choices);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.value[n.name]=n.scaleIdx}}catch(r){t.e(r)}finally{t.f()}return this.base.submit.call(this)}}]),n}(n(115));function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Array.isArray(t.scale))return t.scale.map((function(e){return r({},e)}));for(var n=[],i=1;i<e+1;i++)n.push({i:i,selected:!1});return n}e.exports=h},1841:function(e,t,n){e.exports=n(262)},1842:function(e,t,n){"use strict";var r=n(2),i=n(3),a=n(10),s=n(12),o=n(26),c=n(29),u=n(18),l=n(19),p=function(e){l(n,e);var t=u(n);function n(){return a(this,n),t.apply(this,arguments)}return s(n,[{key:"initialize",value:function(){var e=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(o(n.prototype),"initialize",this).call(this);case 2:return this.value=this.initial=!!this.options.initial,this.disabled=this.options.disabled||"no",this.enabled=this.options.enabled||"yes",e.next=7,this.render();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reset",value:function(){this.value=this.initial,this.render()}},{key:"delete",value:function(){this.alert()}},{key:"toggle",value:function(){this.value=!this.value,this.render()}},{key:"enable",value:function(){if(!0===this.value)return this.alert();this.value=!0,this.render()}},{key:"disable",value:function(){if(!1===this.value)return this.alert();this.value=!1,this.render()}},{key:"up",value:function(){this.toggle()}},{key:"down",value:function(){this.toggle()}},{key:"right",value:function(){this.toggle()}},{key:"left",value:function(){this.toggle()}},{key:"next",value:function(){this.toggle()}},{key:"prev",value:function(){this.toggle()}},{key:"dispatch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";switch(e.toLowerCase()){case" ":return this.toggle();case"1":case"y":case"t":return this.enable();case"0":case"n":case"f":return this.disable();default:return this.alert()}}},{key:"format",value:function(){var e=this,t=function(t){return e.styles.primary.underline(t)};return[this.value?this.disabled:t(this.disabled),this.value?t(this.enabled):this.enabled].join(this.styles.muted(" / "))}},{key:"render",value:function(){var e=i(r.mark((function e(){var t,n,i,a,s,o,c,u,l;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.size,e.next=3,this.header();case 3:return n=e.sent,e.next=6,this.prefix();case 6:return i=e.sent,e.next=9,this.separator();case 9:return a=e.sent,e.next=12,this.message();case 12:return s=e.sent,e.next=15,this.format();case 15:return o=e.sent,e.next=18,this.error();case 18:if(e.t0=e.sent,e.t0){e.next=23;break}return e.next=22,this.hint();case 22:e.t0=e.sent;case 23:return c=e.t0,e.next=26,this.footer();case 26:u=e.sent,l=[i,s,a,o].join(" "),this.state.prompt=l,c&&!l.includes(c)&&(l+=" "+c),this.clear(t),this.write([n,l,u].filter(Boolean).join("\n")),this.write(this.margin[2]),this.restore();case 34:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(n(167));e.exports=p},1843:function(e,t,n){"use strict";var r=n(2),i=n(3),a=n(10),s=n(12),o=n(26),c=n(29),u=n(18),l=n(19),p=function(e){l(n,e);var t=u(n);function n(e){var r;if(a(this,n),"number"!==typeof(r=t.call(this,e)).options.correctChoice||r.options.correctChoice<0)throw new Error("Please specify the index of the correct answer from the list of choices");return r}return s(n,[{key:"toChoices",value:function(){var e=i(r.mark((function e(t,i){var a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(o(n.prototype),"toChoices",this).call(this,t,i);case 2:if(!((a=e.sent).length<2)){e.next=5;break}throw new Error("Please give at least two choices to the user");case 5:if(!(this.options.correctChoice>a.length)){e.next=7;break}throw new Error("Please specify the index of the correct answer from the list of choices");case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"check",value:function(e){return e.index===this.options.correctChoice}},{key:"result",value:function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.t1=this.options.choices[this.options.correctChoice].value,e.next=4,this.check(this.state);case 4:return e.t2=e.sent,e.abrupt("return",{selectedAnswer:e.t0,correctAnswer:e.t1,correct:e.t2});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(n(61));e.exports=p},1844:function(e,t,n){e.exports={ArrayPrompt:n(115),AuthPrompt:n(260),BooleanPrompt:n(167),NumberPrompt:n(263),StringPrompt:n(72)}},1846:function(e,t,n){var r=n(2),i=n(3),a=(n(49),n(35)),s=(n(57).promisify,n(94)),o=n(22)("dos:commands:config"),c=n(264).getHomePath,u=a.join(s.homedir(),".cmd-prototype"),l={set:function(e,t,n){return i(r.mark((function i(){var a,s,l,d,h;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o("set",t,n),a=e.configPath||u,r.next=4,p(a);case 4:return(s=r.sent)[t]=n,r.next=8,writeFile(a,JSON.stringify(s));case 8:if("apiaddr"!==t.toLowerCase()){r.next=15;break}return l=(e.IpfsApi||IpfsApi)(n),d=new Ipld(l.block),r.next=13,c(l);case 13:return h=r.sent,r.abrupt("return",{ctx:{ipld:d,ipfs:l,wd:h}});case 15:case"end":return r.stop()}}),i)})))()},get:function(e,t){return i(r.mark((function n(){var i,a;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o("get",t),n.next=3,p(e.configPath||u);case 3:return i=n.sent,a=t?i[t]:i,n.abrupt("return",{out:a});case 6:case"end":return n.stop()}}),n)})))()}};function p(e){return d.apply(this,arguments)}function d(){return(d=i(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=JSON,e.next=4,readFile(t);case 4:e.t1=e.sent,n=e.t0.parse.call(e.t0,e.t1),e.next=11;break;case 8:e.prev=8,e.t2=e.catch(0),o("failed to read config",e.t2);case 11:return e.abrupt("return",n||{});case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}e.exports=function(){var e=i(r.mark((function e(t,n){var i,a,s,o=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l[n]){e.next=2;break}throw new Error("".concat(n,": subcommand not found"));case 2:for(i=o.length,a=new Array(i>2?i-2:0),s=2;s<i;s++)a[s-2]=o[s];return e.abrupt("return",l[n].apply(l,[t].concat(a)));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},1847:function(e,t,n){(function(t){e.exports=function(e){var n=e.spinner;n&&n.stop(),t.exit()},e.exports.help="Exit the current program"}).call(this,n(11))},1848:function(e,t,n){var r=n(22)("dos:commands:help"),i=n(117),a=n(116);n(1859);e.exports=function(e){var t=i();r("help: ",Object.keys(a)),t.div('Use the following commands (use "tab" for autocomplete):\n');var n=Object.keys(a).filter((function(e){return!!a[e].help}));n.forEach((function(e){t.div({text:e,width:20,padding:[0,0,0,0]},a[e].help.replace(/\n|\r|\r\n/g," ").trim()),t.div()}));var s=Object.keys(a).filter((function(e){return!a[e].help}));return t.div("No help provided for:\n"),t.div("    "+s.toString()),t.div(),{out:t.toString()}},e.exports.help="\nPrints this message\n"},1860:function(e,t,n){var r=n(2),i=n(3),a=(n(35).posix||n(35),n(22)("dos:commands:ls")),s=n(117),o=n(39);n(1861);e.exports=function(){var e=i(r.mark((function e(t,n){var i,c,u,l,p;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.spinner,c=t.blockchain,u=c.getState(),l=u.network,i.text="Resolving ".concat(n),p=s(),Object.keys(l).forEach((function(e){a("child: ".concat(e));var t,n=l[e],r=n.address.getChainId().substring(0,8);a("chainId: ".concat(r));var i=n.lineageHeight,s=n.heavyHeight;(-1===i&&(i="-"),-1===s&&(s="-"),"."===e)&&(i=s=c.getState().provenance.height,r=c.getState().getChainId().substring(0,8));var u=s+"."+i;t="SYMLINK"!==n.systemRole?o.red(e):o.magenta(e),p.div({text:t,width:20},{text:u,width:10},{text:r,width:55})})),e.abrupt("return",{out:p.toString()});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.exports.help="\nlist the objects at the cwd.  lists alias, heavy height.lineage height, and chainId\n"},1862:function(e,t){e.exports=function(e){return{out:e.wd}}},1863:function(e,t,n){var r=n(1864);e.exports=function(){return{out:"v".concat(r.version)}}},1864:function(e){e.exports=JSON.parse('{"name":"@dreamcatcher-tech/dos","version":"0.0.0","description":"Terminal interface to the HyperNet","main":"src/index.js","bin":{"dos":"src/bin.js"},"scripts":{"start":"DEBUG=\'*dos*\' node src/bin","dev":"DEBUG=\'*nodemon*\' nodemon src/bin"},"author":"","license":"AGPL-3.0-or-later","dependencies":{"better-opn":"^2.0.0","chalk":"^4.1.0","clear":"^0.1.0","cliui":"^6.0.0","commander":"^6.1.0","debug":"^4.1.0","dedent":"^0.7.0","detect-node":"^2.0.4","docker-names":"^1.1.1","enquirer":"^2.3.6","figlet":"^1.2.4","filesize":"^3.6.1","localforage":"^1.9.0","ora":"^3.0.0","pad":"^3.2.0","pretty-ms":"^7.0.0","pull-stream":"^3.6.9","random-hash":"^4.0.1","wordwrap":"^1.0.0"},"devDependencies":{"nodemon":"^1.19.3"},"nodemonConfig":{"verbose":false,"watch":["./","/code/interblock"]},"jest":{"testEnvironment":"node","transform":{}},"prettier":{"trailingComma":"es5","tabWidth":2,"semi":false,"singleQuote":true}}')},1865:function(e,t,n){var r=n(2),i=n(3),a=n(22)("dos:commands:pkg");e.exports=function(){var e=i(r.mark((function e(t,n){var i,s,o,c,u=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=t.spinner,s=u.length,o=new Array(s>2?s-2:0),c=2;c<s;c++)o[c-2]=u[c];return a(n,o),e.next=5,new Promise((function(e){return setTimeout(e,2e3)}));case 5:return i.text="now with text",e.next=8,new Promise((function(e){return setTimeout(e,2e3)}));case 8:return i.succeed("stage 1 complete").start(),e.next=11,new Promise((function(e){return setTimeout(e,2e3)}));case 11:return i.fail("stage 2 failed").start(),e.next=14,new Promise((function(e){return setTimeout(e,2e3)}));case 14:return i.info("please try again later").start(),e.next=17,new Promise((function(e){return setTimeout(e,2e3)}));case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.exports.help="\nThe platform package manager.  Use list --installed \nto list all applications installed on the system.\nuse list to show all available applications available for install.\nUse search to narrow down the list of available packages.\nDefaults to listing installed applications.\n"},1866:function(e,t,n){var r=n(1867);e.exports=function(){return r()},e.exports.help="Clear the screen"},1868:function(e,t){var n=0;e.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Test Error";throw new Error(t+" "+n++)},e.exports.help="Throw an error, to test system response"},1869:function(e,t,n){var r=n(2),i=n(3),a=(n(45).prompt,n(1870));e.exports=function(){var e=i(r.mark((function e(t,n){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return debug("open: ",n),e.next=3,a("https://aws.amazon.com/cognito/");case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},1872:function(e,t,n){var r=n(2),i=n(3);n(22)("dos:commands:login");e.exports=function(){var e=i(r.mark((function e(t){var n,i,a,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.spinner,i=t.blockchain,a="34e3c74c43c0e9b2f3f2ef9f93a0f427ededf5878891b23d792d8f7c1a174b94",n.info("logging in to ".concat(a)).start(),n.text="connecting to: ".concat(url),e.next=6,i.addTransport(a,{url:url});case 6:return s=e.sent,n.succeed("latency of ".concat(s," ms ").concat(url)).start(),n.text="logging in to chain",e.next=11,i.login({chainId:a});case 11:return n.succeed("login successful"),e.abrupt("return",{out:url});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help='Loop the user through a signon process that links\nThe current machine pubkey to their interblock user chain.\nWhen this occurs, the guest chain will transition to the\nuser chain, and the prompt will change from "guest" to "user"'},1873:function(e,t,n){var r=n(2),i=n(3),a=function(e){return new Promise((function(t){return setTimeout(t,e)}))};e.exports=function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("\n"),n(119)("https://aws.amazon.com/cognito/"),e.abrupt("return",a(2e3));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nDisconnect from the current remote host, else error and stay as local\n"},1874:function(e,t,n){var r=n(2),i=n(3),a=n(22)("dos:commands:su"),s=(new(n(1875).Command),n(45).prompt);e.exports=function(){var e=i(r.mark((function e(t,n){var i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a(n),n){e.next=3;break}throw new Error("must supply user name or chainId to elevate to");case 3:return e.next=5,s([{name:"password"}]);case 5:i=e.sent,a(i);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},1876:function(e,t,n){var r=n(2),i=n(3),a=n(22)("dos:commands:add"),s=n(39);n(45).prompt;e.exports=function(){var e=i(r.mark((function e(t){var n,i,o,c,u,l,p,d,h,f,v,g,y=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.spinner,i=t.blockchain,o=y.length,c=new Array(o>1?o-1:0),u=1;u<o;u++)c[u-1]=y[u];a("add: %O",c),l="",p=0,d=c;case 5:if(!(p<d.length)){e.next=18;break}return h=d[p],n.text="adding ".concat(h,"..."),e.next=10,i.add(h);case 10:f=e.sent,v=f.alias,g=f.chainId,n.succeed("added ".concat(h)).start(),l+="Added: ".concat(s.red(v),"\n - chainId: ").concat(s.greenBright(g),"\n");case 15:p++,e.next=5;break;case 18:return e.abrupt("return",{out:l.trim()});case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nThis command will be overridden by each application.\nIt serves as the general action of creating a new entity\nwhere the entity is specific to the application being executed.\nWhen used in the native setting, it makes a blank datum chain.\nDepending on the context, additional info may need to be provided to\ncreate the child.\n"},1877:function(e,t,n){var r=n(2),i=n(3);e.exports=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),e.exports.help="\nLinking is act of inserting one Object as the child of another\nwhich allows an Object to be the child of more than one parent.\nThis operation is essential to application data structures\nas opposed to simple filesystem data structures, which are \nusually a tree\n"},1878:function(e,t,n){var r=n(2),i=n(3),a=n(22)("dos:commands:rm");n(39),n(45).prompt;e.exports=function(){var e=i(r.mark((function e(t,n){var i,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.spinner,i=t.blockchain,a("rm: %O",n),e.next=4,i.rm(n);case 4:s=e.sent,a("result: %O",s);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.exports.help="\nRemove blockchains.  If they are symlinks, will remove\nthe link only.  If children, will be permanently deleted.\n"},1879:function(e,t,n){var r=n(2),i=n(3),a=(n(22)("dos:commands:whoami"),n(39)),s=n(117);e.exports=function(){var e=i(r.mark((function e(t){var n,i,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.blockchain,i=n.getState().getChainId(),(o=s()).div({text:"User:",width:15},"root"),o.div({text:"Machine:",width:15},a.green(i)),o.div({text:"Hypercomputer:",width:15},a.red("NOT CONNECTED")),e.abrupt("return",{out:o.toString()});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nLists info about the current machine, current user, and connected hypercomputer\n"},1880:function(e,t,n){var r=n(2),i=n(3);e.exports=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(119)("https://aws.amazon.com/cognito/");case 1:case"end":return e.stop()}}),e)})))},1881:function(e,t,n){var r=n(2),i=n(3),a=n(1882),s=n(22)("dos:commands:time");e.exports=function(){var e=i(r.mark((function e(t){var i,o,c,u,l,p,d,h,f,v=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=n(168),o=i.evaluate,c=v.length,u=new Array(c>1?c-1:0),l=1;l<c;l++)u[l-1]=v[l];if(!(u.length<1)){e.next=4;break}throw new Error("Must supply command");case 4:return p=u[0],d=u.slice(1),s("time: ",p,d),h=Date.now(),e.next=9,o(t,p,d);case 9:if(e.t0=e.sent,e.t0){e.next=12;break}e.t0={};case 12:return(f=e.t0).out=f.out||"",f.out=f.out+"\nTime: ".concat(a(Date.now()-h)),e.abrupt("return",f);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nMeasure how long a command takes.\n"},1884:function(e,t,n){var r=n(2),i=n(3),a=n(22)("dos:commands:ping");e.exports=function(){var e=i(r.mark((function e(t,n,i){var s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.spinner,s=t.blockchain,a("ping path: %O options: %O",n,i),e.next=4,s.ping(n);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),e.exports.help="\nSend a ping to a chain, receive a response.\n\nTODO: \n1. send data with the ping\n2. ping indefinitely\n3. do 4 pings and report average times\n4. allow path pings\n"},1885:function(e,t,n){var r=n(2),i=n(3),a=n(22)("dos:commands:reset"),s=n(45).prompt;e.exports=function(){var e=i(r.mark((function e(t){var n,i,o,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.spinner,t.blockchain,a("reset"),n.stop(),e.next=5,s({type:"confirm",name:"reset",message:"Resetting will delete all local blockchains"});case 5:return i=e.sent,o=i.reset,c=o?"All local blockchains deleted":"Cancelled reset",e.abrupt("return",{out:c});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nDump all the local blockchain state, generate a new\ngenesis block, reset login status.\nIn dev mode will also reset the emulated aws.\n"},1886:function(e,t,n){var r=n(2),i=n(3),a=n(22)("dos:commands:dns");n(39),n(45).prompt;e.exports=function(){var t=i(r.mark((function t(n,i){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.spinner,n.blockchain,a("dns %O",i),t.abrupt("return",{out:e.exports.help});case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.exports.help="\nService to map strings to chainIds.\nMultiple services and manual overrides can be provided.\n"},1887:function(e,t,n){var r=n(2),i=n(3),a=n(57),s=n(22)("dos:commands:cat");n(39),n(45).prompt;e.exports=function(){var e=i(r.mark((function e(t){var n,i,o,c,u,l,p=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t.spinner,n=t.blockchain,i=p.length,o=new Array(i>1?i-1:0),c=1;c<i;c++)o[c-1]=p[c];return s("cat path: %O args: %O",o),u=n.getState(),l=a.inspect(u,{colors:!0,depth:null}),e.abrupt("return",{out:l});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nShow the internal state of a chain.\n\nTODO\nArgs for full state, or partial state, or a particular path in the state.\n"},1888:function(e,t,n){var r=n(2),i=n(3),a=n(22)("dos:commands:tx");n(39),n(45).prompt;e.exports=function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.spinner,t.blockchain,a("TODO tx: %O");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nList and modify the transports used.  These are typically URLs\nwhich point to various block producing peers\n"},1889:function(e,t,n){var r=n(2),i=n(3),a=n(22);e.exports=function(){var e=i(r.mark((function e(t){var n,i,s,o,c,u,l,p,d=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.blockchain,i=d.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=d[o];return c=s.join(" "),u=n._debug.disable(),l=a.disable(),p="current interblock flags: "+u,p+="\ncurrent dos flags: "+l,p+="\nsetting flags to: "+c,n._debug.enable(c),a.enable(c),e.abrupt("return",{out:p});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nChange flags to alter debug output on console.\n\nWith no arguments, toggle disable and enable, and will print the currently set flags.\nOtherwise will set the current flags.\n\nSee https://github.com/visionmedia/debug"},1890:function(e,t,n){var r=n(2),i=n(3);e.exports=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(119)("https://aws.amazon.com/cognito/");case 1:case"end":return e.stop()}}),e)})))},1891:function(e,t,n){var r=n(2),i=n(3),a=n(39),s=n(117),o=a.bold.yellow("Object"),c=a.bold.yellow("Link"),u=a.bold.yellow("Covenant"),l=a.bold.yellow("StateMachine"),p=a.bold.yellow("DistributedOperatingSystem"),d=a.bold.yellow("FileSystem"),h=a.bold.yellow("App");e.exports=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=s()).div("Everything in this ".concat(p," is a Blockchain ").concat(o)),t.div(),t.div({text:"1.",width:4},"".concat(o,"s exist everywhere independent of any single computer because they are virtual, and not tied to a particular machine, freeing them from the faults of nature which plague physical hardware")),t.div({text:"2.",width:4},"".concat(o,"s can connect to each other to transfer instructions or payload data via ").concat(c,"s.")),t.div({text:"3.",width:4},"The logic governing the behaviour of ".concat(o,"s is inside a ").concat(u)),t.div({text:"4.",width:4},"A subclass of ".concat(u," is a ").concat(l)),t.div({text:"5.",width:4},"In our system, ".concat(o,"s are only changed internally by ").concat(l,"s")),t.div({text:"6.",width:4},"When viewed as a Graph, the ".concat(c,"s between all ").concat(o,"s are the ").concat(d)),t.div({text:"7.",width:4},"The ".concat(d," is arranged in a hierarchy from a root, so that it looks like a POSIX filesystem for the familiarity of our users")),t.div({text:"8.",width:4},"When viewed as executables, the collection of ".concat(l,"s are the ").concat(h,"s of our ").concat(p," ")),t.div({text:"9.",width:4},"Including the ".concat(h," named the Dreamcatcher means we by default include the ").concat(h," that coordinates Talent into making more ").concat(h,"s")),t.div(),t.div("type 'help' for a list of commands"),t.div(),e.abrupt("return",{out:t.toString()});case 16:case"end":return e.stop()}}),e)}))),e.exports.help="Information about the HyperNet"},1892:function(e,t,n){var r=n(2),i=n(3),a=n(22)("dos:commands:blocks"),s=n(121).engine.blockPrint;e.exports=function(){var e=i(r.mark((function e(t){var n,i,o,c,u,l,p,d,h,f,v,g,y,m=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.blockchain,i=m.length,o=new Array(i>1?i-1:0),c=1;c<i;c++)o[c-1]=m[c];for(a("blocks %O",o),u=n.getContext(),l=u.wd,p=o[0]||l,a("using path: %o",p),h=p===l?n:n[p],f=h.getState().provenance.height,v=0,g="";v<=f;)y=[],d=h.getState(y,v),g+=s(d,p)+"\n",v++,a("next height: ",v);return e.abrupt("return",{out:g});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nShow the blocks of any given blockchain.\nIf no chain ID or alias given, print the blocks of the \nblockchain at the cwd\n"},1893:function(e,t,n){var r=n(2),i=n(3);e.exports=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),e.exports.help="\nTo ensure the integrity of the system, invoke scrub to\ncheck the hashes of all objects at this location,\nand to verify the availability of all objects.\nUse the option --history to check all blocks in the past\nas well as LATEST.  This will incur significant usage fees\nand bandwidth.\n"},1894:function(e,t,n){var r=n(2),i=n(3),a=n(22)("dos:commands:namegen"),s=n(1895);e.exports=function(){var e=i(r.mark((function e(t){var n,i,o=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t.spinner,t.blockchain,n=o.length>1&&void 0!==o[1]?o[1]:1,a("count: %O",n),i="";n>0;)i+=s.getRandomName(),--n>0&&(i+="\n");return e.abrupt("return",{out:i});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nGenerate a random name, which can be used as an identity for anything.\n"},1896:function(e,t,n){var r=n(2),i=n(3);n(22)("dos:commands:add"),n(39),n(45).prompt;e.exports=function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.spinner,t.blockchain;case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nView, change the validator set of a chain or group of chains.\nRecursively change all validators of the chains children.\nValidators must accept the role before the handover is complete.\nCan be used to force a change if a chain has stalled.\n"},1897:function(e,t,n){var r=n(2),i=n(3),a=n(10),s=n(12),o=n(22)("dos:auto-complete"),c=n(39),u=n(169).withSpin,l=n(116),p=function(){"use strict";function e(){a(this,e),this._list=[],this.getList=this.getList.bind(this)}return s(e,[{key:"updateList",value:function(){var e=i(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.wd,(n=t.spinner)&&(n.text="Updating auto-complete list"),i=Object.keys(l),[],this._list=i;case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getList",value:function(e){return e.includes(" ")?this._list:Object.keys(l)}}]),e}();t.AutoComplete=p,t.withAutoComplete=function(e){return function(){var t=i(r.mark((function t(n){var i=arguments;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.autoComplete||(n.autoComplete=new p,n.autoComplete.updateList=u(n.autoComplete.updateList)),t.prev=1,t.next=4,n.autoComplete.updateList(n);case 4:t.next=10;break;case 6:t.prev=6,t.t0=t.catch(1),console.warn("".concat(c.yellow("\u26a0")," failed to update auto-complete list")),o(t.t0);case 10:return o("auto-complete"),t.abrupt("return",e.apply(this,i));case 12:case"end":return t.stop()}}),t,this,[[1,6]])})));return function(e){return t.apply(this,arguments)}}()}},1898:function(e,t,n){var r=n(2),i=n(3);n(22)("dos:loop");e.exports=function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,t();case 3:e.next=0;break;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},1908:function(e,t,n){"use strict";n.r(t);var r=n(5),i=n.n(r),a=n(270),s=n.n(a),o=(n(284),n(285),n(123),n(55)),c=n.n(o),u=n(271);c()("shell:App");c.a.enable("*metro* dos*");var l=function(){return i.a.createElement(u.a,{style:{height:"100vh",backgroundColor:"black"}})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(l,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},191:function(e,t){},20:function(e,t,n){var r=n(47),i=n(7),a=n(4),s=(n(9)("interblock:models:utils"),n(304),n(24),n(128)),o=n(306),c=o.produce;(0,o.setAutoFreeze)(!1);var u=n(307),l=u.modelInflator,p=u.precompileSchema,d=n(93).registry,h=n(48),f=n(63),v=function(e,t,n){var r,i,o,c=function(){a.strictEqual(typeof t,"object");var n=g(e,t),r=n.hash,s=n.proof;i=r,o=s};return{equals:function(e){return!!n(e)&&f(t,e)},serialize:function(){return r||(r=s(t)),r},getHash:function(){return i||(c(),a(i)),i},getProof:function(){return o||(c(),a(o)),o}}},g=function(e,t){switch(e.title){case"Integrity":return{hash:t.hash};case"Block":var n=y(t,["encryption","timestamp","config","covenantId","binaryIntegrity","acl","state","pending"]),r=h.objectHash(b(n));return{hash:t.provenance.getHash(),proof:r};case"Network":var i=b(t);return{hash:i.hash,proof:{networkChannels:i.proof}};case"Channel":var a=d.get("Remote"),s=y(t,["address","replies","requests","heavyHeight","lineageHeight"]),o=a.clone(s),c=["systemRole","requestsLength","heavy","lineage","lineageTip"],u=y(t,c),l=y(e.properties,c),p=m({properties:l},u).hash;return{hash:h.objectHash({remote:o.getHash(),proof:p}),proof:p};case"State":case"SimpleArray":return{hash:h.objectHash(t)};default:return m(e,t)}},y=function(e,t){var n={};return t.forEach((function(t){"undefined"!==typeof e[t]&&(n[t]=e[t])})),n},m=function(e,t){if(e.patternProperties)return{hash:b(t).hash};var n={},r=e.properties;return Object.keys(t).map((function(e){var i=r[e],a=i.title,s=i.type,o=i.patternProperties,c=t[e];if(d.isRegistered(a))n[e]=c.getHash();else if("array"!==s)if(o){var u=b(c).hash;n[e]=u}else n[e]=h.objectHash(c);else n[e]=k(c)})),{hash:h.objectHash(n)}},k=function(e){return h.objectHash(e.map((function(e){return e.getHash()})))},b=function(e){var t=Object.keys(e).map((function(t){return h.objectHash(r({},t,e[t].getHash()))}));return t.sort(),{hash:h.objectHash(t),proof:t}},x=function(e,t){var n=new Proxy(e,{get:function(e,n,r){return t[n]?t[n]:e[n]},set:function(e,t,n,r){throw new Error("Model properties cannot be altered: ".concat(t))},deleteProperty:function(e,t){throw new Error("Model properties cannot be deleted: ".concat(t))}});return n},w=function(e){var t=e.schema.title;["create","logicize"].forEach((function(n){if("function"!==typeof e[n])throw new Error("Model: ".concat(t," needs function: ").concat(n))}));var n=Object.keys(e).length;if(3!==n)throw new Error("Model: ".concat(t," has ").concat(n," properties, not 3"))},I=function(e){return e.create},M=function e(t){Object.freeze(t),Object.getOwnPropertyNames(t).forEach((function(n){if(t.hasOwnProperty(n)){if(void 0===t[n])throw new Error("Values cannot be undefined: ".concat(n));if("function"===typeof t[n])throw new Error("No functions in deepFreeze: ".concat(n));"object"!==typeof t[n]||Object.isFrozen(t[n])||e(t[n])}}))};e.exports={standardize:function(e){w(e),p(e.schema);var t,n=I(e),r=new WeakSet,s=new WeakMap,o=function(e){return r.has(e)},u=Object.freeze(i({},e,{create:n,clone:function(n,p){if(!n)return t||(t=u.create()),t;if(o(n)&&!p)return n;if(n&&"function"===typeof p&&(a(o(n),"instance must be ".concat(e.schema.title)),n=c(n,p)),"string"===typeof n&&(n=JSON.parse(n)),s.has(n))return s.get(n);var d=l(e.schema,n);M(d);var h=e.logicize(d),f=v(e.schema,d,o),g=f.serialize,y=f.getHash,m=f.getProof,k=f.equals,b=i({},h,{serialize:g,getHash:y,getProof:m,equals:k}),w=x(d,b);return r.add(w),s.set(n,w),w},isModel:o}));return u}}},21:function(e,t,n){var r=n(7),i={};["aclModel","actionModel","addressModel","binaryModel","blockModel","covenantIdModel","continuationModel","dmzModel","configModel","integrityModel","interblockModel","keypairModel","lockModel","provenanceModel","publicKeyModel","signatureModel","timestampModel","channelModel","networkModel","stateModel","remoteModel","validatorsModel","proofModel","pendingModel","simpleArrayModel"].forEach((function(e){try{var t=n(303)("./".concat(e));i[e]=t[e]}catch(r){throw console.log("error loading: ".concat(e)),r}}));var a=n(1734),s=n(107),o=n(93).registry;o.registerModels(i),o.registerModels(a),o.registerModels(s);var c=n(1736),u=n(69),l=u.ciSigner,p=u.pierceSigner;e.exports=r({},i,{},s,{},a,{registry:o,cryptoCacher:c,ciSigner:l,pierceSigner:p})},236:function(e,t,n){var r=n(60),i=n(2),a=n(7),s=n(3),o=(n(4),n(153)),c=new(n(129))({allErrors:!0,verbose:!0}),u=n(9)("interblock:apps:datum"),l=n(44),p=n(34).interchain,d={type:"object",title:"Datum",required:["type","namePath","schema","uiSchema","subscribers","children"],additionalProperties:!1,properties:{type:{enum:["COLLECTION","XSTATE","ARRAY","DATA"]},isEditable:{type:"boolean"},namePath:{type:"array",items:{type:"string"}},formData:{type:"object"},schema:{type:"object"},uiSchema:{type:"object"},subscribers:{type:"array",description:"list of paths that need to be notified when changes occur",items:{type:"string"}},children:{type:"object",patternProperties:{"(.*?)":{$ref:"#"}}}}},h={type:"DATA",isEditable:!0,namePath:[],formData:{},schema:{},uiSchema:{},subscribers:[],children:{}},f=function(){var e=s(i.mark((function e(t,n){var r,s,o,c,d,f,y,m;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object.keys(t).length||(t=h),r=n.type,s=n.payload,e.t0=r,e.next="@@INIT"===e.t0?5:"SET"===e.t0?7:28;break;case 5:return u("@@INIT"),e.abrupt("break",29);case 7:if(v(s)&&(t=b(s)),o=g(t,n),t.formData=o.formData,!Object.keys(t.children).length){e.next=27;break}return e.next=13,p(l.actions.listChildren());case 13:c=e.sent,d=c.children,e.t1=i.keys(t.children);case 16:if((e.t2=e.t1()).done){e.next=27;break}if(f=e.t2.value,d[f]){e.next=25;break}return u("creating new child: ",f),y=C.set(a({},o.children[f],{},t.children[f])),m=l.actions.spawn(f),p(m),e.next=25,p(y,f);case 25:e.next=16;break;case 27:return e.abrupt("return",t);case 28:throw new Error("Unknown action: ".concat(r));case 29:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),v=function e(t){if(t.schema&&Object.keys(t.schema).length)return!0;var n=t.children,r=void 0===n?{}:n;return Object.values(r).some(e)},g=function(e,t){var n=t.payload;if(n.isTestData){var i=t.getHash(),a=parseInt(Number("0x"+i.substring(0,14)));o.seed(a)}x(e);var s=n.isTestData,c=r(n,["isTestData"]),u=y(c);return s&&(u=k(e,u)),m(e,u),u},y=function e(t){if(!t||"undefined"===typeof t.formData)return{};var n=t.formData,r={};if("undefined"!==typeof n&&(r.formData=n),t.children&&Object.keys(t.children).length)for(var i in r.children={},t.children)r.children[i]=e(t.children[i]);return r},m=function e(t,n){if(!c.validate(t.schema,n.formData)){var r=c.errorsText(c.errors);throw new Error("".concat(t.schema.title," failed validation: ").concat(r))}for(var i in t.children)e(t.children[i],n.children[i])},k=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.formData,i=void 0===r?{}:r,s=n.children,c=void 0===s?{}:s;Object.keys(t.schema.properties).forEach((function(e){if(!i[e])switch(e){case"firstName":i[e]=o.name.firstName();break;case"address":i[e]=o.address.streetAddress()}}));var u=a({},n,{formData:i});if(Object.keys(t.children).length){var l={};for(var p in t.children)l[p]=e(t.children[p],c[p]);u.children=l}return u},b=function(e){e.isTestData;var t=r(e,["isTestData"]),n=w(t);return n=I(n),x(n),M(n),n},x=function(e){if(!c.validate(d,e)){var t=c.errorsText(c.errors);throw new Error("Datum failed validation: ".concat(t))}},w=function e(t){var n=a({},h,{},t),r=n.children,i={};for(var s in r)i[s]=e(r[s]);return a({},n,{children:i})},I=function e(t){t.formData;var n=t.children,i=void 0===n?{}:n,s=r(t,["formData","children"]),o={};for(var c in i)o[c]=e(i[c]);return a({},s,{children:o})},M=function e(t){c.compile(t.schema),c.compile(t.uiSchema);Object.values(t.children).every(e)},C={set:function(e){return{type:"SET",payload:e}},subscribe:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{type:"SUBSCRIBE",payload:t}},unsubscribe:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{type:"UN_SUBSCRIBE",payload:t}},setDirectEdit:function(){return{type:"SET_DIRECT"}}};e.exports={actions:C,reducer:f,convertToTemplate:b,demuxFormData:g,validateDatumTemplate:x,muxTemplateWithFormData:function e(t,n){var r=a({},t,{children:{}});for(var i in r.formData=n.formData,t.children)r.children[i]=e(t.children[i],n.children[i]);return r}}},238:function(e,t,n){var r=n(17),i=n(4),a=n(9)("interblock:producers:channel"),s=n(24),o=n(21),c=o.addressModel,u=o.channelModel,l=o.interblockModel,p=o.actionModel,d=o.continuationModel,h=function(e,t){var n={};return t.forEach((function(t){"undefined"!==typeof e[t]&&(n[t]=e[t])})),n};e.exports={ingestInterblock:function(e,t){return u.clone(e,(function(n){a("ingestInterblock"),i(l.isModel(t)),i(e.address.equals(t.provenance.getAddress()));var o=t.provenance,c=o.reflectIntegrity(),u=t.getRemote(),p=t.getWithoutRemote(),d=r(e.lineage),f=function(){d.push(c),n.lineageTip.push(p),n.lineageHeight=o.height,a("ingested lineage: ".concat(o.height))},v=function(){if(n.heavy=t,n.heavyHeight=o.height,i(u||o.address.isGenesis()),u){var r=u.requests,s=Object.keys(r),c=h(e.replies,s);n.replies=c,a("ingested heavy: ".concat(o.height))}},g=s.last(e.lineageTip);g?g.provenance.isNext(o)&&f():o.address.isGenesis()&&(a("ingesting genesis"),f(),v()),u&&n.heavy&&o.height>n.heavy.provenance.height&&d.some((function(e){return e.equals(c)}))&&v(),n.lineage=d}))},ingestPierceInterblock:function(e,t){return u.clone(e,(function(n){i(l.isModel(t));var r=t.provenance;i(e.address.equals(r.getAddress()));var s=t.getRemote();i(s),a("ingestPierceInterblock"),n.heavy=t,n.heavyHeight=r.height,n.lineageHeight=r.height;var o=s.requests,c=Object.keys(o),u=h(e.replies,c);n.replies=u}))},setAddress:function(e,t){return u.clone(e,(function(e){i(c.isModel(t)),i(!t.isGenesis()),e.address=t}))},txRequest:function(e,t){return u.clone(e,(function(n){if(a("txRequest"),i(p.isModel(t),"must supply request object"),Object.values(e.requests).some((function(e){return e.equals(t)}))){var r="Duplicate request found: ".concat(t.type,".  All requests must be distinguishable from each other");throw new Error(r)}var s=n.requestsLength;n.requests[s]=t,n.requestsLength++}))},txReply:function(e,t,n){return u.clone(e,(function(r){i(d.isModel(t),"must supply reply object");var a=e.getNextReplyIndex();n=Number.isInteger(n)?n:a;var o=s.last(e.getRemoteRequestIndices());i(n>=0&&n<=o,"replyIndex out of bounds: ".concat(n)),i(e.getRemote().requests[n]);var c=e.replies[n],u=a===n;if(c&&!c.isPromise())throw new Error("Can only settle previous promises: ".concat(n));if(t.isPromise()&&!u)throw new Error("Can only promise for current action: ".concat(n));if(!c&&!u)throw new Error("Can only settle directly with tip: ".concat(t));r.replies[n]=t}))},shiftTxRequest:function(e,t){return u.clone(e,(function(n){i(u.isModel(e)),i(e.rxReply()),a("shiftTxRequest requestsLength: ".concat(e.requestsLength));var r=e.rxReplyIndex();e.address.isLoopback()&&(i(u.isModel(t)),i(t.address.isLoopback()),i(e.address.isLoopback()),r=t.rxReplyIndex(),i(e.replies[r],"loopback empty at ".concat(r)),delete n.replies[r]),i(e.requests[r],"nothing to remove at ".concat(r)),delete n.requests[r]}))}}},240:function(e,t,n){n(1725);var r=n(63),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"@@RESOLVE",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;switch(e){case"@@PROMISE":if(Object.keys(t).length)throw new Error("Promise payload must be empty");if(n)throw new Error("can only promise to the current request - leave blank");break;case"@@RESOLVE":case"@@REJECT":break;default:throw new Error("Disallowed type: ".concat(e))}if("object"!==typeof t)throw new Error("payload must be object: ".concat(t));var r={type:e,payload:t,request:n};return r},a=["@@PROMISE","@@RESOLVE","@@REJECT"],s=function(e){return!e||!e.type||!a.includes(e.type)};e.exports={request:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(!e)throw new Error("Must supply at least one arg");if("object"===typeof e&&(n="string"===typeof t?t:e.to||".",t=e.payload||{},e=e.type),"string"!==typeof e)throw new Error('"type" must be a string: '.concat(e));if("string"!==typeof n)throw new Error('"to" must be a string: '.concat(n));if("object"!==typeof t)throw new Error('"payload" must be an object: '.concat(t));var r={type:e,payload:t,to:n};return r},promise:function(){return i("@@PROMISE")},resolve:function(e,t){return i("@@RESOLVE",e,t)},reject:function(e,t){return i("@@RESOLVE",e,t)},isReplyFor:function(e,t){if(t&&"object"!==typeof t)return!1;if(s(e))return!1;if(!t)return!0;var n=t.type,i=t.payload,a=e&&e.request;return a&&a.type===n&&r(a.payload,i)}}},241:function(e,t,n){var r=n(2),i=n(3),a=n(9)("interblock:covenants:dpkg"),s=n(34).replyResolve,o=function(){var e=i(r.mark((function e(t,n){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n.type,e.next="GET_INSTALL"===e.t0?3:(e.t0,6);break;case 3:return a("getInstaller"),s(t.installer||{}),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();e.exports={reducer:o,actions:{setInstaller:function(){return{type:"SET_INSTALL"}},getInstaller:function(){return{type:"GET_INSTALL"}}}}},242:function(e,t,n){var r=n(2),i=n(3),a=n(9)("interblock:covenants:net"),s=n(4),o=n(34).interchain,c=n(44),u=n(40),l=u.Machine,p=(u.assign,c.actions),d=p.spawn,h=(p.connect,n(21)),f=h.socketModel,v=h.covenantIdModel,g=n(154),y=(g.respond,g.send,g.sendParent,g.translator);e.exports={netFactory:function(e){var t={actions:{},guards:{},services:{addTransport:function(){var e=i(r.mark((function e(t,n){var i,s,c,u;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a("event: %o",n),i=n.payload.url,s=v.create("socket"),c={isPierced:!0},e.next=6,o(d(i,{covenantId:s,config:c}));case 6:return u=e.sent,e.abrupt("return",u);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),rmTransport:function(){var e=i(r.mark((function e(t,n){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}},n=l({id:"net",initial:"idle",context:{},strict:!0,states:{idle:{on:{ADD:"addTransport",RM:"rmTransport",PING:"ping",PING_LAMBDA:"pingLambda",VERSION:"version"}},addTransport:{invoke:{src:"addTransport",onDone:"idle"}},rmTransport:{invoke:{src:"rmTransport",onDone:"idle"}},ping:{invoke:{src:"ping",onDone:"idle"}},pingLambda:{invoke:{src:"pingLambda",onDone:"idle"}},version:{entry:"respondVersion",always:"idle"},done:{id:"done",type:"final"},error:{id:"error",type:"final"}}},t);return{actions:{add:function(e){return s.strictEqual(typeof e,"string"),{type:"ADD",payload:{url:e=e.replace(/\//g,"|")}}},rm:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:"RM",payload:{url:e,force:t}}}},schemas:{add:{type:"object",description:"Add a new transport.  Will result in a child of this chain.",required:["url"],properties:{url:{type:"url"},type:f.schema.properties.type,name:{type:"string"}}},rm:{description:"Removes a transport.  Gracefully attempts to close the connection.\n        Force will terminate immediately by deleting the chain"}},reducer:y(n),covenantId:v.create("net")}}}},243:function(e,t,n){var r=n(2),i=n(7),a=n(3),s=n(17),o=n(9)("interblock:covenants:socket"),c=n(4),u=n(44),l=n(40),p=l.Machine,d=l.assign,h=u.actions,f=(h.spawn,h.connect,h.getGivenName),v=n(21),g=(v.socketModel,v.covenantIdModel),y=n(244).tcpTransportFactory,m=n(34),k=m.effect,b=m.interchain,x=n(154),w=x.respond,I=(x.send,x.sendParent,x.translator);e.exports={socketFactory:function(e){var t={actions:{addChainId:d({chainIds:function(e,t){var n=e.chainIds;c(Array.isArray(n));var r=new Set(n),i=t.payload.chainId;return c.strictEqual(typeof i,"string"),r.add(i),n=s(r),o("chainIds length: %o",n),n}}),rmChainId:d({chainIds:function(e,t){var n=e.chainIds;c(Array.isArray(n));var r=new Set(n),i=t.payload.chainId;return c.strictEqual(typeof i,"string"),r.delete(i),n=s(r),o("chainIds length: %o",n),n}}),assignGivenName:d({givenName:function(e,t){var n=t.data.givenName;return c.strictEqual(typeof n,"string"),o("givenName",n),n}}),respondPing:function(e,t){return o("respondPing",t),w(t.data)},respondOrigin:function(e,t){return w(t.data)}},guards:{},services:{connectSocket:function(){var t=a(r.mark((function t(n,a){var s,c,u,l,p;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o("connectSocket"),t.next=3,b(f());case 3:return s=t.sent,c=s.givenName,o("givenName: %O",c),u=c.replace(/\|/g,"/"),o("url: %O",u),l=e[c]||y(u),e[c]=l,t.next=12,k("CONNECT",l.connect);case 12:return p=t.sent,o("connected to %o",u),t.abrupt("return",i({givenName:c},p));case 15:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),ping:function(){var t=a(r.mark((function t(n,i){var a,s,u;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.givenName,c.strictEqual(typeof a,"string"),o("ping: %O",i),s=e[a]){t.next=6;break}throw new Error("No socket found for: ".concat(a));case 6:return t.next=8,k("PING",s.ping,i.payload.data);case 8:return u=t.sent,o("ping result: %O",u),t.abrupt("return",u);case 11:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),disconnectSocket:function(){var t=a(r.mark((function t(n,a){var s,c,u;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=n.givenName,o("disconnectSocket"),c=e[s]){t.next=5;break}throw new Error("No socket found for: ".concat(s));case 5:return t.next=7,k("DISCONNECT",c.disconnect);case 7:return u=t.sent,delete e[s],o("disconnectSocket result: ",u),t.abrupt("return",i({},u));case 11:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}},n=p({id:"socket",initial:"idle",context:{chainIds:[],givenName:""},strict:!0,states:{idle:{on:{ADD:"addChainId",CONNECT:"connectSocket",DISCONNECT:"disconnectSocket",PING:"ping",PING_LAMBDA:"pingLambda",VERSION:"version",RM:"rmChainId",TRANSMIT:"transmitInterblock"}},addChainId:{entry:"addChainId",always:"idle"},connectSocket:{invoke:{src:"connectSocket",onDone:{target:"idle",actions:["assignGivenName","respondOrigin"]}}},disconnectSocket:{invoke:{src:"disconnectSocket",onDone:{target:"idle",actions:"respondOrigin"}}},ping:{invoke:{src:"ping",onDone:{target:"idle",actions:"respondPing"}}},pingLambda:{invoke:{src:"pingLambda",onDone:"idle"}},version:{invoke:{src:"version",onDone:"idle"}},rmChainId:{entry:"rmChainId",always:"idle"},transmitInterblock:{invoke:{src:"transmitInterblock",onDone:"idle"}},done:{id:"done",type:"final"},error:{id:"error",type:"final"}}},t);return{actions:{addChainId:function(e){return{type:"ADD",payload:{chainId:e}}},connect:function(){return{type:"CONNECT"}},disconnect:function(){return{type:"DISCONNECT"}},ping:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{type:"PING",payload:{data:e}}},pingLambda:function(){return{type:"PING_LAMBDA"}},version:function(){return{type:"VERSION"}},rmChainId:function(e){return{type:"RM",payload:{chainId:e}}},transmit:function(e){return{type:"TRANSMIT",payload:{interblock:e}}}},schemas:{},reducer:I(n),covenantId:g.create("socket")}}}},244:function(e,t,n){var r=n(2),i=n(3),a=n(4),s=n(21),o=(s.blockModel,s.interblockModel,n(9)("interblock:transport")),c=n(1730);e.exports={tcpTransportFactory:function(e){var t;return{connect:function(){var n=i(r.mark((function n(){var s;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a(!t),(t=new c(e)).on("message",(function(e){o("message: %O",e)})),t.on("close",(function(e){return o("close",e)})),t.on("error",(function(e){return o("error %O",e)})),t.on("ping",(function(e){return o("ping",e.toString())})),t.on("pong",(function(e){return o("pong",e.toString())})),t.on("upgrade",(function(e){return o("upgrade")})),s=Date.now(),n.abrupt("return",new Promise((function(n,a){var c=function(){var e=i(r.mark((function e(n){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o("unexpectedResponse"),t.terminate(),a("unexpectedResponse");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t.on("open",(function(){o("socket open to ".concat(e)),t.removeListener("unexpected-response",c),n({latencyMs:Date.now()-s})})),t.on("unexpected-response",c)})));case 10:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),ping:function(){var e=i(r.mark((function e(){var n,i=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>0&&void 0!==i[0]?i[0]:"",o("ping: %O",n),e.abrupt("return",new Promise((function(e){var r=Date.now();t.ping(n),t.on("pong",(function(t){a.strictEqual(t.toString(),n);var i=Date.now()-r;e({data:n,latencyMs:i})}))})));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),pingLambda:function(){var e=i(r.mark((function e(){var n,i=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>0&&void 0!==i[0]?i[0]:"",o("pingLambda: %O",n),e.abrupt("return",new Promise((function(e){var r=Date.now();t.send("PING_LAMBDA ".concat(n)),t.on("message",(function(t){a.strictEqual(t.toString(),"PONG_LAMBDA ".concat(n)),e(Date.now()-r)}))})));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),version:function(){var e=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o("version"),e.abrupt("return",new Promise((function(e){t.send("VERSION"),t.on("message",(function(t){a.strictEqual(t.toString(),"PONG_LAMBDA ".concat(data)),e(Date.now()-start)}))})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),disconnect:function(){var e=i(r.mark((function e(){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Date.now(),t.close(),e.abrupt("return",new Promise((function(e,r){t.on("close",(function(){return e({latencyMs:Date.now()-n})}))})));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),interblock:function(){var e=i(r.mark((function e(n){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:1,a.strictEqual(t.readyState,1,"websocket not open"),t.send(n.serialize());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}}},245:function(e,t,n){var r=n(4),i=n(20).standardize,a=n(68).actionModel,s=i({schema:n(108).rxReplySchema,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"@@RESOLVE",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;r(a.isModel(n),"Request not model: ".concat(n));var i={type:e,payload:t,request:n};return s.clone(i)},logicize:function(e){var t=e.request,n=t.type,r=t.payload,i=a.create({type:n,payload:r});return{getRequest:function(){return i},isReply:function(){return!0}}}});e.exports={rxReplyModel:s}},246:function(e,t,n){var r=n(33),i=n(4),a=n(52).addressModel;e.exports=function(e){i("string"===typeof e);var t,n=e.split("_"),s=r(n,2),o=s[0],c=s[1],u=parseInt(c);return"LOOPBACK"===o?t=a.create("LOOPBACK"):(t=a.create(o),i(t.isResolved())),{address:t,index:u}}},247:function(e,t,n){var r=n(4),i=(n(9)("interblock:models:lock"),n(120).v4),a=n(20).standardize,s=n(104).timestampModel,o=n(84).blockModel,c=n(110).interblockModel,u=n(156).txReplyModel,l=n(157).txRequestModel,p={title:"Lock",description:"Locking of the persistence layer for execution to take place.",type:"object",required:["uuid","timestamp","expires","interblocks","piercings"],additionalProperties:!1,properties:{uuid:{type:"string",description:"uuidv4 identifying a lock on a chainId"},timestamp:s.schema,expires:{type:"integer",description:"ms until the lock expires",min:0},block:o.schema,interblocks:{type:"array",description:"Punched out blocks from other chains that have accumulated for this chain",uniqueItems:!0,items:c.schema},piercings:{type:"object",description:"Side effects",required:["requests","replies"],properties:{requests:{type:"array",uniqueItems:!0,items:l.schema},replies:{type:"array",uniqueItems:!0,items:u.schema}}}}},d={requests:[],replies:[]},h=a({schema:p,create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i(),a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:d;r(!e||o.isModel(e)),t=t.map(c.clone),a=f(e,a);var u=s.create(),l=2e3,p={uuid:n,timestamp:u,expires:l,interblocks:t,piercings:a};return e&&(p.block=e),h.clone(p)},logicize:function(e){var t=e.block,n=e.timestamp,i=e.expires,a=e.piercings,s=f(t,a),o=a.requests,c=a.replies;r.strictEqual(s.requests.length,o.length),r.strictEqual(s.replies.length,c.length);return{isLocked:function(){return!n.isExpired(i)},isMatch:function(t){return t.uuid===e.uuid},isPiercingsPresent:function(){return o.length||c.length}}}}),f=function(e,t){var n=t.requests,i=t.replies;return n=n.map((function(e){return r.strictEqual(typeof e,"object"),e=l.clone(e)})),n=g(n),i=i.map((function(e){return r.strictEqual(typeof e,"object"),e=u.clone(e)})),i=g(i),v(e,{requests:n,replies:i})},v=function(e,t){var n=t.requests,r=t.replies;if(!e||!e.network[".@@io"])return{requests:n,replies:r};var i=e.network[".@@io"].getRemote(),a=i.requests,s=i.replies,o=Object.values(a),c=Object.values(s);return{requests:n=n.filter((function(e){return!o.some((function(t){return t.equals(e)}))})),replies:r=r.filter((function(e){return!c.some((function(t){return t.equals(e)}))}))}},g=function(e){var t=[];return e.forEach((function(e){t.every((function(t){return!e.equals(t)}))&&t.push(e)})),t};e.exports={lockModel:h}},248:function(e,t,n){var r=n(7),i=(n(4),n(120).v4),a=n(20).standardize,s={id:"fd9e9077-cda5-4b1d-afbf-c8a7cf648ded",type:"internal",info:{}},o=a({schema:{title:"Socket",description:"Socket info, used to store info about block producers",type:"object",required:["id","type","info"],additionalProperties:!1,properties:{id:{type:"string"},type:{enum:["internal","websocket","https","email","udp"]},info:{type:"object"}}},create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return e=r({id:i(),type:"internal",info:{}},e),o.clone(r({},e))},logicize:function(e){return{getIsInternal:function(){return"internal"===e.type}}}});e.exports={socketModel:o}},249:function(e,t,n){var r=n(33),i=n(2),a=n(3),s=n(9)("interblock:consistency:db"),o=n(4),c=(n(24),n(114).ramDynamoDbFactory);e.exports={dbFactory:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c(),n=function(){var e=a(i.mark((function e(n,r){var a,s,o;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={TableName:n,Key:r,ConsistentRead:!0,ReturnConsumedCapacity:"TOTAL"},e.next=3,t.get(a).promise();case 3:return s=e.sent,s.ConsumedCapacity,o=s.Item,e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),u=function(e){return n("dbChains",e)},l=function(){var e=a(i.mark((function e(n,r){var a;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(n),o(r),Array.isArray(r)||(r=[r]),a=r.map((function(e){var r={TableName:n,Item:e,ReturnConsumedCapacity:"TOTAL"};return t.put(r).promise()})),e.next=6,Promise.all(a);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),p=function(e){return l("dbPools",e)},d=function(e){return l("dbChains",e)},h=function(e){return l("dbSubscribers",e)},f=function(){var e=a(i.mark((function e(t){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l("dbSockets",t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=a(i.mark((function e(t){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l("dbCrypto",t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=a(i.mark((function e(t){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l("dbPiercings",t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=a(i.mark((function e(n,r){var a;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(Array.isArray(r)),a=r.map((function(e){var r={TableName:n,Key:e,ReturnConsumedCapacity:"TOTAL"};return t.delete(r).promise()})),e.next=4,Promise.all(a);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),m=function(e){return y("dbSubscribers",e)},k=function(e){return y("dbPools",e)},b=function(e){return y("dbPiercings",e)},x=function(){var e=a(i.mark((function e(n,r,a){var c,u,l;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={TableName:n,KeyConditionExpression:"chainId = :hkey",ExpressionAttributeValues:{":hkey":r},ScanIndexForward:!1,ConsistentRead:!0,ReturnConsumedCapacity:"TOTAL"},a&&(c.Limit=1),s("dbQuery: %O %O",n,r),e.next=5,t.query(c).promise();case 5:if(u=e.sent,u.ConsumedCapacity,l=u.Items,o(Array.isArray(l)),s("dbQuery items length: %O",l.length),!a){e.next=11;break}return e.abrupt("return",l[0]);case 11:return e.abrupt("return",l);case 12:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),w=function(e,t){return x("dbSubscribers",e,t)},I=function(e){return x("dbSockets",e)},M=function(e){return x("dbChains",e,!0)},C=function(e){return x("dbPools",e)},P=function(e){return x("dbPiercings",e)},E=function(){var e=a(i.mark((function e(n){var a,s,c,u,l;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={TableName:n,ConsistentRead:!0,Limit:1},e.next=3,t.scan(a).promise();case 3:if(s=e.sent,s.ConsumedCapacity,c=s.Items,o(Array.isArray(c)),!c.length){e.next=10;break}return o.strictEqual(c.length,1),u=r(c,1),l=u[0],e.abrupt("return",l);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(){var t=a(i.mark((function t(){var n;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=2;break}return t.abrupt("return",e);case 2:return t.next=4,E("dbChains");case 4:return(n=t.sent)&&(e=n),t.abrupt("return",e);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),A=function(){var e=a(i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E("dbCrypto"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{putPool:p,putBlock:d,putSubscriptions:h,putSocket:f,delSubscriptions:m,delPool:k,getBlock:u,queryAffected:w,querySockets:I,queryLatest:M,queryPool:C,scanBaseChainId:R,scanKeypair:A,putKeypair:v,putPierce:g,queryPiercings:P,delPierce:b}}}},250:function(e,t,n){var r=n(33),i=n(2),a=n(3),s=n(4),o=n(9)("interblock:consistency:s3"),c=(n(24),n(21)),u=c.cryptoCacher,l=c.blockModel,p=c.interblockModel,d=n(165).ramS3Factory,h={fromInterblock:function(e){var t=e.getHash(),n=e.provenance.getAddress().getChainId(),r=e.provenance.height,i=e.getRemote(),a=i?i.address.getChainId():"#LINEAGE";return"".concat(n,"/").concat(r,"_").concat(a,"_").concat(t)},fromPoolItem:function(e){var t=e.chainId,n=e.originChainId_height_type,i=e.interblockHash,a=n.split("_"),s=r(a,3),o=s[0],c=s[1],u="light"===s[2]?"#LINEAGE":t;return"".concat(o,"/").concat(c,"_").concat(u,"_").concat(i)},fromBlock:function(e){var t=f(e);return h.fromBlockItem(t)},fromBlockItem:function(e){var t=e.chainId,n=e.height,r=e.blockHash;e.shortestLineage;return"".concat(t,"/").concat(n,"_").concat(r)}},f=function(e){return{chainId:e.provenance.getAddress().getChainId(),height:e.provenance.height,blockHash:e.getHash(),shortestLineage:e.provenance.lineage[0]}};e.exports={s3Factory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d(),t=new Map,n=function(){var n=a(i.mark((function n(r,a){var c,u,l;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=e._isRam?a:a.serialize(),u={Bucket:"wbinterbucket",Key:r,Body:c,ContentType:"application/json"},n.next=4,e.putObject(u).promise();case 4:l=n.sent,t.set(r,a),o("putInterblock: %O",r),s(l);case 8:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),r=function(){var n=a(i.mark((function n(r){var a,s,c,l,d;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a={Bucket:"wbinterbucket",Key:r},o("getInterblock"),!t.has(r)){n.next=5;break}return o("interblock cache hit for %o",r),n.abrupt("return",t.get(r));case 5:return n.prev=5,n.next=8,e.getObject(a).promise();case 8:if(s=n.sent,!p.isModel(s.Body)){n.next=13;break}return n.abrupt("return",s.Body);case 13:return c=s.Body.toString(),l=JSON.parse(c),n.next=17,u.cacheVerifyHash(l);case 17:return d=p.clone(c),o("s3GetInterblock complete"),n.abrupt("return",d);case 20:n.next=25;break;case 22:n.prev=22,n.t0=n.catch(5),o("error fetching: %O %O",r,n.t0.message);case 25:case"end":return n.stop()}}),n,null,[[5,22]])})));return function(e){return n.apply(this,arguments)}}(),c=function(){var n=a(i.mark((function n(r){var c;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s(Array.isArray(r)),o("deleteInterblocks: %O",r.length),c=r.map(function(){var n=a(i.mark((function n(r){var a;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a={Bucket:"wbinterbucket",Key:r},n.next=3,e.deleteObject(a).promise();case 3:t.delete(r);case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()),n.next=5,Promise.all(c);case 5:o("deleteInterblocks complete");case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),h=function(){var n=a(i.mark((function n(r,a){var c,u,p;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s(l.isModel(a)),c=e._isRam?a:a.serialize(),u={Bucket:"wbblockbucket",Key:r,Body:c,ContentType:"application/json"},n.next=5,e.putObject(u).promise();case 5:p=n.sent,t.set(r,a),o("putBlock: %O",r),s(p);case 9:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),f=function(){var n=a(i.mark((function n(r){var a,s,c,p,d;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a={Bucket:"wbblockbucket",Key:r},o("getBlock: %O",r),!t.has(r)){n.next=5;break}return o("block cache hit for: %o",r),n.abrupt("return",t.get(r));case 5:return n.next=7,e.getObject(a).promise();case 7:if(s=n.sent,!l.isModel(s.Body)){n.next=10;break}return n.abrupt("return",s.Body);case 10:return c=s.Body.toString(),p=JSON.parse(c),n.next=14,u.cacheVerifyHash(p);case 14:return d=l.clone(p),o("getBlock complete: %O",r),n.abrupt("return",d);case 17:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return{putInterblock:n,getInterblock:r,deleteInterblocks:c,putBlock:h,getBlock:f}},s3Keys:h}},254:function(e,t,n){var r=n(17),i=n(4),a=n(251),s=n(253),o=n(83),c=n(1773),u=n(1774),l=n(21),p=l.interblockModel,d=(l.blockModel,l.addressModel,l.provenanceModel,s.gray("undefined")),h=new WeakMap,f=function(e){if(h.has(e))return h.get(e);var t=o(c(2*e.serialize().length),12);return h.set(e,t),t},v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bgGreen",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"white",r=" ".concat(a(o(e,9),9)," ");return s[n][t].bold(r)},g=function(e){return u(e,{truncate:!0,showHeaders:!1,minWidth:3,config:{msg:{minWidth:15,maxWidth:15},height:{minWidth:8,maxWidth:8},path:{minWidth:18,maxWidth:18}}})},y=function(e,t){var n=m(e),i=m(t),a=[].concat(r(n),r(i)),s=new Set(a),o=r(s);return o.sort((function(e,t){return e-t})),o},m=function(e){var t=[];return Object.keys(e).forEach((function(e){var n=parseInt(e);t.push(n)})),t.sort((function(e,t){return e-t})),t};e.exports={blockPrint:function(e,t,n,r){var i=v(e.provenance.getAddress().getChainId()),a=s.green(e.provenance.height),l=e.provenance.reflectIntegrity().hash,p=s.dim(v(l,"bgWhite","green")),h=(f(e),{msg:r?s.gray("NOCHANGE"):s.green("BLOCK"),height:a,path:t,chainId:i,hash:p});n&&(h.msg=s.red("NEW_CHAIN"));var g=[h],m=e.network.getAliases();!r&&m.forEach((function(t){var n=e.network[t],r=n.address,i="-",a=d,u=d;o(c(2*n.serialize().length),12);r.isResolved()&&(a=v(r.getChainId(),"bgMagenta","gray")),(r.isRoot()||r.isLoopback())&&(a=v(r.getChainId(),"bgBlack","gray"),u="");var l=n.getRemote();if(n.heavy){var p=n.heavy.provenance.reflectIntegrity().hash;u=s.dim(v(p,"bgWhite","magenta"));var h=n.lineageHeight,f=n.heavyHeight;i=s.magenta(f+"."+h)}var m={msg:s.magenta("  \u2514\u2500\u2500 channel"),height:i,path:s.gray(t),chainId:a,hash:u};g.push(m),y(n.requests,l.replies).forEach((function(e){var t=n.requests[e],r=l.replies[e],i=s.cyan("      \u2514\u2500\u2500 tx:"),a=t?t.type:d,o=s.gray(r?r.type:d),c={msg:i,height:s.cyan(e),path:"",chainId:a,hash:o};g.push(c)})),y(l.requests,n.replies).forEach((function(e){var t=l.requests[e],r=n.replies[e],i={msg:s.yellow("      \u2514\u2500\u2500 rx:"),height:s.yellow(e),path:"",chainId:s.gray(t?t.type:d),hash:r?r.type:d};g.push(i)}))}));return function(e){return u(e,{truncate:!0,showHeaders:!1,minWidth:3,config:{msg:{minWidth:15,maxWidth:15},height:{minWidth:8,maxWidth:8},path:{minWidth:18,maxWidth:18}}})}(g)},interPrint:function(e,t,n,r,a){i(p.isModel(e)),t=t||"INTERBLOCK",n=n||"(unknown)",r=r||"bgYellow",a=a||"yellow";var o=e.provenance,c=o.height,u=o.getAddress().getChainId(),l=v(u,r),h=o.reflectIntegrity().hash,y=s.dim(v(h,"bgWhite",a)),m=f(e),k=[{msg:t,height:c,path:n,chainId:l,hash:y,size:m}],b=e.getRemote();return b&&(t=s.magenta("  \u2514\u2500\u2500 channel"),c="-",n=s.gray(e.getOriginAlias()),m=f(b),k.push({msg:t,height:c,path:n,size:m}),t=s.cyan("      \u2514\u2500\u2500 tx:"),Object.keys(b.requests).forEach((function(e){c=e,l=b.requests[e].type,y=d,m=f(b.requests[e]),k.push({msg:t,height:c,chainId:l,hash:y,size:m})})),t=s.yellow("      \u2514\u2500\u2500 rx:"),Object.keys(b.replies).forEach((function(e){c=e,l=d,y=b.replies[e].type,m=f(b.replies[e]),k.push({msg:t,height:c,chainId:l,hash:y,size:m})}))),g(k)}}},260:function(e,t,n){"use strict";var r=n(2),i=n(3),a=n(10),s=n(12),o=n(26),c=n(29),u=n(18),l=n(19),p=n(166),d=function(){throw new Error("expected prompt to have a custom authenticate method")};e.exports=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,n=function(n){l(d,n);var p=u(d);function d(e){return a(this,d),p.call(this,e)}return s(d,[{key:"submit",value:function(){var e=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.call(this,this.values,this.state);case 2:this.value=e.sent,c(o(d.prototype),"base",this).submit.call(this);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"create",value:function(t){return e(t)}}]),d}(p);return n}()},261:function(e,t,n){"use strict";var r=n(32);e.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.cursorHide();var n=t.input,i=void 0===n?"":n,a=t.initial,s=void 0===a?"":a,o=t.pos,c=t.showCursor,u=void 0===c||c,l=t.color,p=l||e.styles.placeholder,d=r.inverse(e.styles.primary),h=function(t){return d(e.styles.black(t))},f=i,v=" ",g=h(v);if(e.blink&&!0===e.blink.off&&(h=function(e){return e},g=""),u&&0===o&&""===s&&""===i)return h(v);if(u&&0===o&&(i===s||""===i))return h(s[0])+p(s.slice(1));s=r.isPrimitive(s)?"".concat(s):"",i=r.isPrimitive(i)?"".concat(i):"";var y=s&&s.startsWith(i)&&s!==i,m=y?h(s[i.length]):g;if(o!==i.length&&!0===u&&(f=i.slice(0,o)+h(i[o])+i.slice(o+1),m=""),!1===u&&(m=""),y){var k=e.styles.unstyle(f+m);return f+m+p(s.slice(k.length))}return f+m}},262:function(e,t,n){"use strict";var r=n(10),i=n(12),a=n(26),s=n(29),o=n(18),c=n(19),u=n(72),l=n(1830),p=function(e){c(n,e);var t=o(n);function n(e){var i;r(this,n);var a=(i=t.call(this,e)).options.history;if(a&&a.store){var s=a.values||i.initial;i.autosave=!!a.autosave,i.store=a.store,i.data=i.store.get("values")||{past:[],present:s},i.initial=i.data.present||i.data.past[i.data.past.length-1]}return i}return i(n,[{key:"completion",value:function(e){return this.store?(this.data=l(e,this.data,this.input),this.data.present?(this.input=this.data.present,this.cursor=this.input.length,this.render()):this.alert()):this.alert()}},{key:"altUp",value:function(){return this.completion("prev")}},{key:"altDown",value:function(){return this.completion("next")}},{key:"prev",value:function(){return this.save(),s(a(n.prototype),"prev",this).call(this)}},{key:"save",value:function(){this.store&&(this.data=l("save",this.data,this.input),this.store.set("values",this.data))}},{key:"submit",value:function(){return this.store&&!0===this.autosave&&this.save(),s(a(n.prototype),"submit",this).call(this)}}]),n}(u);e.exports=p},263:function(e,t,n){"use strict";var r=n(7),i=n(10),a=n(12),s=n(26),o=n(29),c=n(18),u=n(19),l=function(e){u(n,e);var t=c(n);function n(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i(this,n),(e=t.call(this,r({style:"number"},a))).min=e.isValue(a.min)?e.toNumber(a.min):-1/0,e.max=e.isValue(a.max)?e.toNumber(a.max):1/0,e.delay=null!=a.delay?a.delay:1e3,e.float=!1!==a.float,e.round=!0===a.round||!1===a.float,e.major=a.major||10,e.minor=a.minor||1,e.initial=null!=a.initial?a.initial:"",e.input=String(e.initial),e.cursor=e.input.length,e.cursorShow(),e}return a(n,[{key:"append",value:function(e){return!/[-+.]/.test(e)||"."===e&&this.input.includes(".")?this.alert("invalid number"):o(s(n.prototype),"append",this).call(this,e)}},{key:"number",value:function(e){return o(s(n.prototype),"append",this).call(this,e)}},{key:"next",value:function(){return this.input&&this.input!==this.initial?this.alert():this.isValue(this.initial)?(this.input=this.initial,this.cursor=String(this.initial).length,this.render()):this.alert()}},{key:"up",value:function(e){var t=e||this.minor,n=this.toNumber(this.input);return n>this.max+t?this.alert():(this.input="".concat(n+t),this.render())}},{key:"down",value:function(e){var t=e||this.minor,n=this.toNumber(this.input);return n<this.min-t?this.alert():(this.input="".concat(n-t),this.render())}},{key:"shiftDown",value:function(){return this.down(this.major)}},{key:"shiftUp",value:function(){return this.up(this.major)}},{key:"format",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.input;return"function"===typeof this.options.format?this.options.format.call(this,e):this.styles.info(e)}},{key:"toNumber",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.float?+e:Math.round(+e)}},{key:"isValue",value:function(e){return/^[-+]?[0-9]+((\.)|(\.[0-9]+))?$/.test(e)}},{key:"submit",value:function(){var e=this,t=[this.input,this.initial].find((function(t){return e.isValue(t)}));return this.value=this.toNumber(t||0),o(s(n.prototype),"submit",this).call(this)}}]),n}(n(72));e.exports=l},264:function(e,t,n){var r=n(2),i=n(3),a=n(4),s=(n(35).posix||n(35),n(22)("dos:commands:cd")),o=function(){var e=i(r.mark((function e(t){var n,i,o,c,u,l=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.spinner,i=t.blockchain,o=l.length>1&&void 0!==l[1]?l[1]:".",a.strictEqual(typeof o,"string"),s("cd: ".concat(o)),n.text="Resolving ".concat(o),e.next=7,i.cd(o);case 7:return c=i.getContext(),s("context: %O",c),u=c.wd,e.abrupt("return",{ctx:{wd:u}});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();e.exports=o,e.exports.help="\nNavigate through the filesystem graph using Posix compliant pathing.\nCan jump straight to an object by specifying a chainId.\n"},268:function(e,t,n){(function(t){var r=n(2),i=n(3),a=(n(39),n(22)("dos:print"));e.exports=function(){var e=i(r.mark((function e(n){var i,s,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"string"!==typeof n){e.next=5;break}i={out:n},e.next=8;break;case 5:return e.next=7,n();case 7:i=e.sent;case 8:i&&i.out&&(s="[object String]"===Object.prototype.toString.call(i.out)?i.out:JSON.stringify(i.out,null,2),o=s.replace(/(?:\r\n|\r|\n)/g,"\r\n"),t.stdout.write(o),t.stdout.write("\r\n")),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),a(e.t0),t.stderr.writeln("\u274c\ufe0f ".concat(e.t0));case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}()}).call(this,n(11))},271:function(e,t,n){"use strict";(function(e){var r=n(122),i=n(4),a=n.n(i),s=n(5),o=n.n(s),c=n(55),u=n.n(c),l=n(272),p=n(275),d=n(276),h=n(277),f=n(171),v=n.n(f),g=(n(1900),n(1901),n(1902).stdin),y=u()("terminal");u.a.enable("terminal dos:*");var m=function(t){y("toStdStream");var n=function(){var t=e.stdin;g();var n=e.stdin;return Object.defineProperty(e,"stdin",{value:t,writable:!0}),n}();t.stdin=n,t.isTTY=!0;t.clearLine=function(){return t.write("\x1b[2K")},t.cursorTo=function(e,n){y("cursorTo: ",e,n),a.a.strictEqual(e,0);t.write("\x1b[1000D")}},k="F1 F2 F3 F4 F5 F6 F7 F8 F9 F10 F11 F12".split(" ");t.a=function(t){var n=Object(s.useRef)();Object(s.useEffect)((function(){u.a.enable("terminal dos:*"),y("opening terminal");var t=new p.Terminal({cursorBlink:!0,cursorStyle:"underline",convertEol:!0,rendererType:"dom"}),r=new d.FitAddon;t.loadAddon(r);var i=new h.Unicode11Addon;t.loadAddon(i),t.unicode.activeVersion="11",t.open(document.getElementById("xterm-container")),r.fit(),t.focus(),m(t),t.attachCustomKeyEventHandler((function(e){var t=e.key;e.type;if(k.includes(t))return y("ignoring: ".concat(t)),!1})),t.onKey((function(e){var n=e.key;e.domEvent;t.stdin.send(n)})),n.current=t,window.addEventListener("resize",(function(){return r.fit()})),e.stdout=t,e.stdin=t.stdin,e.stderr=t;var a=new v.a("Roboto Mono"),s=b();y("isTor: ",s);var o=[a.load(null,5e6)],c="Roboto Mono";if(s){y("loading emojis for tor browser");var l=new v.a("TorEmoji");o.push(l.load("\ud83e\udd84",5e6)),c+=", TorEmoji"}Promise.all(o).catch((function(e){y("error loading fonts: ",e)})).then((function(){y("fonts loaded "),y("fonts were: ",t.getOption("fontFamily")),t.setOption("fontFamily",c),y("fonts set: ",t.getOption("fontFamily")),r.fit()}))}),[]);var i=Object(l.a)();Object(r.a)(i,2)[1];return o.a.createElement("div",Object.assign({id:"xterm-container"},t))};var b=function(){for(var e=document.fonts.entries(),t=!1;!t;){var n=e.next();if(t=n.done,n.value&&"proxima-nova"===n.value[0].family)return!1}return!0}}).call(this,n(11))},272:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(2),i=n.n(r),a=n(273),s=n(122),o=n(4),c=n.n(o),u=n(5),l=n(121),p=n(55)("useBlockchain"),d=n(1786),h=new Map,f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];c.a.strictEqual(typeof e,"string"),"string"===typeof t&&(t=[t]),c()(Array.isArray(t));var n=Object(u.useState)(),r=Object(s.a)(n,2),o=r[0],f=r[1],v=Object(u.useRef)();Object(u.useEffect)((function(){return function(){var t=Object(a.a)(i.a.mark((function t(){var n,r,a,s;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!v.current){t.next=2;break}return t.abrupt("return");case 2:if(h.has(e)){t.next=14;break}return p("initializing blockchain: ".concat(e)),n=Object(l.effectorFactory)(),h.set(e,n),t.next=8,n;case 8:r=t.sent,a=r.getState(),console.log("state: ",a),h.set(e,r),d([],{blockchain:r});case 14:s=h.get(e),v.current=s,f(s.getState()),s.subscribe((function(){f(s.getState())}));case 18:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()(),function(){p("TODO shutting down shell")}}),[e]);var g=v.current;return[o,g]}},279:function(e,t,n){e.exports=n(1908)},284:function(e,t,n){},285:function(e,t,n){},293:function(e,t,n){var r=n(177).effectorFactory,i=n(1783).awsFactory,a=n(1784).browserFactory;e.exports={effectorFactory:r,awsFactory:i,browserFactory:a}},294:function(e,t,n){(function(t){var r=n(7),i=n(2),a=n(3),s=n(4),o=n(9)("ib:met"),c=n(24),u=n(178).standardEngineFactory,l=n(112).isolateFactory,p=n(53),d=p.consistencyFactory,h=p.ramDynamoDbFactory,f=p.ramS3Factory,v=p.s3Keys,g=n(1758).createBase,y=n(1759).createTap,m=n(44).actions,k=(n(86).shell,n(21)),b=k.blockModel,x=k.interblockModel,w=k.addressModel,I=n(1782).piercerFactory,M=0,C=function(){var e=a(i.mark((function e(n){var p,y,k,C,E,R,A,q,O,S,T,j=arguments;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p=j.length>1&&void 0!==j[1]?j[1]:{},s.strictEqual(typeof p,"object"),n=n||"id-".concat(M++),o.extend("".concat(n)),y=u(),y.sqsTx,y.sqsRx,y.sqsTransmit,k=y.sqsPool,C=y.sqsIncrease,y.ioCrypto,E=y.ioIsolate,R=y.ioConsistency,y.ioPool,y.ioIncrease,E.setProcessor(l(p)),A=h(),q=f(),R.setProcessor(d(A,q,n)),O=P(y,n),e.next=13,g(R,k);case 13:return S=e.sent,T=function e(n,o){s(w.isModel(n));var u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;"number"===typeof e&&void 0===t&&(t=e,e=[]);var r,i=A._getTables(),a=i.dbChains,o=a[n.getChainId()]||{};if(void 0===t)r=c.last(Object.values(o));else{if(!o[t])throw new Error("out of bounds: ".concat(t," ").concat(o.length));r=o[t]}if(r){var u=v.fromBlockItem(r),l=q._getBuckets(),p=l.wbblockbucket,d=p[u];s(b.isModel(d));var h=d;return e.forEach((function(e){s(h[e],"No segment: ".concat(e)),h=h[e]})),h}},l=new Set,d=new Set;R.subscribe(function(){var e=a(i.mark((function e(t,r){var a;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("UNLOCK"!==t.type){e.next=5;break}return e.next=3,r;case 3:a=t.payload.block,d.has(a)||a.getChainId()!==n.getChainId()||(d.add(a),l.forEach((function(e){return e()})));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),t((function(){return l.forEach((function(e){return e()}))}));var h=function(){var e=a(i.mark((function e(n){var r,a;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=Object.values(y);case 1:if(!r.some((function(e){return e.length()||e.awaitingLength()}))){e.next=12;break}return a=r.map((function(e){return e.settle()})),e.next=5,Promise.all(a);case 5:return e.next=7,new Promise(t);case 7:if(!n){e.next=10;break}return e.next=10,n.settle();case 10:e.next=1;break;case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=I(n,R,C);return{pierce:f,spawn:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return f(m.spawn(e,t))},subscribe:function(e){return s.strictEqual(typeof e,"function"),l.add(e),function(){return l.delete(e)}},getState:u,getContext:function(){return u(["state","context"])},getChildren:function(){var t=u(),n=t.network.getAliases(),r={};return n.forEach((function(n){var i=t.network[n];if("./"===i.systemRole){var a=i.address,s="/"===o?n:o+"/"+n;r[n]=e(a,s)}})),r},getAbsolutePath:function(){return o},getChannels:function(){return u().network},getEngine:function(){return y},getPersistence:function(){return R.getProcessor().persistence},getChainId:function(){return u().provenance.getAddress().getChainId()},getHeight:function(){return u().provenance.height},getPool:function(){var e=A._getTables().dbPools[n.getChainId()],t=Object.values(e).map(v.fromPoolItem),r=q._getBuckets().wbinterbucket;return t.map((function(e){var t=r[e];return s(t),x.clone(t)}))},getCovenants:function(){return r({},p)},settle:h,enableLogging:function(){return O.on()},disableLogging:function(){return O.off()}}},e.abrupt("return",T(S,"/"));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(e,t){var n=e.sqsPool,r=e.sqsTransmit,s=e.ioConsistency;debugPrefix=t?"ib:met:".concat(t):"ib:met";var o=y(debugPrefix);return n.subscribe(function(){var e=a(i.mark((function e(t,n){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),r.subscribe(function(){var e=a(i.mark((function e(t,n){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),s.subscribe(function(){var e=a(i.mark((function e(t,n){var r;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("LOCK"!==t.type){e.next=6;break}return r=Date.now(),e.next=4,n;case 4:e.sent&&o.lock(t.payload,r);case 6:if("UNLOCK"!==t.type){e.next=10;break}return e.next=9,n;case 9:o.block(t.payload.block);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),o};e.exports={metrologyFactory:C}}).call(this,n(58).setImmediate)},301:function(e,t,n){(function(t){var r=n(7),i=n(28),a=n(17),s=n(2),o=n(3),c=n(302),u=n(4),l=function(e,r){u(e&&"string"===typeof e);var l,d=n(9)("interblock:queue:"+e),h=!0,f=[],v=new Set,g=Number.MAX_SAFE_INTEGER,y=0,m=function(){var e=o(s.mark((function e(){var t;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Promise.resolve();case 4:for(;h&&v.size<g&&f.length;)d("awaiting size: ".concat(v.size)),t=f.shift(),v.add(t),k(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var n=o(s.mark((function n(r){var i,a,o,c;return s.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return u(r&&"object"===typeof r),i=r.action,a=r.resolve,o=r.reject,r.promise,u(a&&o),n.prev=3,n.next=6,l(i);case 6:c=n.sent,t(a,c),n.next=14;break;case 10:n.prev=10,n.t0=n.catch(3),d("".concat(e," rejected: %O %O"),r,n.t0),t(o,n.t0);case 14:m(),u(v.has(r)),v.delete(r);case 17:case"end":return n.stop()}}),n,null,[[3,10]])})));return function(e){return n.apply(this,arguments)}}(),b=new Set,x={name:e,settle:function(){var e=o(s.mark((function e(){var n;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v.size&&!f.length){e.next=12;break}if(d("settle _awaiting.size: %o _requests.length: %o",v.size,f.length),!v.size){e.next=8;break}return n=a(v).map((function(e){return e.promise})),e.next=6,Promise.race(n);case 6:e.next=10;break;case 8:return e.next=10,new Promise(t);case 10:e.next=0;break;case 12:d("settled");case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),length:function(){return f.length},awaitingLength:function(){return v.size},awaitNextPush:function(){var e=o(s.mark((function e(){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var t=x.subscribe((function(n,r){t(),e(n)}))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),subscribe:function(e){return u("function"===typeof e),b.add(e),function(){return b.delete(e)}},getProcessor:function(){return l},rejectAll:function(){x.setProcessor((function(e){throw new Error("Tried to process: ".concat(JSON.parse(e,null,2)))}))},setConcurrency:function(e){g=e,m()},push:function(){var e=o(s.mark((function e(t){var n,a,o,c;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d("push ".concat(t.type||r.schema.title)),p(r,t),a=new Promise((function(e,r){var i=y++;n={id:i,action:t,resolve:e,reject:r}})),n.promise=a,f.push(n),m(),o=i(b.values());try{for(o.s();!(c=o.n()).done;)(0,c.value)(t,a)}catch(s){o.e(s)}finally{o.f()}return e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setProcessor:function(e){u(!y||!l,"cannot switch after commencing"),u("function"===typeof e),l=e},halt:function(){var e=o(s.mark((function e(t){var n;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c("_isActive"),h=!1,e.next=3,new Promise((function(e){return setTimeout(e,t)}));case 3:n=new Error("Queue is halting operation"),v.values().forEach((function(e){return(0,e.reject)(n)})),v.clear();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};return x},p=function(e,t){e&&(u("function"===typeof e.isModel),u(e.isModel(t),"model is not addable"))};e.exports={ioQueueFactory:l,sqsQueueFactory:function(e,t){u(e&&"string"===typeof e);var i=n(9)("interblock:queue:sqs:"+e),a=l(e,t),c=a.push,d=function(e){a.push(e)};return r({},a,{push:function(){var n=o(s.mark((function n(r){return s.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i("push sqs ".concat(e)),p(t,r),n.next=4,d(r);case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),pushDirect:c,setSqsProcessor:function(e){!a.getProcessor()||a.setProcessor(a.getProcessor()),d=e}})}}}).call(this,n(58).setImmediate)},303:function(e,t,n){var r={"./aclModel":127,"./aclModel.js":127,"./actionModel":68,"./actionModel.js":68,"./addressModel":52,"./addressModel.js":52,"./binaryModel":150,"./binaryModel.js":150,"./blockModel":84,"./blockModel.js":84,"./channelModel":106,"./channelModel.js":106,"./configModel":159,"./configModel.js":159,"./continuationModel":88,"./continuationModel.js":88,"./covenantIdModel":152,"./covenantIdModel.js":152,"./dmzModel":103,"./dmzModel.js":103,"./integrityModel":41,"./integrityModel.js":41,"./interblockModel":110,"./interblockModel.js":110,"./keypairModel":70,"./keypairModel.js":70,"./lockModel":247,"./lockModel.js":247,"./networkModel":105,"./networkModel.js":105,"./pendingModel":161,"./pendingModel.js":161,"./proofModel":163,"./proofModel.js":163,"./provenanceModel":69,"./provenanceModel.js":69,"./publicKeyModel":85,"./publicKeyModel.js":85,"./remoteModel":109,"./remoteModel.js":109,"./signatureModel":151,"./signatureModel.js":151,"./simpleArrayModel":162,"./simpleArrayModel.js":162,"./stateModel":158,"./stateModel.js":158,"./timestampModel":104,"./timestampModel.js":104,"./validatorsModel":160,"./validatorsModel.js":160};function i(e){var t=a(e);return n(t)}function a(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}i.keys=function(){return Object.keys(r)},i.resolve=a,e.exports=i,i.id=303},307:function(e,t,n){var r=n(7),i=n(4),a=(n(9)("interblock:models:modelInflator"),new(n(129))({allErrors:!0,verbose:!0})),s=n(93).registry,o=function(e,t){i("object"===e.type),i(e.patternProperties),i(!e.additionalProperties),i.strictEqual(Object.keys(e.patternProperties).length,1);var n=Object.keys(e.patternProperties)[0],r="[0-9]*"===n,a=e.patternProperties[n],o=s.get(a.title);i(o,"patternProperties must use models for values");var c={};return Object.keys(t).map((function(e){if(r){var n=parseInt(e);i(Number.isInteger(n),"".concat(e," is not number: ").concat(n))}c[e]=o.clone(t[e])})),c},c=function(e,t){if(i(Array.isArray(t)),i("array"===e.type),i(e.uniqueItems,"uniqueItems not set: ".concat(e.title)),"number"===e.items.type)return t;var n=s.get(e.items.title);return i(n,"Arrays must be models"),t.map(n.clone)},u=function(e,t){i(!e.additionalProperties,"additionalProperties: ".concat(e.title));var n=Object.keys(t),r=Object.keys(e.properties),a=e.required.every((function(e){return n.includes(e)}));i(a);var s=n.every((function(e){return r.includes(e)}));i(s,"fail ".concat(e.title))},l=new Map,p=function(e,t){i(e,"No schema supplied");var n=l.get(e);if(!n)try{n=a.compile(e),l.set(e,n)}catch(c){var r="Compilation failed: ".concat(e&&e.title," ").concat(c.message);throw new Error(r)}var s=n(t),o=a.errorsText(n.errors);if(!s)throw new Error("".concat(e.title," failed validation: ").concat(o))};e.exports={modelInflator:function(e,t){if("State"===e.title)return r({},t);if(i(e.title,"only titled schemas can be inflated"),e.patternProperties)return o(e,t);if("array"===e.type)return c(e,t);u(e,t);var n={},a=e.properties;return Object.keys(t).map((function(e){var r=a[e],i=r.title,u=r.type,l=r.patternProperties,d=t[e];s.isRegistered(i)?n[e]=s.get(i).clone(d):"array"!==u?l?n[e]=o(a[e],d):(p(a[e],d),n[e]=d):n[e]=c(a[e],d)})),n},precompileSchema:function(e){i(e.title,"No title supplied"),validator=a.compile(e),l.set(e,validator)}}},32:function(e,t,n){"use strict";(function(e){var r=n(17),i=Object.prototype.toString,a=n(46),s=!1,o=[],c={yellow:"blue",cyan:"red",green:"magenta",black:"white",blue:"yellow",red:"cyan",magenta:"green",white:"black"};t.longest=function(e,t){return e.reduce((function(e,n){return Math.max(e,t?n[t].length:n.length)}),0)},t.hasColor=function(e){return!!e&&a.hasColor(e)};var u=t.isObject=function(e){return null!==e&&"object"===typeof e&&!Array.isArray(e)};t.nativeType=function(e){return i.call(e).slice(8,-1).toLowerCase().replace(/\s/g,"")},t.isAsyncFn=function(e){return"asyncfunction"===t.nativeType(e)},t.isPrimitive=function(e){return null!=e&&"object"!==typeof e&&"function"!==typeof e},t.resolve=function(e,t){if("function"===typeof t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return t.call.apply(t,[e].concat(r))}return t},t.scrollDown=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[].concat(r(e.slice(1)),[e[0]])},t.scrollUp=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[e.pop()].concat(r(e))},t.reorder=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.slice();return t.sort((function(e,t){return e.index>t.index?1:e.index<t.index?-1:0})),t},t.swap=function(e,t,n){var r=e.length,i=n===r?0:n<0?r-1:n,a=e[t];e[t]=e[i],e[i]=a},t.width=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:80,r=t&&t.columns?t.columns:n;return t&&"function"===typeof t.getWindowSize&&(r=t.getWindowSize()[0]),"win32"===e.platform?r-1:r},t.height=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,n=e&&e.rows?e.rows:t;return e&&"function"===typeof e.getWindowSize&&(n=e.getWindowSize()[1]),n},t.wordWrap=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return e;"number"===typeof t&&(t={width:t});var n=t,r=n.indent,i=void 0===r?"":r,a=n.newline,s=void 0===a?"\n"+i:a,o=n.width,c=void 0===o?80:o,u=(s+i).match(/[^\S\n]/g)||[];c-=u.length;var l=".{1,".concat(c,"}([\\s\\u200B]+|$)|[^\\s\\u200B]+?([\\s\\u200B]+|$)"),p=e.trim(),d=new RegExp(l,"g"),h=p.match(d)||[];return h=h.map((function(e){return e.replace(/\n$/,"")})),t.padEnd&&(h=h.map((function(e){return e.padEnd(c," ")}))),t.padStart&&(h=h.map((function(e){return e.padStart(c," ")}))),i+h.join(s)},t.unmute=function(e){var t=e.stack.find((function(e){return a.keys.color.includes(e)}));return t?a[t]:e.stack.find((function(e){return"bg"===e.slice(2)}))?a[t.slice(2)]:function(e){return e}},t.pascal=function(e){return e?e[0].toUpperCase()+e.slice(1):""},t.inverse=function(e){if(!e||!e.stack)return e;var n=e.stack.find((function(e){return a.keys.color.includes(e)}));if(n){var r=a["bg"+t.pascal(n)];return r?r.black:e}var i=e.stack.find((function(e){return"bg"===e.slice(0,2)}));return i?a[i.slice(2).toLowerCase()]||e:a.none},t.complement=function(e){if(!e||!e.stack)return e;var n=e.stack.find((function(e){return a.keys.color.includes(e)})),r=e.stack.find((function(e){return"bg"===e.slice(0,2)}));if(n&&!r)return a[c[n]||n];if(r){var i=r.slice(2).toLowerCase(),s=c[i];return s&&a["bg"+t.pascal(s)]||e}return a.none},t.meridiem=function(e){var t=e.getHours(),n=e.getMinutes(),r=t>=12?"pm":"am";return(0===(t%=12)?12:t)+":"+(n<10?"0"+n:n)+" "+r},t.set=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0;return n.split(".").reduce((function(e,n,i,a){var s=a.length-1>i?e[n]||{}:r;return!t.isObject(s)&&i<a.length-1&&(s={}),e[n]=s}),e)},t.get=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=null==e[t]?t.split(".").reduce((function(e,t){return e&&e[t]}),e):e[t];return null==r?n:r},t.mixin=function(e,n){if(!u(e))return n;if(!u(n))return e;for(var r=0,i=Object.keys(n);r<i.length;r++){var a=i[r],s=Object.getOwnPropertyDescriptor(n,a);if(s.hasOwnProperty("value"))if(e.hasOwnProperty(a)&&u(s.value)){var o=Object.getOwnPropertyDescriptor(e,a);u(o.value)&&o.value!==s.value?e[a]=t.merge({},e[a],n[a]):Reflect.defineProperty(e,a,s)}else Reflect.defineProperty(e,a,s);else Reflect.defineProperty(e,a,s)}return e},t.merge=function(){for(var e={},n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(var a=0,s=r;a<s.length;a++){var o=s[a];t.mixin(e,o)}return e},t.mixinEmitter=function(e,n){for(var r=n.constructor.prototype,i=0,a=Object.keys(r);i<a.length;i++){var s=a[i],o=r[s];"function"===typeof o?t.define(e,s,o.bind(n)):t.define(e,s,o)}},t.onExit=function(t){var n=function(t,n){s||(s=!0,o.forEach((function(e){return e()})),!0===t&&e.exit(128+n))};0===o.length&&(e.once("SIGTERM",n.bind(null,!0,15)),e.once("SIGINT",n.bind(null,!0,2)),e.once("exit",n)),o.push(t)},t.define=function(e,t,n){Reflect.defineProperty(e,t,{value:n})},t.defineExport=function(e,t,n){var r;Reflect.defineProperty(e,t,{enumerable:!0,configurable:!0,set:function(e){r=e},get:function(){return r?r():n()}})}}).call(this,n(11))},34:function(e,t,n){var r=n(7),i=n(240),a=n(1726);e.exports=r({},i,{},a)},341:function(e,t,n){(function(t){var r=n(2),i=n(3),a=n(4),s=n(9)("interblock:crypto:sodium"),o=n(342),c=o.SodiumPlus,u=o.Ed25519PublicKey,l=o.Ed25519SecretKey,p=n(434),d=p.objectHash,h=p.generateNonce,f={publicKey:"I7xUkSwebpLEqGglyGfif/3FVb/71CRPF6Jqv//ull0=",secretKey:"MDEyMzQ1Njc4OWFiY2RlZjAxMjM0NTY3ODlhYmNkZWYjvFSRLB5uksSoaCXIZ+J//cVVv/vUJE8Xomq//+6WXQ=="},v={publicKey:"8aktZHsVyr/yy6arJiJP8F1OI4Na5eQw9pIH6f7XrV0=",secretKey:"r6m8nU2GqsSg38+0TXKXrIgd8WHsJfr5qlSZZDz7GN7xqS1kexXKv/LLpqsmIk/wXU4jg1rl5DD2kgfp/tetXQ=="};Object.freeze(f),Object.freeze(v);var g,y=new Set(["".concat(f.publicKey,"_").concat(f.secretKey),"".concat(v.publicKey,"_").concat(v.secretKey)]),m=function(){return g||(g=c.auto()),g},k=d("template"),b=function(){var e=i(r.mark((function e(){var t,n,i,o,c,u,l,p,d,h=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=h.length>0&&void 0!==h[0]?h[0]:"",e.next=3,m();case 3:for(n=e.sent,a.strictEqual(typeof t,"string"),a(t.length<=32,"seed too long: ".concat(t.length)),t.length&&s("INSECURE padding seed to 32 bytes - got ".concat(t.length));t.length&&t.length<32;)t+="_";if(t.length){e.next=12;break}return e.next=11,n.randombytes_buf(32);case 11:t=e.sent;case 12:return e.next=14,n.crypto_sign_seed_keypair(t);case 14:return i=e.sent,e.next=17,n.crypto_sign_secretkey(i);case 17:return o=e.sent,e.next=20,n.crypto_sign_publickey(i);case 20:return c=e.sent,u={publicKey:c.toString("base64"),secretKey:o.toString("base64")},l=u.publicKey,p=u.secretKey,d="".concat(l,"_").concat(p),y.add(d),e.abrupt("return",u);case 26:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=i(r.mark((function e(t){var n,i,s,o,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.publicKey,i=t.secretKey,a.strictEqual(typeof n,"string"),a.strictEqual(typeof i,"string"),s="".concat(n,"_").concat(i),e.prev=4,e.next=7,w(k,i);case 7:return o=e.sent,c=o.signature,e.next=11,I(k,c,n);case 11:e.sent&&y.add(s),e.next=17;break;case 15:e.prev=15,e.t0=e.catch(4);case 17:return e.abrupt("return",y.has(s));case 18:case"end":return e.stop()}}),e,null,[[4,15]])})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=i(r.mark((function e(t,n){var i,s,o,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.strictEqual(t.length,k.length,"use objectHash()"),i=l.from(n,"base64"),e.next=4,m();case 4:return s=e.sent,e.next=7,s.crypto_sign_detached(t,i);case 7:return o=e.sent,c=o.toString("base64"),e.abrupt("return",{messageHash:t,signature:c});case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),I=function(){var e=i(r.mark((function e(n,i,a){var o,c,l,p,d;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.from(i,"base64"),c=u.from(a,"base64"),e.next=4,m();case 4:return l=e.sent,e.next=7,l.crypto_sign_verify_detached(n,c,o);case 7:return p=e.sent,d="".concat(n,"_").concat(i,"_").concat(a),p?y.add(d):s("verifyHash failed"),e.abrupt("return",p);case 11:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),M=function(){var e=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m();case 2:return t=e.sent,e.abrupt("return",t.getBackendName());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e.exports={objectHash:d,signHash:w,verifyHash:I,verifyHashSync:function(e,t,n){var r="".concat(e,"_").concat(t,"_").concat(n);return y.has(r)},generateKeyPair:b,verifyKeyPair:x,verifyKeyPairSync:function(e){var t=e.publicKey,n=e.secretKey;return y.has("".concat(t,"_").concat(n))},generateNonce:h,testMode:function(){s("no testmode in sodium")},ciKeypair:f,pierceKeypair:v,_verifiedSet:y,_getBackend:M}}).call(this,n(8).Buffer)},351:function(e,t){},353:function(e,t){},38:function(e,t,n){var r=n(7),i=n(17),a={title:"Action",description:"Messages for communicating with a chains reducer.\n  Actions are always delivered as part of a channel between chains.",type:"object",required:["type","payload"],additionalProperties:!1,properties:{type:{type:"string",description:"The type of the action which is specified by the developer"},payload:{type:"object",description:"Type dependent data being transmitted with the action"}}},s={title:"Continuation",description:"Actions that implement the continuation system.",type:"object",required:["type","payload"],additionalProperties:!1,properties:{type:{type:"string",description:"One of three types.  Synchronous replies are resolves or rejections too.",enum:["@@REJECT","@@PROMISE","@@RESOLVE"]},payload:{type:"object",description:"Type dependent data being transmitted with the action"}}},o={title:"Integrity",description:"cryptographically secure hash produced from content.\n  May be 'UNKNOWN' to signal an address is unknown.",type:"object",additionalProperties:!1,required:["hash","algorithm"],properties:{hash:{type:"string",description:"base58 encoded hash hopefully with identifier at front, or UNKNOWN"},algorithm:{enum:["sha256"]}}},c={title:"Address",description:"Hash of the Provenance of the first block in this chain, \n  with prefix, check digits, in base58",type:"object",additionalProperties:!1,required:["chainId","status"],properties:{chainId:o,status:{pattern:"^UNKNOWN$|^GENESIS_|^LOOPBACK$|^ROOT$|^RESOLVED$"}}},u={title:"PublicKey",description:"public key of a public / secret pair",type:"object",additionalProperties:!1,required:["key","algorithm"],properties:{key:{type:"string"},algorithm:{enum:["tweetnacl","sodium"]}}},l={title:"Signature",description:"A cryptographic signature of some detached integrity",type:"object",additionalProperties:!1,required:["publicKey","integrity","seal"],properties:{publicKey:u,integrity:o,seal:{type:"string"}}},p={title:"Provenance",description:'Proof of the Provenance of the object \n  referenced by signed integrity.\n  The integrity of the first provenance in a chain is the chainId.\n  When the provenance is inserted back into the dmz, the dmz becomes a Block.\n  The integrity which is signed is the integrity of the whole object, \n  minus "integrity" and "signatures" keys\n  \n  Integrity can be a merkle proof so a set of chains with the same\n  validators can create signatures for the root hash, then distribute\n  to all the chains where each is blinded to the others in the merkle \n  proof.\n  \n  Running chains internally is much faster than cross block boundaries.',type:"object",additionalProperties:!1,required:["dmzIntegrity","address","lineage","height","integrity","signatures"],properties:{dmzIntegrity:o,address:c,lineage:{type:"object",description:"Object of previous blockhashes this provenance item extends.\n  There may be many, but at least one is the most recent block provenance.\n  Others might be those resulting from overdrive consensus,\n  or periodic shortcutting of the chain history to quick lookup purposes.\n  Height must always be greater than any previous provenance for this address.\n  Provenance is monotonic, and should increment by 1 each time.\n  \n  First lineage supplied to create defines the chainId of the result.\n  \n  Provenance is a statement of authenticity and position in lineage.  \n  Lineage is the chain of previous provenances.\n  \n  Key gives the provenance id, which can be height, or foreignChain:height.\n  Value gives the hash of the block at the provenance id.",patternProperties:{"(.*?)":o}},height:{type:"integer",minimum:0},integrity:o,signatures:{type:"array",items:l,minItems:1,uniqueItems:!0}}},d={title:"Validators",type:"object",additionalProperties:!1,minProperties:1,patternProperties:{"(.*?)":u}},h={title:"Proof",description:"Interblock proof model.",type:"object",additionalProperties:!1,required:["block"],properties:{block:{type:"string"},network:{type:"object"},channel:{type:"string"}}},f={title:"Remote",description:"Slice of Channel state transmitted with a heavy Interblock",type:"object",additionalProperties:!1,required:["address","replies","requests","heavyHeight","lineageHeight"],properties:{address:c,replies:{type:"object",additionalProperties:!1,patternProperties:{"[0-9]*":s}},requests:{type:"object",additionalProperties:!1,patternProperties:{"[0-9]*":a}},heavyHeight:{type:"integer",minimum:-1},lineageHeight:{type:"integer",minimum:-1}}},v={title:"Interblock",description:"The fundamental unit of inter chain communication.\n  Contains provenance, a punched out DMZ, and a single transmit channel\n  of the source chain.\n  This must be an model, so as to ensure we do not leak info, rather \n  than making it a special case of a BlockModel.\n  This cannot import dmzModel directly, as it is a fundamental\n  circular reference, as the outside depends on the inside.\n  This can only be made from a validated block.\n  \n  This is the only place that needs punched out proofs.\n  \n  With no transmit key, an interblock is simply a provenance chain,\n  which is needed to ensure lineage\n  \n  By placing interblock stream inside the transmission, each side of\n  a connection can know what block of theirs the other side has processed.",type:"object",required:["provenance","proof","validators"],additionalProperties:!1,properties:{provenance:p,proof:h,network:{type:"object",additionalProperties:!1,minProperties:0,maxProperties:1,patternProperties:{"(.*?)":f}},validators:d}},g={title:"Channel",description:"Communication Queues.\n  These queues and their responses are what all interchain\n  communication seeks to facilitate.  All the cryptography\n  employed in this system is to reliably process these \n  queues.\n  \n  Each connection side has a transmit and a receive.\n  Each connection side transmits requests and replies to the other.\n  \n  Transmit = Sum( Channel ) \n  Receive = Sum( Interblock( Channel ) )\n  Interblocks  = Channel + Provenance\n  \n  'provenance' contains a continuous chain all the way back to  the foreign genesis.\n  \n  The contents of the latest received channel is stored on 'remote'\n  Replies are always processed before incoming requests.\n  When a received reply has executed, the local transmit action is removed\n  from the transmit queue.\n  \n  The queues hold the index for their next actions within them:\n  1.  Next remote reply index is the smallest index of the transit queue\n      for which there is a remote reply that is not a promise\n  2.  Next remote request index is given by the local highest reply index\n  \n  If systemRole === '.' then provenance checks are excused, as the\n  networkProducer.tx() function will flip outbound and inbound.  This is used\n  in the self channel.\n  \n  Counter is required to know where the request counter is up to, which needs independent\n  tracking as the channel might be cleared completely, but we cannot reuse numbers until\n  looparound at 32bit limit or similar",type:"object",required:[].concat(i(f.required),["systemRole","requestsLength","lineage","lineageTip"]),additionalProperties:!1,properties:r({},f.properties,{systemRole:{enum:["..",".","./","UP_LINK","DOWN_LINK","PIERCE"]},requestsLength:{type:"integer",minimum:0},heavy:v,lineage:{type:"array",uniqueItems:!0,items:o},lineageTip:{type:"array",uniqueItems:!0,items:v}})};e.exports={integritySchema:o,addressSchema:c,proofSchema:h,interblockSchema:v,provenanceSchema:p,validatorsSchema:d,signatureSchema:l,publicKeySchema:u,remoteSchema:f,channelSchema:g,actionSchema:a,continuationSchema:s}},383:function(e,t){},384:function(e,t){},41:function(e,t,n){var r=n(4),i=(n(9)("interblock:models:integrity"),n(48)),a=(0,n(20).standardize)({schema:n(38).integritySchema,create:function(e){if(!e||"UNKNOWN"===e)return a.clone({hash:"UNKNOWN",algorithm:"sha256"});"string"===typeof e&&(e={string:e}),r("object"===typeof e,"Must supply object: ".concat(e));var t={hash:i.objectHash(e),algorithm:"sha256"};return a.clone(t)},logicize:function(e){return{isUnknown:function(){return"UNKNOWN"===e.hash},isIntegrityMatch:function(t){return a.create(t).hash===e.hash}}}});e.exports={integrityModel:a}},434:function(e,t,n){(function(t){var r=n(435)({coerce:!1}),i=n(438),a=n(83),s=n(440),o=0;e.exports={objectHash:function(e){if("undefined"===typeof t){var n=r.sort(e);return s(n,{algorithm:"sha256",encoding:"hex"})}return r.hash(e)},generateNonce:function(e){if(e){var t=a(9,o,"0");return o++,"0x".concat(t,"c6ee4f60107cc496d1dcacd642be4011c3b4fe09668f08f01f41cc9")}return"0x"+i(32,{type:"Array"}).map((function(e){return("0"+(255&e).toString(16)).slice(-2)})).join("")}}}).call(this,n(11))},439:function(e,t){},44:function(e,t,n){var r=n(1720);e.exports=r},442:function(e,t,n){var r=n(60),i=n(2),a=n(7),s=n(3),o=n(4),c=(new(n(129))({allErrors:!0,verbose:!0}),n(9)("interblock:apps:collection")),u=n(236),l=u.datum,p=u.convertToTemplate,d=u.demuxFormData,h=u.validateDatumTemplate,f=u.muxTemplateWithFormData,v=n(34).interchain,g=n(44).actions.spawn,y=function(){var e=s(i.mark((function e(t,n){var r,s,o,u,y,x,w,I,M,C,P,E;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.type,s=n.payload,e.t0=r,e.next="ADD"===e.t0?4:"SET_TEMPLATE"===e.t0?26:29;break;case 4:if(o=t.datumTemplate,h(o),s.isTestData||m(s),u=d(o,n),y=b(o,u),x=l.covenantId,w=g(y,{covenantId:x}),!y){e.next=15;break}v(w),e.next=20;break;case 15:return e.next=17,v(w);case 17:I=e.sent,M=I.alias,y=M;case 20:return C=f(o,u),P=l.actions.set(C),c("set",P),e.next=25,v(P,y);case 25:return e.abrupt("return",t);case 26:return k(s),E=p(s),e.abrupt("return",a({},t,{datumTemplate:E}));case 29:throw c(n),new Error("Unknown action type: ".concat(n.type));case 31:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),m=function e(t){var n=t.formData,i=t.children,a=r(t,["formData","children"]);if("undefined"===typeof n)throw new Error("Must provide formData key");if(a)throw new Error("Only allowed keys are formData and children");if(i){if("object"!==typeof i)throw new Error("children must be object");return Object.values(i).every(e)}},k=function e(t){if(t.formData)throw new Error("No formData allowed on datum template");if(t.children)return Object.values(t.children).every(e)},b=function(e,t){if(e.namePath.length){var n=t.formData;return e.namePath.forEach((function(e){n=n[e]})),o.strictEqual(typeof n,"string"),c("_getChildName",n),n}c("_getChildName is blank")};e.exports={reducer:y,actions:{add:function(e){return{type:"ADD",payload:e}},setDatumTemplate:function(e){return{type:"SET_TEMPLATE",payload:e}},search:function(){return{type:"SEARCH"}},lock:function(){return{type:"LOCK"}},delete:function(){return{type:"DELETE"}}}}},45:function(e,t,n){"use strict";var r=n(134),i=n(2),a=n(28),s=n(3),o=n(7),c=n(10),u=n(12),l=n(18),p=n(19),d=n(4),h=n(51),f=n(32),v=function(e){p(v,e);var t=l(v);function v(e,n){var r;return c(this,v),(r=t.call(this)).options=f.merge({},e),r.answers=o({},n),r}return u(v,[{key:"register",value:function(e,t){if(f.isObject(e)){for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];this.register(i,e[i])}return this}d.equal(typeof t,"function","expected a function");var a=e.toLowerCase();return t.prototype instanceof this.Prompt?this.prompts[a]=t:this.prompts[a]=t(this.Prompt,this),this}},{key:"prompt",value:function(){var e=s(i.mark((function e(){var t,n,r,s,o=arguments;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=o.length>0&&void 0!==o[0]?o[0]:[],n=a([].concat(t)),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=20;break}if(s=r.value,e.prev=6,"function"!==typeof s){e.next=11;break}return e.next=10,s.call(this);case 10:s=e.sent;case 11:return e.next=13,this.ask(f.merge({},this.options,s));case 13:e.next=18;break;case 15:return e.prev=15,e.t0=e.catch(6),e.abrupt("return",Promise.reject(e.t0));case 18:e.next=4;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(2),n.e(e.t1);case 25:return e.prev=25,n.f(),e.finish(25);case 28:return e.abrupt("return",this.answers);case 29:case"end":return e.stop()}}),e,this,[[2,22,25,28],[6,15]])})));return function(){return e.apply(this,arguments)}}()},{key:"ask",value:function(){var e=s(i.mark((function e(t){var n,r,a,s,o,c,u,l,p,h=this;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!==typeof t){e.next=4;break}return e.next=3,t.call(this);case 3:t=e.sent;case 4:if(n=f.merge({},this.options,t),a=(r=t).type,s=r.name,o=f.set,c=f.get,"function"!==typeof a){e.next=11;break}return e.next=10,a.call(this,t,this.answers);case 10:a=e.sent;case 11:if(a){e.next=13;break}return e.abrupt("return",this.answers[s]);case 13:if(d(this.prompts[a],'Prompt "'.concat(a,'" is not registered')),u=new this.prompts[a](n),l=c(this.answers,s),u.state.answers=this.answers,u.enquirer=this,s&&u.on("submit",(function(e){h.emit("answer",s,e,u),o(h.answers,s,e)})),p=u.emit.bind(u),u.emit=function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=h.emit).call.apply(e,[h].concat(n)),p.apply(void 0,n)},this.emit("prompt",u,this),!n.autofill||null==l){e.next=29;break}if(u.value=u.input=l,"show"!==n.autofill){e.next=27;break}return e.next=27,u.submit();case 27:e.next=32;break;case 29:return e.next=31,u.run();case 31:l=u.value=e.sent;case 32:return e.abrupt("return",l);case 33:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"use",value:function(e){return e.call(this,this),this}},{key:"Prompt",set:function(e){this._Prompt=e},get:function(){return this._Prompt||this.constructor.Prompt}},{key:"prompts",get:function(){return this.constructor.prompts}}],[{key:"Prompt",set:function(e){this._Prompt=e},get:function(){return this._Prompt||n(89)}},{key:"prompts",get:function(){return n(1824)}},{key:"types",get:function(){return n(1844)}},{key:"prompt",get:function(){var e=this,t=function t(n){for(var i=arguments.length,a=new Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];var o=r(e,a),c=o.emit.bind(o);return o.emit=function(){return t.emit.apply(t,arguments),c.apply(void 0,arguments)},o.prompt(n)};return f.mixinEmitter(t,new h),t}}]),v}(h);f.mixinEmitter(v,new h);for(var g=v.prompts,y=function(){var e=k[m],t=e.toLowerCase(),n=function(t){return new g[e](t).run()};v.prompt[t]=n,v[t]=n,v[e]||Reflect.defineProperty(v,e,{get:function(){return g[e]}})},m=0,k=Object.keys(g);m<k.length;m++)y();var b=function(e){f.defineExport(v,e,(function(){return v.types[e]}))};b("ArrayPrompt"),b("AuthPrompt"),b("BooleanPrompt"),b("NumberPrompt"),b("StringPrompt"),e.exports=v},48:function(e,t,n){e.exports=n(341)},52:function(e,t,n){var r=n(7),i=n(4),a=n(48),s=n(20).standardize,o=n(41).integrityModel,c=s({schema:n(38).addressSchema,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.create(),t="UNKNOWN";if("GENESIS"===e)t="GENESIS_".concat(a.generateNonce()),e=o.create("UNKNOWN");else if("LOOPBACK"===e)t="LOOPBACK",e=o.create("UNKNOWN");else if("ROOT"===e)t="ROOT",e=o.create("UNKNOWN");else if("string"===typeof e){var n=o.create(e);if(n.hash.length===e.length){var s=e;e=o.clone(r({},n,{hash:s}))}else e=n}return o.isModel(e)||debug("integrity not model: ",e),i(o.isModel(e)),e.isUnknown()||(t="RESOLVED"),c.clone({chainId:e,status:t})},logicize:function(e){var t=e.chainId,n=e.status;return{getChainId:function(){if("LOOPBACK"===n)return"LOOPBACK";if("ROOT"===n)return"ROOT";if("RESOLVED"!==n)throw new Error("Tried to get chainId on address with status: ".concat(n));return t.hash},isRoot:function(){return"ROOT"===n},isLoopback:function(){return"LOOPBACK"===n},isGenesis:function(){return n.startsWith("GENESIS_")},isUnknown:function(){return"UNKNOWN"===n},isResolved:function(){return"RESOLVED"===n}}}});e.exports={addressModel:c}},53:function(e,t,n){var r=n(1739).consistencySourceFactory,i=n(1745),a=i.toFunctions,s=i.fromFunctions,o=n(114).ramDynamoDbFactory,c=n(165).ramS3Factory,u=n(250).s3Keys,l=n(249).dbFactory;e.exports={consistencyFactory:function(e,t,n){var i=r(e,t,n);return s(i)},toFunctions:a,ramDynamoDbFactory:o,ramS3Factory:c,consistencySourceFactory:r,s3Keys:u,dbFactory:l}},61:function(e,t,n){"use strict";var r=n(2),i=n(3),a=n(10),s=n(12),o=n(26),c=n(29),u=n(18),l=n(19),p=n(115),d=n(32),h=function(e){l(n,e);var t=u(n);function n(e){var r;return a(this,n),(r=t.call(this,e)).emptyError=r.options.emptyError||"No items were selected",r}return s(n,[{key:"dispatch",value:function(){var e=i(r.mark((function e(t,i){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.multiple){e.next=11;break}if(!this[i.name]){e.next=7;break}return e.next=4,this[i.name](t,i);case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,c(o(n.prototype),"dispatch",this).call(this,t,i);case 9:e.t0=e.sent;case 10:return e.abrupt("return",e.t0);case 11:this.alert();case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"separator",value:function(){if(this.options.separator)return c(o(n.prototype),"separator",this).call(this);var e=this.styles.muted(this.symbols.ellipsis);return this.state.submitted?c(o(n.prototype),"separator",this).call(this):e}},{key:"pointer",value:function(e,t){return!this.multiple||this.options.pointer?c(o(n.prototype),"pointer",this).call(this,e,t):""}},{key:"indicator",value:function(e,t){return this.multiple?c(o(n.prototype),"indicator",this).call(this,e,t):""}},{key:"choiceMessage",value:function(e,t){var n=this.resolve(e.message,this.state,e,t);return"heading"!==e.role||d.hasColor(n)||(n=this.styles.strong(n)),this.resolve(n,this.state,e,t)}},{key:"choiceSeparator",value:function(){return":"}},{key:"renderChoice",value:function(){var e=i(r.mark((function e(t,n){var i,a,s,o,c,u,l,p=this;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onChoice(t,n);case 2:return i=this.index===n,e.next=5,this.pointer(t,n);case 5:return a=e.sent,e.next=8,this.indicator(t,n);case 8:return e.t0=e.sent,e.t1=t.pad||"",s=e.t0+e.t1,e.next=13,this.resolve(t.hint,this.state,t,n);case 13:return(o=e.sent)&&!d.hasColor(o)&&(o=this.styles.muted(o)),c=this.indent(t),e.next=18,this.choiceMessage(t,n);case 18:if(u=e.sent,l=function(){return[p.margin[3],c+a+s,u,p.margin[1],o].filter(Boolean).join(" ")},"heading"!==t.role){e.next=22;break}return e.abrupt("return",l());case 22:if(!t.disabled){e.next=25;break}return d.hasColor(u)||(u=this.styles.disabled(u)),e.abrupt("return",l());case 25:return i&&(u=this.styles.em(u)),e.abrupt("return",l());case 27:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"renderChoices",value:function(){var e=i(r.mark((function e(){var t,n,a,s,o=this;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("choices"!==this.state.loading){e.next=2;break}return e.abrupt("return",this.styles.warning("Loading choices"));case 2:if(!this.state.submitted){e.next=4;break}return e.abrupt("return","");case 4:return t=this.visible.map(function(){var e=i(r.mark((function e(t,n){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.renderChoice(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),e.next=7,Promise.all(t);case 7:if((n=e.sent).length||n.push(this.styles.danger("No matching choices")),a=this.margin[0]+n.join("\n"),!this.options.choicesHeader){e.next=14;break}return e.next=13,this.resolve(this.options.choicesHeader,this.state);case 13:s=e.sent;case 14:return e.abrupt("return",[s,a].filter(Boolean).join("\n"));case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"format",value:function(){var e=this;return!this.state.submitted||this.state.cancelled?"":Array.isArray(this.selected)?this.selected.map((function(t){return e.styles.primary(t.name)})).join(", "):this.styles.primary(this.selected.name)}},{key:"render",value:function(){var e=i(r.mark((function e(){var t,n,i,a,s,o,c,u,l,p,d,h;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.submitted,i=t.size,a="",e.next=4,this.header();case 4:return s=e.sent,e.next=7,this.prefix();case 7:return o=e.sent,e.next=10,this.separator();case 10:return c=e.sent,e.next=13,this.message();case 13:return u=e.sent,!1!==this.options.promptLine&&(a=[o,u,c,""].join(" "),this.state.prompt=a),e.next=17,this.format();case 17:return l=e.sent,e.next=20,this.error();case 20:if(e.t0=e.sent,e.t0){e.next=25;break}return e.next=24,this.hint();case 24:e.t0=e.sent;case 25:return p=e.t0,e.next=28,this.renderChoices();case 28:return d=e.sent,e.next=31,this.footer();case 31:h=e.sent,l&&(a+=l),p&&!a.includes(p)&&(a+=" "+p),n&&!l&&!d.trim()&&this.multiple&&null!=this.emptyError&&(a+=this.styles.danger(this.emptyError)),this.clear(i),this.write([s,a,d,h].filter(Boolean).join("\n")),this.write(this.margin[2]),this.restore();case 39:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(p);e.exports=h},68:function(e,t,n){var r=n(7),i=n(20).standardize,a=n(38).actionSchema,s=0,o=function(){return"DEFAULT_ACTION_".concat(s++)},c=i({schema:a,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"===typeof e&&(e={type:e,payload:t}),e.payload||(e=r({},e,{payload:{}})),c.clone(e)},logicize:function(e){return{}}});e.exports={actionModel:c}},69:function(e,t,n){var r,i=n(17),a=n(2),s=n(7),o=n(3),c=n(4),u=(n(24),n(9)("interblock:models:provenance"),n(20).standardize),l=n(41).integrityModel,p=n(70).keypairModel,d=n(52).addressModel,h=n(38).provenanceSchema,f=n(48),v=p.create("PIERCE",f.pierceKeypair),g=p.create("CI",f.ciKeypair),y=function(e){return c(l.isModel(e)),g.sign(e)},m=u({schema:h,create:function(e,t){var i=arguments;return o(a.mark((function o(){var u,p,h,f,v,g,k,b,x,w,I;return a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return u=i.length>2&&void 0!==i[2]?i[2]:{},p=i.length>3&&void 0!==i[3]?i[3]:y,r||(r=n(103).dmzModel,c(r)),e=e||r.create(),c(r.isModel(e)),c(!t||m.isModel(t)),c.strictEqual(typeof u,"object"),c(Object.values(u).every(l.isModel)),c(!Object.keys(u).length||t),h=l.create(),dmzIntegrity=l.clone(s({},h,{hash:e.getHash()})),f=d.create("GENESIS"),v=0,g=s({},u),t&&(k=t.reflectIntegrity(),c(!Object.values(g).some((function(e){return e.equals(k)}))),g[t.height]=k,v=t.height+1,f=t.getAddress()),b={dmzIntegrity:dmzIntegrity,address:f,lineage:g,height:v},x=l.create(b),a.next=19,p(x);case 19:return w=a.sent,I=[w],a.abrupt("return",m.clone(s({},b,{integrity:x,signatures:I})));case 22:case"end":return a.stop()}}),o)})))()},logicize:function(e){if(e.dmzIntegrity.isUnknown())throw new Error("Dmz not a genuine type of integrity: ".concat(e.dmzIntegrity.hash));var t=Object.keys(e.lineage).map((function(e){return parseInt(e)}));c(t.length||e.address.isGenesis()),c(e.height||e.address.isGenesis()),c(t.every((function(t){return t>=0&&t<e.height}))),c.strictEqual(e.signatures.length,1,"single signer only");if(!function(){var t={};["dmzIntegrity","address","lineage","height"].forEach((function(n){return t[n]=e[n]}));var n=l.create(t).equals(e.integrity);return n}())throw new Error("Self integrity degraded - refusing to instantiate");if(!e.signatures.length||!e.signatures.every((function(t){return t.integrity.equals(e.integrity)})))throw new Error("Signature degraded - refusing to instantiate");var n=l.create(e),r=e.address;0===e.height&&(c(r.isGenesis()),r=d.create(n));var a=function(){return n};return{merge:function(){},getAddress:function(){return r},reflectIntegrity:a,isNext:function(t){var n=Object.values(t.lineage).some((function(e){return e.equals(a())})),r=t.height>e.height;t.signatures[0].publicKey;return n&&r},getShortestHeight:function(){var n=i(t);n.sort((function(e,t){return e-t}));var r=n.shift();return c(r>=0&&r<e.height),r}}}});e.exports={provenanceModel:m,ciSigner:y,pierceSigner:function(e){return c(l.isModel(e)),v.sign(e)}}},70:function(e,t,n){var r=n(2),i=n(3),a=n(47),s=n(4),o=n(9)("interblock:models:keypair"),c=n(48),u=n(20).standardize,l=n(85).publicKeyModel,p=n(41).integrityModel,d=n(151).signatureModel,h=u({schema:{title:"Keypair",description:"public private key pair",type:"object",additionalProperties:!1,required:["name","publicKey","secretKey","algorithm"],properties:{name:{type:"string"},publicKey:l.schema,secretKey:{type:"string"},algorithm:{enum:["tweetnacl","sodium"]}}},create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"CI",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.ciKeypair;s.strictEqual(typeof e,"string");var n=l.clone({key:t.publicKey,algorithm:"sodium"}),r=t.secretKey;return h.clone({name:e,publicKey:n,secretKey:r,algorithm:"sodium"})},logicize:function(e){var t={publicKey:e.publicKey.key,secretKey:e.secretKey};if(!c.verifyKeyPairSync(t))throw new Error("Not a valid keypair - refusing to instantiate");return{sign:function(){var t=i(r.mark((function t(n){var i,a,u,l,h,f,v,g;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o("sign"),n){t.next=3;break}throw new Error("Refusing to sign undefined integrity");case 3:return n=p.clone(n),i=n.hash,a=e.publicKey,u=e.secretKey,t.next=8,c.signHash(i,u);case 8:return l=t.sent,h=l.signature,t.next=12,c.verifyHash(i,h,a.key);case 12:return f=t.sent,s(f),s(c.verifyHashSync(i,h,a.key)),v={publicKey:a,integrity:n,seal:h},g=d.clone(v),o("sign complete"),t.abrupt("return",g);case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),getValidatorEntry:function(){return a({},e.name,e.publicKey)}}}});e.exports={keypairModel:h}},71:function(e,t,n){var r=n(1721),i=n(1722),a=n(1723),s=n(238),o=n(1724);e.exports={networkProducer:r,blockProducer:i,lockProducer:a,channelProducer:s,pendingProducer:o}},72:function(e,t,n){"use strict";var r=n(2),i=n(3),a=n(10),s=n(12),o=n(26),c=n(29),u=n(18),l=n(19),p=n(89),d=n(261),h=n(32).isPrimitive,f=function(e){l(n,e);var t=u(n);function n(e){var r;return a(this,n),(r=t.call(this,e)).initial=h(r.initial)?String(r.initial):"",r.initial&&r.cursorHide(),r.state.prevCursor=0,r.state.clipboard=[],r}return s(n,[{key:"keypress",value:function(){var e=i(r.mark((function e(t){var i,a,s=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=s.length>1&&void 0!==s[1]?s[1]:{},a=this.state.prevKeypress,this.state.prevKeypress=i,!0!==this.options.multiline||"return"!==i.name){e.next=6;break}if(a&&"return"===a.name){e.next=6;break}return e.abrupt("return",this.append("\n",i));case 6:return e.abrupt("return",c(o(n.prototype),"keypress",this).call(this,t,i));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"moveCursor",value:function(e){this.cursor+=e}},{key:"reset",value:function(){return this.input=this.value="",this.cursor=0,this.render()}},{key:"dispatch",value:function(e,t){if(!e||t.ctrl||t.code)return this.alert();this.append(e)}},{key:"append",value:function(e){var t=this.state,n=t.cursor,r=t.input;this.input="".concat(r).slice(0,n)+e+"".concat(r).slice(n),this.moveCursor(String(e).length),this.render()}},{key:"insert",value:function(e){this.append(e)}},{key:"delete",value:function(){var e=this.state,t=e.cursor,n=e.input;if(t<=0)return this.alert();this.input="".concat(n).slice(0,t-1)+"".concat(n).slice(t),this.moveCursor(-1),this.render()}},{key:"deleteForward",value:function(){var e=this.state,t=e.cursor,n=e.input;if(void 0===n[t])return this.alert();this.input="".concat(n).slice(0,t)+"".concat(n).slice(t+1),this.render()}},{key:"cutForward",value:function(){var e=this.cursor;if(this.input.length<=e)return this.alert();this.state.clipboard.push(this.input.slice(e)),this.input=this.input.slice(0,e),this.render()}},{key:"cutLeft",value:function(){var e=this.cursor;if(0===e)return this.alert();var t=this.input.slice(0,e),n=this.input.slice(e),r=t.split(" ");this.state.clipboard.push(r.pop()),this.input=r.join(" "),this.cursor=this.input.length,this.input+=n,this.render()}},{key:"paste",value:function(){if(!this.state.clipboard.length)return this.alert();this.insert(this.state.clipboard.pop()),this.render()}},{key:"toggleCursor",value:function(){this.state.prevCursor?(this.cursor=this.state.prevCursor,this.state.prevCursor=0):(this.state.prevCursor=this.cursor,this.cursor=0),this.render()}},{key:"first",value:function(){this.cursor=0,this.render()}},{key:"last",value:function(){this.cursor=this.input.length-1,this.render()}},{key:"next",value:function(){var e=null!=this.initial?String(this.initial):"";if(!e||!e.startsWith(this.input))return this.alert();this.input=this.initial,this.cursor=this.initial.length,this.render()}},{key:"prev",value:function(){if(!this.input)return this.alert();this.reset()}},{key:"backward",value:function(){return this.left()}},{key:"forward",value:function(){return this.right()}},{key:"right",value:function(){return this.cursor>=this.input.length?this.alert():(this.moveCursor(1),this.render())}},{key:"left",value:function(){return this.cursor<=0?this.alert():(this.moveCursor(-1),this.render())}},{key:"isValue",value:function(e){return!!e}},{key:"format",value:function(){var e=i(r.mark((function e(){var t,n,i=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:this.value,e.next=3,this.resolve(this.initial,this.state);case 3:if(n=e.sent,this.state.submitted){e.next=6;break}return e.abrupt("return",d(this,{input:t,initial:n,pos:this.cursor}));case 6:return e.abrupt("return",this.styles.submitted(t||n));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=i(r.mark((function e(){var t,n,i,a,s,o,c,u,l;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.size,e.next=3,this.prefix();case 3:return n=e.sent,e.next=6,this.separator();case 6:return i=e.sent,e.next=9,this.message();case 9:return a=e.sent,s=[n,a,i].filter(Boolean).join(" "),this.state.prompt=s,e.next=14,this.header();case 14:return o=e.sent,e.next=17,this.format();case 17:return c=e.sent,e.next=20,this.error();case 20:if(e.t0=e.sent,e.t0){e.next=25;break}return e.next=24,this.hint();case 24:e.t0=e.sent;case 25:return u=e.t0,e.next=28,this.footer();case 28:l=e.sent,u&&!c.includes(u)&&(c+=" "+u),s+=" "+c,this.clear(t),this.write([o,s,l].filter(Boolean).join("\n")),this.restore();case 34:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(p);e.exports=f},84:function(e,t,n){var r=n(60),i=n(2),a=n(3),s=n(17),o=n(7),c=n(4),u=n(9)("interblock:models:block"),l=n(20).standardize,p=n(69).provenanceModel,d=n(70).keypairModel,h=n(103).dmzModel,f=n(41).integrityModel,v=h.schema,g=o({},v,{title:"Block",description:"The fundamental unit of state persistence and transmission\nA DMZ with a 'provenance' key is a block.",required:[].concat(s(v.required),["provenance"]),properties:o({},v.properties,{provenance:p.schema})}),y=function(){var e=a(i.mark((function e(t){var n;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.create("CI");case 2:return n=e.sent,c(f.isModel(t)),e.abrupt("return",n.sign(t));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=l({schema:g,create:function(e){var t=arguments;return a(i.mark((function n(){var r,a,s,l;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.length>1&&void 0!==t[1]?t[1]:y,u("create"),c("function"===typeof r),e=h.clone(e),void 0,a={},n.next=8,p.create(e,void 0,a,r);case 8:return s=n.sent,l=m.clone(o({},e,{provenance:s})),n.abrupt("return",l);case 11:case"end":return n.stop()}}),n)})))()},logicize:function(e){var t=e.network.getAliases().some((function(t){var n=e.network[t].address;return e.provenance.getAddress().equals(n)}));c(!t,"Loop detected");var n=e.provenance,i=r(e,["provenance"]),a=h.clone(i),s=a.getHash();c(s===n.dmzIntegrity.hash);return{isValidated:function(){if(n.address.isGenesis())return!0;var e=a.validators,t=Object.values(e),r=n.signatures.map((function(e){return e.publicKey})),i=t.every((function(e){return r.some((function(t){return t.equals(e)}))})),s=r.every((function(e){return t.some((function(t){return t.equals(e)}))}));return i&&s},getDmz:function(){return a},whoami:function(e,t){c(m.isModel(t)),e.forEach((function(e){publicKeyModel.clone(e)}))},isNext:function(t){var n=m.isModel(t),r=t.isValidated(),i=e.provenance.isNext(t.provenance);return n&&r&&i},getChainId:function(){return e.provenance.getAddress().getChainId()}}}});e.exports={blockModel:m}},85:function(e,t,n){var r=(0,n(20).standardize)({schema:n(38).publicKeySchema,create:function(){throw new Error("Only the keypairModel can create publicKeyModel types")},logicize:function(e){return{}}});e.exports={publicKeyModel:r}},86:function(e,t,n){var r=n(21).covenantIdModel,i=n(442);i.covenantId=r.create("collection");var a=n(236);a.covenantId=r.create("datum");var s=n(241);s.covenantId=r.create("dpkg");var o=n(1727);o.covenantId=r.create("shell");var c=n(242);c.covenantId=r.create("net");var u=n(243);u.covenantId=r.create("socket");var l=n(1731);l.covenantId=r.create("hyper");var p={reducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e}};p.covenantId=r.create("unity");var d=n(1732);d.covenantId=r.create("probe"),e.exports={collection:i,datum:a,dpkg:s,hyper:l,net:c,probe:d,shell:o,socket:u,unity:p},Object.values(e.exports).forEach(Object.freeze)},88:function(e,t,n){var r=n(4),i=(0,n(20).standardize)({schema:n(38).continuationSchema,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"@@RESOLVE",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.clone({type:e,payload:t})},logicize:function(e){"@@PROMISE"===e.type&&r.strictEqual(Object.keys(e.payload).length,0,"Promises cannot have payloads");return{isPromise:function(){return"@@PROMISE"===e.type},isRejection:function(){return"@@REJECT"===e.type},isResolve:function(){return"@@RESOLVE"===e.type}}}});e.exports={continuationModel:i}},89:function(e,t,n){"use strict";(function(t){var r=n(2),i=n(3),a=n(10),s=n(12),o=n(74),c=n(18),u=n(19),l=n(51),p=n(46),d=n(1815),h=n(1818),f=n(1819),v=n(1820),g=n(32),y=n(1823),m=function(e){u(l,e);var n=c(l);function l(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a(this,l),(e=n.call(this)).name=r.name,e.type=r.type,e.options=r,v(o(e)),h(o(e)),e.state=new f(o(e)),e.initial=[r.initial,r.default].find((function(e){return null!=e})),e.stdout=r.stdout||t.stdout,e.stdin=r.stdin||t.stdin,e.scale=r.scale||1,e.term=e.options.term||Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).TERM_PROGRAM,e.margin=b(e.options.margin),e.setMaxListeners(0),k(o(e)),e}return s(l,[{key:"keypress",value:function(){var e=i(r.mark((function e(t){var n,i,a,s=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]?s[1]:{},this.keypressed=!0,i=d.action(t,d(t,n),this.options.actions),this.state.keypress=i,this.emit("keypress",t,i),this.emit("state",this.state.clone()),"function"!==typeof(a=this.options[i.action]||this[i.action]||this.dispatch)){e.next=11;break}return e.next=10,a.call(this,t,i);case 10:return e.abrupt("return",e.sent);case 11:this.alert();case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"alert",value:function(){delete this.state.alert,!1===this.options.show?this.emit("alert"):this.stdout.write(y.code.beep)}},{key:"cursorHide",value:function(){var e=this;this.stdout.write(y.cursor.hide()),g.onExit((function(){return e.cursorShow()}))}},{key:"cursorShow",value:function(){this.stdout.write(y.cursor.show())}},{key:"write",value:function(e){e&&(this.stdout&&!1!==this.state.show&&this.stdout.write(e),this.state.buffer+=e)}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.state.buffer;this.state.buffer="",(t||e)&&!1!==this.options.show&&this.stdout.write(y.cursor.down(e)+y.clear(t,this.width))}},{key:"restore",value:function(){if(!this.state.closed&&!1!==this.options.show){var e=this.sections(),t=e.prompt,n=e.after,r=e.rest,i=this.cursor,a=this.initial,s=void 0===a?"":a,o=this.input,c=void 0===o?"":o,u=this.value,l=void 0===u?"":u,p={after:n,cursor:i,initial:s,input:c,prompt:t,size:this.state.size=r.length,value:l},d=y.cursor.restore(p);d&&this.stdout.write(d)}}},{key:"sections",value:function(){var e=this.state,t=e.buffer,n=e.input,r=e.prompt;r=p.unstyle(r);var i=p.unstyle(t),a=i.indexOf(r),s=i.slice(0,a),o=i.slice(a).split("\n"),c=o[0],u=o[o.length-1],l=(r+(n?" "+n:"")).length,d=l<c.length?c.slice(l+1):"";return{header:s,prompt:c,after:d,rest:o.slice(1),last:u}}},{key:"submit",value:function(){var e=i(r.mark((function e(){var t,n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.submitted=!0,this.state.validating=!0,!this.options.onSubmit){e.next=5;break}return e.next=5,this.options.onSubmit.call(this,this.name,this.value,this);case 5:if(e.t0=this.state.error,e.t0){e.next=10;break}return e.next=9,this.validate(this.value,this.state);case 9:e.t0=e.sent;case 10:if(!0===(t=e.t0)){e.next=23;break}return n="\n"+this.symbols.pointer+" ",n+="string"===typeof t?t.trim():"Invalid input",this.state.error="\n"+this.styles.danger(n),this.state.submitted=!1,e.next=18,this.render();case 18:return e.next=20,this.alert();case 20:return this.state.validating=!1,this.state.error=void 0,e.abrupt("return");case 23:return this.state.validating=!1,e.next=26,this.render();case 26:return e.next=28,this.close();case 28:return e.next=30,this.result(this.value);case 30:this.value=e.sent,this.emit("submit",this.value);case 32:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.cancelled=this.state.submitted=!0,e.next=3,this.render();case 3:return e.next=5,this.close();case 5:if("function"!==typeof this.options.onCancel){e.next=8;break}return e.next=8,this.options.onCancel.call(this,this.name,this.value,this);case 8:return e.t0=this,e.next=11,this.error(t);case 11:e.t1=e.sent,e.t0.emit.call(e.t0,"cancel",e.t1);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"close",value:function(){var e=i(r.mark((function e(){var t,n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.state.closed=!0;try{t=this.sections(),n=Math.ceil(t.prompt.length/this.width),t.rest&&this.write(y.cursor.down(t.rest.length)),this.write("\n".repeat(n))}catch(r){}this.emit("close");case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"start",value:function(){this.stop||!1===this.options.show||(this.stop=d.listen(this,this.keypress.bind(this)),this.once("close",this.stop))}},{key:"skip",value:function(){var e=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.skipped=!0===this.options.skip,"function"!==typeof this.options.skip){e.next=5;break}return e.next=4,this.options.skip.call(this,this.name,this.value);case 4:this.skipped=e.sent;case 5:return e.abrupt("return",this.skipped);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initialize",value:function(){var e=i(r.mark((function e(){var t,n,a,s,o,c=this;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.format,n=this.options,a=this.result,this.format=function(){return t.call(c,c.value)},this.result=function(){return a.call(c,c.value)},"function"!==typeof n.initial){e.next=7;break}return e.next=6,n.initial.call(this,this);case 6:this.initial=e.sent;case 7:if("function"!==typeof n.onRun){e.next=10;break}return e.next=10,n.onRun.call(this,this);case 10:return"function"===typeof n.onSubmit&&(s=n.onSubmit.bind(this),o=this.submit.bind(this),delete this.options.onSubmit,this.submit=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(c.name,c.value,c);case 2:return e.abrupt("return",o());case 3:case"end":return e.stop()}}),e)})))),e.next=13,this.start();case 13:return e.next=15,this.render();case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){throw new Error("expected prompt to have a custom render method")}},{key:"run",value:function(){var e=this;return new Promise(function(){var t=i(r.mark((function t(n,i){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.once("submit",n),e.once("cancel",i),t.next=4,e.skip();case 4:if(!t.sent){t.next=7;break}return e.render=function(){},t.abrupt("return",e.submit());case 7:return t.next=9,e.initialize();case 9:e.emit("run");case 10:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}},{key:"element",value:function(){var e=i(r.mark((function e(t,n,i){var a,s,o,c,u,l,p,d;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.options,s=this.state,o=this.symbols,c=this.timers,u=c&&c[t],s.timer=u,l=a[t]||s[t]||o[t],!n||null==n[t]){e.next=8;break}e.t0=n[t],e.next=11;break;case 8:return e.next=10,l;case 10:e.t0=e.sent;case 11:if(""!==(p=e.t0)){e.next=14;break}return e.abrupt("return",p);case 14:return e.next=16,this.resolve(p,s,n,i);case 16:if((d=e.sent)||!n||!n[t]){e.next=19;break}return e.abrupt("return",this.resolve(l,s,n,i));case 19:return e.abrupt("return",d);case 20:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"prefix",value:function(){var e=i(r.mark((function e(){var t,n,i,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.element("prefix");case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=this.symbols;case 5:if(t=e.t0,n=this.timers&&this.timers.prefix,(i=this.state).timer=n,g.isObject(t)&&(t=t[i.status]||t.pending),g.hasColor(t)){e.next=13;break}return a=this.styles[i.status]||this.styles.pending,e.abrupt("return",a(t));case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"message",value:function(){var e=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.element("message");case 2:if(t=e.sent,g.hasColor(t)){e.next=5;break}return e.abrupt("return",this.styles.strong(t));case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"separator",value:function(){var e=i(r.mark((function e(){var t,n,i,a,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.element("separator");case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=this.symbols;case 5:return t=e.t0,n=this.timers&&this.timers.separator,(i=this.state).timer=n,a=t[i.status]||t.pending||i.separator,e.next=12,this.resolve(a,i);case 12:if(s=e.sent,g.isObject(s)&&(s=s[i.status]||s.pending),g.hasColor(s)){e.next=16;break}return e.abrupt("return",this.styles.muted(s));case 16:return e.abrupt("return",s);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pointer",value:function(){var e=i(r.mark((function e(t,n){var i,a,s,o,c,u;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.element("pointer",t,n);case 2:if("string"!==typeof(i=e.sent)||!g.hasColor(i)){e.next=5;break}return e.abrupt("return",i);case 5:if(!i){e.next=14;break}return a=this.styles,s=this.index===n,o=s?a.primary:function(e){return e},e.next=11,this.resolve(i[s?"on":"off"]||i,this.state);case 11:return c=e.sent,u=g.hasColor(c)?c:o(c),e.abrupt("return",s?u:" ".repeat(c.length));case 14:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"indicator",value:function(){var e=i(r.mark((function e(t,n){var i,a,s,o,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.element("indicator",t,n);case 2:if("string"!==typeof(i=e.sent)||!g.hasColor(i)){e.next=5;break}return e.abrupt("return",i);case 5:if(!i){e.next=11;break}return a=this.styles,s=!0===t.enabled,o=s?a.success:a.dark,c=i[s?"on":"off"]||i,e.abrupt("return",g.hasColor(c)?c:o(c));case 11:return e.abrupt("return","");case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"body",value:function(){return null}},{key:"footer",value:function(){if("pending"===this.state.status)return this.element("footer")}},{key:"header",value:function(){if("pending"===this.state.status)return this.element("header")}},{key:"hint",value:function(){var e=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("pending"!==this.state.status||this.isValue(this.state.input)){e.next=7;break}return e.next=3,this.element("hint");case 3:if(t=e.sent,g.hasColor(t)){e.next=6;break}return e.abrupt("return",this.styles.muted(t));case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"error",value:function(e){return this.state.submitted?"":e||this.state.error}},{key:"format",value:function(e){return e}},{key:"result",value:function(e){return e}},{key:"validate",value:function(e){return!0!==this.options.required||this.isValue(e)}},{key:"isValue",value:function(e){return null!=e&&""!==e}},{key:"resolve",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return g.resolve.apply(g,[this,e].concat(n))}},{key:"base",get:function(){return l.prototype}},{key:"style",get:function(){return this.styles[this.state.status]}},{key:"height",get:function(){return this.options.rows||g.height(this.stdout,25)}},{key:"width",get:function(){return this.options.columns||g.width(this.stdout,80)}},{key:"size",get:function(){return{width:this.width,height:this.height}}},{key:"cursor",set:function(e){this.state.cursor=e},get:function(){return this.state.cursor}},{key:"input",set:function(e){this.state.input=e},get:function(){return this.state.input}},{key:"value",set:function(e){this.state.value=e},get:function(){var e=this.state,t=e.input,n=[e.value,t].find(this.isValue.bind(this));return this.isValue(n)?n:this.initial}}],[{key:"prompt",get:function(){var e=this;return function(t){return new e(t).run()}}}]),l}(l);function k(e){for(var t=function(t){return void 0===e[t]||"function"===typeof e[t]},n=["actions","choices","initial","margin","roles","styles","symbols","theme","timers","value"],r=["body","footer","error","header","hint","indicator","message","prefix","separator","skip"],i=0,a=Object.keys(e.options);i<a.length;i++){var s=a[i];if(!n.includes(s)&&!/^on[A-Z]/.test(s)){var o=e.options[s];"function"===typeof o&&t(s)?r.includes(s)||(e[s]=o.bind(e)):"function"!==typeof e[s]&&(e[s]=o)}}}function b(e){"number"===typeof e&&(e=[e,e,e,e]);for(var t=[].concat(e||[]),n=function(e){return e%2===0?"\n":" "},r=[],i=0;i<4;i++){var a=n(i);t[i]?r.push(a.repeat(t[i])):r.push("")}return r}e.exports=m}).call(this,n(11))},93:function(e,t){var n={},r={registerModels:function(e){Object.keys(e).forEach((function(t){var r=e[t];if(!t||!e[t])throw new Error("".concat(t," passed in as undefined"));var i=r.schema.title;if(n[i])throw new Error("".concat(i," was already registered"));n[i]=r}))},isRegistered:function(e){return!!n[e]},get:function(e){if(!n[e])throw new Error("Model not found in registry: ".concat(e));return n[e]},_getContainer:function(){return n}};e.exports={registry:r}}},[[279,1,2]]]);