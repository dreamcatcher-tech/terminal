/*! For license information please see main.7e9d6d2a.chunk.js.LICENSE.txt */
(this.webpackJsonpterminal=this.webpackJsonpterminal||[]).push([[0],Array(20).concat([function(e,t,n){var r=n(53),i=n(8),s=n(4),a=(n(11)("interblock:models:utils"),n(291)),o=n(24),c=n(124),u=n(293),l=u.produce;(0,u.setAutoFreeze)(!1);var p=n(294).modelInflator,h=n(127).registry,d=n(54),f=n(99).assertNoUndefined,v=n(59),y=function(e,t,n){var r,i,o,u=function(){s.equal(typeof t,"object");var n=g(e,t),r=n.hash,a=n.proof;i=r,o=a};return{equals:function(e){return!!n(e)&&v(t,e)},serialize:function(){return r||(f(t),s(!a(t),"state must be stringifiable"),r=c(t)),r},getHash:function(){return i||(u(),s(i)),i},getProof:function(){return o||(u(),s(o)),o}}},g=function(e,t){switch(e.title){case"Integrity":return{hash:t.hash};case"Block":var n=o.omit(t,["provenance","network","validators"]),r=d.objectHash(b(n));return{hash:t.provenance.getHash(),proof:r};case"Network":var i=b(t);return{hash:i.hash,proof:{networkChannels:i.proof}};case"Channel":var s=h.get("Remote"),a=s.clone(o.pick(t,["address","requests","replies","heavyHeight","lineageHeight"])),c=o.omit(t,Object.keys(a)),u=o.omit(e.properties,s.schema.properties),l=m({properties:u},c).hash;return{hash:d.objectHash({remote:a.getHash(),proof:l}),proof:l};case"State":return{hash:d.objectHash(t)};default:return m(e,t)}},m=function(e,t){if(e.patternProperties)return{hash:b(t).hash};var n={},r=e.properties;return Object.keys(t).map((function(e){var i=r[e],s=i.title,a=i.type,o=i.patternProperties,c=t[e];if(h.isRegistered(s))n[e]=c.getHash();else if("array"!==a)if(o){var u=b(c).hash;n[e]=u}else n[e]=d.objectHash(c);else n[e]=k(c)})),{hash:d.objectHash(n)}},k=function(e){return d.objectHash(e.map((function(e){return e.getHash()})))},b=function(e){var t=Object.keys(e).map((function(t){return d.objectHash(r({},t,e[t].getHash()))}));return t.sort(),{hash:d.objectHash(t),proof:t}},x=function(e,t){var n=new Proxy(e,{get:function(e,n,r){return t[n]?t[n]:e[n]},set:function(e,t,n,r){throw new Error("Model properties cannot be altered: ".concat(t))},deleteProperty:function(e,t){throw new Error("Model properties cannot be deleted: ".concat(t))}});return n},w=function(e){var t=e.schema.title;["create","logicize"].forEach((function(n){if("function"!==typeof e[n])throw new Error("Model: ".concat(t," needs function: ").concat(n))}));var n=Object.keys(e).length;if(3!==n)throw new Error("Model: ".concat(t," has ").concat(n," properties, not 3"))};e.exports={standardize:function(e){var t;w(e);var n=new WeakSet,r=new WeakMap,a=function(e){return n.has(e)},o=Object.freeze(i({},e,{clone:function(c,u){if(!c)return t||(t=o.create()),t;if(a(c)&&!u)return c;if(c&&"function"===typeof u&&(s(a(c),"instance must be ".concat(e.schema.title)),c=l(c,u)),"string"===typeof c&&(c=JSON.parse(c)),r.has(c))return r.get(c);var h=p(e.schema,c),d=e.logicize(h),f=y(e.schema,h,a),v=f.serialize,g=f.getHash,m=f.getProof,k=f.equals,b=i({},d,{equals:k,serialize:v,getHash:g,getProof:m}),w=x(h,b);return Object.freeze(w),n.add(w),r.set(c,w),w},isModel:a}));return o}}},,,function(e,t,n){var r=n(8),i={};["aclModel","actionModel","addressModel","binaryModel","blockModel","covenantIdModel","continuationModel","dmzModel","configModel","integrityModel","interblockModel","keypairModel","lockModel","provenanceModel","publicKeyModel","signatureModel","timestampModel","channelModel","networkModel","stateModel","remoteModel","validatorsModel","proofModel"].forEach((function(e){try{var t=n(290)("./".concat(e));i[e]=t[e]}catch(r){throw console.log("error loading: ".concat(e)),r}}));var s=n(127).registry,a=n(439),o=n(229);s.registerModels(i),s.registerModels(a),s.registerModels(o);var c=n(441);e.exports=r({},i,{},o,{},a,{registry:s,cryptoCacher:c})},,,,,,,,,function(e,t,n){"use strict";(function(e){var r=n(19),i=Object.prototype.toString,s=n(42),a=!1,o=[],c={yellow:"blue",cyan:"red",green:"magenta",black:"white",blue:"yellow",red:"cyan",magenta:"green",white:"black"};t.longest=function(e,t){return e.reduce((function(e,n){return Math.max(e,t?n[t].length:n.length)}),0)},t.hasColor=function(e){return!!e&&s.hasColor(e)};var u=t.isObject=function(e){return null!==e&&"object"===typeof e&&!Array.isArray(e)};t.nativeType=function(e){return i.call(e).slice(8,-1).toLowerCase().replace(/\s/g,"")},t.isAsyncFn=function(e){return"asyncfunction"===t.nativeType(e)},t.isPrimitive=function(e){return null!=e&&"object"!==typeof e&&"function"!==typeof e},t.resolve=function(e,t){if("function"===typeof t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return t.call.apply(t,[e].concat(r))}return t},t.scrollDown=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[].concat(r(e.slice(1)),[e[0]])},t.scrollUp=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[e.pop()].concat(r(e))},t.reorder=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.slice();return t.sort((function(e,t){return e.index>t.index?1:e.index<t.index?-1:0})),t},t.swap=function(e,t,n){var r=e.length,i=n===r?0:n<0?r-1:n,s=e[t];e[t]=e[i],e[i]=s},t.width=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:80,r=t&&t.columns?t.columns:n;return t&&"function"===typeof t.getWindowSize&&(r=t.getWindowSize()[0]),"win32"===e.platform?r-1:r},t.height=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,n=e&&e.rows?e.rows:t;return e&&"function"===typeof e.getWindowSize&&(n=e.getWindowSize()[1]),n},t.wordWrap=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return e;"number"===typeof t&&(t={width:t});var n=t,r=n.indent,i=void 0===r?"":r,s=n.newline,a=void 0===s?"\n"+i:s,o=n.width,c=void 0===o?80:o,u=(a+i).match(/[^\S\n]/g)||[];c-=u.length;var l=".{1,".concat(c,"}([\\s\\u200B]+|$)|[^\\s\\u200B]+?([\\s\\u200B]+|$)"),p=e.trim(),h=new RegExp(l,"g"),d=p.match(h)||[];return d=d.map((function(e){return e.replace(/\n$/,"")})),t.padEnd&&(d=d.map((function(e){return e.padEnd(c," ")}))),t.padStart&&(d=d.map((function(e){return e.padStart(c," ")}))),i+d.join(a)},t.unmute=function(e){var t=e.stack.find((function(e){return s.keys.color.includes(e)}));return t?s[t]:e.stack.find((function(e){return"bg"===e.slice(2)}))?s[t.slice(2)]:function(e){return e}},t.pascal=function(e){return e?e[0].toUpperCase()+e.slice(1):""},t.inverse=function(e){if(!e||!e.stack)return e;var n=e.stack.find((function(e){return s.keys.color.includes(e)}));if(n){var r=s["bg"+t.pascal(n)];return r?r.black:e}var i=e.stack.find((function(e){return"bg"===e.slice(0,2)}));return i?s[i.slice(2).toLowerCase()]||e:s.none},t.complement=function(e){if(!e||!e.stack)return e;var n=e.stack.find((function(e){return s.keys.color.includes(e)})),r=e.stack.find((function(e){return"bg"===e.slice(0,2)}));if(n&&!r)return s[c[n]||n];if(r){var i=r.slice(2).toLowerCase(),a=c[i];return a&&s["bg"+t.pascal(a)]||e}return s.none},t.meridiem=function(e){var t=e.getHours(),n=e.getMinutes(),r=t>=12?"pm":"am";return(0===(t%=12)?12:t)+":"+(n<10?"0"+n:n)+" "+r},t.set=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0;return n.split(".").reduce((function(e,n,i,s){var a=s.length-1>i?e[n]||{}:r;return!t.isObject(a)&&i<s.length-1&&(a={}),e[n]=a}),e)},t.get=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=null==e[t]?t.split(".").reduce((function(e,t){return e&&e[t]}),e):e[t];return null==r?n:r},t.mixin=function(e,n){if(!u(e))return n;if(!u(n))return e;for(var r=0,i=Object.keys(n);r<i.length;r++){var s=i[r],a=Object.getOwnPropertyDescriptor(n,s);if(a.hasOwnProperty("value"))if(e.hasOwnProperty(s)&&u(a.value)){var o=Object.getOwnPropertyDescriptor(e,s);u(o.value)&&o.value!==a.value?e[s]=t.merge({},e[s],n[s]):Reflect.defineProperty(e,s,a)}else Reflect.defineProperty(e,s,a);else Reflect.defineProperty(e,s,a)}return e},t.merge=function(){for(var e={},n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(var s=0,a=r;s<a.length;s++){var o=a[s];t.mixin(e,o)}return e},t.mixinEmitter=function(e,n){for(var r=n.constructor.prototype,i=0,s=Object.keys(r);i<s.length;i++){var a=s[i],o=r[a];"function"===typeof o?t.define(e,a,o.bind(n)):t.define(e,a,o)}},t.onExit=function(t){var n=function(t,n){a||(a=!0,o.forEach((function(e){return e()})),!0===t&&e.exit(128+n))};0===o.length&&(e.once("SIGTERM",n.bind(null,!0,15)),e.once("SIGINT",n.bind(null,!0,2)),e.once("exit",n)),o.push(t)},t.define=function(e,t,n){Reflect.defineProperty(e,t,{value:n})},t.defineExport=function(e,t,n){var r;Reflect.defineProperty(e,t,{enumerable:!0,configurable:!0,set:function(e){r=e},get:function(){return r?r():n()}})}}).call(this,n(10))},,,,,function(e,t,n){var r=n(8),i=n(19),s={title:"Action",description:"Messages for communicating with a chains reducer.\n  Actions are always delivered as part of a channel between chains.",type:"object",required:["type","payload"],additionalProperties:!1,properties:{type:{type:"string",description:"The type of the action which is specified by the developer"},payload:{type:"object",description:"Type dependent data being transmitted with the action"}}},a={title:"Continuation",description:"Actions that implement the continuation system.",type:"object",required:["type","payload"],additionalProperties:!1,properties:{type:{type:"string",description:"One of three types.  Synchronous replies are resolves or rejections too.",enum:["@@REJECT","@@PROMISE","@@RESOLVE"]},payload:{type:"object",description:"Type dependent data being transmitted with the action"}}},o={title:"Integrity",description:"cryptographically secure hash produced from content.\n  May be 'UNKNOWN' to signal an address is unknown.",type:"object",additionalProperties:!1,required:["hash","algorithm"],properties:{hash:{type:"string",description:"base58 encoded hash hopefully with identifier at front, or UNKNOWN"},algorithm:{enum:["sha256"]}}},c={title:"Address",description:"Hash of the Provenance of the first block in this chain, \n  with prefix, check digits, in base58",type:"object",additionalProperties:!1,required:["chainId","status"],properties:{chainId:o,status:{pattern:"^UNKNOWN$|^GENESIS_|^LOOPBACK$|^ROOT$|^RESOLVED$"}}},u={title:"PublicKey",description:"public key of a public / secret pair",type:"object",additionalProperties:!1,required:["key","algorithm"],properties:{key:{type:"string"},algorithm:{enum:["tweetnacl","sodium"]}}},l={title:"Signature",description:"A cryptographic signature of some detached integrity",type:"object",additionalProperties:!1,required:["publicKey","integrity","seal"],properties:{publicKey:u,integrity:o,seal:{type:"string"}}},p={title:"Provenance",description:'Proof of the Provenance of the object \n  referenced by signed integrity.\n  The integrity of the first provenance in a chain is the chainId.\n  When the provenance is inserted back into the dmz, the dmz becomes a Block.\n  The integrity which is signed is the integrity of the whole object, \n  minus "integrity" and "signatures" keys\n  \n  Integrity can be a merkle proof so a set of chains with the same\n  validators can create signatures for the root hash, then distribute\n  to all the chains where each is blinded to the others in the merkle \n  proof.\n  \n  Running chains internally is much faster than cross block boundaries.',type:"object",additionalProperties:!1,required:["dmzIntegrity","address","lineage","height","integrity","signatures"],properties:{dmzIntegrity:o,address:c,lineage:{type:"object",description:"Object of previous blockhashes this provenance item extends.\n  There may be many, but at least one is the most recent block provenance.\n  Others might be those resulting from overdrive consensus,\n  or periodic shortcutting of the chain history to quick lookup purposes.\n  Height must always be greater than any previous provenance for this address.\n  Provenance is monotonic, and should increment by 1 each time.\n  \n  First lineage supplied to create defines the chainId of the result.\n  \n  Provenance is a statement of authenticity and position in lineage.  \n  Lineage is the chain of previous provenances.\n  \n  Key gives the provenance id, which can be height, or foreignChain:height.\n  Value gives the hash of the block at the provenance id.",patternProperties:{"(.*?)":o}},height:{type:"integer",minimum:0},integrity:o,signatures:{type:"array",items:l,minItems:1,uniqueItems:!0}}},h={title:"Validators",type:"object",additionalProperties:!1,minProperties:1,patternProperties:{"(.*?)":u}},d={title:"Proof",description:"Interblock proof model.",type:"object",additionalProperties:!1,required:["block"],properties:{block:{type:"string"},network:{type:"object"},channel:{type:"string"}}},f={title:"Remote",description:"Slice of Channel state transmitted with a heavy Interblock",type:"object",additionalProperties:!1,required:["address","replies","requests","heavyHeight","lineageHeight"],properties:{address:c,replies:{type:"object",additionalProperties:!1,patternProperties:{"[0-9]*":a}},requests:{type:"object",additionalProperties:!1,patternProperties:{"[0-9]*":s}},heavyHeight:{type:"integer",minimum:-1},lineageHeight:{type:"integer",minimum:-1}}},v={title:"Interblock",description:"The fundamental unit of inter chain communication.\n  Contains provenance, a punched out DMZ, and a single transmit channel\n  of the source chain.\n  This must be an model, so as to ensure we do not leak info, rather \n  than making it a special case of a BlockModel.\n  This cannot import dmzModel directly, as it is a fundamental\n  circular reference, as the outside depends on the inside.\n  This can only be made from a validated block.\n  \n  This is the only place that needs punched out proofs.\n  \n  With no transmit key, an interblock is simply a provenance chain,\n  which is needed to ensure lineage\n  \n  By placing interblock stream inside the transmission, each side of\n  a connection can know what block of theirs the other side has processed.",type:"object",required:["provenance","proof","validators"],additionalProperties:!1,properties:{provenance:p,proof:d,network:{type:"object",additionalProperties:!1,minProperties:0,maxProperties:1,patternProperties:{"(.*?)":f}},validators:h}},y={title:"Channel",description:"Communication Queues.\n  These queues and their responses are what all interchain\n  communication seeks to facilitate.  All the cryptography\n  employed in this system is to reliably process these \n  queues.\n  \n  Each connection side has a transmit and a receive.\n  Each connection side transmits requests and replies to the other.\n  \n  Transmit = Sum( Channel ) \n  Receive = Sum( Interblock( Channel ) )\n  Interblocks  = Channel + Provenance\n  \n  'provenance' contains a continuous chain all the way back to  the foreign genesis.\n  \n  The contents of the latest received channel is stored on 'remote'\n  Replies are always processed before incoming requests.\n  When a received reply has executed, the local transmit action is removed\n  from the transmit queue.\n  \n  The queues hold the index for their next actions within them:\n  1.  Next remote reply index is the smallest index of the transit queue\n      for which there is a remote reply that is not a promise\n  2.  Next remote request index is given by the local highest reply index\n  \n  If systemRole === '.' then provenance checks are excused, as the\n  networkProducer.tx() function will flip outbound and inbound.  This is used\n  in the self channel.\n  \n  Counter is required to know where the request counter is up to",type:"object",required:[].concat(i(f.required),["systemRole","requestsLength","lineage","lineageTip"]),additionalProperties:!1,properties:r({},f.properties,{systemRole:{enum:["..",".","./","UP_LINK","DOWN_LINK"]},requestsLength:{type:"integer",minimum:0},heavy:v,lineage:{type:"array",uniqueItems:!0,items:o},lineageTip:{type:"array",uniqueItems:!0,items:v}})};e.exports={integritySchema:o,addressSchema:c,proofSchema:d,interblockSchema:v,provenanceSchema:p,validatorsSchema:h,signatureSchema:l,publicKeySchema:u,remoteSchema:f,channelSchema:y,actionSchema:s,continuationSchema:a}},function(e,t,n){var r=n(4),i=(n(11)("interblock:models:integrity"),n(54)),s=(0,n(20).standardize)({schema:n(37).integritySchema,create:function(e){if(!e||"UNKNOWN"===e)return s.clone({hash:"UNKNOWN",algorithm:"sha256"});"string"===typeof e&&(e={string:e}),r("object"===typeof e,"Must supply object: ".concat(e));var t={hash:i.objectHash(e),algorithm:"sha256"};return s.clone(t)},logicize:function(e){return{isUnknown:function(){return"UNKNOWN"===e.hash},isIntegrityMatch:function(t){return s.create(t).hash===e.hash}}}});e.exports={integrityModel:s}},,,,,,,,,function(e,t,n){"use strict";var r=n(130),i=n(2),s=n(28),a=n(3),o=n(8),c=n(9),u=n(12),l=n(17),p=n(18),h=n(4),d=n(46),f=n(32),v=function(e){p(v,e);var t=l(v);function v(e,n){var r;return c(this,v),(r=t.call(this)).options=f.merge({},e),r.answers=o({},n),r}return u(v,[{key:"register",value:function(e,t){if(f.isObject(e)){for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];this.register(i,e[i])}return this}h.equal(typeof t,"function","expected a function");var s=e.toLowerCase();return t.prototype instanceof this.Prompt?this.prompts[s]=t:this.prompts[s]=t(this.Prompt,this),this}},{key:"prompt",value:function(){var e=a(i.mark((function e(){var t,n,r,a,o=arguments;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=o.length>0&&void 0!==o[0]?o[0]:[],n=s([].concat(t)),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=20;break}if(a=r.value,e.prev=6,"function"!==typeof a){e.next=11;break}return e.next=10,a.call(this);case 10:a=e.sent;case 11:return e.next=13,this.ask(f.merge({},this.options,a));case 13:e.next=18;break;case 15:return e.prev=15,e.t0=e.catch(6),e.abrupt("return",Promise.reject(e.t0));case 18:e.next=4;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(2),n.e(e.t1);case 25:return e.prev=25,n.f(),e.finish(25);case 28:return e.abrupt("return",this.answers);case 29:case"end":return e.stop()}}),e,this,[[2,22,25,28],[6,15]])})));return function(){return e.apply(this,arguments)}}()},{key:"ask",value:function(){var e=a(i.mark((function e(t){var n,r,s,a,o,c,u,l,p,d=this;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!==typeof t){e.next=4;break}return e.next=3,t.call(this);case 3:t=e.sent;case 4:if(n=f.merge({},this.options,t),s=(r=t).type,a=r.name,o=f.set,c=f.get,"function"!==typeof s){e.next=11;break}return e.next=10,s.call(this,t,this.answers);case 10:s=e.sent;case 11:if(s){e.next=13;break}return e.abrupt("return",this.answers[a]);case 13:if(h(this.prompts[s],'Prompt "'.concat(s,'" is not registered')),u=new this.prompts[s](n),l=c(this.answers,a),u.state.answers=this.answers,u.enquirer=this,a&&u.on("submit",(function(e){d.emit("answer",a,e,u),o(d.answers,a,e)})),p=u.emit.bind(u),u.emit=function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=d.emit).call.apply(e,[d].concat(n)),p.apply(void 0,n)},this.emit("prompt",u,this),!n.autofill||null==l){e.next=29;break}if(u.value=u.input=l,"show"!==n.autofill){e.next=27;break}return e.next=27,u.submit();case 27:e.next=32;break;case 29:return e.next=31,u.run();case 31:l=u.value=e.sent;case 32:return e.abrupt("return",l);case 33:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"use",value:function(e){return e.call(this,this),this}},{key:"Prompt",set:function(e){this._Prompt=e},get:function(){return this._Prompt||this.constructor.Prompt}},{key:"prompts",get:function(){return this.constructor.prompts}}],[{key:"Prompt",set:function(e){this._Prompt=e},get:function(){return this._Prompt||n(86)}},{key:"prompts",get:function(){return n(532)}},{key:"types",get:function(){return n(552)}},{key:"prompt",get:function(){var e=this,t=function t(n){for(var i=arguments.length,s=new Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];var o=r(e,s),c=o.emit.bind(o);return o.emit=function(){return t.emit.apply(t,arguments),c.apply(void 0,arguments)},o.prompt(n)};return f.mixinEmitter(t,new d),t}}]),v}(d);f.mixinEmitter(v,new d);for(var y=v.prompts,g=function(){var e=k[m],t=e.toLowerCase(),n=function(t){return new y[e](t).run()};v.prompt[t]=n,v[t]=n,v[e]||Reflect.defineProperty(v,e,{get:function(){return y[e]}})},m=0,k=Object.keys(y);m<k.length;m++)g();var b=function(e){f.defineExport(v,e,(function(){return v.types[e]}))};b("ArrayPrompt"),b("AuthPrompt"),b("BooleanPrompt"),b("NumberPrompt"),b("StringPrompt"),e.exports=v},,function(e,t,n){var r=n(8),i=n(4),s=n(54),a=n(20).standardize,o=n(38).integrityModel,c=a({schema:n(37).addressSchema,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.create(),t="UNKNOWN";if("GENESIS"===e)t="GENESIS_".concat(s.generateNonce()),e=o.create("UNKNOWN");else if("LOOPBACK"===e)t="LOOPBACK",e=o.create("UNKNOWN");else if("ROOT"===e)t="ROOT",e=o.create("UNKNOWN");else if("string"===typeof e){var n=o.create(e);if(n.hash.length===e.length){var a=e;e=o.clone(r({},n,{hash:a}))}else e=n}return o.isModel(e)||debug("integrity not model: ",e),i(o.isModel(e)),e.isUnknown()||(t="RESOLVED"),c.clone({chainId:e,status:t})},logicize:function(e){var t=e.chainId,n=e.status;return{getChainId:function(){if("LOOPBACK"===n)return"LOOPBACK";if("ROOT"===n)return"ROOT";if("RESOLVED"!==n)throw new Error("Tried to get chainId on address with status: ".concat(n));return t.hash},isRoot:function(){return"ROOT"===n},isLoopback:function(){return"LOOPBACK"===n},isGenesis:function(){return n.startsWith("GENESIS_")},isUnknown:function(){return"UNKNOWN"===n},isResolved:function(){return"RESOLVED"===n}}}});e.exports={addressModel:c}},function(e,t,n){var r=n(444).consistencySourceFactory,i=n(450),s=i.toFunctions,a=i.fromFunctions,o=n(111).ramDynamoDbFactory,c=n(156).ramS3Factory,u=n(238).s3Keys,l=n(237).dbFactory;e.exports={consistencyFactory:function(e,t,n){var i=r(e,t,n);return a(i)},toFunctions:s,ramDynamoDbFactory:o,ramS3Factory:c,consistencySourceFactory:r,s3Keys:u,dbFactory:l}},,,,function(e,t,n){e.exports=n(329)},,function(e,t,n){"use strict";var r=n(2),i=n(3),s=n(9),a=n(12),o=n(26),c=n(29),u=n(17),l=n(18),p=n(112),h=n(32),d=function(e){l(n,e);var t=u(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).emptyError=r.options.emptyError||"No items were selected",r}return a(n,[{key:"dispatch",value:function(){var e=i(r.mark((function e(t,i){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.multiple){e.next=11;break}if(!this[i.name]){e.next=7;break}return e.next=4,this[i.name](t,i);case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,c(o(n.prototype),"dispatch",this).call(this,t,i);case 9:e.t0=e.sent;case 10:return e.abrupt("return",e.t0);case 11:this.alert();case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"separator",value:function(){if(this.options.separator)return c(o(n.prototype),"separator",this).call(this);var e=this.styles.muted(this.symbols.ellipsis);return this.state.submitted?c(o(n.prototype),"separator",this).call(this):e}},{key:"pointer",value:function(e,t){return!this.multiple||this.options.pointer?c(o(n.prototype),"pointer",this).call(this,e,t):""}},{key:"indicator",value:function(e,t){return this.multiple?c(o(n.prototype),"indicator",this).call(this,e,t):""}},{key:"choiceMessage",value:function(e,t){var n=this.resolve(e.message,this.state,e,t);return"heading"!==e.role||h.hasColor(n)||(n=this.styles.strong(n)),this.resolve(n,this.state,e,t)}},{key:"choiceSeparator",value:function(){return":"}},{key:"renderChoice",value:function(){var e=i(r.mark((function e(t,n){var i,s,a,o,c,u,l,p=this;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onChoice(t,n);case 2:return i=this.index===n,e.next=5,this.pointer(t,n);case 5:return s=e.sent,e.next=8,this.indicator(t,n);case 8:return e.t0=e.sent,e.t1=t.pad||"",a=e.t0+e.t1,e.next=13,this.resolve(t.hint,this.state,t,n);case 13:return(o=e.sent)&&!h.hasColor(o)&&(o=this.styles.muted(o)),c=this.indent(t),e.next=18,this.choiceMessage(t,n);case 18:if(u=e.sent,l=function(){return[p.margin[3],c+s+a,u,p.margin[1],o].filter(Boolean).join(" ")},"heading"!==t.role){e.next=22;break}return e.abrupt("return",l());case 22:if(!t.disabled){e.next=25;break}return h.hasColor(u)||(u=this.styles.disabled(u)),e.abrupt("return",l());case 25:return i&&(u=this.styles.em(u)),e.abrupt("return",l());case 27:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"renderChoices",value:function(){var e=i(r.mark((function e(){var t,n,s,a,o=this;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("choices"!==this.state.loading){e.next=2;break}return e.abrupt("return",this.styles.warning("Loading choices"));case 2:if(!this.state.submitted){e.next=4;break}return e.abrupt("return","");case 4:return t=this.visible.map(function(){var e=i(r.mark((function e(t,n){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.renderChoice(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),e.next=7,Promise.all(t);case 7:if((n=e.sent).length||n.push(this.styles.danger("No matching choices")),s=this.margin[0]+n.join("\n"),!this.options.choicesHeader){e.next=14;break}return e.next=13,this.resolve(this.options.choicesHeader,this.state);case 13:a=e.sent;case 14:return e.abrupt("return",[a,s].filter(Boolean).join("\n"));case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"format",value:function(){var e=this;return!this.state.submitted||this.state.cancelled?"":Array.isArray(this.selected)?this.selected.map((function(t){return e.styles.primary(t.name)})).join(", "):this.styles.primary(this.selected.name)}},{key:"render",value:function(){var e=i(r.mark((function e(){var t,n,i,s,a,o,c,u,l,p,h,d;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.submitted,i=t.size,s="",e.next=4,this.header();case 4:return a=e.sent,e.next=7,this.prefix();case 7:return o=e.sent,e.next=10,this.separator();case 10:return c=e.sent,e.next=13,this.message();case 13:return u=e.sent,!1!==this.options.promptLine&&(s=[o,u,c,""].join(" "),this.state.prompt=s),e.next=17,this.format();case 17:return l=e.sent,e.next=20,this.error();case 20:if(e.t0=e.sent,e.t0){e.next=25;break}return e.next=24,this.hint();case 24:e.t0=e.sent;case 25:return p=e.t0,e.next=28,this.renderChoices();case 28:return h=e.sent,e.next=31,this.footer();case 31:d=e.sent,l&&(s+=l),p&&!s.includes(p)&&(s+=" "+p),n&&!l&&!h.trim()&&this.multiple&&null!=this.emptyError&&(s+=this.styles.danger(this.emptyError)),this.clear(i),this.write([a,s,h,d].filter(Boolean).join("\n")),this.write(this.margin[2]),this.restore();case 39:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(p);e.exports=d},,,,,,,,function(e,t,n){var r=n(8),i=n(20).standardize,s=n(37).actionSchema,a=n(99).assertNoUndefined,o=i({schema:s,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"DEFAULT_ACTION";return"string"===typeof e&&(e={type:e}),e.payload||(e=r({},e,{payload:{}})),o.clone(e)},logicize:function(e){return a(e),{}}});e.exports={actionModel:o}},function(e,t,n){var r=n(2),i=n(3),s=n(53),a=n(4),o=n(11)("interblock:models:keypair"),c=n(54),u=n(20).standardize,l=n(83).publicKeyModel,p=n(38).integrityModel,h=n(147).signatureModel,d=u({schema:{title:"Keypair",description:"public private key pair",type:"object",additionalProperties:!1,required:["name","publicKey","secretKey","algorithm"],properties:{name:{type:"string"},publicKey:l.schema,secretKey:{type:"string"},algorithm:{enum:["tweetnacl","sodium"]}}},create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"CI",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c._ciKeypair;a.equal(typeof e,"string");var n=l.clone({key:t.publicKey,algorithm:"sodium"}),r=t.secretKey;return d.clone({name:e,publicKey:n,secretKey:r,algorithm:"sodium"})},logicize:function(e){var t={publicKey:e.publicKey.key,secretKey:e.secretKey};if(!c.verifyKeyPairSync(t))throw new Error("Not a valid keypair - refusing to instantiate");return{sign:function(){var t=i(r.mark((function t(n){var i,s,u,l,d,f,v,y;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o("sign"),n){t.next=3;break}throw new Error("Refusing to sign undefined integrity");case 3:return n=p.clone(n),i=n.hash,s=e.publicKey,u=e.secretKey,t.next=8,c.signHash(i,u);case 8:return l=t.sent,d=l.signature,t.next=12,c.verifyHash(i,d,s.key);case 12:return f=t.sent,a(f),a(c.verifyHashSync(i,d,s.key)),v={publicKey:s,integrity:n,seal:d},y=h.clone(v),o("sign complete"),t.abrupt("return",y);case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),getValidatorEntry:function(){return s({},e.name,e.publicKey)}}}});e.exports={keypairModel:d}},function(e,t,n){var r=n(432),i=n(433),s=n(434),a=n(228);e.exports={networkProducer:r,blockProducer:i,lockProducer:s,channelProducer:a}},function(e,t,n){"use strict";var r=n(2),i=n(3),s=n(9),a=n(12),o=n(26),c=n(29),u=n(17),l=n(18),p=n(86),h=n(249),d=n(32).isPrimitive,f=function(e){l(n,e);var t=u(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).initial=d(r.initial)?String(r.initial):"",r.initial&&r.cursorHide(),r.state.prevCursor=0,r.state.clipboard=[],r}return a(n,[{key:"keypress",value:function(){var e=i(r.mark((function e(t){var i,s,a=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=a.length>1&&void 0!==a[1]?a[1]:{},s=this.state.prevKeypress,this.state.prevKeypress=i,!0!==this.options.multiline||"return"!==i.name){e.next=6;break}if(s&&"return"===s.name){e.next=6;break}return e.abrupt("return",this.append("\n",i));case 6:return e.abrupt("return",c(o(n.prototype),"keypress",this).call(this,t,i));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"moveCursor",value:function(e){this.cursor+=e}},{key:"reset",value:function(){return this.input=this.value="",this.cursor=0,this.render()}},{key:"dispatch",value:function(e,t){if(!e||t.ctrl||t.code)return this.alert();this.append(e)}},{key:"append",value:function(e){var t=this.state,n=t.cursor,r=t.input;this.input="".concat(r).slice(0,n)+e+"".concat(r).slice(n),this.moveCursor(String(e).length),this.render()}},{key:"insert",value:function(e){this.append(e)}},{key:"delete",value:function(){var e=this.state,t=e.cursor,n=e.input;if(t<=0)return this.alert();this.input="".concat(n).slice(0,t-1)+"".concat(n).slice(t),this.moveCursor(-1),this.render()}},{key:"deleteForward",value:function(){var e=this.state,t=e.cursor,n=e.input;if(void 0===n[t])return this.alert();this.input="".concat(n).slice(0,t)+"".concat(n).slice(t+1),this.render()}},{key:"cutForward",value:function(){var e=this.cursor;if(this.input.length<=e)return this.alert();this.state.clipboard.push(this.input.slice(e)),this.input=this.input.slice(0,e),this.render()}},{key:"cutLeft",value:function(){var e=this.cursor;if(0===e)return this.alert();var t=this.input.slice(0,e),n=this.input.slice(e),r=t.split(" ");this.state.clipboard.push(r.pop()),this.input=r.join(" "),this.cursor=this.input.length,this.input+=n,this.render()}},{key:"paste",value:function(){if(!this.state.clipboard.length)return this.alert();this.insert(this.state.clipboard.pop()),this.render()}},{key:"toggleCursor",value:function(){this.state.prevCursor?(this.cursor=this.state.prevCursor,this.state.prevCursor=0):(this.state.prevCursor=this.cursor,this.cursor=0),this.render()}},{key:"first",value:function(){this.cursor=0,this.render()}},{key:"last",value:function(){this.cursor=this.input.length-1,this.render()}},{key:"next",value:function(){var e=null!=this.initial?String(this.initial):"";if(!e||!e.startsWith(this.input))return this.alert();this.input=this.initial,this.cursor=this.initial.length,this.render()}},{key:"prev",value:function(){if(!this.input)return this.alert();this.reset()}},{key:"backward",value:function(){return this.left()}},{key:"forward",value:function(){return this.right()}},{key:"right",value:function(){return this.cursor>=this.input.length?this.alert():(this.moveCursor(1),this.render())}},{key:"left",value:function(){return this.cursor<=0?this.alert():(this.moveCursor(-1),this.render())}},{key:"isValue",value:function(e){return!!e}},{key:"format",value:function(){var e=i(r.mark((function e(){var t,n,i=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:this.value,e.next=3,this.resolve(this.initial,this.state);case 3:if(n=e.sent,this.state.submitted){e.next=6;break}return e.abrupt("return",h(this,{input:t,initial:n,pos:this.cursor}));case 6:return e.abrupt("return",this.styles.submitted(t||n));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=i(r.mark((function e(){var t,n,i,s,a,o,c,u,l;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.size,e.next=3,this.prefix();case 3:return n=e.sent,e.next=6,this.separator();case 6:return i=e.sent,e.next=9,this.message();case 9:return s=e.sent,a=[n,s,i].filter(Boolean).join(" "),this.state.prompt=a,e.next=14,this.header();case 14:return o=e.sent,e.next=17,this.format();case 17:return c=e.sent,e.next=20,this.error();case 20:if(e.t0=e.sent,e.t0){e.next=25;break}return e.next=24,this.hint();case 24:e.t0=e.sent;case 25:return u=e.t0,e.next=28,this.footer();case 28:l=e.sent,u&&!c.includes(u)&&(c+=" "+u),a+=" "+c,this.clear(t),this.write([o,a,l].filter(Boolean).join("\n")),this.restore();case 34:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(p);e.exports=f},,,,,,,,,,,,,function(e,t,n){var r=n(81),i=n(2),s=n(3),a=n(19),o=n(8),c=n(4),u=n(11)("interblock:models:block"),l=n(20).standardize,p=n(82).provenanceModel,h=n(65).keypairModel,d=n(100).dmzModel,f=n(38).integrityModel,v=d.schema,y=o({},v,{title:"Block",description:"The fundamental unit of state persistence and transmission\nA DMZ with a 'provenance' key is a block.",required:[].concat(a(v.required),["provenance"]),properties:o({},v.properties,{provenance:p.schema})}),g=function(){var e=s(i.mark((function e(t){var n;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.create("CI");case 2:return n=e.sent,c(f.isModel(t)),e.abrupt("return",n.sign(t));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=l({schema:y,create:function(e){var t=arguments;return s(i.mark((function n(){var r,s,a,l;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.length>1&&void 0!==t[1]?t[1]:g,u("create"),c("function"===typeof r),e=d.clone(e),void 0,s={},n.next=8,p.create(e,void 0,s,r);case 8:return a=n.sent,l=m.clone(o({},e,{provenance:a})),n.abrupt("return",l);case 11:case"end":return n.stop()}}),n)})))()},logicize:function(e){var t=e.network.getAliases().some((function(t){var n=e.network[t].address;return e.provenance.getAddress().equals(n)}));c(!t,"Loop detected");var n=e.provenance,i=r(e,["provenance"]),s=d.clone(i),a=s.getHash();c(a===n.dmzIntegrity.hash);return{isValidated:function(){if(n.address.isGenesis())return!0;var e=s.validators,t=Object.values(e),r=n.signatures.map((function(e){return e.publicKey})),i=t.every((function(e){return r.some((function(t){return t.equals(e)}))})),a=r.every((function(e){return t.some((function(t){return t.equals(e)}))}));return i&&a},getDmz:function(){return s},whoami:function(e,t){c(m.isModel(t)),e.forEach((function(e){publicKeyModel.clone(e)}))},isNext:function(t){var n=m.isModel(t)&&t.isValidated(),r=e.provenance.isNext(t.provenance);return n&&r},getChainId:function(){return e.provenance.getAddress().getChainId()}}}});e.exports={blockModel:m}},,function(e,t,n){var r=n(19),i=n(8),s=n(2),a=n(3),o=n(4),c=n(24),u=(n(11)("interblock:models:provenance"),n(20).standardize),l=n(38).integrityModel,p=n(65).keypairModel,h=n(49).addressModel,d=n(37).provenanceSchema,f=function(){var e=a(s.mark((function e(t){var n;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.create("CI");case 2:return n=e.sent,o(l.isModel(t)),e.abrupt("return",n.sign(t));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=u({schema:d,create:function(e,t){var r=arguments;return a(s.mark((function a(){var c,u,p,d,y,g,m,k,b,x,w,C,M;return s.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return c=r.length>2&&void 0!==r[2]?r[2]:{},u=r.length>3&&void 0!==r[3]?r[3]:f,p=n(100),d=p.dmzModel,e=e||d.create(),o(d.isModel(e)),o(!t||v.isModel(t)),o.equal(typeof c,"object"),o(Object.values(c).every(l.isModel)),o(!Object.keys(c).length||t),y=l.create(),dmzIntegrity=l.clone(i({},y,{hash:e.getHash()})),g=h.create("GENESIS"),m=0,k=i({},c),t&&(b=t.reflectIntegrity(),o(!Object.values(k).some((function(e){return e.equals(b)}))),k[t.height]=b,m=t.height+1,g=t.getAddress()),x={dmzIntegrity:dmzIntegrity,address:g,lineage:k,height:m},w=l.create(x),s.next=19,u(w);case 19:return C=s.sent,M=[C],s.abrupt("return",v.clone(i({},x,{integrity:w,signatures:M})));case 22:case"end":return s.stop()}}),a)})))()},logicize:function(e){if(e.dmzIntegrity.isUnknown())throw new Error("Dmz not a genuine type of integrity: ".concat(e.dmzIntegrity.hash));var t=Object.keys(e.lineage).map((function(e){return parseInt(e)}));o(t.length||e.address.isGenesis()),o(e.height||e.address.isGenesis()),o(t.every((function(t){return t>=0&&t<e.height}))),o.equal(e.signatures.length,1,"single signer in prototype");if(!function(){var t=c.omit(e,["integrity","signatures"]),n=l.create(t).equals(e.integrity);return n}())throw new Error("Self integrity degraded - refusing to instantiate");if(!e.signatures.length||!e.signatures.every((function(t){return t.integrity.equals(e.integrity)})))throw new Error("Signature degraded - refusing to instantiate");var n=l.create(e),i=e.address;0===e.height&&(o(i.isGenesis()),i=h.create(n));var s=function(){return n};return{merge:function(){},getAddress:function(){return i},reflectIntegrity:s,isNext:function(t){var n=Object.values(t.lineage).some((function(e){return e.equals(s())})),r=t.height>e.height;t.signatures[0].publicKey;return n&&r},getShortestHeight:function(){var n=r(t);n.sort((function(e,t){return e-t}));var i=n.shift();return o(i>=0&&i<e.height),i}}}});e.exports={provenanceModel:v}},function(e,t,n){var r=(0,n(20).standardize)({schema:n(37).publicKeySchema,create:function(){throw new Error("Only the keypairModel can create publicKeyModel types")},logicize:function(e){return{}}});e.exports={publicKeyModel:r}},function(e,t,n){var r=n(431);e.exports=r},function(e,t,n){var r=n(4),i=n(20).standardize,s=n(37).continuationSchema,a=n(99).assertNoUndefined,o=i({schema:s,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"@@RESOLVE",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o.clone({type:e,payload:t})},logicize:function(e){"@@PROMISE"===e.type&&r.equal(Object.keys(e.payload).length,0,"Promises cannot have payloads"),a(e);return{isPromise:function(){return"@@PROMISE"===e.type},isRejection:function(){return"@@REJECT"===e.type},isResolve:function(){return"@@RESOLVE"===e.type}}}});e.exports={continuationModel:o}},function(e,t,n){"use strict";(function(t){var r=n(2),i=n(3),s=n(9),a=n(12),o=n(70),c=n(17),u=n(18),l=n(46),p=n(42),h=n(523),d=n(526),f=n(527),v=n(528),y=n(32),g=n(531),m=function(e){u(l,e);var n=c(l);function l(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s(this,l),(e=n.call(this)).name=r.name,e.type=r.type,e.options=r,v(o(e)),d(o(e)),e.state=new f(o(e)),e.initial=[r.initial,r.default].find((function(e){return null!=e})),e.stdout=r.stdout||t.stdout,e.stdin=r.stdin||t.stdin,e.scale=r.scale||1,e.term=e.options.term||Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).TERM_PROGRAM,e.margin=b(e.options.margin),e.setMaxListeners(0),k(o(e)),e}return a(l,[{key:"keypress",value:function(){var e=i(r.mark((function e(t){var n,i,s,a=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:{},this.keypressed=!0,i=h.action(t,h(t,n),this.options.actions),this.state.keypress=i,this.emit("keypress",t,i),this.emit("state",this.state.clone()),"function"!==typeof(s=this.options[i.action]||this[i.action]||this.dispatch)){e.next=11;break}return e.next=10,s.call(this,t,i);case 10:return e.abrupt("return",e.sent);case 11:this.alert();case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"alert",value:function(){delete this.state.alert,!1===this.options.show?this.emit("alert"):this.stdout.write(g.code.beep)}},{key:"cursorHide",value:function(){var e=this;this.stdout.write(g.cursor.hide()),y.onExit((function(){return e.cursorShow()}))}},{key:"cursorShow",value:function(){this.stdout.write(g.cursor.show())}},{key:"write",value:function(e){e&&(this.stdout&&!1!==this.state.show&&this.stdout.write(e),this.state.buffer+=e)}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.state.buffer;this.state.buffer="",(t||e)&&!1!==this.options.show&&this.stdout.write(g.cursor.down(e)+g.clear(t,this.width))}},{key:"restore",value:function(){if(!this.state.closed&&!1!==this.options.show){var e=this.sections(),t=e.prompt,n=e.after,r=e.rest,i=this.cursor,s=this.initial,a=void 0===s?"":s,o=this.input,c=void 0===o?"":o,u=this.value,l=void 0===u?"":u,p={after:n,cursor:i,initial:a,input:c,prompt:t,size:this.state.size=r.length,value:l},h=g.cursor.restore(p);h&&this.stdout.write(h)}}},{key:"sections",value:function(){var e=this.state,t=e.buffer,n=e.input,r=e.prompt;r=p.unstyle(r);var i=p.unstyle(t),s=i.indexOf(r),a=i.slice(0,s),o=i.slice(s).split("\n"),c=o[0],u=o[o.length-1],l=(r+(n?" "+n:"")).length,h=l<c.length?c.slice(l+1):"";return{header:a,prompt:c,after:h,rest:o.slice(1),last:u}}},{key:"submit",value:function(){var e=i(r.mark((function e(){var t,n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.submitted=!0,this.state.validating=!0,!this.options.onSubmit){e.next=5;break}return e.next=5,this.options.onSubmit.call(this,this.name,this.value,this);case 5:if(e.t0=this.state.error,e.t0){e.next=10;break}return e.next=9,this.validate(this.value,this.state);case 9:e.t0=e.sent;case 10:if(!0===(t=e.t0)){e.next=23;break}return n="\n"+this.symbols.pointer+" ",n+="string"===typeof t?t.trim():"Invalid input",this.state.error="\n"+this.styles.danger(n),this.state.submitted=!1,e.next=18,this.render();case 18:return e.next=20,this.alert();case 20:return this.state.validating=!1,this.state.error=void 0,e.abrupt("return");case 23:return this.state.validating=!1,e.next=26,this.render();case 26:return e.next=28,this.close();case 28:return e.next=30,this.result(this.value);case 30:this.value=e.sent,this.emit("submit",this.value);case 32:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.cancelled=this.state.submitted=!0,e.next=3,this.render();case 3:return e.next=5,this.close();case 5:if("function"!==typeof this.options.onCancel){e.next=8;break}return e.next=8,this.options.onCancel.call(this,this.name,this.value,this);case 8:return e.t0=this,e.next=11,this.error(t);case 11:e.t1=e.sent,e.t0.emit.call(e.t0,"cancel",e.t1);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"close",value:function(){var e=i(r.mark((function e(){var t,n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.state.closed=!0;try{t=this.sections(),n=Math.ceil(t.prompt.length/this.width),t.rest&&this.write(g.cursor.down(t.rest.length)),this.write("\n".repeat(n))}catch(r){}this.emit("close");case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"start",value:function(){this.stop||!1===this.options.show||(this.stop=h.listen(this,this.keypress.bind(this)),this.once("close",this.stop))}},{key:"skip",value:function(){var e=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.skipped=!0===this.options.skip,"function"!==typeof this.options.skip){e.next=5;break}return e.next=4,this.options.skip.call(this,this.name,this.value);case 4:this.skipped=e.sent;case 5:return e.abrupt("return",this.skipped);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initialize",value:function(){var e=i(r.mark((function e(){var t,n,s,a,o,c=this;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.format,n=this.options,s=this.result,this.format=function(){return t.call(c,c.value)},this.result=function(){return s.call(c,c.value)},"function"!==typeof n.initial){e.next=7;break}return e.next=6,n.initial.call(this,this);case 6:this.initial=e.sent;case 7:if("function"!==typeof n.onRun){e.next=10;break}return e.next=10,n.onRun.call(this,this);case 10:return"function"===typeof n.onSubmit&&(a=n.onSubmit.bind(this),o=this.submit.bind(this),delete this.options.onSubmit,this.submit=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a(c.name,c.value,c);case 2:return e.abrupt("return",o());case 3:case"end":return e.stop()}}),e)})))),e.next=13,this.start();case 13:return e.next=15,this.render();case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){throw new Error("expected prompt to have a custom render method")}},{key:"run",value:function(){var e=this;return new Promise(function(){var t=i(r.mark((function t(n,i){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.once("submit",n),e.once("cancel",i),t.next=4,e.skip();case 4:if(!t.sent){t.next=7;break}return e.render=function(){},t.abrupt("return",e.submit());case 7:return t.next=9,e.initialize();case 9:e.emit("run");case 10:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}},{key:"element",value:function(){var e=i(r.mark((function e(t,n,i){var s,a,o,c,u,l,p,h;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=this.options,a=this.state,o=this.symbols,c=this.timers,u=c&&c[t],a.timer=u,l=s[t]||a[t]||o[t],!n||null==n[t]){e.next=8;break}e.t0=n[t],e.next=11;break;case 8:return e.next=10,l;case 10:e.t0=e.sent;case 11:if(""!==(p=e.t0)){e.next=14;break}return e.abrupt("return",p);case 14:return e.next=16,this.resolve(p,a,n,i);case 16:if((h=e.sent)||!n||!n[t]){e.next=19;break}return e.abrupt("return",this.resolve(l,a,n,i));case 19:return e.abrupt("return",h);case 20:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"prefix",value:function(){var e=i(r.mark((function e(){var t,n,i,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.element("prefix");case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=this.symbols;case 5:if(t=e.t0,n=this.timers&&this.timers.prefix,(i=this.state).timer=n,y.isObject(t)&&(t=t[i.status]||t.pending),y.hasColor(t)){e.next=13;break}return s=this.styles[i.status]||this.styles.pending,e.abrupt("return",s(t));case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"message",value:function(){var e=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.element("message");case 2:if(t=e.sent,y.hasColor(t)){e.next=5;break}return e.abrupt("return",this.styles.strong(t));case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"separator",value:function(){var e=i(r.mark((function e(){var t,n,i,s,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.element("separator");case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=this.symbols;case 5:return t=e.t0,n=this.timers&&this.timers.separator,(i=this.state).timer=n,s=t[i.status]||t.pending||i.separator,e.next=12,this.resolve(s,i);case 12:if(a=e.sent,y.isObject(a)&&(a=a[i.status]||a.pending),y.hasColor(a)){e.next=16;break}return e.abrupt("return",this.styles.muted(a));case 16:return e.abrupt("return",a);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pointer",value:function(){var e=i(r.mark((function e(t,n){var i,s,a,o,c,u;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.element("pointer",t,n);case 2:if("string"!==typeof(i=e.sent)||!y.hasColor(i)){e.next=5;break}return e.abrupt("return",i);case 5:if(!i){e.next=14;break}return s=this.styles,a=this.index===n,o=a?s.primary:function(e){return e},e.next=11,this.resolve(i[a?"on":"off"]||i,this.state);case 11:return c=e.sent,u=y.hasColor(c)?c:o(c),e.abrupt("return",a?u:" ".repeat(c.length));case 14:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"indicator",value:function(){var e=i(r.mark((function e(t,n){var i,s,a,o,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.element("indicator",t,n);case 2:if("string"!==typeof(i=e.sent)||!y.hasColor(i)){e.next=5;break}return e.abrupt("return",i);case 5:if(!i){e.next=11;break}return s=this.styles,a=!0===t.enabled,o=a?s.success:s.dark,c=i[a?"on":"off"]||i,e.abrupt("return",y.hasColor(c)?c:o(c));case 11:return e.abrupt("return","");case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"body",value:function(){return null}},{key:"footer",value:function(){if("pending"===this.state.status)return this.element("footer")}},{key:"header",value:function(){if("pending"===this.state.status)return this.element("header")}},{key:"hint",value:function(){var e=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("pending"!==this.state.status||this.isValue(this.state.input)){e.next=7;break}return e.next=3,this.element("hint");case 3:if(t=e.sent,y.hasColor(t)){e.next=6;break}return e.abrupt("return",this.styles.muted(t));case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"error",value:function(e){return this.state.submitted?"":e||this.state.error}},{key:"format",value:function(e){return e}},{key:"result",value:function(e){return e}},{key:"validate",value:function(e){return!0!==this.options.required||this.isValue(e)}},{key:"isValue",value:function(e){return null!=e&&""!==e}},{key:"resolve",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return y.resolve.apply(y,[this,e].concat(n))}},{key:"base",get:function(){return l.prototype}},{key:"style",get:function(){return this.styles[this.state.status]}},{key:"height",get:function(){return this.options.rows||y.height(this.stdout,25)}},{key:"width",get:function(){return this.options.columns||y.width(this.stdout,80)}},{key:"size",get:function(){return{width:this.width,height:this.height}}},{key:"cursor",set:function(e){this.state.cursor=e},get:function(){return this.state.cursor}},{key:"input",set:function(e){this.state.input=e},get:function(){return this.state.input}},{key:"value",set:function(e){this.state.value=e},get:function(){var e=this.state,t=e.input,n=[e.value,t].find(this.isValue.bind(this));return this.isValue(n)?n:this.initial}}],[{key:"prompt",get:function(){var e=this;return function(t){return new e(t).run()}}}]),l}(l);function k(e){for(var t=function(t){return void 0===e[t]||"function"===typeof e[t]},n=["actions","choices","initial","margin","roles","styles","symbols","theme","timers","value"],r=["body","footer","error","header","hint","indicator","message","prefix","separator","skip"],i=0,s=Object.keys(e.options);i<s.length;i++){var a=s[i];if(!n.includes(a)&&!/^on[A-Z]/.test(a)){var o=e.options[a];"function"===typeof o&&t(a)?r.includes(a)||(e[a]=o.bind(e)):"function"!==typeof e[a]&&(e[a]=o)}}}function b(e){"number"===typeof e&&(e=[e,e,e,e]);for(var t=[].concat(e||[]),n=function(e){return e%2===0?"\n":" "},r=[],i=0;i<4;i++){var s=n(i);t[i]?r.push(s.repeat(t[i])):r.push("")}return r}e.exports=m}).call(this,n(10))},,,,,,,,,,,,,function(e,t,n){n(4);var r=n(227);e.exports={assertNoUndefined:function(e){r(e).forEach((function(e){if("undefined"===typeof e)throw new Error("Values cannot be undefined: ".concat(this.path))}))}}},function(e,t,n){var r=n(4),i=n(20).standardize,s=n(148).covenantIdModel,a=n(104).timestampModel,o=n(65).keypairModel,c=n(123).aclModel,u=n(146).binaryModel,l=(n(38).integrityModel,n(149).networkModel),p=n(150).stateModel,h=n(151).configModel,d=n(152).validatorsModel,f=i({schema:{type:"object",title:"Dmz",description:"DMZ coordinates all the models in one place.\nDmz is equivalent to CombineReducers in Redux.",required:["validators","encryption","config","network","covenantId","binaryIntegrity","acl","state"],additionalProperties:!1,properties:{validators:d.schema,encryption:o.schema,config:h.schema,covenantId:s.schema,binaryIntegrity:u.schema,timestamp:a.schema,acl:c.schema,network:l.schema,state:p.schema}},create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r("object"===typeof e);var t={validators:d.clone(e.validators),encryption:o.clone(e.encryption),config:h.create(e.config),covenantId:s.clone(e.covenantId),binaryIntegrity:u.clone(e.binaryIntegrity),acl:c.clone(e.acl),network:l.clone(e.network),state:p.clone(e.state)};return f.clone(t)},logicize:function(e){return r(!e.state.actions),{}}});e.exports={dmzModel:f}},function(e,t,n){var r=n(23).covenantIdModel,i=n(430);i.covenantId=r.create("shell");var s=n(438);s.covenantId=r.create("hyper");var a={reducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e}};a.covenantId=r.create("unity"),e.exports={shell:i,unity:a,hyper:s}},function(e,t,n){var r=n(8),i=n(435);e.exports=r({},i)},,function(e,t,n){var r=(0,n(20).standardize)({schema:{title:"Timestamp",type:"object",description:"Time of issuance in standard format, with Zulu offset",additionalProperties:!1,required:["date","ms"],properties:{date:{type:"string",format:"date-time",examples:["2011-10-05T14:48:00.000Z"]},ms:{type:"integer"}}},create:function(){var e=new Date,t=e.toISOString(),n=e.valueOf();return r.clone({date:t,ms:n})},logicize:function(e){return{isExpired:function(t){return Date.now()-e.ms>=t}}}});e.exports={timestampModel:r}},function(e,t,n){var r=n(28),i=n(8),s=n(4),a=n(11)("interblock:models:channel"),o=n(24),c=n(229),u=c.rxRequestModel,l=c.rxReplyModel,p=n(20).standardize,h=n(49).addressModel,d=n(64).actionModel,f=n(85).continuationModel,v=n(107).remoteModel,y=p({schema:n(37).channelSchema,create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"UP_LINK";e=h.clone(e);var n=v.create({address:e}),r=i({},n,{systemRole:t,requestsLength:0,lineage:[],lineageTip:[]});return y.clone(r)},logicize:function(e){var t=e.address,n=e.systemRole,i=e.requests,c=e.replies,p=e.heavy,h=e.lineageHeight,f=e.heavyHeight,x=e.lineage,w=e.lineageTip,C=(e.requestsLength,"."===n),M=C?v.create(e):p&&p.getRemote()?p.getRemote():v.create();if(s(M),p){s(p.getRemote()||0===f),s.equal(p.provenance.height,f),s(h>=f);var I=o.last(w).provenance;s.equal(I.height,h),s(o.last(x).equals(I.reflectIntegrity()))}s(w.every((function(e){return!e.getRemote()}))),b(i),b(c);var P=function(){if(!t.isUnknown())return k(M.replies).find((function(e){return!M.replies[e].isPromise()&&i[e]}))},A=function(){var e,t=k(M.requests),n=r(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(!c[i])return i}}catch(s){n.e(s)}finally{n.f()}};return{rxRequest:function(e){if(!t.isUnknown()||C){Number.isInteger(e)||(e=A());var n=M.requests[e];if(n){s(d.isModel(n));var r=n.type,i=n.payload,o=u.create(r,i,t,e);return a("rxRequest ".concat(o.type)),o}}},rxReply:function(){var e=P();if(Number.isInteger(e)){s(i[e],"No request for: ".concat(e)),s(M.replies[e],"No reply for: ".concat(e));var t=M.replies[e],n=t.type,r=t.payload,a=i[e];return l.create(n,r,a)}},rxReplyIndex:P,getNextReplyIndex:A,getRemoteRequestIndices:function(){return k(M.requests)},getRemoteReplyIndices:function(){return k(M.replies)},isTxGreaterThan:function(e){s(y.isModel(e));var n=!e.address.equals(t),r=m(c,e.replies),a=m(i,e.requests),o=g(c,e.replies);return n||r||a||o},getRemote:function(){return M}}}}),g=function(e,t){return k(e).some((function(n){var r=e[n],i=t[n];return!(!i||!r)&&(s(f.isModel(r)),s(f.isModel(i)),i.isPromise()&&!r.isPromise())}))},m=function(e,t){var n=k(e),r=k(t),i=x(n,r);return i},k=function(e){var t=[];return Object.keys(e).forEach((function(e){var n=parseInt(e);t.push(n)})),t.sort((function(e,t){return e-t})),t},b=function(e){var t=-1,n=Object.keys(e).every((function(e){var n=parseInt(e),r=n>t;return t=n,r}));s(n)},x=function(e,t){return!(!t.length&&!e.length)&&(!(t.length||!e.length)||!(t.length&&!e.length)&&o.last(t)<o.last(e))};e.exports={channelModel:y}},function(e,t){e.exports={txRequestSchema:{title:"txRequest",description:"Covenant created",type:"object",required:["type","payload","to"],additionalProperties:!1,properties:{type:{type:"string"},payload:{type:"object"},to:{type:"string"}}},rxRequestSchema:{title:"rxRequest",description:"System created inside ChannelModel",type:"object",required:["type","payload","sequence"],additionalProperties:!1,properties:{type:{type:"string"},payload:{type:"object"},sequence:{type:"string",pattern:""}}},txReplySchema:{title:"txReply",description:"Covenant created",type:"object",required:["type","payload","request"],additionalProperties:!1,properties:{type:{type:"string",enum:["@@REJECT","@@PROMISE","@@RESOLVE"]},payload:{type:"object"},request:{description:"Sequence created in rxRequest",type:"object",required:["sequence"],additionalProperties:!1,properties:{sequence:{type:"string",pattern:""}}}}},rxReplySchema:{title:"rxReply",description:"System created\nCreate requires the sequence to be included, and it to be valid ?",type:"object",required:["type","payload","request"],additionalProperties:!1,properties:{type:{type:"string",enum:["@@REJECT","@@PROMISE","@@RESOLVE"]},payload:{type:"object"},request:{description:"Covenants original request, without the 'to' field",type:"object",required:["type","payload"],additionalProperties:!1,properties:{type:{type:"string"},payload:{type:"object"}}}}}}},function(e,t,n){var r=n(8),i=n(4),s=(n(24),n(20).standardize),a=n(37).remoteSchema,o=n(49).addressModel,c=s({schema:a,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i("object"===typeof e);var t={},n=["address","requests","replies","heavyHeight","lineageHeight"];n.forEach((function(n){e[n]&&(t[n]=e[n])}));var s={address:o.create(),requests:{},replies:{},heavyHeight:-1,lineageHeight:-1},a=r({},s,{},t);return c.clone(a)},logicize:function(e){return{}}});e.exports={remoteModel:c}},function(e,t,n){var r=n(8),i=n(53),s=n(4),a=(n(24),n(11)("interblock:models:interblock"),n(20).standardize),o=(n(82).provenanceModel,n(38).integrityModel,n(85).continuationModel),c=n(80).blockModel,u=n(105).channelModel,l=n(107).remoteModel,p=n(37).interblockSchema,h=n(153).proofModel,d=a({schema:p,create:function(e,t){s(c.isModel(e)),f(e,t);var n=e.provenance,r=e.validators,a={provenance:n,proof:h.create(e,t),validators:r};if(t){var o=e.network[t];s(u.isModel(o));var p=l.create(o);a.network=i({},t,p)}return d.clone(a)},logicize:function(e){var t,n=e.provenance,i=(e.proof,e.validators,e.network),a=i&&Object.keys(i)[0],u=a&&i[a];if(s(!u||l.isModel(u)),a){s.equal(Object.keys(i).length,1);var p=i[a];s(!p.address.isUnknown(),"interblock transmission address must be known")}var h,f=function(){if(!t){var e=c.clone(u.requests[0].payload.genesis);s(e.provenance.address.isGenesis()),t=e}return t},v=function(){if(!u)return!1;var e=u.requests[0];return!(!e||"@@INTRO"!==e.type)||void 0};return{extractGenesis:f,getTargetAddress:function(){return u&&u.address},getOriginAlias:function(){return a},getRemote:function(){return u},isConnectionAttempt:v,isGenesisAttempt:function(){try{return f()}catch(e){}return!1},getWithoutRemote:function(){if(!h){var t={block:e.proof.block},n=r({},e,{proof:t});delete n.network,h=d.clone(n)}return h},getLineageHeight:function(){return u.lineageHeight},getHeavyHeight:function(){return u.heavyHeight},isConnectionResponse:function(){if(!u)return!1;s(u&&a);var e=-1===u.lineageHeight&&-1===u.heavyHeight,t=a.startsWith("@@PUBLIC_"),n=a.substring("@@PUBLIC_".length),r=t&&n===u.address.getChainId(),i=u.requests[0],o=i&&"@@ACCEPT"===i.type,c=!Object.keys(u.replies).length;return e&&r&&o&&c},isConnectionResolve:function(){if(!v())return!1;var e=u.replies[0];return e?(s(o.isModel(e)),e.isResolve()):void 0},getChainId:function(){return n.getAddress().getChainId()}}}}),f=function(e,t){if(t&&"string"!==typeof t)throw new Error("Invalid format for target alias: ".concat(t));if(!e.isValidated())throw new Error("Only validated blocks can be reduced to Interblocks");if("."===t)throw new Error("Cannot make interblock from loopback channel")};e.exports={interblockModel:d}},function(e,t,n){var r=n(8),i=n(2),s=n(3),a=n(4),o=n(43).interpret,c=n(443).machineLogger,u=function(){var e=s(i.mark((function e(t,n){var a,u,l;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c(t.type||t,n.id),u=o(n,{execute:!1}),l=new Promise((function(e,t){var n=!1;u.onTransition(function(){var e=s(i.mark((function e(t){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("error"===t.value&&(n=t.event),"error"===t.value||"done"===t.value){e.next=4;break}return e.next=4,a.writeTransition(t.value,t.event,t.context);case 4:u.execute(t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),u.onDone(function(){var o=s(i.mark((function s(o){var c,u,l;return i.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!n){i.next=11;break}return(c=n).type,u=c.data,(l=r({},new Error,{},u)).message=u.message,l.stack=u.stack,l.name=u.name,i.next=8,a.writeTermination(l);case 8:t(l),i.next=14;break;case 11:return i.next=13,a.writeTermination();case 13:e(o.data);case 14:case"end":return i.stop()}}),s)})));return function(e){return o.apply(this,arguments)}}())})),u.start(),u.send(t),e.abrupt("return",l);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();e.exports={thread:u,setLogger:function(e){a.equal(typeof e,"function"),c=e}}},function(e,t,n){var r=n(2),i=n(3),s=n(11)("interblock:services:crypto"),a=n(4),o=n(23),c=o.cryptoCacher,u=o.keypairModel,l=o.integrityModel,p=n(50),h=p.ramDynamoDbFactory,d=p.dbFactory,f=n(54),v=c.cacheVerifyKeypair,y=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"CI";e=e||h();var n=d(e);a("string"===typeof t);var o,c=function(){var e=i(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(l.isModel(t)),e.next=3,y();case 3:return n=e.sent,e.abrupt("return",n.sign(t));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:return t=e.sent,e.abrupt("return",t.getValidatorEntry());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=i(r.mark((function e(){var i,a,c,l,p,h,d,y;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=2;break}return e.abrupt("return",o);case 2:return e.next=4,n.scanKeypair();case 4:if(!(i=e.sent)){e.next=12;break}return a=JSON.parse(i.keypairJson),e.next=9,v(a);case 9:o=u.clone(a),e.next=30;break;case 12:return e.next=14,f.generateKeyPair();case 14:return c=e.sent,l=u.create(t,c),p=l.serialize(),e.next=19,n.putKeypair({keyname:t,keypairJson:p});case 19:return e.next=21,n.scanKeypair();case 21:if(h=e.sent,d=h.keypairJson){e.next=25;break}throw new Error("cannot store keypair");case 25:return y=JSON.parse(d),e.next=28,v(y);case 28:(o=u.clone(y)).equals(l)||s("collision avoided for: ",t);case 30:return e.abrupt("return",o);case 31:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{sign:c,getValidatorEntry:p}};e.exports={cryptoFactory:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"CI",n=y(e,t),a=function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s("crypto: ".concat(t.type)),e.t0=t.type,e.next="SIGN"===e.t0?4:"VALIDATOR"===e.t0?5:6;break;case 4:return e.abrupt("return",n.sign(t.payload));case 5:return e.abrupt("return",n.getValidatorEntry());case 6:throw new Error("Unknown crypto action type: ".concat(t.type));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return a},toFunctions:function(e){return{sign:function(t){return e.push({type:"SIGN",payload:t})},getValidatorEntry:function(){return e.push({type:"VALIDATOR"})}}}}},function(e,t,n){(function(t){var r=n(81),i=n(2),s=n(3),a=n(11)("interblock:aws:ramDynamoDb"),o=n(4),c=(n(24),{dbChains:"height",dbPools:"originChainId_height_type",dbLocks:"chainId",dbSockets:"socketId",dbSubscribers:"targetChainId"}),u=function(e,t){return t[c[e]]};e.exports={ramDynamoDbFactory:function(){var e={dbCrypto:{},dbChains:{},dbPools:{},dbLocks:{},dbSubscribers:{},dbSockets:{}};return{get:function(n,r){var c=n.TableName,l=n.Key;a("get %O callback: %O",c,r),o(e[c]),r&&t(s(i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=r,e.next=3,p.promise();case 3:e.t1=e.sent,(0,e.t0)(null,e.t1);case 5:case"end":return e.stop()}}),e)}))));var p={promise:function(){var t=s(i.mark((function t(){var n,r,s;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:return o(l.chainId),n=e[c][l.chainId]||{},r=u(c,l),s=n[r],t.abrupt("return",{Item:s});case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()};return p},query:function(t){a("query %O",t.TableName);var n=t.TableName,r=t.KeyConditionExpression,c=t.ExpressionAttributeValues;o.equal(r,"chainId = :hkey");var u=c[":hkey"];return o(u),{promise:function(){var t=s(i.mark((function t(){var r,s;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:return r=e[n][u]||{},s=Object.values(r).reverse(),t.abrupt("return",{Items:s});case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}},delete:function(t){var n=t.TableName,r=t.Key;return a("del %O %O",n,r),{promise:function(){var t=s(i.mark((function t(){var s,a,c;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:s=e[n][r.chainId],a=u(n,r),c=s[a],o(c,"cannot delete non existent item"),delete s[a];case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}},put:function(n,o){var c=n.TableName,l=n.Item;r(n,["TableName","Item"]);a("put %O %O",c,l.chainId),o&&t(s(i.mark((function e(){var t;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.promise();case 3:t=e.sent,o(null,t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),o(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))));var p={promise:function(){var t=s(i.mark((function t(){var n,r,s;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:return n=l.chainId,r=e[c][n]||{},s=u(c,l),r[s]&&a("already exists: %O",l.chainId),r[s]=l,e[c][n]=r,t.abrupt("return",!0);case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()};return p},scan:function(t){var n=t.TableName,r=t.Limit;return a("scan: %O %O",n,r),o(["dbChains","dbCrypto"].includes(n)),o.equal(r,1),{promise:function(){var t=s(i.mark((function t(){var r,s,a;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:return r=e[n],s=Object.values(r)[0],a=[],s&&a.push(Object.values(s)[0]),t.abrupt("return",{Items:a});case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}},_getTables:function(){return e}}}}}).call(this,n(57).setImmediate)},function(e,t,n){"use strict";var r=n(28),i=n(8),s=n(2),a=n(3),o=n(9),c=n(12),u=n(247),l=n(26),p=n(29),h=n(17),d=n(18),f=n(42),v=n(86),y=n(534),g=n(32),m=g.reorder,k=g.scrollUp,b=g.scrollDown,x=g.isObject,w=g.swap,C=function(e){d(n,e);var t=h(n);function n(e){var r;return o(this,n),(r=t.call(this,e)).cursorHide(),r.maxSelected=e.maxSelected||1/0,r.multiple=e.multiple||!1,r.initial=e.initial||0,r.delay=e.delay||0,r.longest=0,r.num="",r}return c(n,[{key:"initialize",value:function(){var e=a(s.mark((function e(){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!==typeof this.options.initial){e.next=4;break}return e.next=3,this.options.initial.call(this);case 3:this.initial=e.sent;case 4:return e.next=6,this.reset(!0);case 6:return e.next=8,p(l(n.prototype),"initialize",this).call(this);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reset",value:function(){var e=a(s.mark((function e(){var t,n,r,i,a,o=this;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.options,n=t.choices,r=t.initial,i=t.autofocus,a=t.suggest,this.state._choices=[],this.state.choices=[],e.t0=Promise,e.next=6,this.toChoices(n);case 6:return e.t1=e.sent,e.next=9,e.t0.all.call(e.t0,e.t1);case 9:if(this.choices=e.sent,this.choices.forEach((function(e){return e.enabled=!1})),"function"===typeof a||0!==this.selectable.length){e.next=13;break}throw new Error("At least one choice must be selectable");case 13:if(x(r)&&(r=Object.keys(r)),!Array.isArray(r)){e.next=21;break}return null!=i&&(this.index=this.findIndex(i)),r.forEach((function(e){return o.enable(o.find(e))})),e.next=19,this.render();case 19:e.next=24;break;case 21:null!=i&&(r=i),"string"===typeof r&&(r=this.findIndex(r)),"number"===typeof r&&r>-1&&(this.index=Math.max(0,Math.min(r,this.choices.length)),this.enable(this.find(this.index)));case 24:if(!this.isDisabled(this.focused)){e.next=27;break}return e.next=27,this.down();case 27:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toChoices",value:function(){var e=a(s.mark((function e(t,n){var r,i,o,c=this;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.loadingChoices=!0,r=[],i=0,o=function(){var e=a(s.mark((function e(t,n){var a,u;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!==typeof t){e.next=4;break}return e.next=3,t.call(c);case 3:t=e.sent;case 4:if(!(t instanceof Promise)){e.next=8;break}return e.next=7,t;case 7:t=e.sent;case 8:a=0;case 9:if(!(a<t.length)){e.next=20;break}return e.next=12,c.toChoice(t[a],i++,n);case 12:if(u=t[a]=e.sent,r.push(u),!u.choices){e.next=17;break}return e.next=17,o(u.choices,u);case 17:a++,e.next=9;break;case 20:return e.abrupt("return",r);case 21:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.abrupt("return",o(t,n).then((function(e){return c.state.loadingChoices=!1,e})));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"toChoice",value:function(){var e=a(s.mark((function e(t,n,r){var a,o,c;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!==typeof t){e.next=4;break}return e.next=3,t.call(this,this);case 3:t=e.sent;case 4:if(!(t instanceof Promise)){e.next=8;break}return e.next=7,t;case 7:t=e.sent;case 8:if("string"===typeof t&&(t={name:t}),!t.normalized){e.next=11;break}return e.abrupt("return",t);case 11:if(t.normalized=!0,a=t.value,o=y(t.role,this.options),"string"!==typeof(t=o(this,t)).disabled||t.hint||(t.hint=t.disabled,t.disabled=!0),!0===t.disabled&&null==t.hint&&(t.hint="(disabled)"),null==t.index){e.next=19;break}return e.abrupt("return",t);case 19:if(t.name=t.name||t.key||t.title||t.value||t.message,t.message=t.message||t.name||"",t.value=[t.value,t.name].find(this.isValue.bind(this)),t.input="",t.index=n,t.cursor=0,g.define(t,"parent",r),t.level=r?r.level+1:1,null==t.indent&&(t.indent=r?r.indent+"  ":t.indent||""),t.path=r?r.path+"."+t.name:t.name,t.enabled=!(!this.multiple||this.isDisabled(t)||!t.enabled&&!this.isSelected(t)),this.isDisabled(t)||(this.longest=Math.max(this.longest,f.unstyle(t.message).length)),c=i({},t),t.reset=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.input,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.value,r=0,i=Object.keys(c);r<i.length;r++){var s=i[r];t[s]=c[s]}t.input=e,t.value=n},null!=a||"function"!==typeof t.initial){e.next=37;break}return e.next=36,t.initial.call(this,this.state,t,n);case 36:t.input=e.sent;case 37:return e.abrupt("return",t);case 38:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"onChoice",value:function(){var e=a(s.mark((function e(t,n){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.emit("choice",t,n,this),"function"!==typeof t.onChoice){e.next=4;break}return e.next=4,t.onChoice.call(this,this.state,t,n);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"addChoice",value:function(){var e=a(s.mark((function e(t,n,r){var i;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.toChoice(t,n,r);case 2:return i=e.sent,this.choices.push(i),this.index=this.choices.length-1,this.limit=this.choices.length,e.abrupt("return",i);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"newItem",value:function(){var e=a(s.mark((function e(t,n,r){var a,o;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=i({name:"New choice name?",editable:!0,newChoice:!0},t),e.next=3,this.addChoice(a,n,r);case 3:return(o=e.sent).updateChoice=function(){delete o.newChoice,o.name=o.message=o.input,o.input="",o.cursor=0},e.abrupt("return",this.render());case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"indent",value:function(e){return null==e.indent?e.level>1?"  ".repeat(e.level-1):"":e.indent}},{key:"dispatch",value:function(e,t){if(this.multiple&&this[t.name])return this[t.name]();this.alert()}},{key:"focus",value:function(e,t){return"boolean"!==typeof t&&(t=e.enabled),t&&!e.enabled&&this.selected.length>=this.maxSelected?this.alert():(this.index=e.index,e.enabled=t&&!this.isDisabled(e),e)}},{key:"space",value:function(){return this.multiple?(this.toggle(this.focused),this.render()):this.alert()}},{key:"a",value:function(){if(this.maxSelected<this.choices.length)return this.alert();var e=this.selectable.every((function(e){return e.enabled}));return this.choices.forEach((function(t){return t.enabled=!e})),this.render()}},{key:"i",value:function(){return this.choices.length-this.selected.length>this.maxSelected?this.alert():(this.choices.forEach((function(e){return e.enabled=!e.enabled})),this.render())}},{key:"g",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.focused;return this.choices.some((function(e){return!!e.parent}))?(this.toggle(e.parent&&!e.choices?e.parent:e),this.render()):this.a()}},{key:"toggle",value:function(e,t){var n=this;if(!e.enabled&&this.selected.length>=this.maxSelected)return this.alert();"boolean"!==typeof t&&(t=!e.enabled),e.enabled=t,e.choices&&e.choices.forEach((function(e){return n.toggle(e,t)}));for(var r=e.parent;r;){var i=r.choices.filter((function(e){return n.isDisabled(e)}));r.enabled=i.every((function(e){return!0===e.enabled})),r=r.parent}return M(this,this.choices),this.emit("toggle",e,this),e}},{key:"enable",value:function(e){return this.selected.length>=this.maxSelected?this.alert():(e.enabled=!this.isDisabled(e),e.choices&&e.choices.forEach(this.enable.bind(this)),e)}},{key:"disable",value:function(e){return e.enabled=!1,e.choices&&e.choices.forEach(this.disable.bind(this)),e}},{key:"number",value:function(e){var t=this;this.num+=e;var n=function(e){var n=Number(e);if(n>t.choices.length-1)return t.alert();var r=t.focused,i=t.choices.find((function(e){return n===e.index}));if(!i.enabled&&t.selected.length>=t.maxSelected)return t.alert();if(-1===t.visible.indexOf(i)){var s=m(t.choices),a=s.indexOf(i);if(r.index>a){var o=s.slice(a,a+t.limit),c=s.filter((function(e){return!o.includes(e)}));t.choices=o.concat(c)}else{var u=a-t.limit+1;t.choices=s.slice(u).concat(s.slice(0,u))}}return t.index=t.choices.indexOf(i),t.toggle(t.focused),t.render()};return clearTimeout(this.numberTimeout),new Promise((function(e){var r=t.choices.length,i=t.num,s=function(){var r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=arguments.length>1?arguments[1]:void 0;clearTimeout(t.numberTimeout),r&&(s=n(i)),t.num="",e(s)};return"0"===i||1===i.length&&Number(i+"0")>r?s(!0):Number(i)>r?s(!1,t.alert()):void(t.numberTimeout=setTimeout((function(){return s(!0)}),t.delay))}))}},{key:"home",value:function(){return this.choices=m(this.choices),this.index=0,this.render()}},{key:"end",value:function(){var e=this.choices.length-this.limit,t=m(this.choices);return this.choices=t.slice(e).concat(t.slice(0,e)),this.index=this.limit-1,this.render()}},{key:"first",value:function(){return this.index=0,this.render()}},{key:"last",value:function(){return this.index=this.visible.length-1,this.render()}},{key:"prev",value:function(){return this.visible.length<=1?this.alert():this.up()}},{key:"next",value:function(){return this.visible.length<=1?this.alert():this.down()}},{key:"right",value:function(){return this.cursor>=this.input.length?this.alert():(this.cursor++,this.render())}},{key:"left",value:function(){return this.cursor<=0?this.alert():(this.cursor--,this.render())}},{key:"up",value:function(){var e=this.choices.length,t=this.visible.length,n=this.index;return!1===this.options.scroll&&0===n?this.alert():e>t&&0===n?this.scrollUp():(this.index=(n-1%e+e)%e,this.isDisabled()?this.up():this.render())}},{key:"down",value:function(){var e=this.choices.length,t=this.visible.length,n=this.index;return!1===this.options.scroll&&n===t-1?this.alert():e>t&&n===t-1?this.scrollDown():(this.index=(n+1)%e,this.isDisabled()?this.down():this.render())}},{key:"scrollUp",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.choices=k(this.choices),this.index=e,this.isDisabled()?this.up():this.render()}},{key:"scrollDown",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.visible.length-1;return this.choices=b(this.choices),this.index=e,this.isDisabled()?this.down():this.render()}},{key:"shiftUp",value:function(){var e=a(s.mark((function e(){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==this.options.sort){e.next=7;break}return this.sorting=!0,this.swap(this.index-1),e.next=5,this.up();case 5:return this.sorting=!1,e.abrupt("return");case 7:return e.abrupt("return",this.scrollUp(this.index));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"shiftDown",value:function(){var e=a(s.mark((function e(){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==this.options.sort){e.next=7;break}return this.sorting=!0,this.swap(this.index+1),e.next=5,this.down();case 5:return this.sorting=!1,e.abrupt("return");case 7:return e.abrupt("return",this.scrollDown(this.index));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pageUp",value:function(){return this.visible.length<=1?this.alert():(this.limit=Math.max(this.limit-1,0),this.index=Math.min(this.limit-1,this.index),this._limit=this.limit,this.isDisabled()?this.up():this.render())}},{key:"pageDown",value:function(){return this.visible.length>=this.choices.length?this.alert():(this.index=Math.max(0,this.index),this.limit=Math.min(this.limit+1,this.choices.length),this._limit=this.limit,this.isDisabled()?this.down():this.render())}},{key:"swap",value:function(e){w(this.choices,this.index,e)}},{key:"isDisabled",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.focused,t=["disabled","collapsed","hidden","completing","readonly"];return!(!e||!t.some((function(t){return!0===e[t]})))||e&&"heading"===e.role}},{key:"isEnabled",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.focused;if(Array.isArray(t))return t.every((function(t){return e.isEnabled(t)}));if(t.choices){var n=t.choices.filter((function(t){return!e.isDisabled(t)}));return t.enabled&&n.every((function(t){return e.isEnabled(t)}))}return t.enabled&&!this.isDisabled(t)}},{key:"isChoice",value:function(e,t){return e.name===t||e.index===Number(t)}},{key:"isSelected",value:function(e){var t=this;return Array.isArray(this.initial)?this.initial.some((function(n){return t.isChoice(e,n)})):this.isChoice(e,this.initial)}},{key:"map",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";return[].concat(t||[]).reduce((function(t,r){return t[r]=e.find(r,n),t}),{})}},{key:"filter",value:function(e,t){var n="function"===typeof e?e:function(t,n){return[t.name,n].includes(e)},r=(this.options.multiple?this.state._choices:this.choices).filter(n);return t?r.map((function(e){return e[t]})):r}},{key:"find",value:function(e,t){if(x(e))return t?e[t]:e;var n="function"===typeof e?e:function(t,n){return[t.name,n].includes(e)},r=this.choices.find(n);return r?t?r[t]:r:void 0}},{key:"findIndex",value:function(e){return this.choices.indexOf(this.find(e))}},{key:"submit",value:function(){var e=a(s.mark((function e(){var t,r,i,a,o,c;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.focused){e.next=3;break}return e.abrupt("return",this.alert());case 3:if(!t.newChoice){e.next=8;break}if(t.input){e.next=6;break}return e.abrupt("return",this.alert());case 6:return t.updateChoice(),e.abrupt("return",this.render());case 8:if(!this.choices.some((function(e){return e.newChoice}))){e.next=10;break}return e.abrupt("return",this.alert());case 10:if(r=this.options,i=r.reorder,a=r.sort,o=!0===this.multiple,void 0!==(c=this.selected)){e.next=15;break}return e.abrupt("return",this.alert());case 15:return Array.isArray(c)&&!1!==i&&!0!==a&&(c=g.reorder(c)),this.value=o?c.map((function(e){return e.name})):c.name,e.abrupt("return",p(l(n.prototype),"submit",this).call(this));case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"choices",set:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.state._choices=this.state._choices||[],this.state.choices=t;var n,i=r(t);try{var s=function(){var t=n.value;e.state._choices.some((function(e){return e.name===t.name}))||e.state._choices.push(t)};for(i.s();!(n=i.n()).done;)s()}catch(c){i.e(c)}finally{i.f()}if(!this._initial&&this.options.initial){this._initial=!0;var a=this.initial;if("string"===typeof a||"number"===typeof a){var o=this.find(a);o&&(this.initial=o.index,this.focus(o,!0))}}},get:function(){return M(this,this.state.choices||[])}},{key:"visible",set:function(e){this.state.visible=e},get:function(){return(this.state.visible||this.choices).slice(0,this.limit)}},{key:"limit",set:function(e){this.state.limit=e},get:function(){var e=this.state,t=this.options,n=this.choices,r=e.limit||this._limit||t.limit||n.length;return Math.min(r,this.height)}},{key:"value",set:function(e){u(l(n.prototype),"value",e,this,!0)},get:function(){return"string"!==typeof p(l(n.prototype),"value",this)&&p(l(n.prototype),"value",this)===this.initial?this.input:p(l(n.prototype),"value",this)}},{key:"index",set:function(e){this.state.index=e},get:function(){return Math.max(0,this.state?this.state.index:0)}},{key:"enabled",get:function(){return this.filter(this.isEnabled.bind(this))}},{key:"focused",get:function(){var e=this.choices[this.index];return e&&this.state.submitted&&!0!==this.multiple&&(e.enabled=!0),e}},{key:"selectable",get:function(){var e=this;return this.choices.filter((function(t){return!e.isDisabled(t)}))}},{key:"selected",get:function(){return this.multiple?this.enabled:this.focused}}]),n}(v);function M(e,t){if(t instanceof Promise)return t;if("function"===typeof t){if(g.isAsyncFn(t))return t;t=t.call(e,e)}var n,i=r(t);try{for(i.s();!(n=i.n()).done;){var s=n.value;if(Array.isArray(s.choices)){var a=s.choices.filter((function(t){return!e.isDisabled(t)}));s.enabled=a.every((function(e){return!0===e.enabled}))}!0===e.isDisabled(s)&&delete s.enabled}}catch(o){i.e(o)}finally{i.f()}return t}e.exports=C},function(e,t,n){t.cd=n(252),t.config=n(554),t.exit=n(555),t.help=n(556),t.ls=n(568),t.pwd=n(570),t.version=n(571),t.pkg=n(573),t.clear=n(574),t.open=n(576),t.login=n(579),t.logout=n(580),t.su=n(581),t.add=n(583),t.ln=n(584),t.rm=n(585),t.whoami=n(586),t.search=n(587),t.time=n(588),t.ping=n(591),t.reset=n(592),t.dns=n(593),t.cat=n(594),t.net=n(595),t.debug=n(596),t.edit=n(597),t.about=n(598),t.blocks=n(599),t.scrub=n(600),t.namegen=n(601)},,,,function(e,t,n){var r=n(280),i=r.browserFactory,s=r.effectorFactory,a=r.awsFactory,o=n(122);e.exports={browserFactory:i,effectorFactory:s,awsFactory:a,engine:o}},,,,,function(e,t,n){var r=n(281).metrologyFactory,i=n(169).standardEngineFactory,s=n(50),a=s.consistencyFactory,o=s.toFunctions,c=n(110).cryptoFactory,u=n(242).blockPrint,l=n(109).setLogger;e.exports={metrologyFactory:r,standardEngineFactory:i,consistencyFactory:a,cryptoFactory:c,blockPrint:u,setLogger:l,consistencyQueueToFunctions:o}},function(e,t,n){var r=(0,n(20).standardize)({schema:{type:"object",title:"Acl",description:"Access control list, power rating, alias table, and chargeout rates\nGroups are similar to roles.\nGroups contain only Actors\nActors are similar to users, but represent chains\nThis is the alias table\nActors contain only a single ChainId\nThis might be extended to cover token balance from other chains.\nCould use proofs to show your current balance when an action was requested.\n\nAlias table is contained within the join slices directly.",required:["groups","everybody","balance","shares","costs"],additionalProperties:!1,properties:{groups:{},everybody:{},balance:{},shares:{},costs:{}}},create:function(){return r.clone({groups:{children:{alice:50,chain123:60},founders:{chain123:1}},everybody:{},balance:{},shares:{children:0,founders:100},costs:{"*":{children:50}}})},logicize:function(e){return{isAllowed:function(e,t,n){}}}});e.exports={aclModel:r}},,,,function(e,t){var n={},r={registerModels:function(e){Object.keys(e).forEach((function(t){var r=e[t];if(!t||!e[t])throw new Error("".concat(t," passed in as undefined"));var i=r.schema.title;if(n[i])throw new Error("".concat(i," was already registered"));n[i]=r}))},isRegistered:function(e){return!!n[e]},get:function(e){if(!n[e])throw new Error("Model not found in registry: ".concat(e));return n[e]},_getContainer:function(){return n}};e.exports={registry:r}},,,,,,,,,,,,,,,,,,,function(e,t,n){var r=n(20).standardize,i=n(38).integrityModel,s=r({schema:{title:"Binary",type:"object",description:"Manages the binary attached to each chain.",additionalProperties:!1,required:["integrity","size"],properties:{integrity:i.schema,size:{type:"number",min:0}}},create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e=i.clone(e),s.clone({integrity:e,size:t})},logicize:function(e){return{}}});e.exports={binaryModel:s}},function(e,t,n){var r=n(54),i=n(20).standardize,s=(n(83).publicKeyModel,n(38).integrityModel,i({schema:n(37).signatureSchema,create:function(){throw new Error("Only the keypairModel can create signatureModel types")},logicize:function(e){var t=e.integrity,n=e.seal,i=e.publicKey,s=t.hash,a=i.key;if(!r.verifyHashSync(s,n,a)){var o=new Error("Could not verify hash synchronously: ".concat(s));throw o.toVerify={hash:s,seal:n,key:a},o}return{}}}));e.exports={signatureModel:s}},function(e,t,n){var r=n(20).standardize,i=n(38).integrityModel,s=r({schema:{title:"CovenantId",description:"Covenants are how behaviour is introduced to the system.\nA Covenant represents the loaded piece of language specific code.\nA covenant is a binary package on disk, but in ram it is executable code.\n\nIn all languages, a reducer must be supplied.\nThis pure function takes a json state, and a json action, and returns a json state\n\nOptionally, a list of async functions that are invoked by the side effect system \nmay be supplied",type:"object",additionalProperties:!1,required:["name","version","integrity","language"],properties:{name:{type:"string"},version:{type:"string"},integrity:i.schema,language:{enum:["javascript","javascript/xstate","python","go","rust","haskell","c","c++"]}}},create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"unity",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.create(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0.0.0",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"javascript";if(!i.isModel(t))throw new Error("Invalid integrity for name: ".concat(e));return s.clone({name:e,version:n,integrity:t,language:r})},logicize:function(e){return{isSystemCovenant:function(){return a(e.name)}}}}),a=function(e){return"string"===typeof e&&!!n(101)[e]};e.exports={covenantIdModel:s}},function(e,t,n){var r=n(8),i=n(4),s=(n(11)("interblock:models:network"),n(24)),a=n(20).standardize,o=n(105).channelModel,c=n(49).addressModel,u=n(82).provenanceModel,l=a({schema:{title:"Network",description:"All communication in and out of this blockchain.",type:"object",required:["..","."],additionalProperties:!1,minProperties:2,patternProperties:{"(.*?)":o.schema}},create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e[".."]?e[".."]:o.create(c.create(),".."),n=e["."]?e["."]:o.create(c.create("LOOPBACK"),".");return i(n.address.isLoopback()),l.clone(r({},e,{"..":t,".":n}))},logicize:function(e){i(!e[void 0]);var t=Object.keys(e);Object.freeze(t),i(t.includes("..")),i(t.includes(".")),i(o.isModel(e["."]),"channel invalid"),i("."===e["."].systemRole,"self not loopback channel");var n=function(){return a("reply")},r=function(){return a("request")},a=function(n){var r;return t.find((function(t){var i,s=e[t],a=s.rxReply(),o=s.rxRequest();switch(n){case"reply":i=a;break;case"request":i=o}if(i)return r={alias:t,event:i,channel:s},!0})),r},p=function(){return t},h=function(){return p().filter((function(t){return e[t].address.isResolved()}))},d=function(t){return i(c.isModel(t)),i(!t.isUnknown()),p().find((function(n){return e[n].address.equals(t)}))};return{rxReply:n,rxRequest:r,rxSelf:function(){var t=e["."];return t.rxReply()||t.rxRequest()},rx:function(){return n()||r()},getAliases:p,getResolvedAliases:h,getAlias:d,getParent:function(){return e[".."]},includesInterblock:function(t){var n=t.provenance;i(u.isModel(n));var r=d(n.getAddress());if(!r)return!1;var a=!1,o=e[r];if(n.height<=o.lineageHeight&&(a=!0),n.height===o.lineageHeight){var c=n.equals(s.last(o.lineageTip).provenance);i(c)}return t.getRemote()&&a?(n.height===o.heavy.provenance.height&&i(t.equals(o.heavy)),n.height<=o.heavy.provenance.height):a},isResponseDone:function(t,n){i(c.isModel(t)),i(Number.isInteger(n)),i(n>=0);var r=d(t);return i(e[r]),e[r].replies[n]},txInterblockAliases:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.create();i(l.isModel(t));var n=h(),r=n.filter((function(n){var r=e[n],i=t.getAlias(r.address);if(!i)return!0;var s=t[i];return r.isTxGreaterThan(s)}));return r},isNewChannels:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.create();i(l.isModel(t));var n=h(),r=n.some((function(n){var r=e[n].address;if(!t.getAlias(r))return!0}));return r}}}});e.exports={networkModel:l}},function(e,t,n){var r=n(8),i=n(81),s=n(4),a=n(20).standardize,o=n(234).txRequestModel,c=n(233).txReplyModel,u=n(230).rxReplyModel,l=n(231).rxRequestModel,p=(n(99).assertNoUndefined,{title:"State",description:"The result of running a covenant is stored here.\nIt checks the state minus the actions is serializable\nIncludes the array of requests and replies returned from \nreducing the covenant.  These actions are intended to be transmitted\nvia the network.  This model enforces the format and logic of the\nreturns from the reducer\n\nThis is how covenant info is ingested back into the trusted system.\nIt is crucial that the format of this data is correct\n\nEntry point from covenant to system.\n\nMaximally inflates actions with defaults.  Logical checking is done inside\nthe networkProducer as needs context of the initiating action to fill in\nremaining defaults\n\nThe actions in from the covenant are refined over three states:\n1. create( state ) inflates actions to pass schema validation\n2. logicize( state ) checks static logic\n3. networkProducer.tx( state ) checks context logic\n\nThe returned model is forbidden to have an actions key on it.\nThe validation is run during clone, then logicize strips the actions out.\n\nCreate is only called immediately after a reducer call returns some state.\nTherefore, we always know what the default action is, so we require it of create.\n",type:"object",required:[],additionalProperties:!0,properties:{actions:{type:"array",uniqueItems:!1,items:{oneOf:[o.schema,c.schema]}}}}),h=function(e,t){if(!e)throw new Error("Action cannot be interpreted: ".concat(e));if("string"===typeof e&&(e={type:e}),s(e.type,"Action must supply a type"),d(e.type)){var n,r=e,i=r.type,a=r.payload,u=void 0===a?{}:a,p=e.request;return p?n=p.sequence:(s(l.isModel(t)),n=t.sequence),c.create(i,u,n)}var h=e,f=h.type,v=h.payload,y=void 0===v?{}:v,g=h.to,m=void 0===g?".":g;return o.create(f,y,m)},d=function(e){return c.schema.properties.type.enum.includes(e)},f=a({schema:p,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;s.equal(typeof e,"object");var n=e.actions,a=i(e,["actions"]);if(t&&s(l.isModel(t)||u.isModel(t),"defaultAction must be either rxRequest or rxReply: ".concat(t)),n){!Array.isArray(n)&&n&&(n=[n]);var o=n.map((function(e){return h(e,t)}));a=r({actions:n=o},a)}return f.clone(a)},logicize:function(e){var t=e.actions,n=void 0===t?[]:t,r=i(e,["actions"]);s(Array.isArray(n),"actions must be an array: ".concat(n));var a=[],u=[];n.forEach((function(e){if(d(e.type)){var t=c.clone(e);u.forEach((function(n){n.isPromise()&&s(!t.isPromise(),"Duplicate promise: ".concat(e));var r=n.request.sequence!==t.request.sequence;s(r,"Duplicate reply: ".concat(e))})),u.push(t)}else{var n=o.clone(e);a.push(n)}}));return{getRequests:function(){return[].concat(a)},getReplies:function(){return[].concat(u)},getState:function(){return r}}}});e.exports={stateModel:f}},function(e,t,n){var r=n(8),i=(0,n(20).standardize)({schema:{title:"Config",description:"Configuration options for the chain",type:"object",required:["isPierced","isSideEffectCapable","isPublicChannelOpen"],additionalProperties:!1,properties:{isPierced:{type:"boolean",description:"If the chain should be reduced, even with no known actions"},isSideEffectCapable:{type:"boolean",description:"When reducing, will this chain be allowed network access"},isPublicChannelOpen:{type:"boolean",description:"Will the validators open up new channels on request from unknown chains"}}},create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={isPierced:!1,isSideEffectCapable:!1,isPublicChannelOpen:!1};return i.clone(r({},t,{},e))},logicize:function(e){return{}}});e.exports={configModel:i}},function(e,t,n){var r=n(20).standardize,i=n(37).validatorsSchema,s=(n(83).publicKeyModel,n(65)),a=s.keypairModel,o=s.ciKeypair,c=r({schema:i,create:function(){var e=a.create("CI",o).getValidatorEntry();return c.clone(e)},logicize:function(e){return{}}});e.exports={validatorsModel:c}},function(e,t,n){var r=n(4),i=n(20).standardize,s=n(37).proofSchema,a=n(80).blockModel,o=i({schema:s,create:function(e,t){r(a.isModel(e));var n={block:e.getProof()};return t&&(r(e.network[t],"missing ".concat(t)),n.network=e.network.getProof(),n.channel=e.network[t].getProof()),o.clone(n)},logicize:function(e){return{}}});e.exports={proofModel:o}},function(e,t,n){var r=n(2),i=n(3),s=n(8),a=n(4),o=n(23).blockModel,c=n(101),u=n(11)("interblock:isolate");e.exports={isolateFactory:function(e){var t=function(e){var t={},n=s({},c,{},e);return{loadCovenant:function(){var e=i(r.mark((function e(i){var s,c,l;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(o.isModel(i)),s=i.covenantId,c=i.provenance.reflectIntegrity().hash,l=s.name,a(n[l],"No covenant loaded: ".concat(l)),u("loadCovenant %o from %o",l,Object.keys(n)),u("containerId: %o",c.substring(0,9)),t[c]={covenant:n[l],block:i},e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),tick:function(){var e=i(r.mark((function e(n){var i,s,o,c,l;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.containerId,s=n.state,o=n.action,u("tick: %o action: %o",i.substring(0,9),o.type),c=t[i],a(c,"No tick container for: ".concat(i)),e.next=6,c.covenant.reducer(s,o);case 6:return l=e.sent,e.abrupt("return",l);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),unloadCovenant:function(){var e=i(r.mark((function e(n){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u("attempting to unload: %o",n),e.next=3,Promise.resolve();case 3:a(t[n],"No container for: ".concat(n)),delete t[n];case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}(e);return function(e){switch(e.type){case"LOAD_COVENANT":return t.loadCovenant(e.payload);case"TICK":return t.tick(e.payload);case"UNLOAD_COVENANT":return t.unloadCovenant(e.payload);default:throw new Error("Unknown isolator action type")}}},toFunctions:function(e){return{loadCovenant:function(t){return e.push({type:"LOAD_COVENANT",payload:t})},tick:function(t){return e.push({type:"TICK",payload:t})},unloadCovenant:function(t){return e.push({type:"UNLOAD_COVENANT",payload:t})}}}}},,function(e,t,n){var r=n(2),i=n(3),s=n(11)("interblock:aws:ramS3"),a=n(4);n(24);e.exports={ramS3Factory:function(){var e={wbblockbucket:{},wbinterbucket:{}};return{putObject:function(t){var n=t.Bucket,o=t.Key,c=t.Body;return s("putObject %O %O",n,o),a("string"===typeof n),a("string"===typeof o),a("object"===typeof c),{promise:function(){var t=i(r.mark((function t(){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:return a(e[n]),e[n][o]&&s("item already exists: %O %O",n,o),e[n][o]=c,t.abrupt("return",!0);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}},getObject:function(t){var n=t.Bucket,o=t.Key;return s("getObject %O %O",n,o),a("string"===typeof n),a("string"===typeof o),{promise:function(){var t=i(r.mark((function t(){var i;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:return a(e[n]),e[n][o]||(s(n),s(o)),a(e[n][o]),i=e[n][o],t.abrupt("return",{Body:i});case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}},deleteObject:function(t){var n=t.Bucket,o=t.Key;return s("deleteObject %O %O",n,o),{promise:function(){var t=i(r.mark((function t(){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:return a(e[n]),a(e[n][o]),delete e[n][o],t.abrupt("return",!0);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}},_getBuckets:function(){return e},_isRam:!0}}}},function(e,t,n){"use strict";var r=n(2),i=n(3),s=n(8),a=n(9),o=n(12),c=n(26),u=n(29),l=n(17),p=n(18),h=n(42),d=n(56),f=n(249),v=function(e){p(n,e);var t=l(n);function n(e){var r;return a(this,n),(r=t.call(this,s({},e,{multiple:!0}))).type="form",r.initial=r.options.initial,r.align=[r.options.align,"right"].find((function(e){return null!=e})),r.emptyError="",r.values={},r}return o(n,[{key:"reset",value:function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(c(n.prototype),"reset",this).call(this);case 2:return!0===t&&(this._index=this.index),this.index=this._index,this.values={},this.choices.forEach((function(e){return e.reset&&e.reset()})),e.abrupt("return",this.render());case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"dispatch",value:function(e){return!!e&&this.append(e)}},{key:"append",value:function(e){var t=this.focused;if(!t)return this.alert();var n=t.cursor,r=t.input;return t.value=t.input=r.slice(0,n)+e+r.slice(n),t.cursor++,this.render()}},{key:"delete",value:function(){var e=this.focused;if(!e||e.cursor<=0)return this.alert();var t=e.cursor,n=e.input;return e.value=e.input=n.slice(0,t-1)+n.slice(t),e.cursor--,this.render()}},{key:"deleteForward",value:function(){var e=this.focused;if(!e)return this.alert();var t=e.cursor,n=e.input;if(void 0===n[t])return this.alert();var r="".concat(n).slice(0,t)+"".concat(n).slice(t+1);return e.value=e.input=r,this.render()}},{key:"right",value:function(){var e=this.focused;return e?e.cursor>=e.input.length?this.alert():(e.cursor++,this.render()):this.alert()}},{key:"left",value:function(){var e=this.focused;return e?e.cursor<=0?this.alert():(e.cursor--,this.render()):this.alert()}},{key:"space",value:function(e,t){return this.dispatch(e,t)}},{key:"number",value:function(e,t){return this.dispatch(e,t)}},{key:"next",value:function(){var e=this.focused;if(!e)return this.alert();var t=e.initial,r=e.input;return t&&t.startsWith(r)&&r!==t?(e.value=e.input=t,e.cursor=e.value.length,this.render()):u(c(n.prototype),"next",this).call(this)}},{key:"prev",value:function(){var e=this.focused;return e?0===e.cursor?u(c(n.prototype),"prev",this).call(this):(e.value=e.input="",e.cursor=0,this.render()):this.alert()}},{key:"separator",value:function(){return""}},{key:"format",value:function(e){return this.state.submitted?"":u(c(n.prototype),"format",this).call(this,e)}},{key:"pointer",value:function(){return""}},{key:"indicator",value:function(e){return e.input?"\u29bf":"\u2299"}},{key:"choiceSeparator",value:function(){var e=i(r.mark((function e(t,n){var i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resolve(t.separator,this.state,t,n);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=":";case 5:return i=e.t0,e.abrupt("return",i?" "+this.styles.disabled(i):"");case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"renderChoice",value:function(){var e=i(r.mark((function e(t,n){var i,s,a,o,c,u,l,p,d,v,y,g,m,k,b,x,w,C,M,I,P,A,O,S,E;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onChoice(t,n);case 2:return i=this.state,s=this.styles,a=t.cursor,o=t.initial,c=void 0===o?"":o,u=t.name,l=t.hint,p=t.input,d=void 0===p?"":p,v=s.muted,y=s.submitted,g=s.primary,m=s.danger,k=l,b=this.index===n,x=t.validate||function(){return!0},e.next=10,this.choiceSeparator(t,n);case 10:return w=e.sent,C=t.message,"right"===this.align&&(C=C.padStart(this.longest+1," ")),"left"===this.align&&(C=C.padEnd(this.longest+1," ")),M=this.values[u]=d||c,I=d?"success":"dark",e.next=18,x.call(t,M,this.state);case 18:if(e.t0=e.sent,!0===e.t0){e.next=21;break}I="danger";case 21:return P=s[I],e.t1=P,e.next=25,this.indicator(t,n);case 25:if(e.t2=e.sent,e.t3=(0,e.t1)(e.t2),e.t4=t.pad||"",A=e.t3+e.t4,O=this.indent(t),S=function(){return[O,A,C+w,d,k].filter(Boolean).join(" ")},!i.submitted){e.next=36;break}return C=h.unstyle(C),d=y(d),k="",e.abrupt("return",S());case 36:if(!t.format){e.next=42;break}return e.next=39,t.format.call(this,d,t,n);case 39:d=e.sent,e.next=45;break;case 42:E=this.styles.muted,d=f(this,{input:d,initial:c,pos:a,showCursor:b,color:E});case 45:if(this.isValue(d)||(d=this.styles.muted(this.symbols.ellipsis)),!t.result){e.next=50;break}return e.next=49,t.result.call(this,M,t,n);case 49:this.values[u]=e.sent;case 50:return b&&(C=g(C)),t.error?d+=(d?" ":"")+m(t.error.trim()):t.hint&&(d+=(d?" ":"")+v(t.hint.trim())),e.abrupt("return",S());case 53:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"submit",value:function(){var e=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.value=this.values,e.abrupt("return",u(c(n.prototype),"base",this).submit.call(this));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(d);e.exports=v},function(e,t,n){"use strict";var r=n(2),i=n(3),s=n(9),a=n(12),o=n(247),c=n(26),u=n(29),l=n(17),p=n(18),h=n(86),d=n(32),f=d.isPrimitive,v=d.hasColor,y=function(e){p(n,e);var t=l(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).cursorHide(),r}return a(n,[{key:"initialize",value:function(){var e=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resolve(this.initial,this.state);case 2:return t=e.sent,e.next=5,this.cast(t);case 5:return this.input=e.sent,e.next=8,u(c(n.prototype),"initialize",this).call(this);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispatch",value:function(e){return this.isValue(e)?(this.input=e,this.submit()):this.alert()}},{key:"format",value:function(e){var t=this.styles;return this.state.submitted?t.success(e):t.primary(e)}},{key:"cast",value:function(e){return this.isTrue(e)}},{key:"isTrue",value:function(e){return/^[ty1]/i.test(e)}},{key:"isFalse",value:function(e){return/^[fn0]/i.test(e)}},{key:"isValue",value:function(e){return f(e)&&(this.isTrue(e)||this.isFalse(e))}},{key:"hint",value:function(){var e=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("pending"!==this.state.status){e.next=7;break}return e.next=3,this.element("hint");case 3:if(t=e.sent,v(t)){e.next=6;break}return e.abrupt("return",this.styles.muted(t));case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=i(r.mark((function e(){var t,n,i,s,a,o,c,u,l,p,h,d,f;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.input,i=t.size,e.next=3,this.prefix();case 3:return s=e.sent,e.next=6,this.separator();case 6:return a=e.sent,e.next=9,this.message();case 9:return o=e.sent,c=this.styles.muted(this.default),u=[s,o,c,a].filter(Boolean).join(" "),this.state.prompt=u,e.next=15,this.header();case 15:return l=e.sent,p=this.value=this.cast(n),e.next=19,this.format(p);case 19:return h=e.sent,e.next=22,this.error();case 22:if(e.t0=e.sent,e.t0){e.next=27;break}return e.next=26,this.hint();case 26:e.t0=e.sent;case 27:return d=e.t0,e.next=30,this.footer();case 30:f=e.sent,d&&!u.includes(d)&&(h+=" "+d),u+=" "+h,this.clear(i),this.write([l,u,f].filter(Boolean).join("\n")),this.restore();case 36:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"value",set:function(e){o(c(n.prototype),"value",e,this,!0)},get:function(){return this.cast(u(c(n.prototype),"value",this))}}]),n}(h);e.exports=y},function(e,t,n){var r=n(19),i=n(21)("dos:eval"),s=n(113);e.exports.evaluate=function(e,t,n){if(i(t,n),t=t||""){if(!s[t])throw new Error("".concat(t,": command not found"));return s[t].apply(s,[e].concat(r(n)))}}},function(e,t,n){var r=n(2),i=n(3),s=n(244),a=n(21)("dos:spinner");t.withSpin=function(e){return function(){var t=i(r.mark((function t(n){var i=arguments;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a("spinner"),n.spinner=s({spinner:"clock"}).start(),t.prev=2,t.next=5,e.apply(this,i);case 5:return t.abrupt("return",t.sent);case 8:t.prev=8,t.t0=t.catch(2),a(t.t0);case 11:return t.prev=11,n.spinner.stop(),n.spinner=null,t.finish(11);case 15:case"end":return t.stop()}}),t,this,[[2,8,11,15]])})));return function(e){return t.apply(this,arguments)}}()}},,,,,,,,function(e,t,n){var r=n(8),i=n(2),s=n(3),a=n(4),o=n(122).metrologyFactory,c=n(24),u=n(11)("interblock:effector"),l=(n(84).actions,n(101).shell),p=n(23),h=p.addressModel,d=p.socketModel,f=n(488).tcpTransportFactory,v=function(){var e=s(i.mark((function e(t){var c,p,v,g,m,k,b,x,w,C,M,I,P,A,O;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u("effectorFactory"),c=l.covenantId,e.next=4,o(t).spawn("shell",{covenantId:c});case 4:return p=e.sent,v=p.getEngine(),g=v.ioConsistency,e.next=8,p.getChildren().shell;case 8:return m=e.sent,function(){var e=s(i.mark((function e(t){var n;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,awsFactory("aws");case 2:n=e.sent,client.sqsTx.setProcessor(n.sqsRx.push),n.sqsTx.setProcessor(client.sqsRx.push);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(e){var t=e.type,n=e.payload;u("dispatch action.type: %O",t);return p.dispatch({type:t,payload:n,to:"shell"})},b=function(){var e=arguments.length>1?arguments[1]:void 0;return m.getState(e)},x=function(){return m.getState().state.xstate.context},w=m.subscribe,C=function(){var e=s(i.mark((function e(t,n){var r,s,o,c,l,p;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.equal(typeof n,"object"),a.equal(typeof t,"string"),a.equal(typeof n.url,"string"),r=n.url,s=f(r),e.next=7,s.connect();case 7:return u("connected to %o",r),e.next=10,s.pingLambda();case 10:return o=e.sent,u("latency of %o ms to %o ",o,r),c=h.create(t),l=d.create({type:"awsApiGw",info:n}),p={type:"PUT_SOCKET",payload:{address:c,socket:l}},e.next=17,g.push(p);case 17:return e.abrupt("return",o);case 18:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),M=function(){var e=s(i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),I=y(k),P=p.getEngine(),A=P.sqsTx,O=P.sqsRx,e.next=20,p.settle();case 20:return e.abrupt("return",r({},I,{dispatch:k,getState:b,getContext:x,subscribe:w,addTransport:C,removeTransports:M,sqsTx:A,sqsRx:O,engine:p,_debug:n(11)}));case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(e){var t={};return c.forOwn(l.actions,(function(n,r){t[r]=function(){var t=n.apply(void 0,arguments);return e(t)}})),t};e.exports={effectorFactory:v}},function(e,t,n){var r=n(8),i=n(2),s=n(3),a=n(4),o=(n(24),n(285)),c=n(171).sqsQueueFactory,u=n(23),l=u.interblockModel,p=u.addressModel,h=u.txModel,d=(u.socketModel,n(442).fsmFactory),f=n(11)("interblock:engine");e.exports={standardEngineFactory:function(){f("standardEngineFactory");var e=0,t=d(),n=(t.ioIsolate,t.ioCrypto,t.ioConsistency,t.ioPool),u=t.ioIncrease,v=t.ioReceive,y=t.ioTransmit,g=c("sqsTx",h),m=c("sqsRx",h),k=c("sqsTransmit",l),b=c("sqsPool",l),x=c("sqsIncrease",p),w={sqsTx:g,sqsRx:m,sqsTransmit:k,sqsPool:b,sqsIncrease:x};return m.setProcessor(function(e,t,n){return function(){var r=s(i.mark((function r(s){var o,c,u,l,p;return i.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return f.extend("receiver")("receiver"),a(h.isModel(s)),o=s.interblock,r.next=6,e.push(s);case 6:return c=r.sent,u=c.isPoolable,l=c.isCatchupable,a("boolean"===typeof u),a("boolean"===typeof l),p=[],u&&p.push(t.push(o)),l&&p.push(n.push(o)),r.next=16,Promise.all(p);case 16:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()}(v,b,k)),k.setProcessor(function(e,t,n){return function(){var r=s(i.mark((function r(s){var o,c;return i.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return f.extend("transmitter")("transmitter"),a(l.isModel(s)),r.next=5,e.push(s);case 5:return o=r.sent,a(o.every(h.isModel),"failed transmitter"),c=o.map((function(e){var r=e.interblock;return e.socket.getIsInternal()?n.push(r):t.push(e)})),r.next=10,Promise.all(c);case 10:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()}(y,g,b)),b.setProcessor(function(e,t){return function(){var n=s(i.mark((function n(r){var s,o,c;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(s=f.extend("pooler"))("pooler"),a(l.isModel(r)),n.next=5,e.push(r);case 5:return o=n.sent,a(Array.isArray(o),"failed pool"),s("affectedAddresses length: %o",o.length),c=o.map((function(e){return t.push(e)})),n.next=11,Promise.all(c);case 11:return n.abrupt("return",o);case 12:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(n,x)),x.setProcessor(function(t,n){var r=new Map,c=new Map;return function(){var u=s(i.mark((function s(u){var h,d,v,y;return i.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if((h=f.extend("increasor").extend(o(3,e++)))("throttler"),a(p.isModel(u)),d=u.getChainId(),c.get(d)){i.next=24;break}case 5:return r.delete(d),c.set(d,!0),i.next=9,t.push(u);case 9:if(!(v=i.sent)){i.next=19;break}return a(Array.isArray(v)),a(v.every(l.isModel)),h("transmission count: ".concat(v.length)),y=v.map((function(e){return n.push(e)})),i.next=17,Promise.all(y);case 17:i.next=20;break;case 19:h("could not externally lock: %o",d);case 20:c.delete(d);case 21:if(r.get(d)){i.next=5;break}case 22:i.next=26;break;case 24:r.set(d,!0),h("redrive raised");case 26:case"end":return i.stop()}}),s)})));return function(e){return u.apply(this,arguments)}}()}(u,k)),r({},t,{},w)}}},,function(e,t,n){var r=n(288),i=r.ioQueueFactory,s=r.sqsQueueFactory;e.exports={ioQueueFactory:i,sqsQueueFactory:s}},,,,,,,,,,,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var r=n(19),i=n(4),s=n(11)("interblock:producers:channel"),a=n(24),o=n(23),c=o.addressModel,u=o.channelModel,l=o.interblockModel,p=o.actionModel,h=o.continuationModel;e.exports={ingestInterblock:function(e,t){return u.clone(e,(function(n){s("ingestInterblock"),i(l.isModel(t)),i(e.address.equals(t.provenance.getAddress()));var o=t.provenance,c=o.reflectIntegrity(),u=t.getRemote(),p=t.getWithoutRemote(),h=r(e.lineage),d=function(){h.push(c),n.lineageTip.push(p),n.lineageHeight=o.height,s("ingested lineage: ".concat(o.height))},f=function(){if(n.heavy=t,n.heavyHeight=o.height,i(u||o.address.isGenesis()),u){var e=u.requests,r=Object.keys(e),c=a.pick(n.replies,r);n.replies=c,s("ingested heavy: ".concat(o.height))}},v=a.last(e.lineageTip);v?v.provenance.isNext(o)&&d():o.address.isGenesis()&&(s("ingesting genesis"),d(),f()),u&&n.heavy&&o.height>n.heavy.provenance.height&&h.some((function(e){return e.equals(c)}))&&f(),n.lineage=h}))},setAddress:function(e,t){return u.clone(e,(function(e){i(c.isModel(t)),i(!t.isGenesis()),e.address=t}))},txRequest:function(e,t){return u.clone(e,(function(e){s("txRequest"),i(p.isModel(t),"must supply request object");var n=e.requestsLength;e.requests[n]=t,e.requestsLength++}))},txReply:function(e,t,n){return u.clone(e,(function(r){i(h.isModel(t),"must supply reply object");var s=e.getNextReplyIndex();n=Number.isInteger(n)?n:s;var o=a.last(e.getRemoteRequestIndices());i(n>=0&&n<=o,"replyIndex out of bounds: ".concat(n)),i(e.getRemote().requests[n]);var c=e.replies[n],u=s===n;if(c&&!c.isPromise())throw new Error("Can only settle previous promises: ".concat(n));if(t.isPromise()&&!u)throw new Error("Can only promise for current action: ".concat(n));if(!c&&!u)throw new Error("Can only settle directly with tip: ".concat(t));r.replies[n]=t}))},shiftTxRequest:function(e){return u.clone(e,(function(t){i(e.rxReply()),s("shiftTxRequest requestsLength: ".concat(e.requestsLength));var n=e.rxReplyIndex();i(e.requests[n],"nothing to remove at ".concat(n)),delete t.requests[n],"."===e.systemRole&&delete t.replies[n]}))}}},function(e,t,n){var r=n(230).rxReplyModel,i=n(231).rxRequestModel,s=n(233).txReplyModel,a=n(234).txRequestModel;e.exports={rxReplyModel:r,rxRequestModel:i,txReplyModel:s,txRequestModel:a}},function(e,t,n){var r=n(4),i=n(20).standardize,s=n(64).actionModel,a=i({schema:n(106).rxReplySchema,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"@@RESOLVE",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;r(s.isModel(n),"Request not model: ".concat(n));var i={type:e,payload:t,request:n};return a.clone(i)},logicize:function(e){var t=e.request,n=t.type,r=t.payload,i=s.create(n,r);return{getRequest:function(){return i},isReply:function(){return!0}}}});e.exports={rxReplyModel:a}},function(e,t,n){var r=n(4),i=n(20).standardize,s=n(232),a=n(64).actionModel,o=n(49).addressModel,c=i({schema:n(106).rxRequestSchema,create:function(e,t,n,i){r(Number.isInteger(i)),r(o.isModel(n));var s={type:e,payload:t,sequence:"".concat(n.getChainId(),"_").concat(i)};return c.clone(s)},logicize:function(e){var t=e.type,n=e.payload,r=e.sequence,i=s(r),o=i.address,c=i.index,u=a.create(t,n);return{getAddress:function(){return o},getIndex:function(){return c},getRequest:function(){return u},isReply:function(){return!1}}}});e.exports={rxRequestModel:c}},function(e,t,n){var r=n(8),i=n(33),s=n(4),a=n(49).addressModel,o=n(38).integrityModel;e.exports=function(e){s("string"===typeof e);var t,n=e.split("_"),c=i(n,2),u=c[0],l=c[1],p=parseInt(l);if("LOOPBACK"===u)t=a.create("LOOPBACK");else{var h=o.clone(r({},o.clone(),{hash:u}));t=a.create(h)}return{address:t,index:p}}},function(e,t,n){var r=n(4),i=n(20).standardize,s=n(85).continuationModel,a=n(106).txReplySchema,o=n(232),c=i({schema:a,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"@@RESOLVE",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;r.equal(typeof t,"object");var i={type:e,payload:t,request:{sequence:n}};return c.clone(i)},logicize:function(e){var t=e.type,n=e.payload,r=e.request.sequence,i=o(r),a=i.address,c=i.index,u=s.create(t,n);return{getAddress:function(){return a},getIndex:function(){return c},getContinuation:function(){return u}}}});e.exports={txReplyModel:c}},function(e,t,n){var r=n(4),i=n(20).standardize,s=n(64).actionModel,a=i({schema:n(106).txRequestSchema,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"DEFAULT_TX_REQUEST",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";r.equal(typeof t,"object");var i={type:e,payload:t,to:n};return a.clone(i)},logicize:function(e){var t=e.type,n=e.payload,r=(e.to,s.create({type:t,payload:n}));return{getAction:function(){return r}}}});e.exports={txRequestModel:a}},function(e,t,n){var r=n(4),i=(n(11)("interblock:models:lock"),n(161).v4),s=n(20).standardize,a=n(104).timestampModel,o=n(80).blockModel,c=n(108).interblockModel,u=s({schema:{title:"Lock",description:"Locking of the persistence layer for execution to take place.",type:"object",required:["uuid","timestamp","expires","interblocks"],additionalProperties:!1,properties:{uuid:{type:"string",description:"uuidv4 identifying a lock on a chainId"},timestamp:a.schema,expires:{type:"integer",description:"ms until the lock expires",min:0},block:o.schema,interblocks:{type:"array",description:"Punched out blocks from other chains that have accumulated for this chain",uniqueItems:!0,items:c.schema}}},create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i();r(!e||o.isModel(e)),t=t.map(c.clone);var s=a.create(),l=2e3,p={uuid:n,timestamp:s,expires:l,interblocks:t};e&&(p.block=e);var h=u.clone(p);return h},logicize:function(e){var t=e.timestamp,n=e.expires;return{isLocked:function(){return!t.isExpired(n)},isMatch:function(t){return t.uuid===e.uuid}}}});e.exports={lockModel:u}},function(e,t,n){var r=n(8),i=(n(4),n(161).v4),s=n(20).standardize,a={id:"fd9e9077-cda5-4b1d-afbf-c8a7cf648ded",type:"internal",info:{}},o=s({schema:{title:"Socket",description:"Socket info, used to store info about block producers",type:"object",required:["id","type","info"],additionalProperties:!1,properties:{id:{type:"string"},type:{enum:["internal","websocket","https","email","udp","awsApiGw"]},info:{type:"object"}}},create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;return e=r({id:i(),type:"internal",info:{}},e),o.clone(r({},e))},logicize:function(e){return{getIsInternal:function(){return"internal"===e.type}}}});e.exports={socketModel:o}},function(e,t,n){var r=n(33),i=n(2),s=n(3),a=n(11)("interblock:consistency:db"),o=n(4),c=(n(24),n(111).ramDynamoDbFactory);e.exports={dbFactory:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c(),n=function(){var e=s(i.mark((function e(n,r){var s,a,o;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={TableName:n,Key:r,ConsistentRead:!0,ReturnConsumedCapacity:"TOTAL"},e.next=3,t.get(s).promise();case 3:return a=e.sent,a.ConsumedCapacity,o=a.Item,e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),u=function(e){return n("dbChains",e)},l=function(){var e=s(i.mark((function e(n,r){var s;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(n),o(r),Array.isArray(r)||(r=[r]),s=r.map((function(e){var r={TableName:n,Item:e,ReturnConsumedCapacity:"TOTAL"};return t.put(r).promise()})),e.next=6,Promise.all(s);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),p=function(e){return l("dbPools",e)},h=function(e){return l("dbChains",e)},d=function(e){return l("dbSubscribers",e)},f=function(){var e=s(i.mark((function e(t){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l("dbSockets",t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=s(i.mark((function e(t){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l("dbCrypto",t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=s(i.mark((function e(n,r){var s;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(Array.isArray(r)),s=r.map((function(e){var r={TableName:n,Key:e,ReturnConsumedCapacity:"TOTAL"};return t.delete(r).promise()})),e.next=4,Promise.all(s);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),g=function(e){return y("dbSubscribers",e)},m=function(e){return y("dbPools",e)},k=function(){var e=s(i.mark((function e(n,r,s){var c,u,l;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={TableName:n,KeyConditionExpression:"chainId = :hkey",ExpressionAttributeValues:{":hkey":r},ScanIndexForward:!1,ConsistentRead:!0,ReturnConsumedCapacity:"TOTAL"},s&&(c.Limit=1),a("dbQuery: %O %O",n,r),e.next=5,t.query(c).promise();case 5:if(u=e.sent,u.ConsumedCapacity,l=u.Items,o(Array.isArray(l)),a("dbQuery items length: %O",l.length),!s){e.next=11;break}return e.abrupt("return",l[0]);case 11:return e.abrupt("return",l);case 12:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),b=function(e,t){return k("dbSubscribers",e,t)},x=function(e){return k("dbSockets",e)},w=function(e){return k("dbChains",e,!0)},C=function(e){return k("dbPools",e)},M=function(){var e=s(i.mark((function e(n){var s,a,c,u,l;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={TableName:n,ConsistentRead:!0,Limit:1},e.next=3,t.scan(s).promise();case 3:if(a=e.sent,a.ConsumedCapacity,c=a.Items,o(Array.isArray(c)),!c.length){e.next=10;break}return o.equal(c.length,1),u=r(c,1),l=u[0],e.abrupt("return",l);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(){var t=s(i.mark((function t(){var n;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=2;break}return t.abrupt("return",e);case 2:return t.next=4,M("dbChains");case 4:return(n=t.sent)&&(e=n),t.abrupt("return",e);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),P=function(){var e=s(i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",M("dbCrypto"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{putPool:p,putBlock:h,putSubscriptions:d,putSocket:f,delSubscriptions:g,delPool:m,getBlock:u,queryAffected:b,querySockets:x,queryLatest:w,queryPool:C,scanBaseChainId:I,scanKeypair:P,putKeypair:v}}}},function(e,t,n){var r=n(33),i=n(2),s=n(3),a=n(4),o=n(11)("interblock:consistency:s3"),c=(n(24),n(23)),u=c.cryptoCacher,l=c.blockModel,p=c.interblockModel,h=n(156).ramS3Factory,d={fromInterblock:function(e){var t=e.getHash(),n=e.provenance.getAddress().getChainId(),r=e.provenance.height,i=e.getRemote(),s=i?i.address.getChainId():"#LINEAGE";return"".concat(n,"/").concat(r,"_").concat(s,"_").concat(t)},fromPoolItem:function(e){var t=e.chainId,n=e.originChainId_height_type,i=e.interblockHash,s=n.split("_"),a=r(s,3),o=a[0],c=a[1],u="light"===a[2]?"#LINEAGE":t;return"".concat(o,"/").concat(c,"_").concat(u,"_").concat(i)},fromBlock:function(e){var t=f(e);return d.fromBlockItem(t)},fromBlockItem:function(e){var t=e.chainId,n=e.height,r=e.blockHash;e.shortestLineage;return"".concat(t,"/").concat(n,"_").concat(r)}},f=function(e){return{chainId:e.provenance.getAddress().getChainId(),height:e.provenance.height,blockHash:e.getHash(),shortestLineage:e.provenance.lineage[0]}};e.exports={s3Factory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h(),t=new Map,n=function(){var n=s(i.mark((function n(r,s){var c,u,l;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=e._isRam?s:s.serialize(),u={Bucket:"wbinterbucket",Key:r,Body:c,ContentType:"application/json"},n.next=4,e.putObject(u).promise();case 4:l=n.sent,t.set(r,s),o("putInterblock: %O",r),a(l);case 8:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),r=function(){var n=s(i.mark((function n(r){var s,a,c,l,h;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s={Bucket:"wbinterbucket",Key:r},o("getInterblock"),!t.has(r)){n.next=5;break}return o("interblock cache hit for %o",r),n.abrupt("return",t.get(r));case 5:return n.prev=5,n.next=8,e.getObject(s).promise();case 8:if(a=n.sent,!p.isModel(a.Body)){n.next=13;break}return n.abrupt("return",a.Body);case 13:return c=a.Body.toString(),l=JSON.parse(c),n.next=17,u.cacheVerifyHash(l);case 17:return h=p.clone(c),o("s3GetInterblock complete"),n.abrupt("return",h);case 20:n.next=25;break;case 22:n.prev=22,n.t0=n.catch(5),o("error fetching: %O %O",r,n.t0.message);case 25:case"end":return n.stop()}}),n,null,[[5,22]])})));return function(e){return n.apply(this,arguments)}}(),c=function(){var n=s(i.mark((function n(r){var c;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a(Array.isArray(r)),o("deleteInterblocks: %O",r.length),c=r.map(function(){var n=s(i.mark((function n(r){var s;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s={Bucket:"wbinterbucket",Key:r},n.next=3,e.deleteObject(s).promise();case 3:t.delete(r);case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()),n.next=5,Promise.all(c);case 5:o("deleteInterblocks complete");case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),d=function(){var n=s(i.mark((function n(r,s){var c,u,p;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a(l.isModel(s)),c=e._isRam?s:s.serialize(),u={Bucket:"wbblockbucket",Key:r,Body:c,ContentType:"application/json"},n.next=5,e.putObject(u).promise();case 5:p=n.sent,t.set(r,s),o("putBlock: %O",r),a(p);case 9:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),f=function(){var n=s(i.mark((function n(r){var s,a,c,p,h;return i.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s={Bucket:"wbblockbucket",Key:r},o("getBlock: %O",r),!t.has(r)){n.next=5;break}return o("block cache hit for: %o",r),n.abrupt("return",t.get(r));case 5:return n.next=7,e.getObject(s).promise();case 7:if(a=n.sent,!l.isModel(a.Body)){n.next=10;break}return n.abrupt("return",a.Body);case 10:return c=a.Body.toString(),p=JSON.parse(c),n.next=14,u.cacheVerifyHash(p);case 14:return h=l.clone(p),o("getBlock complete: %O",r),n.abrupt("return",h);case 17:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return{putInterblock:n,getInterblock:r,deleteInterblocks:c,putBlock:d,getBlock:f}},s3Keys:d}},,,,function(e,t,n){var r=n(19),i=n(4),s=n(239),a=n(241),o=n(79),c=n(479),u=n(480),l=n(23),p=l.interblockModel,h=(l.blockModel,l.addressModel,l.provenanceModel,a.gray("undefined")),d=new WeakMap,f=function(e){if(d.has(e))return d.get(e);var t=o(c(2*e.serialize().length),12);return d.set(e,t),t},v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bgGreen",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"white",r=" ".concat(s(o(e,9),9)," ");return a[n][t].bold(r)},y=function(e){return u(e,{truncate:!0,showHeaders:!1,minWidth:3,config:{msg:{minWidth:15,maxWidth:15},height:{minWidth:8,maxWidth:8},path:{minWidth:18,maxWidth:18}}})},g=function(e,t){var n=m(e),i=m(t),s=[].concat(r(n),r(i)),a=new Set(s),o=r(a);return o.sort((function(e,t){return e-t})),o},m=function(e){var t=[];return Object.keys(e).forEach((function(e){var n=parseInt(e);t.push(n)})),t.sort((function(e,t){return e-t})),t};e.exports={blockPrint:function(e,t,n,r){var i=v(e.provenance.getAddress().getChainId()),s=a.green(e.provenance.height),l=e.provenance.reflectIntegrity().hash,p=a.dim(v(l,"bgWhite","green")),d=f(e),y={msg:r?a.gray("NOCHANGE"):a.green("BLOCK"),height:s,path:t,chainId:i,hash:p,size:d};n&&(y.msg=a.red("NEW_CHAIN"));var m=[y],k=e.network.getAliases();!r&&k.forEach((function(t){var n=e.network[t],r=n.address,i="-",s=h,u=h,l=o(c(2*n.serialize().length),12);r.isResolved()&&(s=v(r.getChainId(),"bgMagenta","gray")),(r.isRoot()||r.isLoopback())&&(s=v(r.getChainId(),"bgBlack","gray"),u="");var p=n.getRemote();if(n.heavy){var d=n.heavy.provenance.reflectIntegrity().hash;u=a.dim(v(d,"bgWhite","magenta"));var y=n.lineageHeight,k=n.heavyHeight;i=a.magenta(k+"."+y)}var b={msg:a.magenta("  \u2514\u2500\u2500 channel"),height:i,path:a.gray(t),chainId:s,hash:u,size:l};m.push(b),g(n.requests,p.replies).forEach((function(e){var t=n.requests[e],r=p.replies[e],i=a.cyan("      \u2514\u2500\u2500 tx:"),s=t?t.type:h,o=a.gray(r?r.type:h),c={msg:i,height:a.cyan(e),path:"",chainId:s,hash:o,size:t?f(t):h};m.push(c)})),g(p.requests,n.replies).forEach((function(e){var t=p.requests[e],r=n.replies[e],i={msg:a.yellow("      \u2514\u2500\u2500 rx:"),height:a.yellow(e),path:"",chainId:a.gray(t?t.type:h),hash:r?r.type:h,size:r?f(r):h};m.push(i)}))}));return function(e){return u(e,{truncate:!0,showHeaders:!1,minWidth:3,config:{msg:{minWidth:15,maxWidth:15},height:{minWidth:8,maxWidth:8},path:{minWidth:18,maxWidth:18}}})}(m)},interPrint:function(e,t,n,r,s){i(p.isModel(e)),t=t||"INTERBLOCK",n=n||"(unknown)",r=r||"bgYellow",s=s||"yellow";var o=e.provenance,c=o.height,u=o.getAddress().getChainId(),l=v(u,r),d=o.reflectIntegrity().hash,g=a.dim(v(d,"bgWhite",s)),m=f(e),k=[{msg:t,height:c,path:n,chainId:l,hash:g,size:m}],b=e.getRemote();return b&&(t=a.magenta("  \u2514\u2500\u2500 channel"),c="-",n=a.gray(e.getOriginAlias()),m=f(b),k.push({msg:t,height:c,path:n,size:m}),t=a.cyan("      \u2514\u2500\u2500 tx:"),Object.keys(b.requests).forEach((function(e){c=e,l=b.requests[e].type,g=h,m=f(b.requests[e]),k.push({msg:t,height:c,chainId:l,hash:g,size:m})})),t=a.yellow("      \u2514\u2500\u2500 rx:"),Object.keys(b.replies).forEach((function(e){c=e,l=h,g=b.replies[e].type,m=f(b.replies[e]),k.push({msg:t,height:c,chainId:l,hash:g,size:m})}))),y(k)}}},,,,,,function(e,t,n){"use strict";var r=n(2),i=n(3),s=n(9),a=n(12),o=n(26),c=n(29),u=n(17),l=n(18),p=n(157),h=function(){throw new Error("expected prompt to have a custom authenticate method")};e.exports=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,n=function(n){l(h,n);var p=u(h);function h(e){return s(this,h),p.call(this,e)}return a(h,[{key:"submit",value:function(){var e=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.call(this,this.values,this.state);case 2:this.value=e.sent,c(o(h.prototype),"base",this).submit.call(this);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"create",value:function(t){return e(t)}}]),h}(p);return n}()},function(e,t,n){"use strict";var r=n(32);e.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.cursorHide();var n=t.input,i=void 0===n?"":n,s=t.initial,a=void 0===s?"":s,o=t.pos,c=t.showCursor,u=void 0===c||c,l=t.color,p=l||e.styles.placeholder,h=r.inverse(e.styles.primary),d=function(t){return h(e.styles.black(t))},f=i,v=" ",y=d(v);if(e.blink&&!0===e.blink.off&&(d=function(e){return e},y=""),u&&0===o&&""===a&&""===i)return d(v);if(u&&0===o&&(i===a||""===i))return d(a[0])+p(a.slice(1));a=r.isPrimitive(a)?"".concat(a):"",i=r.isPrimitive(i)?"".concat(i):"";var g=a&&a.startsWith(i)&&a!==i,m=g?d(a[i.length]):y;if(o!==i.length&&!0===u&&(f=i.slice(0,o)+d(i[o])+i.slice(o+1),m=""),!1===u&&(m=""),g){var k=e.styles.unstyle(f+m);return f+m+p(a.slice(k.length))}return f+m}},function(e,t,n){"use strict";var r=n(9),i=n(12),s=n(26),a=n(29),o=n(17),c=n(18),u=n(67),l=n(538),p=function(e){c(n,e);var t=o(n);function n(e){var i;r(this,n);var s=(i=t.call(this,e)).options.history;if(s&&s.store){var a=s.values||i.initial;i.autosave=!!s.autosave,i.store=s.store,i.data=i.store.get("values")||{past:[],present:a},i.initial=i.data.present||i.data.past[i.data.past.length-1]}return i}return i(n,[{key:"completion",value:function(e){return this.store?(this.data=l(e,this.data,this.input),this.data.present?(this.input=this.data.present,this.cursor=this.input.length,this.render()):this.alert()):this.alert()}},{key:"altUp",value:function(){return this.completion("prev")}},{key:"altDown",value:function(){return this.completion("next")}},{key:"prev",value:function(){return this.save(),a(s(n.prototype),"prev",this).call(this)}},{key:"save",value:function(){this.store&&(this.data=l("save",this.data,this.input),this.store.set("values",this.data))}},{key:"submit",value:function(){return this.store&&!0===this.autosave&&this.save(),a(s(n.prototype),"submit",this).call(this)}}]),n}(u);e.exports=p},function(e,t,n){"use strict";var r=n(8),i=n(9),s=n(12),a=n(26),o=n(29),c=n(17),u=n(18),l=function(e){u(n,e);var t=c(n);function n(){var e,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i(this,n),(e=t.call(this,r({style:"number"},s))).min=e.isValue(s.min)?e.toNumber(s.min):-1/0,e.max=e.isValue(s.max)?e.toNumber(s.max):1/0,e.delay=null!=s.delay?s.delay:1e3,e.float=!1!==s.float,e.round=!0===s.round||!1===s.float,e.major=s.major||10,e.minor=s.minor||1,e.initial=null!=s.initial?s.initial:"",e.input=String(e.initial),e.cursor=e.input.length,e.cursorShow(),e}return s(n,[{key:"append",value:function(e){return!/[-+.]/.test(e)||"."===e&&this.input.includes(".")?this.alert("invalid number"):o(a(n.prototype),"append",this).call(this,e)}},{key:"number",value:function(e){return o(a(n.prototype),"append",this).call(this,e)}},{key:"next",value:function(){return this.input&&this.input!==this.initial?this.alert():this.isValue(this.initial)?(this.input=this.initial,this.cursor=String(this.initial).length,this.render()):this.alert()}},{key:"up",value:function(e){var t=e||this.minor,n=this.toNumber(this.input);return n>this.max+t?this.alert():(this.input="".concat(n+t),this.render())}},{key:"down",value:function(e){var t=e||this.minor,n=this.toNumber(this.input);return n<this.min-t?this.alert():(this.input="".concat(n-t),this.render())}},{key:"shiftDown",value:function(){return this.down(this.major)}},{key:"shiftUp",value:function(){return this.up(this.major)}},{key:"format",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.input;return"function"===typeof this.options.format?this.options.format.call(this,e):this.styles.info(e)}},{key:"toNumber",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.float?+e:Math.round(+e)}},{key:"isValue",value:function(e){return/^[-+]?[0-9]+((\.)|(\.[0-9]+))?$/.test(e)}},{key:"submit",value:function(){var e=this,t=[this.input,this.initial].find((function(t){return e.isValue(t)}));return this.value=this.toNumber(t||0),o(a(n.prototype),"submit",this).call(this)}}]),n}(n(67));e.exports=l},function(e,t,n){var r=n(2),i=n(3),s=n(4),a=(n(34).posix||n(34),n(21)("dos:commands:cd")),o=function(){var e=i(r.mark((function e(t){var n,i,o,c,u,l=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.spinner,i=t.blockchain,o=l.length>1&&void 0!==l[1]?l[1]:"~",s.equal(typeof o,"string"),a("cd: ".concat(o)),n.text="Resolving ".concat(o),e.next=7,i.cd(o);case 7:return c=i.getContext(),a("context: %O",c),u=c.wd,e.abrupt("return",{ctx:{wd:u}});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();e.exports=o,e.exports.help="\nNavigate through the filesystem graph using Posix compliant pathing.\nCan jump straight to an object by specifying a chainId.\n"},,,,function(e,t,n){(function(t){var r=n(2),i=n(3),s=n(39),a=n(21)("dos:print");e.exports=function(){var e=i(r.mark((function e(n){var i,o,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"string"!==typeof n){e.next=5;break}i={out:n},e.next=8;break;case 5:return e.next=7,n();case 7:i=e.sent;case 8:i&&i.out&&(o="[object String]"===Object.prototype.toString.call(i.out)?i.out:JSON.stringify(i.out,null,2),c=o.replace(/(?:\r\n|\r|\n)/g,"\r\n"),t.stdout.write(c),t.stdout.write("\r\n")),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),a(e.t0),t.stderr.writeln("".concat(s.red("\u2716")," ").concat(e.t0));case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}()}).call(this,n(10))},,,function(e,t,n){"use strict";(function(e){var r=n(118),i=n(4),s=n.n(i),a=n(5),o=n.n(a),c=n(68),u=n.n(c),l=n(260),p=n(263),h=n(264),d=(n(606),n(607).stdin),f=u()("terminal"),v=function(t){f("toStdStream");var n=function(){var t=e.stdin;d();var n=e.stdin;return Object.defineProperty(e,"stdin",{value:t,writable:!0}),n}();t.stdin=n,t.isTTY=!0;t.clearLine=function(){return t.write("\x1b[2K")},t.cursorTo=function(e,n){f("cursorTo: ",e,n),s.a.equal(e,0);t.write("\x1b[1000D")}},y="F1 F2 F3 F4 F5 F6 F7 F8 F9 F10 F11 F12".split(" ");t.a=function(t){var n=Object(a.useRef)();Object(a.useEffect)((function(){f("opening terminal");var t=new p.Terminal({cursorBlink:!0,convertEol:!0}),r=new h.FitAddon;t.loadAddon(r),t.open(document.getElementById("xterm-container")),r.fit(),t.focus(),v(t),t.attachCustomKeyEventHandler((function(e){var t=e.key;e.type;if(y.includes(t))return f("ignoring: ".concat(t)),!1})),t.onKey((function(e){var n=e.key;e.domEvent;t.stdin.send(n)})),n.current=t,window.addEventListener("resize",(function(){return r.fit()})),e.stdout=t,e.stdin=t.stdin,e.stderr=t}),[]);var i=Object(l.a)();Object(r.a)(i,2)[1];return o.a.createElement("div",Object.assign({id:"xterm-container"},t))}}).call(this,n(10))},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(2),i=n.n(r),s=n(261),a=n(118),o=n(4),c=n.n(o),u=n(5),l=n(117),p=n(68)("useBlockchain"),h=n(493),d=new Map,f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];c.a.equal(typeof e,"string"),"string"===typeof t&&(t=[t]),c()(Array.isArray(t));var n=Object(u.useState)(),r=Object(a.a)(n,2),o=r[0],f=r[1],v=Object(u.useRef)();Object(u.useEffect)((function(){return function(){var t=Object(s.a)(i.a.mark((function t(){var n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!v.current){t.next=2;break}return t.abrupt("return");case 2:return d.has(e)||(p("initializing blockchain: ".concat(e)),n=Object(l.effectorFactory)(),d.set(e,n),h([],{blockchain:n})),t.next=5,d.get(e);case 5:r=t.sent,v.current=r,f(r.getState()),r.subscribe((function(){f(r.getState())}));case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()(),function(){p("TODO shutting down shell")}}),[e]);var y=v.current;return[o,y]}},,,,,,function(e,t,n){e.exports=n(613)},,,,,function(e,t,n){},function(e,t,n){},,,,,,,,function(e,t,n){var r=n(168).effectorFactory,i=n(490).awsFactory,s=n(491).browserFactory;e.exports={effectorFactory:r,awsFactory:i,browserFactory:s}},function(e,t,n){(function(t){var r=n(8),i=n(2),s=n(3),a=n(4),o=n(11)("interblock:metrology"),c=n(24),u=n(169).standardEngineFactory,l=n(463),p=n(154).isolateFactory,h=n(50),d=h.consistencyFactory,f=h.ramDynamoDbFactory,v=h.ramS3Factory,y=h.s3Keys,g=n(464).createBase,m=n(465).createTap,k=n(84).actions,b=n(23),x=b.blockModel,w=b.interblockModel,C=b.addressModel,M=function(e,t){var n=e.sqsPool,r=e.sqsTransmit,a=e.ioConsistency;debugPrefix=t?"interblock:metrology:".concat(t):"interblock:metrology";var o=m(debugPrefix);return n.subscribe(function(){var e=s(i.mark((function e(t,n){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.interblockPool(t);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),r.subscribe(function(){var e=s(i.mark((function e(t,n){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.interblockTransmit(t);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),a.subscribe(function(){var e=s(i.mark((function e(t,n){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("UNLOCK"!==t.type){e.next=4;break}return e.next=3,n;case 3:o.block(t.payload.block);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),o};e.exports={metrologyFactory:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o("metrologyFactory");var h=u(),m=(h.sqsTx,h.sqsRx,h.sqsTransmit,h.sqsPool),b=h.sqsIncrease,I=(h.ioCrypto,h.ioIsolate),P=h.ioConsistency,A=(h.ioPool,h.ioIncrease,function(){throw new Error("injector was overridden")});if(!n.hyper){var O=l();A=O.injector,n={hyper:O}}I.setProcessor(p(n));var S=f(),E=v();P.setProcessor(d(S,E,e));var R=M(h,e),T=g(P,m),q=function(){var e=s(i.mark((function e(n){var u,l,p,d,f,v,g,m,M,I,O,T,q,L,N,D,z,B;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!==typeof n.then){e.next=6;break}return e.next=3,n;case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0=n;case 7:return u=e.t0,a(C.isModel(u)),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.map((function(e){var t=e.type,n=e.payload,r=e.to,i=void 0===r?".":r;return o("dispatch to: %o action: %O",i,t),A({type:t,payload:n,to:i})}));return b.push(u),Promise.all(r)},l=function(e){var t=e.type,n=e.payload,r=e.to,i=void 0===r?".":r;o("dispatch to: %o type: %O",i,t);var s=A({type:t,payload:n,to:i});return b.push(u),s},p=function(e){var t,n=S._getTables().dbChains[u.getChainId()]||{};if(void 0===e)t=c.last(Object.values(n));else{if(!n[e])throw new Error("out of bounds: ".concat(e," ").concat(n.length));t=n[e]}if(t){var r=y.fromBlockItem(t),i=E._getBuckets().wbblockbucket[r];return a(x.isModel(i)),i}},d=new Set,f=new Set,P.subscribe(function(){var e=s(i.mark((function e(t,n){var r;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("UNLOCK"!==t.type){e.next=5;break}return e.next=3,n;case 3:r=t.payload.block,f.has(r)||(f.add(r),d.forEach((function(e){return e()})));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".";return a.equal(typeof e,"function"),a.equal(typeof t,"string"),d.add(e),function(){return d.delete(e)}},g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l(k.spawn(e,t))},m=function(){var e=p(),t=e.network.getAliases(),n={};return t.map((function(t){var r=e.network[t];if("./"===r.systemRole){var i=r.address;n[t]=j(i)}})),n},M=function(){},I=function(){},O=function(){var e=p(),t=e.network.getAliases();return c.pick(e.network,t)},T=function(){return r({},h)},q=function(){return P.getProcessor().persistence},L=function(){return p().provenance.getAddress().getChainId()},N=function(){return p().provenance.height},D=function(){var e=S._getTables().dbPools[u.getChainId()],t=Object.values(e).map(y.fromPoolItem),n=E._getBuckets().wbinterbucket;return t.map((function(e){var t=n[e];return a(t),w.clone(t)}))},z=function(){var e=s(i.mark((function e(n){var r,s;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=Object.values(h);case 1:if(!r.some((function(e){return e.length()||e.awaitingLength()}))){e.next=12;break}return s=r.map((function(e){return e.settle()})),e.next=5,Promise.all(s);case 5:return e.next=7,new Promise(t);case 7:if(!n){e.next=10;break}return e.next=10,n.settle();case 10:e.next=1;break;case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(){return R.on()},e.abrupt("return",{dispatch:l,getState:p,subscribe:v,getChildren:m,getParent:M,getSelf:I,getChannels:O,getEngine:T,getPersistence:q,getChainId:L,getHeight:N,getPool:D,spawn:g,settle:z,enableLogging:B});case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(e){var t=q(e),n=["dispatch","getState","getChildren","getParent","getSelf","getChannels","getEngine","getPersistence","getChainId","getHeight","getPool","settle","enableLogging","spawn"],r=["spawn"];return function e(o){return a("function"===typeof o.then),n.map((function(n){o[n]=function(){var a=function(){var a=s(i.mark((function a(){var c,u,l,p=arguments;return i.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t;case 2:return c=a.sent,a.next=5,o;case 5:if(!(u=c[n].apply(c,p))||"function"!==typeof u.then){a.next=13;break}if("dispatch"===n){a.next=10;break}return l=function(){var e=s(i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u;case 2:return e.abrupt("return",c);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),a.abrupt("return",e(l()));case 10:return a.abrupt("return",e(u));case 13:if(!r.includes(n)){a.next=17;break}return a.abrupt("return",c);case 17:return a.abrupt("return",u);case 18:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}(),c=a.apply(void 0,arguments);return e(c)}})),o}(t)};return j(T)}}}).call(this,n(57).setImmediate)},,,,,,,function(e,t,n){(function(t){var r=n(8),i=n(28),s=n(19),a=n(2),o=n(3),c=n(289),u=n(4),l=function(e,r){u(e&&"string"===typeof e);var l,h=n(11)("interblock:queue:"+e),d=!0,f=[],v=new Set,y=Number.MAX_SAFE_INTEGER,g=0,m=function(){var e=o(a.mark((function e(){var t;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Promise.resolve();case 4:for(;d&&v.size<y&&f.length;)h("awaiting size: ".concat(v.size)),t=f.shift(),v.add(t),k(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var n=o(a.mark((function n(r){var i,s,o,c;return a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return u(r&&"object"===typeof r),i=r.action,s=r.resolve,o=r.reject,r.promise,u(s&&o),n.prev=3,n.next=6,l(i);case 6:c=n.sent,t(s,c),n.next=14;break;case 10:n.prev=10,n.t0=n.catch(3),h("".concat(e," rejected: %O %O"),r,n.t0),t(o,n.t0);case 14:m(),u(v.has(r)),v.delete(r);case 17:case"end":return n.stop()}}),n,null,[[3,10]])})));return function(e){return n.apply(this,arguments)}}(),b=new Set,x={name:e,settle:function(){var e=o(a.mark((function e(){var n;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v.size&&!f.length){e.next=11;break}if(!v.size){e.next=7;break}return n=s(v).map((function(e){return e.promise})),e.next=5,Promise.race(n);case 5:e.next=9;break;case 7:return e.next=9,new Promise(t);case 9:e.next=0;break;case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),length:function(){return f.length},awaitingLength:function(){return v.size},awaitNextPush:function(){var e=o(a.mark((function e(){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var t=x.subscribe((function(n,r){t(),e(n)}))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),subscribe:function(e){return u("function"===typeof e),b.add(e),function(){return b.delete(e)}},getProcessor:function(){return l},rejectAll:function(){x.setProcessor((function(e){throw new Error("Tried to process: ".concat(JSON.parse(e,null,2)))}))},setConcurrency:function(e){y=e,m()},push:function(){var e=o(a.mark((function e(t){var n,s,o,c;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h("push ".concat(t.type||r.schema.title)),p(r,t),s=new Promise((function(e,r){var i=g++;n={id:i,action:t,resolve:e,reject:r}})),n.promise=s,f.push(n),m(),o=i(b.values());try{for(o.s();!(c=o.n()).done;)(0,c.value)(t,s)}catch(a){o.e(a)}finally{o.f()}return e.abrupt("return",s);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setProcessor:function(e){u(!g||!l,"cannot switch after commencing"),u("function"===typeof e),l=e},halt:function(){var e=o(a.mark((function e(t){var n;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c("_isActive"),d=!1,e.next=3,new Promise((function(e){return setTimeout(e,t)}));case 3:n=new Error("Queue is halting operation"),v.values().forEach((function(e){return(0,e.reject)(n)})),v.clear();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};return x},p=function(e,t){e&&(u("function"===typeof e.isModel),u(e.isModel(t),"model is not addable"))};e.exports={ioQueueFactory:l,sqsQueueFactory:function(e,t){u(e&&"string"===typeof e);var i=n(11)("interblock:queue:sqs:"+e),s=l(e,t),c=s.push,h=function(e){s.push(e)};return r({},s,{push:function(){var n=o(a.mark((function n(r){return a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i("push sqs ".concat(e)),p(t,r),n.next=4,h(r);case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),pushDirect:c,setSqsProcessor:function(e){!s.getProcessor()||s.setProcessor(s.getProcessor()),h=e}})}}}).call(this,n(57).setImmediate)},,function(e,t,n){var r={"./aclModel":123,"./aclModel.js":123,"./actionModel":64,"./actionModel.js":64,"./addressModel":49,"./addressModel.js":49,"./binaryModel":146,"./binaryModel.js":146,"./blockModel":80,"./blockModel.js":80,"./channelModel":105,"./channelModel.js":105,"./configModel":151,"./configModel.js":151,"./continuationModel":85,"./continuationModel.js":85,"./covenantIdModel":148,"./covenantIdModel.js":148,"./dmzModel":100,"./dmzModel.js":100,"./integrityModel":38,"./integrityModel.js":38,"./interblockModel":108,"./interblockModel.js":108,"./keypairModel":65,"./keypairModel.js":65,"./lockModel":235,"./lockModel.js":235,"./networkModel":149,"./networkModel.js":149,"./proofModel":153,"./proofModel.js":153,"./provenanceModel":82,"./provenanceModel.js":82,"./publicKeyModel":83,"./publicKeyModel.js":83,"./remoteModel":107,"./remoteModel.js":107,"./signatureModel":147,"./signatureModel.js":147,"./stateModel":150,"./stateModel.js":150,"./timestampModel":104,"./timestampModel.js":104,"./validatorsModel":152,"./validatorsModel.js":152};function i(e){var t=s(e);return n(t)}function s(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}i.keys=function(){return Object.keys(r)},i.resolve=s,e.exports=i,i.id=290},,,,function(e,t,n){var r=n(8),i=n(4),s=(n(11)("interblock:models:modelInflator"),new(n(295))({allErrors:!0,verbose:!0})),a=n(127).registry,o=function(e,t){i("object"===e.type),i(e.patternProperties),i(!e.additionalProperties),i.equal(Object.keys(e.patternProperties).length,1);var n=Object.keys(e.patternProperties)[0],r="[0-9]*"===n,s=e.patternProperties[n],o=a.get(s.title);i(o,"patternProperties must use models for values");var c={};return Object.keys(t).map((function(e){if(r){var n=parseInt(e);i(Number.isInteger(n),"".concat(e," is not number: ").concat(n))}c[e]=o.clone(t[e])})),c},c=function(e,t){i(Array.isArray(t)),i("array"===e.type),i(e.uniqueItems,"uniqueItems not set: ".concat(e.title));var n=a.get(e.items.title);return i(n,"Arrays must be models"),t.map(n.clone)},u=function(e,t){i.equal(e.additionalProperties,!1);var n=Object.keys(t),r=Object.keys(e.properties),s=e.required.every((function(e){return n.includes(e)}));return i(s),i(n.every((function(e){return r.includes(e)}))),!0},l=new WeakMap,p=function(e,t){var n=l.get(e);if(!n)try{n=s.compile(e),l.set(e,n)}catch(o){var r="Compilation failed: ".concat(e&&e.title," ").concat(o.message);throw new Error(r)}var i=n(t),a=s.errorsText(n.errors);if(!i)throw new Error("".concat(e.title," failed validation: ").concat(a))};e.exports={modelInflator:function(e,t){if("State"===e.title){var n=t.actions;return n&&(i(Array.isArray(n)),i(n.every((function(e){return e.getAction||e.getContinuation})))),r({},t)}if(e.patternProperties)return o(e,t);i(u(e,t),"Keys do not match");var s={},l=e.properties;return Object.keys(t).map((function(e){var n=l[e],r=n.title,i=n.type,u=n.patternProperties,h=t[e];a.isRegistered(r)?s[e]=a.get(r).clone(h):"array"!==i?u?s[e]=o(l[e],h):(p(l[e],h),s[e]=h):s[e]=c(l[e],h)})),s}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){(function(t){var r=n(2),i=n(3),s=n(4),a=n(11)("interblock:crypto:sodium"),o=n(330),c=o.SodiumPlus,u=o.Ed25519PublicKey,l=o.Ed25519SecretKey,p=n(422),h=p.objectHash,d=p.generateNonce,f={publicKey:"I7xUkSwebpLEqGglyGfif/3FVb/71CRPF6Jqv//ull0=",secretKey:"MDEyMzQ1Njc4OWFiY2RlZjAxMjM0NTY3ODlhYmNkZWYjvFSRLB5uksSoaCXIZ+J//cVVv/vUJE8Xomq//+6WXQ=="};Object.freeze(f);var v,y=new Set(["".concat(f.publicKey,"_").concat(f.secretKey)]),g=function(){return v||(v=c.auto()),v},m=h("template"),k=function(){var e=i(r.mark((function e(t){var n,i,s,a,o,c,u;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:if(n=e.sent,e.t0=t,e.t0){e.next=8;break}return e.next=7,n.randombytes_buf(32);case 7:e.t0=e.sent;case 8:return t=e.t0,e.next=11,n.crypto_sign_seed_keypair(t);case 11:return i=e.sent,e.next=14,n.crypto_sign_secretkey(i);case 14:return s=e.sent,e.next=17,n.crypto_sign_publickey(i);case 17:return a=e.sent,o={publicKey:a.toString("base64"),secretKey:s.toString("base64")},c=o.secretKey,u="".concat(o.publicKey,"_").concat(c),y.add(u),e.abrupt("return",o);case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=i(r.mark((function e(t){var n,i,a,o,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.publicKey,i=t.secretKey,s.equal(typeof n,"string"),s.equal(typeof i,"string"),a="".concat(n,"_").concat(i),e.prev=4,e.next=7,x(m,i);case 7:return o=e.sent,c=o.signature,e.next=11,w(m,c,n);case 11:e.sent&&y.add(a),e.next=17;break;case 15:e.prev=15,e.t0=e.catch(4);case 17:return e.abrupt("return",y.has(a));case 18:case"end":return e.stop()}}),e,null,[[4,15]])})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=i(r.mark((function e(t,n){var i,a,o,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.equal(t.length,m.length,"use objectHash()"),i=l.from(n,"base64"),e.next=4,g();case 4:return a=e.sent,e.next=7,a.crypto_sign_detached(t,i);case 7:return o=e.sent,c=o.toString("base64"),e.abrupt("return",{messageHash:t,signature:c});case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),w=function(){var e=i(r.mark((function e(n,i,s){var o,c,l,p,h;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.from(i,"base64"),c=u.from(s,"base64"),e.next=4,g();case 4:return l=e.sent,e.next=7,l.crypto_sign_verify_detached(n,c,o);case 7:return p=e.sent,h="".concat(n,"_").concat(i,"_").concat(s),p?y.add(h):a("verifyHash failed"),e.abrupt("return",p);case 11:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),C=function(){var e=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:return t=e.sent,e.abrupt("return",t.getBackendName());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e.exports={objectHash:h,signHash:x,verifyHash:w,verifyHashSync:function(e,t,n){var r="".concat(e,"_").concat(t,"_").concat(n);return y.has(r)},generateKeyPair:k,verifyKeyPair:b,verifyKeyPairSync:function(e){var t=e.publicKey,n=e.secretKey;return y.has("".concat(t,"_").concat(n))},generateNonce:d,testMode:function(){a("no testmode in sodium")},_ciKeypair:f,_verifiedSet:y,_getBackend:C}}).call(this,n(7).Buffer)},,,,,,,,,,function(e,t){},,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){(function(t){var r=n(423)({coerce:!1}),i=n(426),s=n(79),a=n(428),o=0;e.exports={objectHash:function(e){if("undefined"===typeof t){var n=r.sort(e);return a(n,{algorithm:"sha256",encoding:"hex"})}return r.hash(e)},generateNonce:function(e){if(e){var t=s(9,o,"0");return o++,"0x".concat(t,"c6ee4f60107cc496d1dcacd642be4011c3b4fe09668f08f01f41cc9")}return"0x"+i(32,{type:"Array"}).map((function(e){return("0"+(255&e).toString(16)).slice(-2)})).join("")}}}).call(this,n(10))},,,,,function(e,t){},,,function(e,t,n){var r=n(8),i=n(2),s=n(81),a=n(3),o=n(11)("interblock:covenants:shell"),c=n(4),u=n(84),l=n(43),p=l.Machine,h=(l.assign,u.actions),d=h.spawn,f=h.connect,v=n(436),y=v.respond,g=(v.send,v.sendParent,v.invoke),m=v.translator,k=p({id:"shell",initial:"idle",context:{root:"/",wd:"~"},strict:!0,states:{idle:{on:{"@@INIT":"idle",PING:"ping",LOGIN:"login",ADD:"addActor",LS:"listActors",CD:"changeDirectory",RM:"removeActor",MV:"moveActor",LN:"linkActor",UP:"uplinkActor",CAT:"getState",DISPATCH:"dispatch",INSTALL:"install",LOGOUT:"logout",BAL:"balance"}},ping:{invoke:{src:"ping",onDone:"idle"},exit:"respondPing"},login:{invoke:{src:"login",onDone:"idle"}},addActor:{invoke:{src:"addActor",onError:"idle",onDone:"idle"},exit:"respondAddActor"},listActors:{invoke:{src:"listActors",onDone:"idle",onError:"idle"}},changeDirectory:{invoke:{src:"changeDirectory",onDone:"idle",onError:"idle"}},removeActor:{invoke:{src:"removeActor",onDone:"idle",onError:"idle"}},moveActor:{},linkActor:{},uplinkActor:{},getState:{},logout:{},balance:{},dispatch:{},install:{},done:{id:"done",data:"info about the files ?",type:"final"},error:{id:"error",type:"final"}}},{actions:{respondPing:function(e,t){return o("respondPing event: %O",t),y(t.data)},respondAddActor:function(e,t){return y(t.data.addActor)}},guards:{},services:{ping:function(){var e=a(i.mark((function e(t,n){var r,a,u,l,p,h;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o("ping: %O",n),r=n.type,a=n.payload,u=a.to,l=void 0===u?".":u,p=s(a,["to"]),c("PING"===r),"."!==l){e.next=7;break}return o("ping to self"),e.abrupt("return",{type:"PONG",payload:p});case 7:return e.next=9,g(r,{},l);case 9:return h=e.sent,o("ping result: %O",h),e.abrupt("return",h);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),login:function(){var e=a(i.mark((function e(t,n){var r,a,c,u,l;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o("login: %O",n.payload.terminal),r=n.payload,a=r.chainId,c=s(r,["chainId"]),u=f("terminal",a),e.next=5,g(u);case 5:return e.next=7,g("@@INTRO",c,"terminal");case 7:return l=e.sent,o("loginResult: %O",l),e.abrupt("return",{loginResult:l});case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),addActor:function(){var e=a(i.mark((function e(t,n){var r,s,a,u,l,p,h,f;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.equal(typeof n.payload,"object"),r=n.payload,s=r.alias,a=r.spawnOptions,u=r.to,o("addActor",s,u),l=d(s,a),p=l.type,h=l.payload,e.next=6,g(p,h,u);case 6:return f=e.sent,e.abrupt("return",{addActor:f});case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),listActors:function(){var e=a(i.mark((function e(t,n){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),changeDirectory:function(){var e=a(i.mark((function e(t,n){var r;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.payload.path,o("changeDirectory",r),c.equal(typeof r,"string");case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),removeActor:function(){var e=a(i.mark((function e(t,n){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o("removeActor",n);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}}),b={ping:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".",t=arguments.length>1?arguments[1]:void 0;return{type:"PING",payload:r({},t,{to:e})}},login:function(e){return{type:"LOGIN",payload:e}},add:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";return{type:"ADD",payload:{alias:e,spawnOptions:t,to:n}}},ls:function(e){return{type:"LS",payload:{path:e}}},rm:function(e){return{type:"RM",payload:{path:e}}},cd:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".";return{type:"CD",payload:{path:e}}},up:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".",t=arguments.length>1?arguments[1]:void 0;return{type:"UP",payload:{path:e,remoteParent:t}}}},x=m(k);e.exports={actions:b,reducer:x}},function(e,t,n){var r=n(2),i=n(8),s=n(3),a=n(4),o=n(11)("interblock:dmzReducer"),c=(n(24),n(79)),u=n(23),l=u.addressModel,p=(u.stateModel,u.keypairModel,u.dmzModel),h=u.blockModel,d=u.interblockModel,f=u.channelModel,v=u.networkModel,y=u.rxRequestModel,g=u.rxReplyModel,m=n(66).channelProducer,k=n(102),b=k.promise,x=k.resolve,w=k.request,C=k.isReplyFor,M=(k.reject,function(){var e=s(r.mark((function e(t,n){var s,c,u,l,d,f,v,y,g,m,k,w,M,I;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o("reducer( ".concat(n.type," )")),a(p.isModel(t)),s=[],c=t.network,e.t0=n.type,e.next="@@SPAWN"===e.t0?7:"@@CONNECT"===e.t0?16:"@@GENESIS"===e.t0?18:"@@OPEN_CHILD"===e.t0?19:"@@INTRO"===e.t0?20:"@@ACCEPT"===e.t0?21:22;break;case 7:return e.next=9,A(t,n);case 9:return u=e.sent,l=u.nextNetwork,d=u.genesisRequest,c=l,s.push(d),s.push(b()),e.abrupt("break",23);case 16:return c=O(t.network,n),e.abrupt("break",23);case 18:case 19:case 20:case 21:case 22:return e.abrupt("break",23);case 23:if(!C(n)){e.next=35;break}f=n.request,e.t1=f.type,e.next="@@GENESIS"===e.t1?28:35;break;case 28:return v=f.payload,y=v.genesis,g=v.alias,m=v.originAction,k=h.clone(y),w={alias:g,chainId:k.getChainId()},M=x(m,w),o("reply received for @@GENESIS"),s.push(M),e.abrupt("break",35);case 35:return I=i({},t,{network:c,actions:s}),e.abrupt("return",I);case 37:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),I={},P={spawn:"@@SPAWN",connect:"@@CONNECT",intro:"@@INTRO",accept:"@@ACCEPT",genesis:"@@GENESIS",open:"@@OPEN_CHILD"};I.spawn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{type:P.spawn,payload:{alias:e,spawnOpts:t}}};var A=function(){var e=s(r.mark((function e(t,n){var s,c,u,l,y,g,k,b,x;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.payload,u=c.alias,l=c.spawnOpts,y=t.network,g=t.validators,k=p.create(i({},l,{validators:g})),e.next=5,h.create(k);case 5:return s=e.sent,b=v.clone(y,(function(e){o("spawn alias: ".concat(u)),u=u||S(y),a(!y[u],"childAlias exists: ".concat(u));var t=s.provenance.getAddress(),n=f.create(t,"./"),r=d.create(s);n=m.ingestInterblock(n,r),e[u]=n})),a(h.isModel(s),"Genesis block creation failed"),x=w("@@GENESIS",{genesis:s,alias:u,originAction:n},u),e.abrupt("return",{nextNetwork:b,genesisRequest:x});case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();I.connect=function(e,t){return{type:P.connect,payload:{alias:e,chainId:t}}};var O=function(e,t){return v.clone(e,(function(n){a(v.isModel(e));var r=l.create(t.payload.chainId);a.equal(r.getChainId(),t.payload.chainId);var i=t.payload.alias;a(i&&"string"===typeof i);var s=e[i]||f.create(r);n[i]=m.setAddress(s,r)}))},S=function(e){var t=0;return e.getAliases().forEach((function(e){if(e.startsWith("file_"))try{var n=parseInt(e.substring("file_".length));t=n>t?n:t}catch(r){o("autoAlias error: ",r)}})),"file_"+c(5,t+1,"0")};e.exports={actions:I,reducer:M,isSystemRequest:function(e){a(y.isModel(e));var t=e&&Object.values(P).includes(e.type);return o("isSystemAction: ".concat(t&&e.type)),t},isSystemReply:function(e){a(g.isModel(e));var t=e&&"@@GENESIS"===e.request.type;return o("isSystemReply: ".concat(t&&e.type)),t}}},function(e,t,n){var r=n(19),i=n(8),s=n(4),a=n(11)("interblock:producers:network"),o=n(24),c=n(23),u=c.channelModel,l=c.continuationModel,p=c.actionModel,h=c.networkModel,d=c.stateModel,f=c.interblockModel,v=c.addressModel,y=c.rxRequestModel,g=c.txRequestModel,m=c.txReplyModel,k=c.configModel,b=n(228),x=k.create(),w=function(e,t,n){return h.clone(e,(function(r){s(y.isModel(t)),s(l.isModel(n));var i=t.getAddress(),a=e.getAlias(i),o=e[a];s(u.isModel(o)),s(o.address.equals(i)),s(o.rxRequest().equals(t));var c=t.getIndex();s(!o.replies[c]);var p=b.txReply(o,n);s(p.replies[c]),r[a]=p}))},C=function(e,t){return Array.isArray(e)||(e=[e]),e.map(t)};e.exports={ingestInterblocks:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:x;return h.clone(e,(function(c){t=C(t,f.clone),s(k.isModel(n)),a("ingestInterblocks count: ".concat(t.length)),t.sort((function(e,t){return e.provenance.height-t.provenance.height}));var l={};t.forEach((function(t){var r=t.provenance.getAddress(),o=e.getAlias(r),h=n.isPublicChannelOpen;if(!o&&h&&t.isConnectionAttempt()){a("connection attempt accepted");var d="@@PUBLIC_".concat(r.getChainId()),f=u.create(r),v=p.create({type:"@@ACCEPT"}),y=u.clone(i({},f,{requests:{0:v}}));c[d]=y}if(o){var g=l[o]||e[o];if(s(u.isModel(g)),g=b.ingestInterblock(g,t),t.isConnectionResponse(),!g.heavy||g.equals(e[o]))return;l[o]=g}})),e.getAliases().forEach((function(t){var n=e[t];if(n&&n.address.isResolved()&&n.heavy){var a=l[t]||n,c=n.lineageTip.slice(0,-1),p=o.without.apply(o,[a.lineageTip].concat(r(c))),h=a.lineage.findIndex((function(e){return e.equals(a.heavy.provenance.reflectIntegrity())})),d=a.lineage.findIndex((function(e){return e.equals(p[0].provenance.reflectIntegrity())})),f=h<d?h:d;s(f>=0,"minIndex out of bounds");var v=a.lineage.slice(f);(a=u.clone(i({},a,{lineage:v,lineageTip:p}))).equals(n)||(l[t]=a)}})),Object.keys(l).forEach((function(e){return c[e]=l[e]}))}))},respondRejection:function(e,t,n){a("respondRejection %O",n);var r=l.create("@@REJECT",n);return w(e,t,r)},respondRequest:function(e,t){a("respondRequest request: %o",t.type);var n=l.create("@@RESOLVE");return w(e,t,n)},respondReply:function(e,t){return h.clone(e,(function(n){s(h.isModel(e));var r=e.getAlias(t);a("respondReply alias: ".concat(r));var i=e[r],o=i.rxReply();s(o);var c=b.shiftTxRequest(i);n[r]=c}))},tx:function(e,t){return h.clone(e,(function(n){s(h.isModel(e)),s(d.isModel(t));var r=t.getRequests(),i=t.getReplies();a("tx requests: ".concat(r.length," replies: ").concat(i.length));var o={};r.forEach((function(t){s(g.isModel(t));var n=t.to,r=o[n]||e[n];if(!r){var i=v.create("SYMLINK");a("channel created with systemRole: ".concat("SYMLINK")),r=u.create(i,"SYMLINK")}o[n]=b.txRequest(r,t.getAction())})),i.forEach((function(t){s(m.isModel(t));var n=t.getAddress(),r=t.getIndex(),i=e.getAlias(n);if(i){var c=o[i]||e[i],u=t.getContinuation();o[i]=b.txReply(c,u,r)}else a("No alias found for: %O",t)})),Object.keys(o).forEach((function(e){return n[e]=o[e]}))}))}}},function(e,t,n){var r=n(8),i=n(2),s=n(3),a=n(4),o=n(23),c=o.dmzModel,u=o.keypairModel,l=o.provenanceModel,p=o.blockModel,h=o.integrityModel,d=function(){var e=s(i.mark((function e(t){var n;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.create("CI"),a(h.isModel(t)),e.abrupt("return",n.sign(t));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=s(i.mark((function e(t,n){var s,o,u,f,v,y,g,m,k,b=arguments;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=b.length>2&&void 0!==b[2]?b[2]:d,a(c.isModel(t)),a(p.isModel(n)),a(!t.equals(n.getDmz())),a("function"===typeof s),o=t.network.isNewChannels(n.network),u={},f=0===n.provenance.height,o&&!f&&(v=h.create(),y=n.provenance.getAddress().getChainId(),g=h.clone(r({},v,{hash:y})),u[0]=g),e.next=11,l.create(t,n.provenance,u,s);case 11:return m=e.sent,k=p.clone(r({},t,{provenance:m})),a(n.isNext(k)),e.abrupt("return",k);case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();e.exports={generateNext:f}},function(e,t,n){var r=n(4),i=n(23),s=i.lockModel,a=i.blockModel;e.exports={reconcile:function(e,t){return s.clone(e,(function(n){r(a.isModel(t)),r(s.isModel(e)),n.block=t;var i=e.interblocks.filter((function(e){var n=t.network.includesInterblock(e),r=t.network.getAlias(e.provenance.getAddress());return!n&&r}));n.interblocks=i}))}}},function(e,t,n){var r=n(227),i=n(59),s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"@@RESOLVE",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;switch(e){case"@@PROMISE":if(Object.keys(t).length)throw new Error("Promise payload must be empty");if(n)throw new Error("can only promise to the current request - leave blank");break;case"@@RESOLVE":case"@@REJECT":break;default:throw new Error("Disallowed type: ".concat(e))}if("object"!==typeof t)throw new Error("payload must be object: ".concat(t));c(t);var r={type:e,payload:t,request:n};return r},a=["@@PROMISE","@@RESOLVE","@@REJECT"],o=function(e){return!e||!e.type||!a.includes(e.type)},c=function(e){r(e).forEach((function(e){if("undefined"===typeof e)throw new Error("Values cannot be undefined: ".concat(this.path))}))};e.exports={request:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"PING",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if("object"===typeof e&&(t=e.payload||{},n=e.to||".",e=e.type),"string"!==typeof e)throw new Error('"type" must be a string: '.concat(e));if("string"!==typeof n)throw new Error('"to" must be a string: '.concat(n));if("object"!==typeof t)throw new Error('"payload" must be an object: '.concat(t));c(t);var r={type:e,payload:t,to:n};return r},promise:function(){return s("@@PROMISE")},resolve:function(e,t){return s("@@RESOLVE",t,e)},reject:function(e,t){return s("@@RESOLVE",e,t)},isReplyFor:function(e,t){if(t&&"object"!==typeof t)return!1;if(o(e))return!1;if(!t)return!0;var n=t.type,r=t.payload,s=e&&e.request;return s&&s.type===n&&i(s.payload,r)}}},function(e,t,n){var r=n(437);e.exports=r},function(e,t,n){(function(t){var r=n(81),i=n(19),s=n(8),a=n(2),o=n(3),c=n(4),u=n(11)("interblock:xstate:translator"),l=(n(24),n(59)),p=n(43).State,h=n(102),d=h.request,f=h.promise,v=h.resolve,y=(h.reject,h.isReplyFor),g=function(){var e,t=function(){var t=o(a.mark((function t(n,r,i){var s;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=d(n,r,i),u("invoke: %O",s.type),c("function"===typeof e,"_callback not set"),t.abrupt("return",e(s));case 4:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}();return t._hook=function(t){c(!e,"attempt to overwrite hook"),e=t},t._clearHook=function(){c(e,"attempt to remove empty hook"),e=void 0},t}(),m=function(e,t){return e.some((function(e){var n=e.request;return l(n,t)}))},k=function(){var e=o(a.mark((function e(n,r,i){var l,p,h,d,f,v,y,m,k,x,w,C,M,I;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u("exhaust requestId: ".concat(i)),l=r.context,p=r.event,h=r.src,d=r.accumulator,f=n.options.services[h],c("function"===typeof f),v=0,g._hook(function(){var e=o(a.mark((function e(t){var n,r,o,l;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u("reExecute hook invoked"),!(v<d.length)){e.next=6;break}return n=d[v],v++,u("prior resolve returned"),e.abrupt("return",n);case 6:return u("making new response with id: ".concat(i)),c("undefined"===typeof t.payload.requestId),r=s({},t.payload,{requestId:i}),o=s({},t,{payload:r}),y(o),l=new Promise((function(){})),e.abrupt("return",l);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),m=b("invoke",function(){var e=o(a.mark((function e(){var t;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Promise((function(e,t){u("setting exhaustedTrigger"),y=function(t){u("exhaustedTrigger pulled: %O",t),e(t)}})),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()),k=b("service",f(l,p)),x=b("reaper",new Promise(t)),w=[m,k,x],e.next=13,Promise.race(w);case 13:C=e.sent,g._clearHook(),M=C.name,I=C.response,e.t0=M,e.next="invoke"===e.t0?19:"service"===e.t0?21:"reaper"===e.t0?23:24;break;case 19:return u("invoke completed first"),e.abrupt("return",s({},r,{response:I}));case 21:return u("service completed first"),e.abrupt("return",s({},r,{response:I,done:!0}));case 23:throw new Error("Neither service nor invoke completed in time");case 24:throw new Error("Unreachable");case 25:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),b=function(){var e=o(a.mark((function e(t,n){var r;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n;case 2:return"string"===typeof(r=e.sent)&&(r={type:r}),e.abrupt("return",{name:t,response:r});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),x=function(e,t){if(e&&e.message&&e.stack){u("error detected %O",e);var n=e,r=n.message,i=n.stack;e=s({},e,{stack:i,message:r})}return{type:"done.invoke."+t,data:e}},w=function(e){c(Array.isArray(e))},C=function(e,t){switch(e.type){case"@@SEND":return void u("send: %O",e);case"@@SEND_PARENT":return void u("sendParent: %O",e);case"@@RESPOND":var n=v(t,e.data);return u("respond: ",n),n;default:if(e.type.startsWith("done.invoke.")){var r=s({},e,{payload:e.data});return delete r.data,r}return e}},M=function(e,t){if(!e.nextEvents.includes(t.type)){var n=t&&t.type,r=e&&e.value;throw new Error("State: ".concat(r," does not accept event type: ").concat(n))}};e.exports={respond:function(e){return"string"===typeof e&&(e={type:e}),{type:"@@RESPOND",data:e}},send:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".";return{type:"@@SEND",payload:e,path:t}},sendParent:function(e){return{type:"@@SEND_PARENT",payload:e,path:".."}},invoke:g,translator:function(e){var t={xstate:e.initialState,promises:[],requestId:0,originAction:null};return o(a.mark((function n(){var l,h,d,g,b,I,P,A,O,S,E,R,T,q,j,L,N,D,z,B,_,K,F,H,G=arguments;return a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(l=G.length>0&&void 0!==G[0]?G[0]:t,h=G.length>1?G[1]:void 0,c(!l.actions,"Actions key disallowed in state"),"@@TIMESTAMP"!==h.type){n.next=9;break}if(l.xstate){n.next=8;break}h="@@INIT",n.next=9;break;case 8:return n.abrupt("return",l);case 9:if("string"===typeof h&&(h={type:h}),h.type.startsWith("done.invoke.")&&delete(h=s({},h,{data:h.payload})).payload,u("translator reducer action: %O",h),l=l.xstate?l:t,g=(d=l).xstate,b=d.promises,I=d.requestId,P=d.originAction,c(!g.actions||!g.actions.length,"uncleared xstate"),!y(h)){n.next=36;break}if(u("reply received: ".concat(h.type)),A=b.find((function(e){var t=e.response;return t&&y(h,t)}))){n.next=21;break}return u("No promise found for action ".concat(h.type)),n.abrupt("return",l);case 21:return(O=i(A.accumulator)).push(h.payload),S=s({},A,{accumulator:O}),n.next=26,k(e,S,I++);case 26:if(E=n.sent,b=b.filter((function(e){return e!==A})),E.done){n.next=31;break}return b.push(E),n.abrupt("return",s({},l,{promises:b,requestId:I,actions:[E.response]}));case 31:c(!b.length),u("transforming into doneInvoke: %O",h.type),h=x(E.response,E.src),n.next=37;break;case 36:P||"@@INIT"===h.type||(u("setting originAction: %O",h.type),P=h);case 37:return u("previous machine state: ",g.value),R=p.create(g),T=e.resolveState(R),M(T,h),q=e.transition(T,h),u("next machine state: ",q.value),j=q.toJSON(),L=j.actions,N=r(j,["actions"]),D=JSON.parse(JSON.stringify(N)),z=D.context,B=D.event,w(L),_=[],K=L.some((function(e){return"@@RESPOND"===e.type})),F=L.some((function(e){return"xstate.start"===e.type})),!K&&F&&P===h&&_.push(f()),H=L.map(function(){var t=o(a.mark((function t(n){var r,s,o,l,p,h,d,f,v,y,g,m;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=n.type,t.next="xstate.start"===t.t0?3:"xstate.stop"===t.t0?15:17;break;case 3:return u("invoke called"),r=n.activity,c(r&&"xstate.invoke"===r.type),s=r.src,o={context:z,event:B,src:s,accumulator:[],done:!1},t.next=10,k(e,o,I++);case 10:return l=t.sent,p=l.response,u("invoke result: ",p&&p.type),l.done?(h=l.response,d=l.src,u("tracker done immediately after starting"),f=x(h,d),v=C(f),_.push(v)):(b=[].concat(i(b),[l]),_.push(l.response)),t.abrupt("break",20);case 15:return u("end of invoke"),t.abrupt("break",20);case 17:return u("default: %O",n),n.exec?(y=n.exec(z,B),u("execResult %O",y),g=C(y,P),u("mapped %O",g),_.push(g)):(u("standard action ? %O",n),m=C(n,P),_.push(m)),t.abrupt("break",20);case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),n.next=55,Promise.all(H);case 55:return _.length||"@@INIT"===h.type||(_.push(v(P)),P=null),m(_,P)&&(P=null),u("shell actions length: ",_),n.abrupt("return",{actions:_,xstate:D,promises:b,requestId:I,originAction:P});case 59:case"end":return n.stop()}}),n)})))}}}).call(this,n(57).setImmediate)},function(e,t,n){var r=n(2),i=n(8),s=n(3),a=n(11)("interblock:covenants:hyper"),o=n(102),c=o.resolve,u=(o.request,n(84).actions,{}),l={reducer:function(){var e=s(r.mark((function e(){var t,n,s,o,l=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=l.length>0&&void 0!==l[0]?l[0]:u,n=l.length>1?l[1]:void 0,a("hyper action: ",n.type),s=[],e.t0=n.type,e.next="PING"===e.t0?7:10;break;case 7:return o=c(n,{type:"PONG"}),s.push(o),e.abrupt("break",10);case 10:return e.abrupt("return",i({},t,{actions:s}));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),actions:{}};e.exports=i({},l)},function(e,t,n){var r=n(440).txModel,i=n(236).socketModel;e.exports={socketModel:i,txModel:r}},function(e,t,n){var r=n(4),i=n(20).standardize,s=n(108).interblockModel,a=n(236).socketModel,o=i({schema:{title:"Tx",description:"An interblock plus socket info, used for transmission functions",type:"object",required:["socket","interblock"],additionalProperties:!1,properties:{socket:a.schema,interblock:s.schema}},create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.create(),t=arguments.length>1?arguments[1]:void 0;return r(a.isModel(e)),r(s.isModel(t)),o.clone({socket:e,interblock:t})},logicize:function(e){return{}}});e.exports={txModel:o}},function(e,t,n){var r=n(2),i=n(3),s=n(54),a=function(){var e=i(r.mark((function e(t){var n,a,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("object"===typeof t){e.next=2;break}return e.abrupt("return");case 2:if(n=t,t.interblock&&(n=t.interblock),n.provenance&&n.provenance.signatures){e.next=6;break}return e.abrupt("return");case 6:if(a=n.provenance.signatures,Array.isArray(a)){e.next=9;break}return e.abrupt("return");case 9:return c=a.map(function(){var e=i(r.mark((function e(t){var n,i,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.publicKey,i=t.integrity,a=t.seal,s.verifyKeyPairSync(i.hash,a,n.key)){e.next=3;break}return e.abrupt("return",s.verifyHash(i.hash,a,n.key));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=12,Promise.all(c);case 12:if(!n.network||!n.network["."]){e.next=15;break}return e.next=15,o(n.network);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o=function(){var e=i(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object.values(t).map(function(){var e=i(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a(t.heavy);case 2:return n=t.lineageTip.map(a),e.next=5,Promise.all(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=3,Promise.all(n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=i(r.mark((function e(t){var n,i,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.publicKey.key,i=t.secretKey,a={publicKey:n,secretKey:i},s.verifyKeyPairSync(a)){e.next=6;break}return e.next=6,s.verifyKeyPair(a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();e.exports={cacheVerifyHash:a,cacheVerifyKeypair:c}},function(e,t,n){(function(t){var r=n(2),i=n(3),s=n(43),a=s.Machine,o=s.assign;t.Machine=a,t.assign=o;var c=n(4),u=n(171).ioQueueFactory,l=n(23),p=l.interblockModel,h=l.addressModel,d=l.txModel,f=n(109).thread,v=n(154).isolateFactory,y=n(110).cryptoFactory,g=n(50).consistencyFactory,m=n(451).increasorConfig,k=n(457).poolConfig,b=n(459).receiveConfig,x=n(461).transmitConfig;e.exports={fsmFactory:function(){var e=u("ioIsolate"),t=u("ioCrypto"),n=u("ioConsistency"),s=u("ioPool",p),a=u("ioIncrease",h),o=u("ioReceive",d),l=u("ioTransmit",p);e.setProcessor(v()),t.setProcessor(y()),n.setProcessor(g());var w=k(t,n);s.setProcessor(function(){var e=i(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(p.isModel(t)),n={type:"POOL_INTERBLOCK",payload:t},e.next=4,f(n,w);case 4:return i=e.sent,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var C=m(t,n,e);a.setProcessor(function(){var e=i(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(h.isModel(t)),n={type:"INCREASE_CHAIN",payload:t},e.next=4,f(n,C);case 4:return i=e.sent,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var M=b(n);o.setProcessor(function(){var e=i(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(d.isModel(t)),n={type:"RECEIVE_INTERBLOCK",payload:t},e.next=4,f(n,M);case 4:return i=e.sent,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var I=x(n);return l.setProcessor(function(){var e=i(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(p.isModel(t)),n={type:"TRANSMIT_INTERBLOCK",payload:t},e.next=4,f(n,I);case 4:return i=e.sent,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),{ioIsolate:e,ioCrypto:t,ioConsistency:n,ioPool:s,ioIncrease:a,ioReceive:o,ioTransmit:l}}}}).call(this,n(31))},function(e,t,n){var r=n(161).v4,i=n(79),s=0;e.exports={machineLogger:function(e,t){var a=r(),o=Date.now(),c=n(11)("interblock:machines:".concat(i(t,11)));c("INVOCATION: ".concat(t," -> ").concat(e));var u=[],l=!1,p={},h=function(){for(var e=Date.now();p[e];)e++;return p[e]=!0,e},d=function(e){s++,c("TRANSITION: ".concat(i(3,s)," %O"),e)},f=function(e){c("TERMINATOR: ".concat(e.machine," -> ").concat(e.type," execution ended after ").concat(e.elapsedTime,"ms"))};return{writeTransition:function(e,t,n){var r=h();r;var i=e;if(u.push(i),l)return d(i);l=!0},writeTermination:function(n){var r=h();return f({invocation:a,timestamp:r,type:e,machine:t,elapsedTime:r-o,state:"TERMINATION",event:u})}}}}},function(e,t,n){var r=n(19),i=n(2),s=n(3),a=n(8),o=n(4),c=n(24),u=n(23),l=u.addressModel,p=u.integrityModel,h=u.provenanceModel,d=u.lockModel,f=u.blockModel,v=u.socketModel,y=u.interblockModel,g=n(11)("interblock:services:consistency"),m=function(e){var t=p.create(),n=p.clone(a({},t,{hash:e})),r=l.create(n);return o.equal(r.getChainId(),e),r},k=function(e){return{chainId:e.provenance.getAddress().getChainId(),height:e.provenance.height,blockHash:e.getHash(),shortestLineage:e.provenance.lineage[0]}},b=function(e){return function(t){return x(t,e)}},x=function(e,t){var n=t.getChainId(),r=e.getRemote()?"heavy":"light",i=e.provenance.getAddress().getChainId(),s=e.provenance.height;return{chainId:n,originChainId_height_type:"".concat(i,"_").concat(s,"_").concat(r),interblockHash:e.getHash(),isDeleted:!1}},w=function(e){return function(t){var n=t.getChainId(),r=e.provenance.getAddress().getChainId(),i=e.network.getAlias(t),s=e.network[i];return o(s),{chainId:n,targetChainId:r,heavyHeight:s.heavyHeight,lineageHeight:s.lineageHeight,height:e.provenance.height}}},C=n(445).lockFactory,M=n(237).dbFactory,I=n(238),P=I.s3Factory,A=I.s3Keys,O=n(111).ramDynamoDbFactory,S=n(156).ramS3Factory;e.exports={consistencySourceFactory:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"CI";e=e||O(),t=t||S();var u=C(e),p=M(e),I=P(t),E=new Map,R=function(){var e=s(i.mark((function e(t){var n,r,s,a,c,u,h,d,f;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.affectedAddresses,r=t.interblock,o(n.every(l.isModel)),o(y.isModel(r)),g("poolInterblocks for ".concat(n.length," addresses")),c=r.getWithoutRemote(),u=n.map((function(e){var t=c;return e.equals(r.getTargetAddress())?(a=!0,t=r):s=!0,x(t,e)})),g("poolItems count: %O",u.length),h=[],s&&(d=A.fromInterblock(c),h.push(I.putInterblock(d,c))),a&&(f=A.fromInterblock(r),h.push(I.putInterblock(f,r))),e.next=12,p.putPool(u);case 12:return e.next=14,Promise.all(h);case 14:g("poolInterblock complete for: ".concat(n.length," addresses"));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=s(i.mark((function e(t,r){var a,h,f,v,m,k,b,x,w,C;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(l.isModel(t)),a=t.getChainId(),e.next=4,u.tryAcquire(a,n,r);case 4:if(h=e.sent){e.next=8;break}return g("lockChain could not lock ".concat(a)),e.abrupt("return");case 8:return g("locked chain: ".concat(a," with: ").concat(h)),f=G({address:t}),e.next=12,p.queryPool(a);case 12:return v=e.sent,m=v.filter((function(e){return!e.isDeleted})),g("pool total: ".concat(v.length," valid: ").concat(m.length)),k=m.map(function(){var e=s(i.mark((function e(t){var n,r;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=A.fromPoolItem(t),e.next=3,I.getInterblock(n);case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return");case 6:return o(y.isModel(r)),o.equal(t.interblockHash,r.getHash()),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=18,Promise.all(k);case 18:return b=e.sent,x=c.compact(b),g("interblocks fetched: ".concat(x.length)),e.next=23,f;case 23:return w=e.sent,g("block height: %O",w&&w.provenance.height),g("interblock count: %O",x.length),C=d.create(w,x,h),o(!E.has(a)),E.set(a,C),g("lock complete: %O",C.uuid),e.abrupt("return",C);case 31:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),q=function(){var e=s(i.mark((function e(t){var n,r,s,a,c,l,h,f,v;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g("putUnlockChain"),o(d.isModel(t)),o(t.block,"cannot unlock without a block"),n=t.block.provenance.getAddress(),r=n.getChainId(),e.next=7,u.isValid(r,t.uuid);case 7:if(e.sent){e.next=11;break}return g("unlock rejected for ".concat(r)),e.abrupt("return");case 11:if(s=E.get(r),a=t.block,!(c=s.block)||c.isNext(a)){e.next=19;break}g("block is not next %O",a.provenance.height),g("no change: ",c.equals(a)),e.next=30;break;case 19:if(c||a.provenance.address.isGenesis()){e.next=23;break}g("next was not genesis: %O",a.height),e.next=30;break;case 23:return l=A.fromBlock(a),e.next=26,I.putBlock(l,a);case 26:return h=k(a),e.next=29,p.putBlock(h);case 29:g("block added");case 30:return f=j(a,c),v=L(s,t),e.next=34,Promise.all([f,v]);case 34:return E.delete(r),e.next=37,u.release(r,t.uuid);case 37:g("putUnlockChain complete");case 38:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=s(i.mark((function e(t,n){var r,s,a,c,u,l,h,d;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(f.isModel(t)),o(!n||f.isModel(n)),r=n?n.network.getAliases():[],s=r.filter((function(e){return n.network[e].address.isResolved()})),a=t.network.getAliases().filter((function(e){return t.network[e].address.isResolved()})),c=a.filter((function(e){return!s.includes(e)})).map((function(e){return t.network[e].address})),u=s.filter((function(e){return!a.includes(e)})).map((function(e){return t.network[e].address})),l=c.map((function(e){return e.getChainId()})),g("_updateRouteTable newAddresses",l),h=c.map(w(t)),d=u.map(w(t)),e.next=13,Promise.all([p.putSubscriptions(h),p.delSubscriptions(d)]);case 13:g("updateRouteTable complete");case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),L=function(){var e=s(i.mark((function e(t,n){var r,s,u,l,h,d,f,v;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(n.block),r=t.interblocks,s=n.interblocks,o(r.length>=s.length),u=c.difference(r,s),l=n.block.provenance.getAddress(),h=u.map(b(l)).map((function(e){return a({},e,{isDeleted:!0})})),e.next=9,p.putPool(h);case 9:return g("_purgePool isDeleted marked"),e.next=12,N(u);case 12:return d=e.sent,g("_purgePool _findOrphans found: ".concat(d.length)),f=d.map(A.fromInterblock),e.next=17,I.deleteInterblocks(f);case 17:return v=h.map((function(e){return{chainId:e.chainId,originChainId_height_type:e.originChainId_height_type}})),e.next=20,p.delPool(v);case 20:g("_purgePool complete");case 21:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),N=function(){var e=s(i.mark((function e(t){var n,a,o,u;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.filter((function(e){return e.getRemote()})),a=t.filter((function(e){return!e.getRemote()})),o=a.map(function(){var e=s(i.mark((function e(t){var n;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z(t);case 2:return n=e.sent,e.abrupt("return",!n&&t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.t0=c,e.next=6,Promise.all(o);case 6:return e.t1=e.sent,u=e.t0.compact.call(e.t0,e.t1),e.abrupt("return",[].concat(r(u),r(n)));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=s(i.mark((function e(t){var n,r,s,a,c,u,l,p,d;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.provenance,r=t.height,g("getLineage from height: ",s=void 0===r?0:r),o(h.isModel(n)),o(Number.isInteger(s)&&s>=0),o(s<n.height),a=n.getAddress(),c=[],l=n;case 8:return u=l.getShortestHeight(),e.next=11,G({address:a,height:u});case 11:p=e.sent,o(f.isModel(p)),c.push(p),l=p.provenance;case 15:if(u>s){e.next=8;break}case 16:return d=c.map((function(e){return y.create(e)})),e.abrupt("return",d);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=s(i.mark((function e(t){var n,r;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(y.isModel(t)),n=t.provenance.getAddress().getChainId(),!0,e.next=5,p.queryAffected(n,!0);case 5:return r=e.sent,e.abrupt("return",!!r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=s(i.mark((function e(t){var n,s,a,c,u,l;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(y.isModel(t)),n=t.provenance.getAddress().getChainId(),s=t.provenance.height,e.next=5,p.queryAffected(n);case 5:return a=e.sent,c=a.filter((function(e){var t=e.targetChainId,n=e.heavyHeight,r=e.lineageHeight;return t.startsWith(t)?n<s:r<s})),u=c.map((function(e){var t=e.targetChainId;return m(t)})),l=new Set(u),g("dbQueryAffected items length: %O",l.size),e.abrupt("return",r(l));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=s(i.mark((function e(t){var n,r,s;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(l.isModel(t)),n=t.getChainId(),g("getSockets for: %O",n),e.next=5,p.querySockets(n);case 5:return r=e.sent,o(Array.isArray(r)),o(r.every((function(e){return"object"===typeof e}))),s=r.map((function(e){var t=e.socketJson;return o(t),v.clone(t)})),g("getSockets length: ".concat(s.length)),e.abrupt("return",s);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=s(i.mark((function e(t){var n,r,s,a,c,u,h;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.address,r=t.socket,g("putSocket"),o(l.isModel(n)),o(v.isModel(r)),s=n.getChainId(),a=r.id,c=parseInt(Date.now()/1e3),u=r.serialize(),h={chainId:s,socketId:a,updatedTime:c,socketJson:u},e.next=11,p.putSocket(h);case 11:g("putSocket complete");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=s(i.mark((function e(t){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o(v.isModel(t)),g("delSocket %o",t.id);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(e){return p.queryLatest(e.getChainId())},G=function(){var e=s(i.mark((function e(t){var n,r,s,a,c,u;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.address,r=t.height,g("getBlock",n&&n.getChainId(),r),n){e.next=5;break}return o(!r),e.abrupt("return",U());case 5:if(o(l.isModel(n)),s=n.getChainId(),Number.isInteger(r)){e.next=13;break}return e.next=10,p.queryLatest(s);case 10:a=e.sent,e.next=16;break;case 13:return e.next=15,p.getBlock({chainId:s,height:r});case 15:a=e.sent;case 16:if(a){e.next=18;break}return e.abrupt("return");case 18:return Number.isInteger(r)||(r=a.height),c=A.fromBlockItem(a),g("s3.getBlock(s3Key)",c),e.next=23,I.getBlock(c);case 23:return u=e.sent,o(f.isModel(u)),o(n.equals(u.provenance.getAddress())),o.equal(u.getHash(),a.blockHash),o.equal(u.provenance.height,r),g("getBlock complete"),e.abrupt("return",u);case 30:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=s(i.mark((function e(){var t,n;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g("getBaseAddress"),e.next=3,p.scanBaseChainId();case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return");case 6:return o(t.chainId),n=l.create(t.chainId),o.equal(t.chainId,n.getChainId()),g("getBaseAddress: ".concat(n.getChainId())),e.abrupt("return",n);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{putSocket:K,getSockets:_,delSocket:F,putPoolInterblock:R,putLockChain:T,putUnlockChain:q,getLineage:D,getIsAnyAffected:z,getAffected:B,getIsPresent:H,getBlock:G}}}},function(e,t,n){var r=n(2),i=n(3),s=n(446),a=n(52).promisify,o=n(111).ramDynamoDbFactory,c=0,u=1;e.exports={lockFactory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o(),t=n(11)("interblock:aws:lock:id-".concat(c++)),l=new Map,p=function(){var n=i(r.mark((function n(o,c,p){var h,d,v,y,g,m,k,b,x,w,C,M;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t("attempting to lock %o %o %o",o.substring(0,16),c,p),!l.has(o)){n.next=4;break}return t("already locked to this thread: ".concat(o)),n.abrupt("return");case 4:if(!e._getTables){n.next=9;break}return h="ramLockId-"+u++,d={uuid:h,tryRelease:function(){t("ram tryRelease for uuid: %o and chainId: %o",h,o)}},l.set(o,d),n.abrupt("return",h);case 9:return l.set(o,"acquisition in progress"),v=new s.FailOpen({dynamodb:e,lockTable:"dbLocks",partitionKey:"chainId",leaseDurationMs:p||12e3,retryCount:0,owner:c,trustLocalTime:!0}),n.prev=11,n.next=14,f("dbLocks",{chainId:o});case 14:if(!(y=n.sent)||1===y.leaseDurationMs){n.next=23;break}if(g=y.lockAcquiredTimeUnixMs,m=y.leaseDurationMs,2e3,Date.now()-g>m+2e3){n.next=23;break}return t("lock not available ".concat(o)),n.abrupt("return");case 23:return k=a(v.acquireLock).bind(v),n.next=26,k(o);case 26:return b=n.sent,x=b.fencingToken,t("locked ".concat(o," with fencing token: ").concat(x)),w=function(){var e=i(r.mark((function e(){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=a(b.release).bind(b),e.next=4,n();case 4:t("released lock for ".concat(o)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t("failed to release lock for ".concat(o," ").concat(e.t0.message));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),C=b._guid.toString("base64"),M={uuid:C,tryRelease:w},l.set(o,M),t("lock complete"),n.abrupt("return",C);case 37:return n.prev=37,n.t0=n.catch(11),t("failed to lock: ".concat(o," %O"),n.t0),"string"===typeof l.get(o)&&l.delete(o),n.abrupt("return");case 43:case"end":return n.stop()}}),n,null,[[11,37]])})));return function(e,t,r){return n.apply(this,arguments)}}(),h=function(){var e=i(r.mark((function e(n,i){var s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve();case 2:if(l.has(n)){e.next=5;break}return t("unknown lock for ".concat(n)),e.abrupt("return",!1);case 5:return s=l.get(n),e.abrupt("return",s.uuid===i);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),d=function(){var e=i(r.mark((function e(t,n){var i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=l.get(t)).uuid!==n){e.next=6;break}return e.next=4,i.tryRelease();case 4:return l.delete(t),e.abrupt("return");case 6:throw new Error("invalid lock: ".concat(t," ").concat(n));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),f=function(){var t=i(r.mark((function t(n,i){var s,a,o;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s={TableName:n,Key:i,ConsistentRead:!0,ReturnConsumedCapacity:"TOTAL"},t.next=3,e.get(s).promise();case 3:return a=t.sent,a.ConsumedCapacity,o=a.Item,t.abrupt("return",o);case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();return{tryAcquire:p,isValid:h,release:d}}}},,,,,function(e,t,n){var r=n(2),i=n(3);e.exports={toFunctions:function(e){return{putSocket:function(t){return e.push({type:"PUT_SOCKET",payload:t})},getSockets:function(t){return e.push({type:"GET_SOCKETS",payload:t})},delSocket:function(t){return e.push({type:"DEL_SOCKET",payload:t})},putPoolInterblock:function(t){return e.push({type:"POOL",payload:t})},putLockChain:function(t){return e.push({type:"LOCK",payload:t})},putUnlockChain:function(t){return e.push({type:"UNLOCK",payload:t})},getLineage:function(t){return e.push({type:"LINEAGE",payload:t})},getIsAnyAffected:function(t){return e.push({type:"ANY_AFFECTED",payload:t})},getAffected:function(t){return e.push({type:"AFFECTED",payload:t})},getIsPresent:function(t){return e.push({type:"IS_PRESENT",payload:t})},getBlock:function(t){return e.push({type:"GET_BLOCK",payload:t})}}},fromFunctions:function(e){return function(){var t=i(r.mark((function t(n){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=n.type,t.next="PUT_SOCKET"===t.t0?3:"GET_SOCKETS"===t.t0?4:"DEL_SOCKET"===t.t0?5:"POOL"===t.t0?6:"LOCK"===t.t0?7:"UNLOCK"===t.t0?8:"LINEAGE"===t.t0?9:"ANY_AFFECTED"===t.t0?10:"AFFECTED"===t.t0?11:"IS_PRESENT"===t.t0?12:"GET_BLOCK"===t.t0?13:14;break;case 3:return t.abrupt("return",e.putSocket(n.payload));case 4:return t.abrupt("return",e.getSockets(n.payload));case 5:return t.abrupt("return",e.delSocket(n.payload));case 6:return t.abrupt("return",e.putPoolInterblock(n.payload));case 7:return t.abrupt("return",e.putLockChain(n.payload));case 8:return t.abrupt("return",e.putUnlockChain(n.payload));case 9:return t.abrupt("return",e.getLineage(n.payload));case 10:return t.abrupt("return",e.getIsAnyAffected(n.payload));case 11:return t.abrupt("return",e.getAffected(n.payload));case 12:return t.abrupt("return",e.getIsPresent(n.payload));case 13:return t.abrupt("return",e.getBlock(n.payload));case 14:throw new Error("Unknown action type: ".concat(n&&n.type));case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}},function(e,t,n){var r=n(2),i=n(3),s=n(4),a=n(11)("interblock:config:increasor"),o=(n(24),n(43).assign),c=n(23),u=c.lockModel,l=c.addressModel,p=c.dmzModel,h=c.blockModel,d=c.interblockModel,f=c.networkModel,v=n(66),y=v.blockProducer,g=v.lockProducer,m=(v.networkProducer,y.generateNext),k=n(109).thread,b=n(452).machine,x=n(50),w=n(110),C=n(453).isolatorConfig;e.exports={increasorConfig:function(e,t,n){var c=x.toFunctions(t),v=w.toFunctions(e);return b.withConfig({actions:{assignLock:o({lock:function(e,t){a("assignLock");var n=t.data;return s(u.isModel(n)),n}}),assignNextDmz:o({nextDmz:function(e,t){var n=t.data;return s(p.isModel(n)),n}}),assignBlock:o({block:function(e,t){var n=t.data;return s(h.isModel(n)),n}}),reconcileLock:o({nextLock:function(e){var t=e.lock,n=e.block;s(u.isModel(t)),s(h.isModel(n)),a("reconcileLock");var r=g.reconcile(t,n);return r}}),repeatLock:o({nextLock:function(e){return e.lock}}),assignTxInterblocks:o({txInterblocks:function(e){var t=e.block,n=e.lock;a("txInterblocks");var r=n.block;s(h.isModel(t)),s(h.isModel(r)),s(!t.provenance.address.isGenesis());var i=r.network;2===t.provenance.height&&!t.network[".."].address.isRoot()&&(i=f.create());var o=t.network.txInterblockAliases(i).map((function(e){return d.create(t,e)}));return a("txInterblocks raw length: ".concat(o.length)),o.push(d.create(t)),o}}),unassignTxInterblocks:o({txInterblocks:void 0})},guards:{isLockAcquired:function(e,t){var n=!1,r=t.data;return r&&(s(u.isModel(r)),n=r.block,!r.block&&a("WARNING missing chain locked")),a("isLockAcquired: ",!!n),n},isProposer:function(){return!0},isValidator:function(){return!1},isIsolationComplete:function(e){var t=!!e.nextDmz;return a("isIsolationComplete: ".concat(t)),t},isDmzChanged:function(e){var t=e.lock,n=e.nextDmz;s(u.isModel(t)),s(p.isModel(n)),s(t.block);var r=t.block.network,i=n.network.txInterblockAliases(r).length;return a("isDmzChanged: ".concat(i)),i},isNewBlock:function(e){var t=e.block,n=t&&h.isModel(t);return a("isNewBlock: ".concat(n)),n}},services:{lockChain:function(){var e=i(r.mark((function e(t,n){var i,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.payload,a("lockChain ".concat(i.getChainId())),s(l.isModel(i)),e.next=5,c.putLockChain(i);case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),isolate:function(){var e=i(r.mark((function e(t){var i,a,o,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.lock,a={type:"EXECUTE_COVENANT",payload:i},o=C(n),e.next=5,k(a,o);case 5:return c=e.sent,s(p.isModel(c)),e.abrupt("return",c);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),signBlock:function(){var e=i(r.mark((function e(t){var n,i,a,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.lock,i=t.nextDmz,s(p.isModel(i)),s(u.isModel(n)),a=n.block,s(a),e.next=7,m(i,a,v.sign);case 7:return o=e.sent,e.abrupt("return",o);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),unlockChain:function(){var e=i(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.nextLock,s(u.isModel(n)),a("unlockChain"),e.next=5,c.putUnlockChain(n);case 5:return e.abrupt("return");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}})}}},function(e,t,n){var r={id:"increasor",initial:"idle",context:{lock:void 0,nextLock:void 0,block:void 0,nextDmz:void 0,txInterblocks:[]},strict:!0,states:{idle:{on:{INCREASE_CHAIN:"lockChain"}},lockChain:{invoke:{src:"lockChain",onDone:[{target:"execute",cond:"isLockAcquired",actions:"assignLock"},{target:"done",actions:"unassignTxInterblocks"}],onError:"error"}},execute:{initial:"branch",states:{branch:{always:[{target:"proposeNext",cond:"isProposer"},{target:"validateNext",cond:"isValidator"},{target:"#done"}]},proposeNext:{initial:"branch",states:{branch:{always:[{target:"isDmzChanged",cond:"isIsolationComplete"},{target:"#increasor.isolate"}]},isDmzChanged:{always:[{target:"signBlock",cond:"isDmzChanged"},{target:"#increasor.unlockChain"}]},signBlock:{invoke:{src:"signBlock",onDone:{target:"#increasor.unlockChain",actions:"assignBlock"},onError:"#error"}}}},validateNext:{always:[{target:".signBlock",cond:"isIsolationComplete"},{target:"#increasor.isolate",cond:"isIsolationRequired"}],initial:"signBlock",states:{signBlock:{}}},history:{type:"history"}}},isolate:{invoke:{src:"isolate",onDone:{target:"#increasor.execute.history",actions:"assignNextDmz"},onError:"error"}},unlockChain:{initial:"isNewBlock",states:{isNewBlock:{always:[{target:"unlockChain",cond:"isNewBlock",actions:"reconcileLock"},{target:"unlockChain",actions:"repeatLock"}]},unlockChain:{invoke:{src:"unlockChain",onDone:"done"}},done:{type:"final"}},onDone:[{target:"done",cond:"isNewBlock",actions:"assignTxInterblocks"},{target:"done"}]},done:{id:"done",data:function(e){return e.txInterblocks},type:"final"},error:{id:"error",type:"final"}}},i=Machine(r);e.exports={definition:r,machine:i}},function(e,t,n){var r=n(2),i=n(3),s=n(8),a=n(4),o=n(11)("interblock:config:isolator"),c=n(43).assign,u=n(23),l=u.rxRequestModel,p=u.dmzModel,h=u.lockModel,d=n(66).networkProducer,f=n(109).thread,v=n(454).interpreterConfig,y=n(456).machine,g=n(154),m=y.withConfig({actions:{assignLock:c({lock:function(e,t){var n=t.payload;return a(h.isModel(n)),a(n.block,"can only isolate for existing chains"),n}}),primeDmz:c({dmz:function(e){var t=e.lock;a(h.isModel(t));var n=t.block,r=t.interblocks,i=n.getDmz(),o=d.ingestInterblocks(i.network,r,i.config);return p.clone(s({},i,{network:o}))}}),assignContainerId:c({containerId:function(e,t){var n=t.data;return n}}),updateDmz:c({dmz:function(e,t){o("updateDmz");var n=t.data;return a(p.isModel(n)),n}})},guards:{isDmzChangeable:function(e){var t=e.dmz;a(p.isModel(t));var n=t.config.isPierced,r=t.network.rx(),i=n||r;return o("isDmzChangeable: ".concat(i)),i},isExhausted:function(e){var t=e.dmz;a(p.isModel(t));var n=!t.network.rx();return o("isExhausted: ".concat(n)),n}},services:{loadCovenant:function(){var e=i(r.mark((function e(t){var n,i,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.lock,i=t.isolation,a(h.isModel(n)),e.next=4,i.loadCovenant(n.block);case 4:return s=e.sent,o("loadCovenant containerId: ".concat(s.substring(0,9))),e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),reduceActionless:function(){var e=i(r.mark((function e(t){var n,i,s,c,u,l,h,d;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dmz,i=t.containerId,s=t.isolation,o("reduceActionless"),a(p.isModel(n)),c=n.network["."].address,u=b(c),l=k(i,s.tick),h=v(l,n,u,c),e.next=9,f("TICK",h);case 9:return d=e.sent,a(p.isModel(d)),e.abrupt("return",d);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),reduce:function(){var e=i(r.mark((function e(t){var n,i,s,c,u,l,h,d,y,g,m;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dmz,i=t.containerId,s=t.isolation,a(p.isModel(n)),a(n.network.rx()),c=n.network.rx(),u=c.event,l=c.channel,c.alias,h=l.getNextReplyIndex(),o("reduce: ",u.type,h),d=l.address,a(!d.isUnknown()),y=k(i,s.tick),g=v(y,n,u,d),e.next=12,f("TICK",g);case 12:return m=e.sent,a(p.isModel(m)),e.abrupt("return",m);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),unloadCovenant:function(){var e=i(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.containerId,i=t.isolation,o("unloadCovenant containerId: %o",n.substring(0,9)),e.next=4,i.unloadCovenant(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}),k=function(e,t){return function(n,r){return t({containerId:e,state:n,action:r})}},b=function(e){return l.create("@@TIMESTAMP",{timestamp:Date.now()},e,0)};e.exports={isolatorConfig:function(e){var t=g.toFunctions(e);return m.withContext({isolation:t})}}},function(e,t,n){var r=n(2),i=n(3),s=n(8),a=n(4),o=n(11)("interblock:config:interpreter"),c=n(23),u=c.rxReplyModel,l=c.rxRequestModel,p=c.addressModel,h=c.stateModel,d=c.dmzModel,f=n(66).networkProducer,v=n(84),y=n(455).machine,g=n(43).assign,m=y.withConfig({actions:{assignRejection:g({reduceRejection:function(e,t){return t.data}}),assignResolve:g({reduceResolve:function(e,t){return t.data}}),mergeSystem:g({dmz:function(e){var t=e.reduceResolve;o("mergeSystem"),a(h.isModel(t));var n=d.clone(t.getState()),r=f.tx(n.network,t);return d.clone(s({},n,{network:r}))}}),mergeCovenant:g({dmz:function(e){var t=e.dmz,n=e.reduceResolve;a(h.isModel(n)),a(d.isModel(t));var r=n.getRequests().length,i=n.getReplies().length;o("mergeCovenant requests: %o replies %o",r,i);var c=f.tx(t.network,n),u=n.getState();return d.clone(s({},t,{state:u,network:c}))}}),respondReply:g({dmz:function(e){var t=e.dmz,n=e.address;o("respondReply"),a(d.isModel(t));var r=f.respondReply(t.network,n);return d.clone(s({},t,{network:r}))}}),respondRejection:g({dmz:function(e){var t=e.dmz,n=e.anvil,r=e.reduceRejection;a(d.isModel(t));var i=f.respondRejection(t.network,n,r);return d.clone(s({},t,{network:i}))}}),respondRequest:g({dmz:function(e){var t=e.dmz,n=e.address,r=e.anvil;o("respondRequest"),a(d.isModel(t)),a(l.isModel(r)),a(r.getAddress().equals(n));var i=f.respondRequest(t.network,r);return d.clone(s({},t,{network:i}))}}),loadSelfAnvil:g({anvil:function(e){var t=e.dmz.network.rxSelf();return o("loadSelfAnvil anvil: %o",t.type),t},address:function(e){var t=e.dmz.network["."].address;return a(t,"Self not found"),o("loadSelfAnvil selfAddress: %o",t.getChainId()),t}})},guards:{isSystem:function(e){var t=e.anvil,n=e.address;if("@@TIMESTAMP"===t.type)return!1;if(a(p.isModel(n)),a(l.isModel(t)||u.isModel(t)),t.isReply()){var r=v.isSystemReply(t);return o("isSystem: ".concat(r)),r}var i=v.isSystemRequest(t);return o("isSystem: ".concat(i)),i},isChannelUnavailable:function(e){var t=e.anvil,n=e.dmz,r=e.address;if("@@TIMESTAMP"===t.type)return o("isChannelUnavailable: ",!0),!0;a(p.isModel(r),"If Anvil, then address required"),a(!r.isUnknown(),"Address unknown");var i=n.network.getAlias(r);return o("isChannelUnavailable: ",!i),!i},isReply:function(e){var t=e.anvil;return a(t),o("isReply type: ".concat(t.type," isReply: ").concat(t.isReply())),t.isReply()},isRejection:function(e){var t=e.reduceRejection;return o("isRejection ".concat(!!t)),t&&o(t.message),t},isResponseDone:function(e){var t=e.dmz,n=e.anvil,r=e.address;a(d.isModel(t)),a(l.isModel(n)),a(n.getAddress().equals(r));var i=n.getIndex(),s=t.network.isResponseDone(r,i);return o("isResponseDone: ".concat(!!s," anvil: %o"),n.type),s},isSelfExhausted:function(e){var t=!e.dmz.network.rxSelf();return o("isSelfExhausted: ".concat(t)),t}},services:{reduceCovenant:function(){var e=i(r.mark((function e(t){var n,i,s,c,u,l;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dmz,i=t.anvil,s=t.isolatedTick,o("reduceCovenant anvil: %o",i.type),a(i),c=n.state.getState(),e.next=6,s(c,i);case 6:return u=e.sent,a(u,"Covenant returned: ".concat(u)),l=h.create(u,i),e.abrupt("return",l);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),reduceSystem:function(){var e=i(r.mark((function e(t){var n,i,s,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dmz,i=t.anvil,o("reduceSystem anvil: %o",i.type),a(i),e.next=5,v.reducer(n,i);case 5:return s=e.sent,a(s,"System returned: ".concat(s)),c=h.create(s,i),a(d.clone(c.getState()),"Uncloneable dmz"),e.abrupt("return",c);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}});e.exports={interpreterConfig:function(e,t,n,r){return a("function"===typeof e),a(d.isModel(t)),a(p.isModel(r)),a(l.isModel(n)||u.isModel(n)),l.isModel(n)&&a(n.getAddress().equals(r)),o("interpreterConfig: %o from chainId: %o",n.type,r.getChainId()),m.withContext({dmz:t,anvil:n,address:r,isolatedTick:e})}}},function(e,t,n){var r={id:"interpreter",initial:"idle",context:{anvil:void 0,address:void 0,dmz:void 0,reduceRejection:void 0,reduceResolve:void 0},strict:!0,states:{idle:{on:{TICK:"reduce"}},done:{id:"done",data:function(e){return e.dmz},type:"final"},reduce:{initial:"isSystem",states:{isSystem:{always:[{target:"reduceSystem",cond:"isSystem"},{target:"reduceCovenant"}]},reduceSystem:{invoke:{src:"reduceSystem",onDone:"done",onError:"error"}},reduceCovenant:{invoke:{src:"reduceCovenant",onDone:"done",onError:"error"}},error:{type:"final",entry:"assignRejection"},done:{type:"final",entry:"assignResolve"}},onDone:{target:"merge"}},merge:{initial:"isRejection",states:{isRejection:{always:[{target:"done",cond:"isRejection"},{target:"mergeSystem",cond:"isSystem"},{target:"mergeCovenant"}]},mergeSystem:{entry:"mergeSystem",type:"final"},mergeCovenant:{entry:"mergeCovenant",type:"final"},done:{type:"final"}},onDone:"respond"},respond:{initial:"isReply",states:{isReply:{always:[{target:"done",cond:"isChannelUnavailable"},{target:"respondReply",cond:"isReply"},{target:"respondRejection",cond:"isRejection"},{target:"done",cond:"isResponseDone"},{target:"respondRequest"}]},respondReply:{entry:"respondReply",type:"final"},respondRejection:{entry:"respondRejection",type:"final"},respondRequest:{entry:"respondRequest",type:"final"},done:{type:"final"}},onDone:[{target:"done",cond:"isSelfExhausted"},{target:"reduce",actions:"loadSelfAnvil"}]}}},i=Machine(r);e.exports={definition:r,machine:i}},function(e,t,n){var r={id:"isolator",initial:"idle",context:{lock:void 0,dmz:void 0,isolation:function(){return"isolation function"}},strict:!0,states:{idle:{on:{EXECUTE_COVENANT:{target:"isDmzChangeable",actions:["assignLock","primeDmz"]}}},isDmzChangeable:{always:[{target:"loadCovenant",cond:"isDmzChangeable"},{target:"done"}]},loadCovenant:{invoke:{src:"loadCovenant",onDone:{target:"reduceActionless",actions:"assignContainerId"},onError:"error"}},reduceActionless:{invoke:{src:"reduceActionless",onDone:"isExhausted",onError:"error"}},reduce:{invoke:{src:"reduce",onDone:"isExhausted",onError:"error"}},isExhausted:{entry:"updateDmz",always:[{target:"unloadCovenant",cond:"isExhausted"},{target:"reduce"}]},unloadCovenant:{invoke:{src:"unloadCovenant",onDone:"done",onError:"error"}},done:{data:function(e){return e.dmz},type:"final"},error:{type:"final"}}},i=Machine(r);e.exports={definition:r,machine:i}},function(e,t,n){var r=n(2),i=n(3),s=n(19),a=n(8),o=n(4),c=n(11)("interblock:config:pool"),u=(n(24),n(43).assign),l=n(458).machine,p=n(23),h=p.channelModel,d=p.networkModel,f=p.blockModel,v=p.lockModel,y=p.interblockModel,g=p.addressModel,m=p.dmzModel,k=p.covenantIdModel,b=p.publicKeyModel,x=(p.provenanceModel,n(66)),w=x.blockProducer,C=x.lockProducer,M=x.channelProducer,I=x.networkProducer,P=w.generateNext,A=n(50),O=n(110);e.exports={poolConfig:function(e,t){var n=A.toFunctions(t),p=O.toFunctions(e);return l.withConfig({actions:{assignInterblock:u({interblock:function(e,t){var n=t.payload;return o(y.isModel(n)),n}}),assignLock:u({lock:function(e,t){return o(v.isModel(t.data)),t.data}}),assignDmz:u({dmz:function(e){var t=e.lock;o(v.isModel(t));var n=t.block&&t.block.getDmz();return n}}),assignNextBlock:u({nextBlock:function(e){var t=e.lock;return o(v.isModel(t)),t.block}}),mergeGenesis:u({nextBlock:function(e){var t=e.lock,n=e.interblock;c("mergeGenesis"),o(v.isModel(t)),o(y.isModel(n));var r=n.extractGenesis();return r}}),connectToParent:u({dmz:function(e){var t=e.interblock,n=e.dmz;c("connectToParent");var r=t.provenance.getAddress(),i=n.network[".."];i=M.setAddress(i,r);var s=a({},n.network,{"..":i});return m.clone(a({},n,{network:s}))}}),ingestParentLineage:u({dmz:function(e,t){var n=e.dmz,r=t.data;o(Array.isArray(r)),o(r.every(y.isModel)),c("ingestParentLineage length: ".concat(r.length));var i=I.ingestInterblocks(n.network,r,n.config);return n=m.clone(a({},n,{network:i}))}}),mergeBlockToLock:u({lock:function(e){var t=e.lock,n=e.nextBlock;return o(v.isModel(t)),o(f.isModel(n)),c("mergeBlockToLock increased: ".concat(!n.equals(t.block))),C.reconcile(t,n)}}),assignInitializedAddress:u({affectedAddresses:function(e){return[e.lock.block.provenance.getAddress()]}}),assignGeneratedBlock:u({nextBlock:function(e,t){return o(f.isModel(t.data)),c("assignGeneratedBlock"),t.data}}),unassignLock:u({lock:function(){}}),createBaseDmz:u({baseDmz:function(e){var t=e.validators,n=k.create("hyper"),r=g.create("ROOT"),i=h.create(r),s=a({},d.create(),{"..":i});return m.create({covenantId:n,validators:t,network:s,config:{isPierced:!0,isPublicChannelOpen:!0}})}}),assignValidatorKey:u({validators:function(e,t){c("assignValidatorKey: %o",t.data);var n=Object.values(t.data)[0];return o(b.isModel(n)),t.data}}),assignAffectedAddresses:u({affectedAddresses:function(e,t){var n=e.affectedAddresses;c("assignAffectedAddresses");var r=t.data;return o(Array.isArray(r)),[].concat(s(r),s(n))}}),assignConnectionAttempt:u({affectedAddresses:function(e){var t=e.interblock,n=e.affectedAddresses;o(Array.isArray(n)),o(y.isModel(t));var r=t.getTargetAddress();return[].concat(s(n),[r])}})},guards:{isStorageEmpty:function(e,t){var n=t.data.isStorageEmpty;return c("isStorageEmpty: ".concat(n)),n},isInitialConditions:function(e){return!!e.baseDmz},isGenesis:function(e){var t=e.interblock;o(y.isModel(t));var n=!1;try{t.extractGenesis(),n=!0}catch(r){}return c("isGenesis: ".concat(n)),n},isOriginPresent:function(e,t){var n=t.data;return o("boolean"===typeof n),c("isOriginPresent: ".concat(n)),n},isLockFailed:function(e,t){var n=!t.data&&!v.isModel(t.data);return c("isLockFailed: ".concat(n)),n},isBirthingCompleted:function(e){var t=e.lock;o(v.isModel(t));var n=t.block&&t.block.provenance.height>=1;return c("isBirthingCompleted: ".concat(n)),n},verifyLineage:function(e,t){var n=e.interblock,r=t.data;return o(r.length),o.equal(n.getChainId(),r[0].getChainId()),o(!r[0].provenance.height),c("verifyLineage"),!0},isLockForGenesis:function(e){var t=e.lock;o(v.isModel(t));var n=t.block,r=n&&n.provenance.address.isGenesis();return c("isLockForGenesis: ".concat(r)),r},isLockForBirthBlock:function(e){var t=e.lock;o(v.isModel(t));var n=t.block,r=n&&1===n.provenance.height;return c("isLockForBirthBlock: ".concat(r)),r},isConnectionAttempt:function(e){return e.interblock.isConnectionAttempt()},isConnectable:function(e,t){return t.data}},services:{isStorageEmpty:function(){var e=i(r.mark((function e(){var t,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0,e.next=3,n.getBlock({address:void 0});case 3:return t=e.sent,c("isStorageEmpty: ".concat(i=!t)),e.abrupt("return",{isStorageEmpty:i});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),checkIsOriginPresent:function(){var e=i(r.mark((function e(t){var i,s,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.interblock,s=i.provenance.getAddress(),e.next=4,n.getIsPresent(s);case 4:return a=e.sent,c("checkIsOriginPresent: %O",!!a),e.abrupt("return",!!a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),lockChildChain:function(){var e=i(r.mark((function e(t){var i,s,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.interblock,o(y.isModel(i)),s=i.extractGenesis().provenance.getAddress(),e.next=5,n.putLockChain(s);case 5:return a=e.sent,c("lockChildChain: ".concat(!!a)),e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchParentLineage:function(){var e=i(r.mark((function e(t){var i,s,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.interblock,o(y.isModel(i)),s=i.provenance,e.next=5,n.getLineage({provenance:s});case 5:return a=e.sent,o(Array.isArray(a)),o(a.every(y.isModel)),o.equal(a[0].provenance.height,0),c("fetchParentLineage length: ".concat(a.length)),e.abrupt("return",a);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),generateBirthBlock:function(){var e=i(r.mark((function e(t){var n,i,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dmz,i=t.lock,o(m.isModel(n)),o(v.isModel(i)),c("generateBirthBlock"),e.next=6,P(n,i.block,p.sign);case 6:return s=e.sent,e.abrupt("return",s);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),unlockChain:function(){var e=i(r.mark((function e(t){var i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.lock,o(v.isModel(i)),c("unlockChain"),e.next=5,n.putUnlockChain(i);case 5:return e.abrupt("return");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),poolBirthBlock:function(){var e=i(r.mark((function e(t){var i,s,a,c,u;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.lock,o(v.isModel(i)),s=i.block,o(s),o(1===s.provenance.height),a=s.network[".."].address,o(a.isResolved()),c=y.create(s),u=[a],e.next=11,n.putPoolInterblock({affectedAddresses:u,interblock:c});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchValidatorKey:function(){var e=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c("fetchValidatorKey"),e.next=3,p.getValidatorEntry();case 3:return t=e.sent,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),signBlock:function(){var e=i(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.baseDmz,c("signBlock"),e.next=4,f.create(n,p.sign);case 4:return i=e.sent,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),lockBaseChain:function(){var e=i(r.mark((function e(t){var i,s,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.nextBlock,c("lockBaseChain"),s=i.provenance.getAddress(),e.next=5,n.putLockChain(s);case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchAffectedAddresses:function(){var e=i(r.mark((function e(t){var i,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.interblock,e.next=3,n.getAffected(i);case 3:return s=e.sent,c("fetchAffectedAddresses: ".concat(s.length)),e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),isConnectable:function(){var e=i(r.mark((function e(t){var i,s,a,u;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.interblock,o(y.isModel(i)),s=i.getTargetAddress(),o(s),e.next=6,n.getBlock({address:s});case 6:return(a=e.sent)&&o(f.isModel(a)),u=a&&a.config.isPublicChannelOpen,c("isConnectable: ",u),e.abrupt("return",u);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),storeInPools:function(){var e=i(r.mark((function e(t){var i,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.interblock,s=t.affectedAddresses,o(Array.isArray(s)),o(y.isModel(i)),c("storeInPools"),e.next=6,n.putPoolInterblock({affectedAddresses:s,interblock:i});case 6:c("storeInPools completed on ".concat(s.length," items"));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}})}}},function(e,t,n){var r={id:"pool",initial:"idle",context:{interblock:void 0,lock:void 0,dmz:void 0,nextBlock:void 0,affectedAddresses:[],baseDmz:void 0,validators:void 0},strict:!0,states:{idle:{on:{POOL_INTERBLOCK:{target:"initializeStorage",actions:"assignInterblock"}}},done:{id:"done",data:function(e){return e.affectedAddresses},type:"final"},initializeStorage:{initial:"isStorageEmpty",states:{isStorageEmpty:{invoke:{src:"isStorageEmpty",onDone:[{target:"fetchValidatorKey",cond:"isStorageEmpty"},{target:"done"}]}},fetchValidatorKey:{invoke:{src:"fetchValidatorKey",onDone:{target:"createBaseBlock",actions:"assignValidatorKey"}}},createBaseBlock:{entry:"createBaseDmz",invoke:{src:"signBlock",onDone:{target:"lockBaseChain",actions:"assignGeneratedBlock"}}},lockBaseChain:{invoke:{src:"lockBaseChain",onDone:{target:"unlockChain",actions:"assignLock"}}},unlockChain:{entry:"mergeBlockToLock",invoke:{src:"unlockChain",onDone:{target:"done",actions:"assignInitializedAddress"}}},done:{type:"final"}},onDone:[{target:"done",cond:"isInitialConditions"},{target:"poolInterblock"}]},poolInterblock:{initial:"isGenesis",states:{isGenesis:{always:[{target:"birthChild",cond:"isGenesis"},{target:"poolAffectedChains"}]},poolAffectedChains:{initial:"fetchAffectedAddresses",states:{fetchAffectedAddresses:{invoke:{src:"fetchAffectedAddresses",onDone:{target:"isConnectionAttempt",actions:"assignAffectedAddresses"}}},isConnectionAttempt:{always:[{target:"isConnectable",cond:"isConnectionAttempt"},{target:"storeInPools"}]},isConnectable:{invoke:{src:"isConnectable",onDone:[{target:"storeInPools",cond:"isConnectable",actions:"assignConnectionAttempt"},{target:"storeInPools"}]}},storeInPools:{invoke:{src:"storeInPools",onDone:{target:"done"}}},done:{type:"final"}},onDone:"done"},done:{type:"final"},birthChild:{initial:"checkIsOriginPresent",states:{checkIsOriginPresent:{invoke:{src:"checkIsOriginPresent",onDone:[{target:"lockChildChain",cond:"isOriginPresent"},{target:"done"}]}},done:{type:"final"},lockChildChain:{entry:"unassignLock",invoke:{src:"lockChildChain",onDone:[{target:"done",cond:"isLockFailed"},{target:"increaseChain"}]}},increaseChain:{entry:["assignLock","assignDmz","assignNextBlock"],always:[{target:"unlockChain",cond:"isBirthingCompleted"},{target:"fetchParentLineage",cond:"isLockForGenesis"},{target:"mergeGenesis"}]},mergeGenesis:{entry:"mergeGenesis",always:"unlockChain"},fetchParentLineage:{entry:"connectToParent",invoke:{src:"fetchParentLineage",onDone:{target:"generateBirthBlock",cond:"verifyLineage"}},exit:"ingestParentLineage"},generateBirthBlock:{invoke:{src:"generateBirthBlock",onDone:{target:"unlockChain",actions:"assignGeneratedBlock"}}},unlockChain:{entry:"mergeBlockToLock",invoke:{src:"unlockChain",onDone:[{target:"lockChildChain",cond:"isLockForGenesis"},{target:"poolBirthBlock",cond:"isLockForBirthBlock"},{target:"done"}]}},poolBirthBlock:{invoke:{src:"poolBirthBlock",onDone:"done"}}},onDone:"poolAffectedChains"}},onDone:"done"},error:{id:"error",type:"final"}}},i=Machine(r);e.exports={definition:r,machine:i}},function(e,t,n){var r=n(2),i=n(3),s=n(4),a=n(11)("interblock:config:receive"),o=(n(24),n(43).assign),c=n(23),u=(c.lockModel,c.addressModel,c.txModel),l=c.blockModel,p=c.interblockModel,h=n(66),d=(h.blockProducer,h.lockProducer,h.networkProducer,n(460).machine),f=n(50);e.exports={receiveConfig:function(e){var t=f.toFunctions(e);return d.withConfig({actions:{assignInterblock:o({interblock:function(e,t){var n=t.payload;return s(u.isModel(n)),n.interblock}}),assignSocket:o({socket:function(e,t){var n=t.payload;return s(u.isModel(n)),n.socket}}),assignIsPoolable:o({isPoolable:function(e,t){return!0}})},guards:{isInitialConditions:function(e,t){var n=t.data;return a("isInitialConditions: ".concat(n)),n},isPoolable:function(e,t){var n=t.data;return s("boolean"===typeof n),a("isPoolable: ".concat(n)),n},isConnectionAttempt:function(e){return e.interblock.isConnectionAttempt()},isConnectable:function(e,t){return t.data}},services:{isInitialConditions:function(){var e=i(r.mark((function e(){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0,e.next=3,t.getBlock({address:void 0});case 3:return n=e.sent,a("isInitialConditions: ".concat(!n)),e.abrupt("return",!n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),isAnyAffected:function(){var e=i(r.mark((function e(n){var i,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,e.next=3,t.getIsAnyAffected(i);case 3:return s=e.sent,a("isAnyAffected: ".concat(s)),e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),isConnectable:function(){var e=i(r.mark((function e(n){var i,o,c,u;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,s(p.isModel(i)),o=i.getTargetAddress(),s(o),e.next=6,t.getBlock({address:o});case 6:return(c=e.sent)&&s(l.isModel(c)),u=c&&c.config.isPublicChannelOpen,a("isConnectable: ",u),e.abrupt("return",u);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),storeConnection:function(){var e=i(r.mark((function e(n){var i,s,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,s=n.socket,a("storeConnection"),o=i.provenance.getAddress(),e.next=5,t.putSocket({address:o,socket:s});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}})}}},function(e,t,n){var r={id:"receive",initial:"idle",context:{socket:void 0,interblock:void 0,isPoolable:!1,isCatchupable:!1},strict:!0,states:{idle:{on:{RECEIVE_INTERBLOCK:{target:"isInitialConditions",actions:["assignInterblock","assignSocket"]}}},isInitialConditions:{invoke:{src:"isInitialConditions",onDone:[{target:"done",actions:"assignIsPoolable",cond:"isInitialConditions"},{target:"isAnyAffected"}]}},isAnyAffected:{invoke:{src:"isAnyAffected",onDone:[{target:"storeConnection",actions:"assignIsPoolable",cond:"isPoolable"},{target:"isConnectable",cond:"isConnectionAttempt"},{target:"done"}]}},storeConnection:{invoke:{src:"storeConnection",onDone:"done"}},isConnectable:{invoke:{src:"isConnectable",onDone:[{target:"storeConnection",actions:"assignIsPoolable",cond:"isConnectable"},{target:"done"}]}},done:{data:function(e){return{isPoolable:e.isPoolable,isCatchupable:e.isCatchupable}},type:"final"},error:{id:"error",type:"final"}}},i=Machine(r);e.exports={definition:r,machine:i}},function(e,t,n){var r=n(2),i=n(3),s=n(19),a=n(4),o=n(11)("interblock:config:transmit"),c=n(24),u=n(43).assign,l=n(23),p=l.interblockModel,h=l.blockModel,d=l.socketModel,f=l.txModel,v=l.addressModel,y=n(462).machine,g=n(50);e.exports={transmitConfig:function(e){var t=g.toFunctions(e);return y.withConfig({actions:{assignInterblock:u({interblock:function(e,t){var n=t.payload;return o("assignInterblock"),a(p.isModel(n)),n}}),assignBlock:u({block:function(e,t){var n=t.data.block;return a(h.isModel(n)),n}}),extendListeningTxs:u({listeningTxs:function(e,t){var n=e.interblock,r=e.listeningTxs;o("extendListeningTxs");var i=t.data.sockets;a(i.every(d.isModel));var c=n.getWithoutRemote(),u=i.map((function(e){return f.create(e,c)}));return[].concat(s(r),s(u))}}),extendTargetTxs:u({targetTxs:function(e,t){var n=e.interblock,r=e.targetTxs;o("assignTargetTxs");var i=t.data;a(i.every(d.isModel));var c=i.map((function(e){return f.create(e,n)}));return[].concat(s(r),s(c))}}),assignLineage:u({lineage:function(e,t){return t.data}}),assignSelfTarget:u({targetTxs:function(e){var t=e.targetTxs,n=e.interblock,r=d.create(),i=f.create(r,n),a=[].concat(s(t),[i]);return o("assignSelfTarget targetTxs length: ".concat(a.length)),a}}),extendLineageTxs:u({lineageTxs:function(e){var t=e.targetTxs,n=e.lineage;o("extendLineageTxs"),a(n.every(p.isModel)),a(n.every((function(e){return!e.getTargetAddress()})));var r=[];return t.forEach((function(e){n.forEach((function(t){a(f.isModel(e));var n=e.socket;a(d.isModel(n)),r.push(f.create(n,t))}))})),o("extendLineageTxs generated ".concat(r.length," extensions")),r}}),extendGenesisAttempt:u({targetTxs:function(e){var t=e.interblock,n=e.targetTxs;a(p.isModel(t)),a(t.isGenesisAttempt());var r=f.create(d.create(),t);return n=[].concat(s(n),[r])}}),removeListeningTxs:u({listeningTxs:function(e){var t=e.listeningTxs,n=e.targetTxs;o("removeListeningTxs");var r=n.map((function(e){return e.socket})),i=t.filter((function(e){var t=e.socket;return!r.some((function(e){return e.equals(t)}))}));return o("filter removed: ".concat(r.length-i.length)),i}}),mergeTransmissions:u({transmissions:function(e){var t=e.listeningTxs,n=e.targetTxs,r=e.lineageTxs;return[].concat(s(t),s(r),s(n))}})},guards:{isBlockFetched:function(e,t){return h.isModel(t.data.block)},isLineageInterblock:function(e){return!e.interblock.getRemote()},isConnectionResponse:function(e){return e.interblock.isConnectionResponse()},isConnectionResolve:function(e){return e.interblock.isConnectionResolve()},isGenesisAttempt:function(e){return e.interblock.isGenesisAttempt()},isOriginPresent:function(e,t){return t.data.isOriginPresent}},services:{fetchBlock:function(){var e=i(r.mark((function e(n){var i,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,a(p.isModel(i)),e.next=4,t.getBlock(i.provenance);case 4:return s=e.sent,a(h.isModel(s)),a(s.provenance.equals(i.provenance)),o("fetchBlock height: ".concat(s.provenance.height)),e.abrupt("return",{block:s});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchRemoteListeners:function(){var e=i(r.mark((function e(n){var i,u,l,f,v,y,g,m;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,u=n.block,a(p.isModel(i)),a(!i.getRemote()),a(h.isModel(u)),l=u.network,f=l.getResolvedAliases().map((function(e){var n=l[e].address;return t.getSockets(n)})),e.next=8,Promise.all(f);case 8:return v=e.sent,y=c.flatten(v),g=new Set(y),o("fetchListeningSockets length: ".concat(g.size)),m=s(g),a(m.every(d.isModel)),e.abrupt("return",{sockets:m});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchSelfListener:function(){var e=i(r.mark((function e(n){var i,s,c,u,l,f;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,s=n.block,a(p.isModel(i)),a(h.isModel(s)),c=s.network,u=c.getResolvedAliases().map((function(e){var n=c[e].address;return t.getIsPresent(n)})),e.next=7,Promise.race(u);case 7:return l=e.sent,o("fetchSelfListener: ".concat(l)),f=l?[d.create()]:[],e.abrupt("return",{sockets:f});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchRemoteTargets:function(){var e=i(r.mark((function e(n){var i,s,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,a(p.isModel(i)),s=i.getTargetAddress(),a(v.isModel(s)),e.next=6,t.getSockets(s);case 6:return c=e.sent,o("fetchTargetSockets length: ".concat(c.length)),e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchSelfTarget:function(){var e=i(r.mark((function e(n){var i,s,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,a(p.isModel(i)),s=i.getTargetAddress(),a(s),e.next=6,t.getIsPresent(s);case 6:return c=e.sent,o("fetchSelfTarget: ".concat(c)),e.abrupt("return",c?[d.create()]:[]);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchLineageToGenesis:function(){var e=i(r.mark((function e(n){var i,s,c,u;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,a(p.isModel(i)),0,o("fetchLineage from height: ".concat(0)),s=i.provenance,c={provenance:s,height:0},e.next=8,t.getLineage(c);case 8:return u=e.sent,o("fetchLineage length: ".concat(u.length)),e.abrupt("return",u);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),isOriginPresent:function(){var e=i(r.mark((function e(n){var i,s,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.interblock,a(p.isModel(i)),s=i.provenance.getAddress(),e.next=5,t.getIsPresent(s);case 5:return c=e.sent,o("isOriginPresent: ",c),e.abrupt("return",{isOriginPresent:c});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}})}}},function(e,t,n){var r={id:"transmit",initial:"idle",context:{interblock:void 0,listeningTxs:[],targetTxs:[],lineage:[],lineageTxs:[],transmissions:[]},strict:!0,states:{idle:{on:{TRANSMIT_INTERBLOCK:{target:"isLineageInterblock",actions:"assignInterblock"}}},done:{entry:["removeListeningTxs","mergeTransmissions"],data:function(e){return e.transmissions},type:"final"},isLineageInterblock:{always:[{target:"fetchLineageSockets",cond:"isLineageInterblock"},{target:"fetchTargetSockets"}]},fetchLineageSockets:{initial:"fetchBlock",states:{fetchBlock:{invoke:{src:"fetchBlock",onDone:[{target:"fetchListeners",actions:"assignBlock",cond:"isBlockFetched"},{target:"done"}]}},done:{type:"final"},fetchListeners:{type:"parallel",states:{fetchRemoteListeners:{initial:"promise",states:{promise:{invoke:{src:"fetchRemoteListeners",onDone:{target:"done",actions:"extendListeningTxs"}}},done:{type:"final"}}},fetchSelfListener:{initial:"promise",states:{promise:{invoke:{src:"fetchSelfListener",onDone:{target:"done",actions:"extendListeningTxs"}}},done:{type:"final"}}}},onDone:"done"}},onDone:"done"},fetchTargetSockets:{type:"parallel",states:{isGenesisAttempt:{initial:"isGenesisAttempt",states:{isGenesisAttempt:{always:[{target:"isOriginPresent",cond:"isGenesisAttempt"},{target:"done"}]},isOriginPresent:{invoke:{src:"isOriginPresent",onDone:[{target:"done",cond:"isOriginPresent",actions:"extendGenesisAttempt"},{target:"done"}]}},done:{type:"final"}}},fetchRemoteTargets:{initial:"promise",states:{promise:{invoke:{src:"fetchRemoteTargets",onDone:{target:"done",actions:"extendTargetTxs"}}},done:{type:"final"}}},fetchSelfTarget:{initial:"promise",states:{promise:{invoke:{src:"fetchSelfTarget",onDone:{target:"done",actions:"extendTargetTxs"}}},done:{type:"final"}}},addLineage:{initial:"isLineageRequired",states:{isLineageRequired:{always:[{target:"fetchLineageToGenesis",cond:"isConnectionResponse"},{target:"fetchLineageToGenesis",cond:"isConnectionResolve"},{target:"done"}]},fetchLineageToGenesis:{invoke:{src:"fetchLineageToGenesis",onDone:{target:"done",actions:"assignLineage"}}},done:{type:"final"}}}},onDone:{target:"done",actions:"extendLineageTxs"}}}},i=Machine(r);e.exports={definition:r,machine:i}},function(e,t,n){var r=n(2),i=n(3),s=n(33),a=n(8),o=n(28),c=n(4),u=n(102),l=u.isReplyFor,p=u.request,h=n(11)("interblock:effector:dispatchCovenant");e.exports=function(){var e=new Map,t=[],n=0,u=function(){var e=i(r.mark((function e(i){var s,o,c,u,l;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=i.type,o=i.payload,c=i.to,h("injector: %s id: %i to: %s",s,n,c),o=a({},o,{_dispatchId:n}),n++,u=p(s,o,c),l=d(u),t.push(u),e.next=9,Promise.resolve();case 9:return e.abrupt("return",l);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(t){var n={},r=new Promise((function(e,t){n.settled={resolve:e,reject:t}}));return r.pending=new Promise((function(e,t){n.pending={resolve:e,reject:t}})),e.set(t,n),r};return{injector:u,reducer:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;c(r,"must supply an action"),h("reducer: %o",r.type);var i,u=o(e);try{for(u.s();!(i=u.n()).done;){var p=s(i.value,2),d=p[0],f=p[1],v=f.pending,y=f.settled;if(l(r,d))switch(h("reply received: %j for: %j",r.type,d.type),v.resolve(),r.type){case"@@REJECT":y.reject(r.payload);break;case"@@PROMISE":throw new Error("Promises should never be seen by covenants");case"@@RESOLVE":y.resolve(r.payload),e.delete(d)}}}catch(m){u.e(m)}finally{u.f()}var g=[].concat(t);return t.length=0,a({},n,{actions:g})}}}},function(e,t,n){var r=n(2),i=n(3),s=n(23),a=s.blockModel,o=s.interblockModel,c=function(){var e=i(r.mark((function e(t,n){var i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(n),e.next=3,l(t);case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),u=function(){var e=i(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.create();case 2:n=e.sent,i=o.create(n),t.push(i);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(e){var t,n=new Promise((function(e){return t=e})),s=e.subscribe(function(){var e=i(r.mark((function e(n,i){var a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("UNLOCK"!==n.type){e.next=6;break}return a=n.payload.block,e.next=4,i;case 4:t(a.provenance.getAddress()),s();case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());return n};e.exports={createBase:c}},function(e,t,n){var r=n(4),i=n(24),s=(n(239),n(79),n(241)),a=n(242),o=a.blockPrint,c=a.interPrint,u=n(23),l=u.blockModel,p=u.interblockModel;e.exports={createTap:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"interblock:blocktap",t=!1,a=function(){return t=!0},u=function(){return t=!1},h=n(11)(e),d={},f=(s.gray("undefined"),h.extend("tran")),v=function(e){if(t){var n=m(e);f(n)}},y=h.extend("pool"),g=function(e){if(t){var n=m(e);y(n)}},m=function(e){r(p.isModel(e));var t=s.yellow("INTER_LIGHT"),n=s.gray(w(e,d));return e.getRemote()&&(t=s.yellow("INTER_HEAVY")),c(e,t,n,"bgYellow","yellow")},k=h.extend("bloc"),b=function(e){r(l.isModel(e));var n=e.provenance.getAddress().getChainId(),i=!d[n],s=d[n]&&d[n].some((function(t){return t.equals(e)}));if(x(e,d),t){var a=w(e,d),c=o(e,a,i,s);k(c)}},x=function(e,t){var n=e.provenance.getAddress().getChainId();t[n]||(t[n]=[]),t[n].some((function(t){return t.equals(e)}))||t[n].push(e)},w=function(e,t){if(!(e=i.last(t[e.provenance.getAddress().getChainId()])))return"(unknown)";for(var n=[],s=e,a=0;s&&a<10;){a++;var o=s.network[".."].address;if(o.isRoot())s=void 0,n.unshift("");else if(o.isUnknown())n.unshift("(unknown)"),s=void 0;else{var c=o.getChainId(),u=i.last(t[c]);r(l.isModel(u),"Hole in pedigree");var p=u.network.getAlias(s.provenance.getAddress());n.unshift(p),s=u}}a>=10&&debug("Path over loopCount");var h=n.join("/");return h||"/"};return{on:a,off:u,block:b,interblockTransmit:v,interblockPool:g}}}},,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var r=n(2),i=n(3),s=n(4),a=n(23),o=(a.blockModel,a.interblockModel,n(11)("interblock:transport")),c=n(489);e.exports={tcpTransportFactory:function(e){var t;return{connect:function(){var n=i(r.mark((function n(){return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s(!t),(t=new c(e)).on("message",(function(e){o("message: %O",e)})),t.on("close",(function(e){return o("close",e)})),t.on("error",(function(e){return o("error %O",e)})),t.on("ping",(function(e){return o("ping",e)})),t.on("pong",(function(e){return o("pong",e.toString())})),t.on("upgrade",(function(e){return o("upgrade")})),n.abrupt("return",new Promise((function(n,s){var a=function(){var e=i(r.mark((function e(n){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o("unexpectedResponse"),t.terminate(),s("unexpectedResponse");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t.on("open",(function(){o("socket open to ".concat(e)),t.removeListener("unexpected-response",a),n()})),t.on("unexpected-response",a)})));case 9:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),ping:function(){var e=i(r.mark((function e(){var n,i=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>0&&void 0!==i[0]?i[0]:"",o("ping: %O",n),e.abrupt("return",new Promise((function(e){var r=Date.now();t.ping(n),t.on("pong",(function(t){s.equal(t.toString(),n),e(Date.now()-r)}))})));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),pingLambda:function(){var e=i(r.mark((function e(){var n,i=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>0&&void 0!==i[0]?i[0]:"",o("pingLambda: %O",n),e.abrupt("return",new Promise((function(e){var r=Date.now();t.send("PING_LAMBDA ".concat(n)),t.on("message",(function(t){s.equal(t.toString(),"PONG_LAMBDA ".concat(n)),e(Date.now()-r)}))})));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),close:function(){var e=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.close(),e.abrupt("return",new Promise((function(e,n){t.on("close",e)})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),interblock:function(){var e=i(r.mark((function e(n){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:1,s.equal(t.readyState,1,"websocket not open"),t.send(n.serialize());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}}},,function(e,t,n){var r=n(2),i=n(8),s=n(3),a=n(122).metrologyFactory,o=n(101).hyper,c=function(){var e=s(r.mark((function e(){var t,n,s,c,u,l,p,h=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=h.length>0&&void 0!==h[0]?h[0]:"aws",n=h.length>1?h[1]:void 0,n=i({},n,{hyper:o}),e.next=5,a(t,n);case 5:return s=e.sent,c=s.getEngine(),u=c.sqsTx,l=c.sqsRx,p=s.getState().provenance.getAddress(),e.next=10,s.settle();case 10:return e.abrupt("return",{sqsTx:u,sqsRx:l,hyperAddress:p,engine:s});case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e.exports={awsFactory:c}},function(e,t,n){var r=n(2),i=n(3),s=n(168).effectorFactory,a=n(11)("interblock:browser"),o=n(492),c=function(){var e=i(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.config({name:"@dreamcatcher/interblock_".concat(t)}),a("loading browser module"),e.next=4,s("web");case 4:return n=e.sent,a("browser client ready"),e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();e.exports={browserFactory:c}},,function(e,t,n){(function(t){var r=n(2),i=n(3),s=n(21)("dos"),a=n(496),o=n(159).evaluate,c=n(160).withSpin,u=n(256);function l(e,t,n,r){return s("evalPrint"),r.evaluate=r.evaluate||c(o),u((function(){return r.evaluate(e,t,n)}))}e.exports=function(){var e=i(r.mark((function e(n){var i,o=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=o.length>1&&void 0!==o[1]?o[1]:{},s("argv",n),n=(n||t.argv).slice(2),s("argv",n),e.abrupt("return",n.length?l(ctx,n[0],n.slice(1),i):a(i));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}).call(this,n(10))},,,function(e,t,n){var r=n(2),i=n(19),s=n(497),a=n(3),o=n(21)("dos:repl"),c=n(244),u=n(117).effectorFactory,l=n(521).read,p=n(159).evaluate,h=n(603).withAutoComplete,d=n(160).withSpin,f=n(256),v=n(604),y=n(113);n(605)(0,80);function g(e){return m.apply(this,arguments)}function m(){return(m=a(r.mark((function e(t){var n,i,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.blockchain,t.evaluate,(i=c({spinner:"clock"}).start()).info("begining boot sequence Ctrl+C to cancel and drop to local shell"),i.text='checking for new app version on server "this webpage"',i.succeed("current build version: 0.0.0").start(),i.text='looking for previous chains under the domain "this webpage"',i.succeed("no previous chains found").start(),n||(i.text="Initializing blockchain...",n=u("console")),!n.then){e.next=12;break}return e.next=11,n;case 11:n=e.sent;case 12:return s=n.getState().getChainId(),i.succeed("Blockchain initialized with chainId: ".concat(s)).start(),i.text="connecting to mainnet...",e.next=17,new Promise((function(e){return setTimeout(e,700)}));case 17:return i.succeed("connection to mainnet established").start(),i.info("mainnet latency: 543 ms"),i.info("peer connection count: 1").start(),i.text="benchmarking local system",e.next=23,new Promise((function(e){return setTimeout(e,700)}));case 23:return i.succeed("local blockrate 23 blocks per second / 53 ms per block"),i.stop(),e.next=27,f('Welcome to the HyperNet\n  Blockchain core: v0.0.5\n  Terminal:        v0.0.12\n  type "help" to get started');case 27:return"root","local",i.stop(),e.abrupt("return",{user:"root",machineId:"local",blockchain:n});case 31:case"end":return e.stop()}}),e)})))).apply(this,arguments)}e.exports=function(){var e=a(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o("repl"),(t=t||{}).read=t.read||h(l),t.evaluate=t.evaluate||d(p),o("opts: ",Object.keys(t)),e.next=7,g(t);case 7:return n=e.sent,o("changing to home directory"),e.next=11,t.evaluate(n,"cd",[]);case 11:return e.abrupt("return",v(function(){var e=a(r.mark((function e(){var c,u,l,p,h;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.read(n);case 2:return c=e.sent,u=c.split(" ").filter(Boolean),l=s(u),p=l[0],h=l.slice(1),o("command: ",p,h),e.next=7,f(a(r.mark((function e(){var s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!k.includes(p)&&y[p]&&(h=[p].concat(i(h)),p="time"),e.next=3,t.evaluate(n,p,h);case 3:return(s=e.sent)&&s.ctx&&Object.assign(n,s.ctx),e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)}))));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var k=["time","clear","help"]},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var r=n(2),i=n(3),s=n(47).prompt,a=n(21)("dos:read"),o=n(39);t.read=function(){var e=i(r.mark((function e(t){var n,i,c,u,l,p,h,d,f;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.autoComplete,n=t.user,i=t.machineId,c=t.blockchain,u=c.getContext(),l=u.wd,p="".concat(o.green("".concat(n,"@").concat(i)),":").concat(o.blue(l),"$"),a("reading: ".concat(p)),h={type:"input",name:"result",message:p},e.next=8,s(h);case 8:return d=e.sent,f=d.result,a("prompt result: ",f),e.abrupt("return",f);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},,function(e,t,n){"use strict";(function(t,r){var i=n(19),s=n(8),a=n(524),o=n(525),c=/^(?:\x1b)([a-zA-Z0-9])$/,u=/^(?:\x1b+)(O|N|\[|\[\[)(?:(\d+)(?:;(\d+))?([~^$])|(?:1;)?(\d+)?([a-zA-Z]))/,l={OP:"f1",OQ:"f2",OR:"f3",OS:"f4","[11~":"f1","[12~":"f2","[13~":"f3","[14~":"f4","[[A":"f1","[[B":"f2","[[C":"f3","[[D":"f4","[[E":"f5","[15~":"f5","[17~":"f6","[18~":"f7","[19~":"f8","[20~":"f9","[21~":"f10","[23~":"f11","[24~":"f12","[A":"up","[B":"down","[C":"right","[D":"left","[E":"clear","[F":"end","[H":"home",OA:"up",OB:"down",OC:"right",OD:"left",OE:"clear",OF:"end",OH:"home","[1~":"home","[2~":"insert","[3~":"delete","[4~":"end","[5~":"pageup","[6~":"pagedown","[[5~":"pageup","[[6~":"pagedown","[7~":"home","[8~":"end","[a":"up","[b":"down","[c":"right","[d":"left","[e":"clear","[2$":"insert","[3$":"delete","[5$":"pageup","[6$":"pagedown","[7$":"home","[8$":"end",Oa:"up",Ob:"down",Oc:"right",Od:"left",Oe:"clear","[2^":"insert","[3^":"delete","[5^":"pageup","[6^":"pagedown","[7^":"home","[8^":"end","[Z":"tab"};function p(e){return["[a","[b","[c","[d","[e","[2$","[3$","[5$","[6$","[7$","[8$","[Z"].includes(e)}function h(e){return["Oa","Ob","Oc","Od","Oe","[2^","[3^","[5^","[6^","[7^","[8^"].includes(e)}var d=function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=s({name:r.name,ctrl:!1,meta:!1,shift:!1,option:!1,sequence:n,raw:n},r);if(t.isBuffer(n)?n[0]>127&&void 0===n[1]?(n[0]-=128,n="\x1b"+String(n)):n=String(n):void 0!==n&&"string"!==typeof n?n=String(n):n||(n=a.sequence||""),a.sequence=a.sequence||n||a.name,"\r"===n)a.raw=void 0,a.name="return";else if("\n"===n)a.name="enter";else if("\t"===n)a.name="tab";else if("\b"===n||"\x7f"===n||"\x1b\x7f"===n||"\x1b\b"===n)a.name="backspace",a.meta="\x1b"===n.charAt(0);else if("\x1b"===n||"\x1b\x1b"===n)a.name="escape",a.meta=2===n.length;else if(" "===n||"\x1b "===n)a.name="space",a.meta=2===n.length;else if(n<="\x1a")a.name=String.fromCharCode(n.charCodeAt(0)+"a".charCodeAt(0)-1),a.ctrl=!0;else if(1===n.length&&n>="0"&&n<="9")a.name="number";else if(1===n.length&&n>="a"&&n<="z")a.name=n;else if(1===n.length&&n>="A"&&n<="Z")a.name=n.toLowerCase(),a.shift=!0;else if(e=c.exec(n))a.meta=!0,a.shift=/^[A-Z]$/.test(e[1]);else if(e=u.exec(n)){var o=i(n);"\x1b"===o[0]&&"\x1b"===o[1]&&(a.option=!0);var d=[e[1],e[2],e[4],e[6]].filter(Boolean).join(""),f=(e[3]||e[5]||1)-1;a.ctrl=!!(4&f),a.meta=!!(10&f),a.shift=!!(1&f),a.code=d,a.name=l[d],a.shift=p(d)||a.shift,a.ctrl=h(d)||a.ctrl}return a};d.listen=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=e.stdin;if(!n||n!==r.stdin&&!n.isTTY)throw new Error("Invalid stream passed");a(n);var i=function(e,n){return t(e,d(e,n))},s=n.isRaw;n.isTTY&&n.setRawMode(!0),n.on("keypress",i),n.resume();var o=function(){n.isTTY&&n.setRawMode(s),n.removeListener("keypress",i),n.emit("close")};return o},d.action=function(e,t,n){var r=s({},o,{},n);return t.ctrl?(t.action=r.ctrl[t.name],t):t.option&&r.option?(t.action=r.option[t.name],t):t.shift?(t.action=r.shift[t.name],t):(t.action=r.keys[t.name],t)},e.exports=d}).call(this,n(7).Buffer,n(10))},,function(e,t,n){"use strict";t.ctrl={a:"first",b:"backward",c:"cancel",d:"deleteForward",e:"last",f:"forward",g:"reset",i:"tab",k:"cutForward",l:"reset",n:"newItem",m:"cancel",j:"submit",p:"search",r:"remove",s:"save",u:"undo",w:"cutLeft",x:"toggleCursor",v:"paste"},t.shift={up:"shiftUp",down:"shiftDown",left:"shiftLeft",right:"shiftRight",tab:"prev"},t.fn={up:"pageUp",down:"pageDown",left:"pageLeft",right:"pageRight",delete:"deleteForward"},t.option={b:"backward",f:"forward",d:"cutRight",left:"cutLeft",up:"altUp",down:"altDown"},t.keys={pageup:"pageUp",pagedown:"pageDown",home:"home",end:"end",cancel:"cancel",delete:"deleteForward",backspace:"delete",down:"down",enter:"submit",escape:"cancel",left:"left",space:"space",number:"number",return:"submit",right:"right",tab:"next",up:"up"}},function(e,t,n){"use strict";function r(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.timers[t]={name:t,start:Date.now(),ms:0,tick:0},i=n.interval||120;r.frames=n.frames||[],r.loading=!0;var s=setInterval((function(){r.ms=Date.now()-r.start,r.tick++,e.render()}),i);return r.stop=function(){r.loading=!1,clearInterval(s)},Reflect.defineProperty(r,"interval",{value:s}),e.once("close",(function(){return r.stop()})),r.stop}e.exports=function(e){e.timers=e.timers||{};var t=e.options.timers;if(t)for(var n=0,i=Object.keys(t);n<i.length;n++){var s=i[n],a=t[s];"number"===typeof a&&(a={interval:a}),r(e,s,a)}}},function(e,t,n){"use strict";(function(t,r){var i=n(8),s=n(9),a=n(12),o=n(32),c=o.define,u=o.width,l=function(){function e(n){s(this,e);var r=n.options;c(this,"_prompt",n),this.type=n.type,this.name=n.name,this.message="",this.header="",this.footer="",this.error="",this.hint="",this.input="",this.cursor=0,this.index=0,this.lines=0,this.tick=0,this.prompt="",this.buffer="",this.width=u(r.stdout||t.stdout),Object.assign(this,r),this.name=this.name||this.message,this.message=this.message||this.name,this.symbols=n.symbols,this.styles=n.styles,this.required=new Set,this.cancelled=!1,this.submitted=!1}return a(e,[{key:"clone",value:function(){var e=i({},this);return e.status=this.status,e.buffer=r.from(e.buffer),delete e.clone,e}},{key:"color",set:function(e){this._color=e},get:function(){var e=this.prompt.styles;if(this.cancelled)return e.cancelled;if(this.submitted)return e.submitted;var t=this._color||e[this.status];return"function"===typeof t?t:e.pending}},{key:"loading",set:function(e){this._loading=e},get:function(){return"boolean"===typeof this._loading?this._loading:!!this.loadingChoices&&"choices"}},{key:"status",get:function(){return this.cancelled?"cancelled":this.submitted?"submitted":"pending"}}]),e}();e.exports=l}).call(this,n(10),n(7).Buffer)},function(e,t,n){"use strict";var r=n(529),i=n(530),s=n(32);e.exports=function(e){e.options=s.merge({},e.options.theme,e.options),e.symbols=i.merge(e.options),e.styles=r.merge(e.options)}},function(e,t,n){"use strict";var r=n(32),i=n(42),s={default:i.noop,noop:i.noop,set inverse(e){this._inverse=e},get inverse(){return this._inverse||r.inverse(this.primary)},set complement(e){this._complement=e},get complement(){return this._complement||r.complement(this.primary)},primary:i.cyan,success:i.green,danger:i.magenta,strong:i.bold,warning:i.yellow,muted:i.dim,disabled:i.gray,dark:i.dim.gray,underline:i.underline,set info(e){this._info=e},get info(){return this._info||this.primary},set em(e){this._em=e},get em(){return this._em||this.primary.underline},set heading(e){this._heading=e},get heading(){return this._heading||this.muted.underline},set pending(e){this._pending=e},get pending(){return this._pending||this.primary},set submitted(e){this._submitted=e},get submitted(){return this._submitted||this.success},set cancelled(e){this._cancelled=e},get cancelled(){return this._cancelled||this.danger},set typing(e){this._typing=e},get typing(){return this._typing||this.dim},set placeholder(e){this._placeholder=e},get placeholder(){return this._placeholder||this.primary.dim},set highlight(e){this._highlight=e},get highlight(){return this._highlight||this.inverse},merge:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.styles&&"boolean"===typeof e.styles.enabled&&(i.enabled=e.styles.enabled),e.styles&&"boolean"===typeof e.styles.visible&&(i.visible=e.styles.visible);var t=r.merge({},s,e.styles);delete t.merge;for(var n=function(){var e=o[a];t.hasOwnProperty(e)||Reflect.defineProperty(t,e,{get:function(){return i[e]}})},a=0,o=Object.keys(i);a<o.length;a++)n();for(var c=function(){var e=l[u];t.hasOwnProperty(e)||Reflect.defineProperty(t,e,{get:function(){return i[e]}})},u=0,l=Object.keys(i.styles);u<l.length;u++)c();return t}};e.exports=s},function(e,t,n){"use strict";(function(t){var r=n(8),i="win32"===t.platform,s=n(42),a=n(32),o=r({},s.symbols,{upDownDoubleArrow:"\u21d5",upDownDoubleArrow2:"\u2b0d",upDownArrow:"\u2195",asterisk:"*",asterism:"\u2042",bulletWhite:"\u25e6",electricArrow:"\u2301",ellipsisLarge:"\u22ef",ellipsisSmall:"\u2026",fullBlock:"\u2588",identicalTo:"\u2261",indicator:s.symbols.check,leftAngle:"\u2039",mark:"\u203b",minus:"\u2212",multiplication:"\xd7",obelus:"\xf7",percent:"%",pilcrow:"\xb6",pilcrow2:"\u2761",pencilUpRight:"\u2710",pencilDownRight:"\u270e",pencilRight:"\u270f",plus:"+",plusMinus:"\xb1",pointRight:"\u261e",rightAngle:"\u203a",section:"\xa7",hexagon:{off:"\u2b21",on:"\u2b22",disabled:"\u2b22"},ballot:{on:"\u2611",off:"\u2610",disabled:"\u2612"},stars:{on:"\u2605",off:"\u2606",disabled:"\u2606"},folder:{on:"\u25bc",off:"\u25b6",disabled:"\u25b6"},prefix:{pending:s.symbols.question,submitted:s.symbols.check,cancelled:s.symbols.cross},separator:{pending:s.symbols.pointerSmall,submitted:s.symbols.middot,cancelled:s.symbols.middot},radio:{off:i?"( )":"\u25ef",on:i?"(*)":"\u25c9",disabled:i?"(|)":"\u24be"},numbers:["\u24ea","\u2460","\u2461","\u2462","\u2463","\u2464","\u2465","\u2466","\u2467","\u2468","\u2469","\u246a","\u246b","\u246c","\u246d","\u246e","\u246f","\u2470","\u2471","\u2472","\u2473","\u3251","\u3252","\u3253","\u3254","\u3255","\u3256","\u3257","\u3258","\u3259","\u325a","\u325b","\u325c","\u325d","\u325e","\u325f","\u32b1","\u32b2","\u32b3","\u32b4","\u32b5","\u32b6","\u32b7","\u32b8","\u32b9","\u32ba","\u32bb","\u32bc","\u32bd","\u32be","\u32bf"]});o.merge=function(e){var t=a.merge({},s.symbols,o,e.symbols);return delete t.merge,t},e.exports=o}).call(this,n(10))},function(e,t,n){"use strict";(function(r){var i=n(28),s=n(19),a="Apple_Terminal"===Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).TERM_PROGRAM,o=n(42),c=n(32),u=e.exports=t,l="\x1b[",p=!1,h=u.code={bell:"\x07",beep:"\x07",beginning:"".concat(l,"G"),down:"".concat(l,"J"),esc:l,getPosition:"".concat(l,"6n"),hide:"".concat(l,"?25l"),line:"".concat(l,"2K"),lineEnd:"".concat(l,"K"),lineStart:"".concat(l,"1K"),restorePosition:l+(a?"8":"u"),savePosition:l+(a?"7":"s"),screen:"".concat(l,"2J"),show:"".concat(l,"?25h"),up:"".concat(l,"1J")},d=u.cursor={get hidden(){return p},hide:function(){return p=!0,h.hide},show:function(){return p=!1,h.show},forward:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"".concat(l).concat(e,"C")},backward:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"".concat(l).concat(e,"D")},nextLine:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"".concat(l,"E").repeat(e)},prevLine:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"".concat(l,"F").repeat(e)},up:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return e?"".concat(l).concat(e,"A"):""},down:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return e?"".concat(l).concat(e,"B"):""},right:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return e?"".concat(l).concat(e,"C"):""},left:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return e?"".concat(l).concat(e,"D"):""},to:function(e,t){return t?"".concat(l).concat(t+1,";").concat(e+1,"H"):"".concat(l).concat(e+1,"G")},move:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n="";return n+=e<0?d.left(-e):e>0?d.right(e):"",n+=t<0?d.up(-t):t>0?d.down(t):""},restore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.after,n=e.cursor,r=e.initial,i=e.input,s=e.prompt,a=e.size,o=e.value;if(r=c.isPrimitive(r)?String(r):"",i=c.isPrimitive(i)?String(i):"",o=c.isPrimitive(o)?String(o):"",a){var l=u.cursor.up(a)+u.cursor.to(s.length),p=i.length-n;return p>0&&(l+=u.cursor.left(p)),l}if(o||t){var h=!i&&r?-r.length:-i.length+n;return t&&(h-=t.length),""===i&&r&&!s.includes(r)&&(h+=r.length),u.cursor.move(h)}}},f=u.erase={screen:h.screen,up:h.up,down:h.down,line:h.line,lineEnd:h.lineEnd,lineStart:h.lineStart,lines:function(e){for(var t="",n=0;n<e;n++)t+=u.erase.line+(n<e-1?u.cursor.up(1):"");return e&&(t+=u.code.beginning),t}};u.clear=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.stdout.columns;if(!t)return f.line+d.to(0);var n,a=function(e){return s(o.unstyle(e)).length},c=e.split(/\r?\n/),u=0,l=i(c);try{for(l.s();!(n=l.n()).done;){var p=n.value;u+=1+Math.floor(Math.max(a(p)-1,0)/t)}}catch(h){l.e(h)}finally{l.f()}return(f.line+d.prevLine()).repeat(u-1)+f.line+d.to(0)}}).call(this,n(10))},function(e,t,n){"use strict";var r=n(32),i=function(e,n){r.defineExport(t,e,n),r.defineExport(t,e.toLowerCase(),n)};i("AutoComplete",(function(){return n(533)})),i("BasicAuth",(function(){return n(535)})),i("Confirm",(function(){return n(536)})),i("Editable",(function(){return n(537)})),i("Form",(function(){return n(157)})),i("Input",(function(){return n(250)})),i("Invisible",(function(){return n(539)})),i("List",(function(){return n(540)})),i("MultiSelect",(function(){return n(541)})),i("Numeral",(function(){return n(542)})),i("Password",(function(){return n(543)})),i("Scale",(function(){return n(544)})),i("Select",(function(){return n(56)})),i("Snippet",(function(){return n(545)})),i("Sort",(function(){return n(547)})),i("Survey",(function(){return n(548)})),i("Text",(function(){return n(549)})),i("Toggle",(function(){return n(550)})),i("Quiz",(function(){return n(551)}))},function(e,t,n){"use strict";var r=n(8),i=n(2),s=n(3),a=n(9),o=n(12),c=n(26),u=n(29),l=n(17),p=n(18),h=n(56),d=function(e,t){var n=e.toLowerCase();return function(e){var r=e.toLowerCase().indexOf(n),i=t(e.slice(r,r+n.length));return r>=0?e.slice(0,r)+i+e.slice(r+n.length):e}},f=function(e){p(n,e);var t=l(n);function n(e){var r;return a(this,n),(r=t.call(this,e)).cursorShow(),r}return o(n,[{key:"moveCursor",value:function(e){this.state.cursor+=e}},{key:"dispatch",value:function(e){return this.append(e)}},{key:"space",value:function(e){return this.options.multiple?u(c(n.prototype),"space",this).call(this,e):this.append(e)}},{key:"append",value:function(e){var t=this.state,n=t.cursor,r=t.input;return this.input=r.slice(0,n)+e+r.slice(n),this.moveCursor(1),this.complete()}},{key:"delete",value:function(){var e=this.state,t=e.cursor,n=e.input;return n?(this.input=n.slice(0,t-1)+n.slice(t),this.moveCursor(-1),this.complete()):this.alert()}},{key:"deleteForward",value:function(){var e=this.state,t=e.cursor,n=e.input;return void 0===n[t]?this.alert():(this.input="".concat(n).slice(0,t)+"".concat(n).slice(t+1),this.complete())}},{key:"number",value:function(e){return this.append(e)}},{key:"complete",value:function(){var e=s(i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.completing=!0,e.next=3,this.suggest(this.input,this.state._choices);case 3:return this.choices=e.sent,this.state.limit=void 0,this.index=Math.min(Math.max(this.visible.length-1,0),this.index),e.next=8,this.render();case 8:this.completing=!1;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"suggest",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.input,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state._choices;if("function"===typeof this.options.suggest)return this.options.suggest.call(this,e,t);var n=e.toLowerCase();return t.filter((function(e){return e.message.toLowerCase().includes(n)}))}},{key:"pointer",value:function(){return""}},{key:"format",value:function(){var e=this;if(!this.focused)return this.input;if(this.options.multiple&&this.state.submitted)return this.selected.map((function(t){return e.styles.primary(t.message)})).join(", ");if(this.state.submitted){var t=this.value=this.input=this.focused.value;return this.styles.primary(t)}return this.input}},{key:"render",value:function(){var e=s(i.mark((function e(){var t,s,a;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("pending"===this.state.status){e.next=2;break}return e.abrupt("return",u(c(n.prototype),"render",this).call(this));case 2:return t=this.options.highlight?this.options.highlight.bind(this):this.styles.placeholder,s=d(this.input,t),a=this.choices,this.choices=a.map((function(e){return r({},e,{message:s(e.message)})})),e.next=8,u(c(n.prototype),"render",this).call(this);case 8:this.choices=a;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"submit",value:function(){return this.options.multiple&&(this.value=this.selected.map((function(e){return e.name}))),u(c(n.prototype),"submit",this).call(this)}}]),n}(h);e.exports=f},function(e,t,n){"use strict";var r=n(32),i={default:function(e,t){return t},checkbox:function(e,t){throw new Error("checkbox role is not implemented yet")},editable:function(e,t){throw new Error("editable role is not implemented yet")},expandable:function(e,t){throw new Error("expandable role is not implemented yet")},heading:function(e,t){return t.disabled="",t.indicator=[t.indicator," "].find((function(e){return null!=e})),t.message=t.message||"",t},input:function(e,t){throw new Error("input role is not implemented yet")},option:function(e,t){return i.default(e,t)},radio:function(e,t){throw new Error("radio role is not implemented yet")},separator:function(e,t){return t.disabled="",t.indicator=[t.indicator," "].find((function(e){return null!=e})),t.message=t.message||e.symbols.line.repeat(5),t},spacer:function(e,t){return t}};e.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.merge({},i,t.roles);return n[e]||n.default}},function(e,t,n){"use strict";var r=n(8),i=n(9),s=n(12),a=n(17),o=n(18),c=n(248);function u(e,t){return e.username===this.options.username&&e.password===this.options.password}e.exports=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,n=[{name:"username",message:"username"},{name:"password",message:"password",format:function(e){return this.options.showPassword?e:(this.state.submitted?this.styles.primary:this.styles.muted)(this.symbols.asterisk.repeat(e.length))}}],l=function(t){o(u,t);var c=a(u);function u(e){return i(this,u),c.call(this,r({},e,{choices:n}))}return s(u,null,[{key:"create",value:function(t){return e(t)}}]),u}(c.create(t));return l}()},function(e,t,n){"use strict";var r=n(9),i=n(17),s=n(18),a=function(e){s(n,e);var t=i(n);function n(e){var i;return r(this,n),(i=t.call(this,e)).default=i.options.default||(i.initial?"(Y/n)":"(y/N)"),i}return n}(n(158));e.exports=a},function(e,t,n){"use strict";var r=n(28),i=n(2),s=n(3),a=n(8),o=n(9),c=n(12),u=n(26),l=n(29),p=n(17),h=n(18),d=n(56),f=n(157).prototype,v=function(e){h(n,e);var t=p(n);function n(e){var r;return o(this,n),(r=t.call(this,a({},e,{multiple:!0}))).align=[r.options.align,"left"].find((function(e){return null!=e})),r.emptyError="",r.values={},r}return c(n,[{key:"dispatch",value:function(e,t){var r=this.focused,i=r.parent||{};return r.editable||i.editable||"a"!==e&&"i"!==e?f.dispatch.call(this,e,t):l(u(n.prototype),e,this).call(this)}},{key:"append",value:function(e,t){return f.append.call(this,e,t)}},{key:"delete",value:function(e,t){return f.delete.call(this,e,t)}},{key:"space",value:function(e){return this.focused.editable?this.append(e):l(u(n.prototype),"space",this).call(this)}},{key:"number",value:function(e){return this.focused.editable?this.append(e):l(u(n.prototype),"number",this).call(this,e)}},{key:"next",value:function(){return this.focused.editable?f.next.call(this):l(u(n.prototype),"next",this).call(this)}},{key:"prev",value:function(){return this.focused.editable?f.prev.call(this):l(u(n.prototype),"prev",this).call(this)}},{key:"indicator",value:function(){var e=s(i.mark((function e(t,r){var s,a;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.indicator||"",a=t.editable?s:l(u(n.prototype),"indicator",this).call(this,t,r),e.next=4,this.resolve(a,this.state,t,r);case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0="";case 7:return e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"indent",value:function(e){return"heading"===e.role?"":e.editable?" ":"  "}},{key:"renderChoice",value:function(){var e=s(i.mark((function e(t,r){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.indent="",!t.editable){e.next=3;break}return e.abrupt("return",f.renderChoice.call(this,t,r));case 3:return e.abrupt("return",l(u(n.prototype),"renderChoice",this).call(this,t,r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"error",value:function(){return""}},{key:"footer",value:function(){return this.state.error}},{key:"validate",value:function(){var e=s(i.mark((function e(){var t,n,s,a,o;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,n=r(this.choices),e.prev=2,n.s();case 4:if((s=n.n()).done){e.next=19;break}if("function"===typeof(a=s.value).validate){e.next=8;break}return e.abrupt("continue",17);case 8:if("heading"!==a.role){e.next=10;break}return e.abrupt("continue",17);case 10:return o=a.parent?this.value[a.parent.name]:this.value,a.editable?o=a.value===a.name?a.initial||"":a.value:this.isDisabled(a)||(o=!0===a.enabled),e.next=14,a.validate(o,this.state);case 14:if(!0===(t=e.sent)){e.next=17;break}return e.abrupt("break",19);case 17:e.next=4;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(2),n.e(e.t0);case 24:return e.prev=24,n.f(),e.finish(24);case 27:return!0!==t&&(this.state.error="string"===typeof t?t:"Invalid Input"),e.abrupt("return",t);case 29:case"end":return e.stop()}}),e,this,[[2,21,24,27]])})));return function(){return e.apply(this,arguments)}}()},{key:"submit",value:function(){if(!0===this.focused.newChoice)return l(u(n.prototype),"submit",this).call(this);if(this.choices.some((function(e){return e.newChoice})))return this.alert();this.value={};var e,t=r(this.choices);try{for(t.s();!(e=t.n()).done;){var i=e.value,s=i.parent?this.value[i.parent.name]:this.value;"heading"!==i.role?i.editable?s[i.name]=i.value===i.name?i.initial||"":i.value:this.isDisabled(i)||(s[i.name]=!0===i.enabled):this.value[i.name]={}}}catch(a){t.e(a)}finally{t.f()}return this.base.submit.call(this)}}]),n}(d);e.exports=v},function(e,t,n){"use strict";var r=n(19),i=function(e){return function(e){return e.filter((function(t,n){return e.lastIndexOf(t)===n}))}(e).filter(Boolean)};e.exports=function(e){var t,n,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=s.past,c=void 0===o?[]:o,u=s.present,l=void 0===u?"":u;switch(e){case"prev":case"undo":return t=c.slice(0,c.length-1),n=c[c.length-1]||"",{past:i([a].concat(r(t))),present:n};case"next":case"redo":return t=c.slice(1),n=c[0]||"",{past:i([].concat(r(t),[a])),present:n};case"save":return{past:i([].concat(r(c),[a])),present:""};case"remove":return l="",(n=i(c.filter((function(e){return e!==a})))).length&&(l=n.pop()),{past:n,present:l};default:throw new Error('Invalid action: "'.concat(e,'"'))}}},function(e,t,n){"use strict";var r=n(9),i=n(12),s=n(17),a=n(18),o=function(e){a(n,e);var t=s(n);function n(){return r(this,n),t.apply(this,arguments)}return i(n,[{key:"format",value:function(){return""}}]),n}(n(67));e.exports=o},function(e,t,n){"use strict";var r=n(2),i=n(3),s=n(9),a=n(12),o=n(26),c=n(29),u=n(17),l=n(18),p=function(e){l(n,e);var t=u(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s(this,n),(e=t.call(this,r)).sep=e.options.separator||/, */,e.initial=r.initial||"",e}return a(n,[{key:"split",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.value;return e?String(e).split(this.sep):[]}},{key:"format",value:function(){var e=this.state.submitted?this.styles.primary:function(e){return e};return this.list.map(e).join(", ")}},{key:"submit",value:function(){var e=i(r.mark((function e(t){var i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.state.error,e.t0){e.next=5;break}return e.next=4,this.validate(this.list,this.state);case 4:e.t0=e.sent;case 5:if(!0===(i=e.t0)){e.next=9;break}return this.state.error=i,e.abrupt("return",c(o(n.prototype),"submit",this).call(this));case 9:return this.value=this.list,e.abrupt("return",c(o(n.prototype),"submit",this).call(this));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"list",get:function(){return this.split()}}]),n}(n(67));e.exports=p},function(e,t,n){"use strict";var r=n(8),i=n(9),s=n(17),a=n(18),o=function(e){a(n,e);var t=s(n);function n(e){return i(this,n),t.call(this,r({},e,{multiple:!0}))}return n}(n(56));e.exports=o},function(e,t,n){e.exports=n(251)},function(e,t,n){"use strict";var r=n(9),i=n(12),s=n(17),a=n(18),o=function(e){a(n,e);var t=s(n);function n(e){var i;return r(this,n),(i=t.call(this,e)).cursorShow(),i}return i(n,[{key:"format",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.input;if(!this.keypressed)return"";var t=this.state.submitted?this.styles.primary:this.styles.muted;return t(this.symbols.asterisk.repeat(e.length))}}]),n}(n(67));e.exports=o},function(e,t,n){"use strict";var r=n(19),i=n(28),s=n(2),a=n(3),o=n(9),c=n(12),u=n(26),l=n(29),p=n(17),h=n(18),d=n(42),f=n(112),v=n(32),y=function(e){h(n,e);var t=p(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,n),(e=t.call(this,r)).widths=[].concat(r.messageWidth||50),e.align=[].concat(r.align||"left"),e.linebreak=r.linebreak||!1,e.edgeLength=r.edgeLength||3,e.newline=r.newline||"\n   ";var i=r.startNumber||1;return"number"===typeof e.scale&&(e.scaleKey=!1,e.scale=Array(e.scale).fill(0).map((function(e,t){return{name:t+i}}))),e}return c(n,[{key:"reset",value:function(){var e=a(s.mark((function e(){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.tableized=!1,e.next=3,l(u(n.prototype),"reset",this).call(this);case 3:return e.abrupt("return",this.render());case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"tableize",value:function(){if(!0!==this.tableized){this.tableized=!0;var e,t=0,n=i(this.choices);try{for(n.s();!(e=n.n()).done;){var r=e.value;t=Math.max(t,r.message.length),r.scaleIndex=r.initial||2,r.scale=[];for(var s=0;s<this.scale.length;s++)r.scale.push({index:s})}}catch(a){n.e(a)}finally{n.f()}this.widths[0]=Math.min(this.widths[0],t+3)}}},{key:"dispatch",value:function(){var e=a(s.mark((function e(t,r){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.multiple){e.next=11;break}if(!this[r.name]){e.next=7;break}return e.next=4,this[r.name](t,r);case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,l(u(n.prototype),"dispatch",this).call(this,t,r);case 9:e.t0=e.sent;case 10:return e.abrupt("return",e.t0);case 11:this.alert();case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"heading",value:function(e,t,n){return this.styles.strong(e)}},{key:"separator",value:function(){return this.styles.muted(this.symbols.ellipsis)}},{key:"right",value:function(){var e=this.focused;return e.scaleIndex>=this.scale.length-1?this.alert():(e.scaleIndex++,this.render())}},{key:"left",value:function(){var e=this.focused;return e.scaleIndex<=0?this.alert():(e.scaleIndex--,this.render())}},{key:"indent",value:function(){return""}},{key:"format",value:function(){var e=this;return this.state.submitted?this.choices.map((function(t){return e.styles.info(t.index)})).join(", "):""}},{key:"pointer",value:function(){return""}},{key:"renderScaleKey",value:function(){var e=this;if(!1===this.scaleKey)return"";if(this.state.submitted)return"";var t=this.scale.map((function(e){return"   ".concat(e.name," - ").concat(e.message)}));return[""].concat(r(t)).map((function(t){return e.styles.muted(t)})).join("\n")}},{key:"renderScaleHeading",value:function(e){var t=this,n=this.scale.map((function(e){return e.name}));"function"===typeof this.options.renderScaleHeading&&(n=this.options.renderScaleHeading.call(this,e));var r=this.scaleLength-n.join("").length,i=Math.round(r/(n.length-1)),s=n.map((function(e){return t.styles.strong(e)})).join(" ".repeat(i)),a=" ".repeat(this.widths[0]);return this.margin[3]+a+this.margin[1]+s}},{key:"scaleIndicator",value:function(e,t,n){if("function"===typeof this.options.scaleIndicator)return this.options.scaleIndicator.call(this,e,t,n);var r=e.scaleIndex===t.index;return t.disabled?this.styles.hint(this.symbols.radio.disabled):r?this.styles.success(this.symbols.radio.on):this.symbols.radio.off}},{key:"renderScale",value:function(e,t){var n=this,r=e.scale.map((function(r){return n.scaleIndicator(e,r,t)})),i="Hyper"===this.term?"":" ";return r.join(i+this.symbols.line.repeat(this.edgeLength))}},{key:"renderChoice",value:function(){var e=a(s.mark((function e(t,n){var r,i,a,o,c,u,l,p,h,f,y,g=this;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onChoice(t,n);case 2:return r=this.index===n,e.next=5,this.pointer(t,n);case 5:return i=e.sent,e.next=8,t.hint;case 8:return(a=e.sent)&&!v.hasColor(a)&&(a=this.styles.muted(a)),o=function(e){return g.margin[3]+e.replace(/\s+$/,"").padEnd(g.widths[0]," ")},c=this.newline,u=this.indent(t),e.next=15,this.resolve(t.message,this.state,t,n);case 15:return l=e.sent,e.next=18,this.renderScale(t,n);case 18:return p=e.sent,h=this.margin[1]+this.margin[3],this.scaleLength=d.unstyle(p).length,this.widths[0]=Math.min(this.widths[0],this.width-this.scaleLength-h.length),f=v.wordWrap(l,{width:this.widths[0],newline:c}),y=f.split("\n").map((function(e){return o(e)+g.margin[1]})),r&&(p=this.styles.info(p),y=y.map((function(e){return g.styles.info(e)}))),y[0]+=p,this.linebreak&&y.push(""),e.abrupt("return",[u+i,y.join("\n")].filter(Boolean));case 28:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"renderChoices",value:function(){var e=a(s.mark((function e(){var t,n,i,o=this;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.submitted){e.next=2;break}return e.abrupt("return","");case 2:return this.tableize(),t=this.visible.map(function(){var e=a(s.mark((function e(t,n){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.renderChoice(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),e.next=6,Promise.all(t);case 6:return n=e.sent,e.next=9,this.renderScaleHeading();case 9:return i=e.sent,e.abrupt("return",this.margin[0]+[i].concat(r(n.map((function(e){return e.join(" ")})))).join("\n"));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=a(s.mark((function e(){var t,n,r,i,a,o,c,u,l,p,h,d,f,v;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.submitted,r=t.size,e.next=3,this.prefix();case 3:return i=e.sent,e.next=6,this.separator();case 6:return a=e.sent,e.next=9,this.message();case 9:return o=e.sent,c="",!1!==this.options.promptLine&&(c=[i,o,a,""].join(" "),this.state.prompt=c),e.next=14,this.header();case 14:return u=e.sent,e.next=17,this.format();case 17:return l=e.sent,e.next=20,this.renderScaleKey();case 20:return p=e.sent,e.next=23,this.error();case 23:if(e.t0=e.sent,e.t0){e.next=28;break}return e.next=27,this.hint();case 27:e.t0=e.sent;case 28:return h=e.t0,e.next=31,this.renderChoices();case 31:return d=e.sent,e.next=34,this.footer();case 34:f=e.sent,v=this.emptyError,l&&(c+=l),h&&!c.includes(h)&&(c+=" "+h),n&&!l&&!d.trim()&&this.multiple&&null!=v&&(c+=this.styles.danger(v)),this.clear(r),this.write([u,c,p,d,f].filter(Boolean).join("\n")),this.state.submitted||this.write(this.margin[2]),this.restore();case 43:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"submit",value:function(){this.value={};var e,t=i(this.choices);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.value[n.name]=n.scaleIndex}}catch(r){t.e(r)}finally{t.f()}return this.base.submit.call(this)}}]),n}(f);e.exports=y},function(e,t,n){"use strict";var r=n(19),i=n(33),s=n(28),a=n(2),o=n(3),c=n(9),u=n(12),l=n(26),p=n(29),h=n(17),d=n(18),f=n(42),v=n(546),y=function(e){d(n,e);var t=h(n);function n(e){var r;return c(this,n),(r=t.call(this,e)).cursorHide(),r.reset(!0),r}return u(n,[{key:"initialize",value:function(){var e=o(a.mark((function e(){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(this);case 2:return this.interpolate=e.sent,e.next=5,p(l(n.prototype),"initialize",this).call(this);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reset",value:function(){var e=o(a.mark((function e(t){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.keys=[],this.state.invalid=new Map,this.state.missing=new Set,this.state.completed=0,this.state.values={},!0===t){e.next=10;break}return e.next=8,this.initialize();case 8:return e.next=10,this.render();case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"moveCursor",value:function(e){var t=this.getItem();this.cursor+=e,t.cursor+=e}},{key:"dispatch",value:function(e,t){t.code||t.ctrl||null==e||!this.getItem()?this.alert():this.append(e,t)}},{key:"append",value:function(e,t){var n=this.getItem(),r=n.input.slice(0,this.cursor),i=n.input.slice(this.cursor);this.input=n.input="".concat(r).concat(e).concat(i),this.moveCursor(1),this.render()}},{key:"delete",value:function(){var e=this.getItem();if(this.cursor<=0||!e.input)return this.alert();var t=e.input.slice(this.cursor),n=e.input.slice(0,this.cursor-1);this.input=e.input="".concat(n).concat(t),this.moveCursor(-1),this.render()}},{key:"increment",value:function(e){return e>=this.state.keys.length-1?0:e+1}},{key:"decrement",value:function(e){return e<=0?this.state.keys.length-1:e-1}},{key:"first",value:function(){this.state.index=0,this.render()}},{key:"last",value:function(){this.state.index=this.state.keys.length-1,this.render()}},{key:"right",value:function(){if(this.cursor>=this.input.length)return this.alert();this.moveCursor(1),this.render()}},{key:"left",value:function(){if(this.cursor<=0)return this.alert();this.moveCursor(-1),this.render()}},{key:"prev",value:function(){this.state.index=this.decrement(this.state.index),this.getItem(),this.render()}},{key:"next",value:function(){this.state.index=this.increment(this.state.index),this.getItem(),this.render()}},{key:"up",value:function(){this.prev()}},{key:"down",value:function(){this.next()}},{key:"format",value:function(e){var t=this.state.completed<100?this.styles.warning:this.styles.success;return!0===this.state.submitted&&100!==this.state.completed&&(t=this.styles.danger),t("".concat(this.state.completed,"% completed"))}},{key:"render",value:function(){var e=o(a.mark((function e(){var t,n,r,i,s,o,c,u,l,p,h,d,f,v,y,g,m,k,b;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.index,r=t.keys,i=void 0===r?[]:r,s=t.submitted,o=t.size,c=[this.options.newline,"\n"].find((function(e){return null!=e})),e.next=4,this.prefix();case 4:return u=e.sent,e.next=7,this.separator();case 7:return l=e.sent,e.next=10,this.message();case 10:return p=e.sent,h=[u,p,l].filter(Boolean).join(" "),this.state.prompt=h,e.next=15,this.header();case 15:return d=e.sent,e.next=18,this.error();case 18:if(e.t0=e.sent,e.t0){e.next=21;break}e.t0="";case 21:return f=e.t0,e.next=24,this.hint();case 24:if(e.t1=e.sent,e.t1){e.next=27;break}e.t1="";case 27:if(v=e.t1,!s){e.next=32;break}e.t2="",e.next=35;break;case 32:return e.next=34,this.interpolate(this.state);case 34:e.t2=e.sent;case 35:return y=e.t2,g=this.state.key=i[n]||"",e.next=39,this.format(g);case 39:return m=e.sent,e.next=42,this.footer();case 42:k=e.sent,m&&(h+=" "+m),v&&!m&&0===this.state.completed&&(h+=" "+v),this.clear(o),b=[d,h,y,k,f.trim()],this.write(b.filter(Boolean).join(c)),this.restore();case 49:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getItem",value:function(e){var t=this.state,n=t.items,r=t.keys,i=t.index,s=n.find((function(e){return e.name===r[i]}));return s&&null!=s.input&&(this.input=s.input,this.cursor=s.cursor),s}},{key:"submit",value:function(){var e=o(a.mark((function e(){var t,o,c,u,h,d,v,y,g,m,k,b,x;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"===typeof this.interpolate){e.next=3;break}return e.next=3,this.initialize();case 3:return e.next=5,this.interpolate(this.state,!0);case 5:if(t=this.state,o=t.invalid,c=t.missing,u=t.output,h=t.values,!o.size){e.next=12;break}d="",v=s(o);try{for(v.s();!(y=v.n()).done;)g=i(y.value,2),m=g[0],k=g[1],d+="Invalid ".concat(m,": ").concat(k,"\n")}catch(d){v.e(d)}finally{v.f()}return this.state.error=d,e.abrupt("return",p(l(n.prototype),"submit",this).call(this));case 12:if(!c.size){e.next=15;break}return this.state.error="Required: "+r(c.keys()).join(", "),e.abrupt("return",p(l(n.prototype),"submit",this).call(this));case 15:return b=f.unstyle(u).split("\n"),x=b.map((function(e){return e.slice(1)})).join("\n"),this.value={values:h,result:x},e.abrupt("return",p(l(n.prototype),"submit",this).call(this));case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(n(86));e.exports=y},function(e,t,n){"use strict";var r=n(28),i=n(8),s=n(2),a=n(3),o=n(9),c=n(42),u=function e(t){o(this,e),this.name=t.key,this.field=t.field||{},this.value=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"string"===typeof e?e.replace(/^['"]|['"]$/g,""):""}(t.initial||this.field.initial||""),this.message=t.message||this.name,this.cursor=0,this.input="",this.lines=[]},l=function(){var e=a(s.mark((function e(){var t,n,r,i,a,o,c,l,p,h,d,f,v,y,g,m,k=arguments;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=k.length>0&&void 0!==k[0]?k[0]:{},n=k.length>1&&void 0!==k[1]?k[1]:{},r=k.length>2&&void 0!==k[2]?k[2]:function(e){return e},i=new Set,a=t.fields||[],o=t.template,c=[],l=[],p=[],h=1,"function"!==typeof o){e.next=14;break}return e.next=13,o();case 13:o=e.sent;case 14:d=-1,f=function(){return o[++d]},v=function(){return o[d+1]},(y=function(e){e.line=h,c.push(e)})({type:"bos",value:""});case 19:if(!(d<o.length-1)){e.next=40;break}if(g=f(),!/^[^\S\n ]$/.test(g)){e.next=24;break}return y({type:"text",value:g}),e.abrupt("continue",19);case 24:if("\n"!==g){e.next=28;break}return y({type:"newline",value:g}),h++,e.abrupt("continue",19);case 28:if("\\"!==g){e.next=32;break}return g+=f(),y({type:"text",value:g}),e.abrupt("continue",19);case 32:if("$"!==g&&"#"!==g&&"{"!==g||"{"!==v()){e.next=36;break}if("continue"!==function(){for(var e=f(),t={type:"template",open:g+=e,inner:"",close:"",value:g},s=void 0;s=f();){if("}"===s){"}"===v()&&(s+=f()),t.value+=s,t.close=s;break}":"===s?(t.initial="",t.key=t.inner):void 0!==t.initial&&(t.initial+=s),t.value+=s,t.inner+=s}t.template=t.open+(t.initial||t.inner)+t.close,t.key=t.key||t.inner,n.hasOwnProperty(t.key)&&(t.initial=n[t.key]),t=r(t),y(t),p.push(t.key),i.add(t.key);var o=l.find((function(e){return e.name===t.key}));return t.field=a.find((function(e){return e.name===t.key})),o||(o=new u(t),l.push(o)),o.lines.push(t.line-1),"continue"}()){e.next=36;break}return e.abrupt("continue",19);case 36:"text"===(m=c[c.length-1]).type&&m.line===h?m.value+=g:y({type:"text",value:g}),e.next=19;break;case 40:return y({type:"eos",value:""}),e.abrupt("return",{input:o,tabstops:c,unique:i,keys:p,items:l});case 42:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function p(e,t,n,r){return function(n,i,s,a){return"function"===typeof s.field[e]?s.field[e].call(t,n,i,s,a):[r,n].find((function(e){return t.isValue(e)}))}}e.exports=function(){var e=a(s.mark((function e(t){var n,o,u,h,d,f,v,y,g,m,k;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.options,o=new Set(!0===n.required?[]:n.required||[]),u=i({},n.values,{},n.initial),e.next=5,l(n,u);case 5:return h=e.sent,d=h.tabstops,f=h.items,v=h.keys,y=p("result",t,n),g=p("format",t,n),m=p("validate",t,n,!0),k=t.isValue.bind(t),e.abrupt("return",a(s.mark((function e(){var i,u,l,p,h,b,x,w,C,M,I,P,A,O=arguments;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=O.length>0&&void 0!==O[0]?O[0]:{},u=O.length>1&&void 0!==O[1]&&O[1],l=0,i.required=o,i.items=f,i.keys=v,i.output="",p=function(){var e=a(s.mark((function e(t,n,r,i){var a;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(t,n,r,i);case 2:if(!1!==(a=e.sent)){e.next=5;break}return e.abrupt("return","Invalid field "+r.name);case 5:return e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}(),h=r(d),e.prev=9,x=s.mark((function e(){var r,a,o,h,d,v,m,x,w,C;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=b.value,a=r.value,o=r.key,"template"===r.type){e.next=6;break}return a&&(i.output+=a),e.abrupt("return","continue");case 6:if("template"!==r.type){e.next=35;break}if(h=f.find((function(e){return e.name===o})),!0===n.required&&i.required.add(h.name),d=[h.input,i.values[h.value],h.value,a].find(k),v=h.field||{},m=v.message||r.inner,!u){e.next=25;break}return e.next=15,p(i.values[o],i,h,l);case 15:if(!((x=e.sent)&&"string"===typeof x||!1===x)){e.next=19;break}return i.invalid.set(o,x),e.abrupt("return","continue");case 19:return i.invalid.delete(o),e.next=22,y(i.values[o],i,h,l);case 22:return w=e.sent,i.output+=c.unstyle(w),e.abrupt("return","continue");case 25:return h.placeholder=!1,C=a,e.next=29,g(a,i,h,l);case 29:a=e.sent,d!==a?(i.values[o]=d,a=t.styles.typing(d),i.missing.delete(m)):(i.values[o]=void 0,d="<".concat(m,">"),a=t.styles.primary(d),h.placeholder=!0,i.required.has(o)&&i.missing.add(m)),i.missing.has(m)&&i.validating&&(a=t.styles.warning(d)),i.invalid.has(o)&&i.validating&&(a=t.styles.danger(d)),l===i.index&&(a=C!==a?t.styles.underline(a):t.styles.heading(c.unstyle(a))),l++;case 35:a&&(i.output+=a);case 36:case"end":return e.stop()}}),e)})),h.s();case 12:if((b=h.n()).done){e.next=19;break}return e.delegateYield(x(),"t0",14);case 14:if("continue"!==e.t0){e.next=17;break}return e.abrupt("continue",17);case 17:e.next=12;break;case 19:e.next=24;break;case 21:e.prev=21,e.t1=e.catch(9),h.e(e.t1);case 24:return e.prev=24,h.f(),e.finish(24);case 27:w=i.output.split("\n").map((function(e){return" "+e})),C=f.length,M=0,I=r(f);try{for(I.s();!(P=I.n()).done;)A=P.value,i.invalid.has(A.name)&&A.lines.forEach((function(e){" "===w[e][0]&&(w[e]=i.styles.danger(i.symbols.bullet)+w[e].slice(1))})),t.isValue(i.values[A.name])&&M++}catch(S){I.e(S)}finally{I.f()}return i.completed=(M/C*100).toFixed(0),i.output=w.join("\n"),e.abrupt("return",i.output);case 35:case"end":return e.stop()}}),e,null,[[9,21,24,27]])}))));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},function(e,t,n){"use strict";var r=n(2),i=n(3),s=n(8),a=n(9),o=n(12),c=n(70),u=n(26),l=n(29),p=n(17),h=n(18),d="(Use <shift>+<up/down> to sort)",f=function(e){h(n,e);var t=p(n);function n(e){var r;return a(this,n),(r=t.call(this,s({},e,{reorder:!1,sort:!0,multiple:!0}))).state.hint=[r.options.hint,d].find(r.isValue.bind(c(r))),r}return o(n,[{key:"indicator",value:function(){return""}},{key:"renderChoice",value:function(){var e=i(r.mark((function e(t,i){var s,a,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(u(n.prototype),"renderChoice",this).call(this,t,i);case 2:if(s=e.sent,a=this.symbols.identicalTo+" ",o=this.index===i&&this.sorting?this.styles.muted(a):"  ",!1===this.options.drag&&(o=""),!0!==this.options.numbered){e.next=8;break}return e.abrupt("return",o+"".concat(i+1," - ")+s);case 8:return e.abrupt("return",o+s);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"submit",value:function(){return this.value=this.choices.map((function(e){return e.value})),l(u(n.prototype),"submit",this).call(this)}},{key:"selected",get:function(){return this.choices}}]),n}(n(56));e.exports=f},function(e,t,n){"use strict";var r=n(8),i=n(2),s=n(28),a=n(3),o=n(9),c=n(12),u=n(26),l=n(29),p=n(17),h=n(18),d=function(e){h(n,e);var t=p(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(o(this,n),(e=t.call(this,r)).emptyError=r.emptyError||"No items were selected",e.term=Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).TERM_PROGRAM,!e.options.header){var i=["","4 - Strongly Agree","3 - Agree","2 - Neutral","1 - Disagree","0 - Strongly Disagree",""];i=i.map((function(t){return e.styles.muted(t)})),e.state.header=i.join("\n   ")}return e}return c(n,[{key:"toChoices",value:function(){var e=a(i.mark((function e(){var t,r,a,o,c,p,h,d,v=arguments;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.createdScales){e.next=2;break}return e.abrupt("return",!1);case 2:for(this.createdScales=!0,r=v.length,a=new Array(r),o=0;o<r;o++)a[o]=v[o];return e.next=6,(t=l(u(n.prototype),"toChoices",this)).call.apply(t,[this].concat(a));case 6:c=e.sent,p=s(c);try{for(p.s();!(h=p.n()).done;)(d=h.value).scale=f(5,this.options),d.scaleIdx=2}catch(i){p.e(i)}finally{p.f()}return e.abrupt("return",c);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispatch",value:function(){this.alert()}},{key:"space",value:function(){var e=this.focused,t=e.scale[e.scaleIdx],n=t.selected;return e.scale.forEach((function(e){return e.selected=!1})),t.selected=!n,this.render()}},{key:"indicator",value:function(){return""}},{key:"pointer",value:function(){return""}},{key:"separator",value:function(){return this.styles.muted(this.symbols.ellipsis)}},{key:"right",value:function(){var e=this.focused;return e.scaleIdx>=e.scale.length-1?this.alert():(e.scaleIdx++,this.render())}},{key:"left",value:function(){var e=this.focused;return e.scaleIdx<=0?this.alert():(e.scaleIdx--,this.render())}},{key:"indent",value:function(){return"   "}},{key:"renderChoice",value:function(){var e=a(i.mark((function e(t,n){var r,s,a,o,c,u,l,p,h,d,f,v,y,g,m,k,b=this;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onChoice(t,n);case 2:return r=this.index===n,s="Hyper"===this.term,a=s?9:8,o=s?"":" ",c=this.symbols.line.repeat(a),u=" ".repeat(a+(s?0:1)),l=function(e){return(e?b.styles.success("\u25c9"):"\u25ef")+o},p=n+1+".",h=r?this.styles.heading:this.styles.noop,e.next=13,this.resolve(t.message,this.state,t,n);case 13:return d=e.sent,f=this.indent(t),v=f+t.scale.map((function(e,n){return l(n===t.scaleIdx)})).join(c),y=function(e){return e===t.scaleIdx?h(e):e},g=f+t.scale.map((function(e,t){return y(t)})).join(u),m=function(){return[p,d].filter(Boolean).join(" ")},k=function(){return[m(),v,g," "].filter(Boolean).join("\n")},r&&(v=this.styles.cyan(v),g=this.styles.cyan(g)),e.abrupt("return",k());case 22:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"renderChoices",value:function(){var e=a(i.mark((function e(){var t,n,r=this;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.submitted){e.next=2;break}return e.abrupt("return","");case 2:return t=this.visible.map(function(){var e=a(i.mark((function e(t,n){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.renderChoice(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),e.next=5,Promise.all(t);case 5:return(n=e.sent).length||n.push(this.styles.danger("No matching choices")),e.abrupt("return",n.join("\n"));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"format",value:function(){var e=this;return this.state.submitted?this.choices.map((function(t){return e.styles.info(t.scaleIdx)})).join(", "):""}},{key:"render",value:function(){var e=a(i.mark((function e(){var t,n,r,s,a,o,c,u,l,p,h,d;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.submitted,r=t.size,e.next=3,this.prefix();case 3:return s=e.sent,e.next=6,this.separator();case 6:return a=e.sent,e.next=9,this.message();case 9:return o=e.sent,c=[s,o,a].filter(Boolean).join(" "),this.state.prompt=c,e.next=14,this.header();case 14:return u=e.sent,e.next=17,this.format();case 17:return l=e.sent,e.next=20,this.error();case 20:if(e.t0=e.sent,e.t0){e.next=25;break}return e.next=24,this.hint();case 24:e.t0=e.sent;case 25:return p=e.t0,e.next=28,this.renderChoices();case 28:return h=e.sent,e.next=31,this.footer();case 31:d=e.sent,!l&&p||(c+=" "+l),p&&!c.includes(p)&&(c+=" "+p),n&&!l&&!h&&this.multiple&&"form"!==this.type&&(c+=this.styles.danger(this.emptyError)),this.clear(r),this.write([c,u,h,d].filter(Boolean).join("\n")),this.restore();case 38:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"submit",value:function(){this.value={};var e,t=s(this.choices);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.value[n.name]=n.scaleIdx}}catch(r){t.e(r)}finally{t.f()}return this.base.submit.call(this)}}]),n}(n(112));function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Array.isArray(t.scale))return t.scale.map((function(e){return r({},e)}));for(var n=[],i=1;i<e+1;i++)n.push({i:i,selected:!1});return n}e.exports=d},function(e,t,n){e.exports=n(250)},function(e,t,n){"use strict";var r=n(2),i=n(3),s=n(9),a=n(12),o=n(26),c=n(29),u=n(17),l=n(18),p=function(e){l(n,e);var t=u(n);function n(){return s(this,n),t.apply(this,arguments)}return a(n,[{key:"initialize",value:function(){var e=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(o(n.prototype),"initialize",this).call(this);case 2:return this.value=this.initial=!!this.options.initial,this.disabled=this.options.disabled||"no",this.enabled=this.options.enabled||"yes",e.next=7,this.render();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reset",value:function(){this.value=this.initial,this.render()}},{key:"delete",value:function(){this.alert()}},{key:"toggle",value:function(){this.value=!this.value,this.render()}},{key:"enable",value:function(){if(!0===this.value)return this.alert();this.value=!0,this.render()}},{key:"disable",value:function(){if(!1===this.value)return this.alert();this.value=!1,this.render()}},{key:"up",value:function(){this.toggle()}},{key:"down",value:function(){this.toggle()}},{key:"right",value:function(){this.toggle()}},{key:"left",value:function(){this.toggle()}},{key:"next",value:function(){this.toggle()}},{key:"prev",value:function(){this.toggle()}},{key:"dispatch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";switch(e.toLowerCase()){case" ":return this.toggle();case"1":case"y":case"t":return this.enable();case"0":case"n":case"f":return this.disable();default:return this.alert()}}},{key:"format",value:function(){var e=this,t=function(t){return e.styles.primary.underline(t)};return[this.value?this.disabled:t(this.disabled),this.value?t(this.enabled):this.enabled].join(this.styles.muted(" / "))}},{key:"render",value:function(){var e=i(r.mark((function e(){var t,n,i,s,a,o,c,u,l;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.size,e.next=3,this.header();case 3:return n=e.sent,e.next=6,this.prefix();case 6:return i=e.sent,e.next=9,this.separator();case 9:return s=e.sent,e.next=12,this.message();case 12:return a=e.sent,e.next=15,this.format();case 15:return o=e.sent,e.next=18,this.error();case 18:if(e.t0=e.sent,e.t0){e.next=23;break}return e.next=22,this.hint();case 22:e.t0=e.sent;case 23:return c=e.t0,e.next=26,this.footer();case 26:u=e.sent,l=[i,a,s,o].join(" "),this.state.prompt=l,c&&!l.includes(c)&&(l+=" "+c),this.clear(t),this.write([n,l,u].filter(Boolean).join("\n")),this.write(this.margin[2]),this.restore();case 34:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(n(158));e.exports=p},function(e,t,n){"use strict";var r=n(2),i=n(3),s=n(9),a=n(12),o=n(26),c=n(29),u=n(17),l=n(18),p=function(e){l(n,e);var t=u(n);function n(e){var r;if(s(this,n),"number"!==typeof(r=t.call(this,e)).options.correctChoice||r.options.correctChoice<0)throw new Error("Please specify the index of the correct answer from the list of choices");return r}return a(n,[{key:"toChoices",value:function(){var e=i(r.mark((function e(t,i){var s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(o(n.prototype),"toChoices",this).call(this,t,i);case 2:if(!((s=e.sent).length<2)){e.next=5;break}throw new Error("Please give at least two choices to the user");case 5:if(!(this.options.correctChoice>s.length)){e.next=7;break}throw new Error("Please specify the index of the correct answer from the list of choices");case 7:return e.abrupt("return",s);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"check",value:function(e){return e.index===this.options.correctChoice}},{key:"result",value:function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.t1=this.options.choices[this.options.correctChoice].value,e.next=4,this.check(this.state);case 4:return e.t2=e.sent,e.abrupt("return",{selectedAnswer:e.t0,correctAnswer:e.t1,correct:e.t2});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(n(56));e.exports=p},function(e,t,n){e.exports={ArrayPrompt:n(112),AuthPrompt:n(248),BooleanPrompt:n(158),NumberPrompt:n(251),StringPrompt:n(67)}},,function(e,t,n){var r=n(2),i=n(3),s=(n(44),n(34)),a=(n(52).promisify,n(90)),o=n(21)("dos:commands:config"),c=n(252).getHomePath,u=s.join(a.homedir(),".cmd-prototype"),l={set:function(e,t,n){return i(r.mark((function i(){var s,a,l,h,d;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o("set",t,n),s=e.configPath||u,r.next=4,p(s);case 4:return(a=r.sent)[t]=n,r.next=8,writeFile(s,JSON.stringify(a));case 8:if("apiaddr"!==t.toLowerCase()){r.next=15;break}return l=(e.IpfsApi||IpfsApi)(n),h=new Ipld(l.block),r.next=13,c(l);case 13:return d=r.sent,r.abrupt("return",{ctx:{ipld:h,ipfs:l,wd:d}});case 15:case"end":return r.stop()}}),i)})))()},get:function(e,t){return i(r.mark((function n(){var i,s;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o("get",t),n.next=3,p(e.configPath||u);case 3:return i=n.sent,s=t?i[t]:i,n.abrupt("return",{out:s});case 6:case"end":return n.stop()}}),n)})))()}};function p(e){return h.apply(this,arguments)}function h(){return(h=i(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=JSON,e.next=4,readFile(t);case 4:e.t1=e.sent,n=e.t0.parse.call(e.t0,e.t1),e.next=11;break;case 8:e.prev=8,e.t2=e.catch(0),o("failed to read config",e.t2);case 11:return e.abrupt("return",n||{});case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}e.exports=function(){var e=i(r.mark((function e(t,n){var i,s,a,o=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l[n]){e.next=2;break}throw new Error("".concat(n,": subcommand not found"));case 2:for(i=o.length,s=new Array(i>2?i-2:0),a=2;a<i;a++)s[a-2]=o[a];return e.abrupt("return",l[n].apply(l,[t].concat(s)));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},function(e,t,n){(function(t){e.exports=function(e){var n=e.spinner;n&&n.stop(),t.exit()},e.exports.help="Exit the current program"}).call(this,n(10))},function(e,t,n){var r=n(21)("dos:commands:help"),i=n(114),s=n(113);n(567);e.exports=function(e){var t=i();r("help: ",Object.keys(s)),t.div('Use the following commands (use "tab" for autocomplete):\n');var n=Object.keys(s).filter((function(e){return!!s[e].help}));n.forEach((function(e){t.div({text:e,width:20,padding:[0,0,0,0]},s[e].help.replace(/\n|\r|\r\n/g," ").trim()),t.div()}));var a=Object.keys(s).filter((function(e){return!s[e].help}));return t.div("No help provided for:\n"),t.div("    "+a.toString()),t.div(),{out:t.toString()}},e.exports.help="\nPrints this message\n"},,,,,,,,,,,,function(e,t,n){var r=n(2),i=n(3),s=(n(34).posix||n(34),n(21)("dos:commands:ls")),a=n(114),o=n(39);n(569);e.exports=function(){var e=i(r.mark((function e(t,n){var i,c,u,l,p;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.spinner,c=t.blockchain,u=c.getState(),l=u.network,i.text="Resolving ".concat(n),p=a(),Object.keys(l).forEach((function(e){s("child: ".concat(e));var t,n=l[e],r=n.address.getChainId().substring(0,8);s("chainId: ".concat(r));var i=n.lineageHeight,a=n.heavyHeight;(-1===i&&(i="-"),-1===a&&(a="-"),"."===e)&&(i=a=c.getState().provenance.height,r=c.getState().getChainId().substring(0,8));var u=a+"."+i;t="SYMLINK"!==n.systemRole?o.red(e):o.magenta(e),p.div({text:t,width:20},{text:u,width:10},{text:r,width:55})})),e.abrupt("return",{out:p.toString()});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.exports.help="\nlist the objects at the cwd.  lists alias, heavy height.lineage height, and chainId\n"},,function(e,t){e.exports=function(e){return{out:e.wd}}},function(e,t,n){var r=n(572);e.exports=function(){return{out:"v".concat(r.version)}}},function(e){e.exports=JSON.parse('{"name":"@dreamcatcher-tech/dos","version":"0.0.0","description":"Terminal interface to the HyperNet","main":"src/index.js","bin":{"dos":"src/bin.js"},"scripts":{"start":"DEBUG=\'dos* enquirer*\' node src/bin","dev":"DEBUG=\'\' nodemon src/bin","build":"webpack","build:watch":"nodemon --exec npm run build"},"author":"","license":"AGPL-3.0-or-later","dependencies":{"better-opn":"^2.0.0","chalk":"^4.1.0","clear":"^0.1.0","cliui":"^6.0.0","commander":"^6.1.0","debug":"^4.1.0","dedent":"^0.7.0","detect-node":"^2.0.4","docker-names":"^1.1.1","enquirer":"^2.3.6","figlet":"^1.2.4","filesize":"^3.6.1","localforage":"^1.9.0","ora":"^3.0.0","pad":"^3.2.0","pretty-ms":"^7.0.0","pull-stream":"^3.6.9","random-hash":"^4.0.1","wordwrap":"^1.0.0"},"devDependencies":{"nodemon":"^1.19.3"},"nodemonConfig":{"verbose":false,"watch":["./"]},"jest":{"testEnvironment":"node","transform":{}},"prettier":{"trailingComma":"es5","tabWidth":2,"semi":false,"singleQuote":true}}')},function(e,t,n){var r=n(2),i=n(3),s=n(21)("dos:commands:pkg");e.exports=function(){var e=i(r.mark((function e(t,n){var i,a,o,c,u=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=t.spinner,a=u.length,o=new Array(a>2?a-2:0),c=2;c<a;c++)o[c-2]=u[c];return s(n,o),e.next=5,new Promise((function(e){return setTimeout(e,2e3)}));case 5:return i.text="now with text",e.next=8,new Promise((function(e){return setTimeout(e,2e3)}));case 8:return i.succeed("stage 1 complete").start(),e.next=11,new Promise((function(e){return setTimeout(e,2e3)}));case 11:return i.fail("stage 2 failed").start(),e.next=14,new Promise((function(e){return setTimeout(e,2e3)}));case 14:return i.info("please try again later").start(),e.next=17,new Promise((function(e){return setTimeout(e,2e3)}));case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.exports.help="\nThe platform package manager.  Use list --installed \nto list all applications installed on the system.\nuse list to show all available applications available for install.\nUse search to narrow down the list of available packages.\nDefaults to listing installed applications.\n"},function(e,t,n){var r=n(575);e.exports=function(){return r()},e.exports.help="Clear the screen"},,function(e,t,n){var r=n(2),i=n(3),s=(n(47).prompt,n(577));e.exports=function(){var e=i(r.mark((function e(t,n){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return debug("open: ",n),e.next=3,s("https://aws.amazon.com/cognito/");case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},,,function(e,t,n){var r=n(2),i=n(3);n(21)("dos:commands:login");e.exports=function(){var e=i(r.mark((function e(t){var n,i,s,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.spinner,i=t.blockchain,s="34e3c74c43c0e9b2f3f2ef9f93a0f427ededf5878891b23d792d8f7c1a174b94",n.info("logging in to ".concat(s)).start(),n.text="connecting to: ".concat(url),e.next=6,i.addTransport(s,{url:url});case 6:return a=e.sent,n.succeed("latency of ".concat(a," ms ").concat(url)).start(),n.text="logging in to chain",e.next=11,i.login({chainId:s});case 11:return n.succeed("login successful"),e.abrupt("return",{out:url});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help='Loop the user through a signon process that links\nThe current machine pubkey to their interblock user chain.\nWhen this occurs, the guest chain will transition to the\nuser chain, and the prompt will change from "guest" to "user"'},function(e,t,n){var r=n(2),i=n(3),s=function(e){return new Promise((function(t){return setTimeout(t,e)}))};e.exports=function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("\n"),n(116)("https://aws.amazon.com/cognito/"),e.abrupt("return",s(2e3));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nDisconnect from the current remote host, else error and stay as local\n"},function(e,t,n){var r=n(2),i=n(3),s=n(21)("dos:commands:su"),a=(new(n(582).Command),n(47).prompt);e.exports=function(){var e=i(r.mark((function e(t,n){var i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s(n),n){e.next=3;break}throw new Error("must supply user name or chainId to elevate to");case 3:return e.next=5,a([{name:"password"}]);case 5:i=e.sent,s(i);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},,function(e,t,n){var r=n(2),i=n(3),s=n(21)("dos:commands:add"),a=n(39);n(47).prompt;e.exports=function(){var e=i(r.mark((function e(t){var n,i,o,c,u,l,p,h,d,f,v,y,g=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.spinner,i=t.blockchain,o=g.length,c=new Array(o>1?o-1:0),u=1;u<o;u++)c[u-1]=g[u];s("add: %O",c),l="",p=0,h=c;case 5:if(!(p<h.length)){e.next=18;break}return d=h[p],n.text="adding ".concat(d,"..."),e.next=10,i.add(d);case 10:f=e.sent,v=f.alias,y=f.chainId,n.succeed("added ".concat(d)).start(),l+="Added: ".concat(a.red(v),"\n - chainId: ").concat(a.greenBright(y),"\n");case 15:p++,e.next=5;break;case 18:return e.abrupt("return",{out:l.trim()});case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nThis command will be overridden by each application.\nIt serves as the general action of creating a new entity\nwhere the entity is specific to the application being executed.\nWhen used in the native setting, it makes a blank datum chain.\nDepending on the context, additional info may need to be provided to\ncreate the child.\n"},function(e,t,n){var r=n(2),i=n(3);e.exports=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),e.exports.help="\nLinking is act of inserting one Object as the child of another\nwhich allows an Object to be the child of more than one parent.\nThis operation is essential to application data structures\nas opposed to simple filesystem data structures, which are \nusually a tree\n"},function(e,t,n){var r=n(2),i=n(3),s=n(21)("dos:commands:rm");n(39),n(47).prompt;e.exports=function(){var e=i(r.mark((function e(t,n){var i,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.spinner,i=t.blockchain,s("rm: %O",n),e.next=4,i.rm(n);case 4:a=e.sent,s("result: %O",a);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.exports.help="\nRemove blockchains.  If they are symlinks, will remove\nthe link only.  If children, will be permanently deleted.\n"},function(e,t,n){var r=n(2),i=n(3),s=(n(21)("dos:commands:whoami"),n(39)),a=n(114);e.exports=function(){var e=i(r.mark((function e(t){var n,i,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.blockchain,i=n.getState().getChainId(),(o=a()).div({text:"User:",width:15},"root"),o.div({text:"Machine:",width:15},s.green(i)),o.div({text:"Hypercomputer:",width:15},s.red("NOT CONNECTED")),e.abrupt("return",{out:o.toString()});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nLists info about the current machine, current user, and connected hypercomputer\n"},function(e,t,n){var r=n(2),i=n(3);e.exports=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(116)("https://aws.amazon.com/cognito/");case 1:case"end":return e.stop()}}),e)})))},function(e,t,n){var r=n(2),i=n(3),s=n(589),a=n(21)("dos:commands:time");e.exports=function(){var e=i(r.mark((function e(t){var i,o,c,u,l,p,h,d,f,v=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=n(159),o=i.evaluate,c=v.length,u=new Array(c>1?c-1:0),l=1;l<c;l++)u[l-1]=v[l];if(!(u.length<1)){e.next=4;break}throw new Error("Must supply command");case 4:return p=u[0],h=u.slice(1),a("time: ",p,h),d=Date.now(),e.next=9,o(t,p,h);case 9:if(e.t0=e.sent,e.t0){e.next=12;break}e.t0={};case 12:return(f=e.t0).out=f.out||"",f.out=f.out+"\nTime: ".concat(s(Date.now()-d)),e.abrupt("return",f);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nMeasure how long a command takes.\n"},,,function(e,t,n){var r=n(2),i=n(3),s=n(21)("dos:commands:ping");e.exports=function(){var e=i(r.mark((function e(t,n,i){var a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.spinner,a=t.blockchain,s("ping path: %O options: %O",n,i),e.next=4,a.ping(n);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),e.exports.help="\nSend a ping to a chain, receive a response.\n\nTODO: \n1. send data with the ping\n2. ping indefinitely\n3. do 4 pings and report average times\n4. allow path pings\n"},function(e,t,n){var r=n(2),i=n(3),s=n(21)("dos:commands:reset"),a=n(47).prompt;e.exports=function(){var e=i(r.mark((function e(t){var n,i,o,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.spinner,t.blockchain,s("reset"),n.stop(),e.next=5,a({type:"confirm",name:"reset",message:"Resetting will delete all local blockchains"});case 5:return i=e.sent,o=i.reset,c=o?"All local blockchains deleted":"Cancelled reset",e.abrupt("return",{out:c});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nDump all the local blockchain state, generate a new\ngenesis block, reset login status.\nIn dev mode will also reset the emulated aws.\n"},function(e,t,n){var r=n(2),i=n(3),s=n(21)("dos:commands:dns");n(39),n(47).prompt;e.exports=function(){var t=i(r.mark((function t(n,i){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.spinner,n.blockchain,s("dns %O",i),t.abrupt("return",{out:e.exports.help});case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.exports.help="\nService to map strings to chainIds.\nMultiple services and manual overrides can be provided.\n"},function(e,t,n){var r=n(2),i=n(3),s=n(52),a=n(21)("dos:commands:cat");n(39),n(47).prompt;e.exports=function(){var e=i(r.mark((function e(t){var n,i,o,c,u,l,p,h=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t.spinner,n=t.blockchain,i=h.length>1&&void 0!==h[1]?h[1]:".",o=h.length,c=new Array(o>2?o-2:0),u=2;u<o;u++)c[u-2]=h[u];return a("cat path: %O args: %O",i,c),l=n.getState(i),p=s.inspect(l,{colors:!0,depth:null}),e.abrupt("return",{out:p});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nShow the internal state of a chain.\n\nTODO\nArgs for full state, or partial state, or a particular path in the state.\n"},function(e,t,n){var r=n(2),i=n(3),s=n(21)("dos:commands:tx");n(39),n(47).prompt;e.exports=function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.spinner,t.blockchain,s("TODO tx: %O");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nList and modify the transports used.  These are typically URLs\nwhich point to various block producing peers\n"},function(e,t,n){var r=n(2),i=n(3),s=n(21);e.exports=function(){var e=i(r.mark((function e(t){var n,i,a,o,c,u,l,p,h=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.blockchain,i=h.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=h[o];return c=a.join(" "),u=n._debug.disable(),l=s.disable(),p="current interblock flags: "+u,p+="\ncurrent dos flags: "+l,p+="\nsetting flags to: "+c,n._debug.enable(c),s.enable(c),e.abrupt("return",{out:p});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nChange flags to alter debug output on console.\n\nWith no arguments, toggle disable and enable, and will print the currently set flags.\nOtherwise will set the current flags.\n\nSee https://github.com/visionmedia/debug"},function(e,t,n){var r=n(2),i=n(3);e.exports=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(116)("https://aws.amazon.com/cognito/");case 1:case"end":return e.stop()}}),e)})))},function(e,t,n){var r=n(2),i=n(3),s=n(39),a=n(114),o=s.bold.yellow("Object"),c=s.bold.yellow("Link"),u=s.bold.yellow("Covenant"),l=s.bold.yellow("StateMachine"),p=s.bold.yellow("DistributedOperatingSystem"),h=s.bold.yellow("FileSystem"),d=s.bold.yellow("App");e.exports=i(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=a()).div("Everything in this ".concat(p," is a Blockchain ").concat(o)),t.div(),t.div({text:"1.",width:4},"".concat(o,"s exist everywhere independent of any single computer because they are virtual, and not tied to a particular machine, freeing them from the faults of nature which plague physical hardware")),t.div({text:"2.",width:4},"".concat(o,"s can connect to each other to transfer instructions or payload data via ").concat(c,"s.")),t.div({text:"3.",width:4},"The logic governing the behaviour of ".concat(o,"s is inside a ").concat(u)),t.div({text:"4.",width:4},"A subclass of ".concat(u," is a ").concat(l)),t.div({text:"5.",width:4},"In our system, ".concat(o,"s are only changed internally by ").concat(l,"s")),t.div({text:"6.",width:4},"When viewed as a Graph, the ".concat(c,"s between all ").concat(o,"s are the ").concat(h)),t.div({text:"7.",width:4},"The ".concat(h," is arranged in a hierarchy from a root, so that it looks like a POSIX filesystem for the familiarity of our users")),t.div({text:"8.",width:4},"When viewed as executables, the collection of ".concat(l,"s are the ").concat(d,"s of our ").concat(p," ")),t.div({text:"9.",width:4},"Including the ".concat(d," named the Dreamcatcher means we by default include the ").concat(d," that coordinates Talent into making more ").concat(d,"s")),t.div(),t.div("type 'help' for a list of commands"),t.div(),e.abrupt("return",{out:t.toString()});case 16:case"end":return e.stop()}}),e)}))),e.exports.help="Information about the HyperNet"},function(e,t,n){var r=n(2),i=n(3),s=n(21)("dos:commands:blocks"),a=n(117).engine.blockPrint;e.exports=function(){var e=i(r.mark((function e(t){var n,i,o,c,u;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.blockchain,s("blocks"),o=n.getState().provenance.height,c=0,u="";c<=o;)".",i=n.getState(".",c),u+=a(i,"/test/")+"\n",c++,s("next height: ",c);return e.abrupt("return",{out:u});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nShow the blocks of any given blockchain.\nIf no chain ID or alias given, print the blocks of the \nblockchain at the cwd\n"},function(e,t,n){var r=n(2),i=n(3);e.exports=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),e.exports.help="\nTo ensure the integrity of the system, invoke scrub to\ncheck the hashes of all objects at this location,\nand to verify the availability of all objects.\nUse the option --history to check all blocks in the past\nas well as LATEST.  This will incur significant usage fees\nand bandwidth.\n"},function(e,t,n){var r=n(2),i=n(3),s=n(21)("dos:commands:namegen"),a=n(602);e.exports=function(){var e=i(r.mark((function e(t){var n,i,o=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t.spinner,t.blockchain,n=o.length>1&&void 0!==o[1]?o[1]:1,s("count: %O",n),i="";n>0;)i+=a.getRandomName(),--n>0&&(i+="\n");return e.abrupt("return",{out:i});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.exports.help="\nGenerate a random name, which can be used as an identity for anything.\n"},,function(e,t,n){var r=n(2),i=n(3),s=n(9),a=n(12),o=n(21)("dos:auto-complete"),c=n(39),u=n(160).withSpin,l=n(113),p=function(){"use strict";function e(){s(this,e),this._list=[],this.getList=this.getList.bind(this)}return a(e,[{key:"updateList",value:function(){var e=i(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.wd,(n=t.spinner)&&(n.text="Updating auto-complete list"),i=Object.keys(l),[],this._list=i;case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getList",value:function(e){return e.includes(" ")?this._list:Object.keys(l)}}]),e}();t.AutoComplete=p,t.withAutoComplete=function(e){return function(){var t=i(r.mark((function t(n){var i=arguments;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.autoComplete||(n.autoComplete=new p,n.autoComplete.updateList=u(n.autoComplete.updateList)),t.prev=1,t.next=4,n.autoComplete.updateList(n);case 4:t.next=10;break;case 6:t.prev=6,t.t0=t.catch(1),console.warn("".concat(c.yellow("\u26a0")," failed to update auto-complete list")),o(t.t0);case 10:return o("auto-complete"),t.abrupt("return",e.apply(this,i));case 12:case"end":return t.stop()}}),t,this,[[1,6]])})));return function(e){return t.apply(this,arguments)}}()}},function(e,t,n){var r=n(2),i=n(3);e.exports=function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,t();case 3:e.next=0;break;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},,,,,,,,,function(e,t,n){"use strict";n.r(t);var r=n(5),i=n.n(r),s=n(258),a=n.n(s),o=(n(271),n(272),n(119),n(68)),c=n.n(o),u=n(259);c()("shell:App");c.a.enable("*metro* dos-shell*");var l=function(){return i.a.createElement(u.a,{style:{height:"100vh",backgroundColor:"black"}})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(l,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}]),[[266,1,2]]]);